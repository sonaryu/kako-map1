(()=>{var e,t,i={2359:(e,t,i)=>{var s=i(5623);e.exports=function expandTop(e){if(!e)return[];"{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2));return expand(function escapeBraces(e){return e.split("\\\\").join(n).split("\\{").join(a).split("\\}").join(r).split("\\,").join(o).split("\\.").join(c)}(e),!0).map(unescapeBraces)};var n="\0SLASH"+Math.random()+"\0",a="\0OPEN"+Math.random()+"\0",r="\0CLOSE"+Math.random()+"\0",o="\0COMMA"+Math.random()+"\0",c="\0PERIOD"+Math.random()+"\0";function numeric(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function unescapeBraces(e){return e.split(n).join("\\").split(a).join("{").split(r).join("}").split(o).join(",").split(c).join(".")}function parseCommaParts(e){if(!e)return[""];var t=[],i=s("{","}",e);if(!i)return e.split(",");var n=i.pre,a=i.body,r=i.post,o=n.split(",");o[o.length-1]+="{"+a+"}";var c=parseCommaParts(r);return r.length&&(o[o.length-1]+=c.shift(),o.push.apply(o,c)),t.push.apply(t,o),t}function embrace(e){return"{"+e+"}"}function isPadded(e){return/^-?0\d/.test(e)}function lte(e,t){return e<=t}function gte(e,t){return e>=t}function expand(e,t){var i=[],n=s("{","}",e);if(!n)return[e];var a=n.pre,o=n.post.length?expand(n.post,!1):[""];if(/\$$/.test(n.pre))for(var c=0;c<o.length;c++){var l=a+"{"+n.body+"}"+o[c];i.push(l)}else{var p,d,h=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),u=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),g=h||u,v=n.body.indexOf(",")>=0;if(!g&&!v)return n.post.match(/,.*\}/)?expand(e=n.pre+"{"+n.body+r+n.post):[e];if(g)p=n.body.split(/\.\./);else if(1===(p=parseCommaParts(n.body)).length&&1===(p=expand(p[0],!1).map(embrace)).length)return o.map((function(e){return n.pre+p[0]+e}));if(g){var y=numeric(p[0]),x=numeric(p[1]),_=Math.max(p[0].length,p[1].length),b=3==p.length?Math.abs(numeric(p[2])):1,w=lte;x<y&&(b*=-1,w=gte);var E=p.some(isPadded);d=[];for(var k=y;w(k,x);k+=b){var S;if(u)"\\"===(S=String.fromCharCode(k))&&(S="");else if(S=String(k),E){var T=_-S.length;if(T>0){var A=new Array(T+1).join("0");S=k<0?"-"+A+S.slice(1):A+S}}d.push(S)}}else{d=[];for(var O=0;O<p.length;O++)d.push.apply(d,expand(p[O],!1))}for(O=0;O<d.length;O++)for(c=0;c<o.length;c++){l=a+d[O]+o[c];(!t||g||l)&&i.push(l)}}return i}},5492:(e,t,i)=>{function ownProp(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.setopts=function setopts(e,t,i){i||(i={});if(i.matchBase&&-1===t.indexOf("/")){if(i.noglobstar)throw new Error("base matching requires globstar");t="**/"+t}e.silent=!!i.silent,e.pattern=t,e.strict=!1!==i.strict,e.realpath=!!i.realpath,e.realpathCache=i.realpathCache||Object.create(null),e.follow=!!i.follow,e.dot=!!i.dot,e.mark=!!i.mark,e.nodir=!!i.nodir,e.nodir&&(e.mark=!0);e.sync=!!i.sync,e.nounique=!!i.nounique,e.nonull=!!i.nonull,e.nosort=!!i.nosort,e.nocase=!!i.nocase,e.stat=!!i.stat,e.noprocess=!!i.noprocess,e.absolute=!!i.absolute,e.fs=i.fs||s,e.maxLength=i.maxLength||1/0,e.cache=i.cache||Object.create(null),e.statCache=i.statCache||Object.create(null),e.symlinks=i.symlinks||Object.create(null),function setupIgnores(e,t){e.ignore=t.ignore||[],Array.isArray(e.ignore)||(e.ignore=[e.ignore]);e.ignore.length&&(e.ignore=e.ignore.map(ignoreMap))}(e,i),e.changedCwd=!1;var a=process.cwd();ownProp(i,"cwd")?(e.cwd=n.resolve(i.cwd),e.changedCwd=e.cwd!==a):e.cwd=n.resolve(a);e.root=i.root||n.resolve(e.cwd,"/"),e.root=n.resolve(e.root),e.cwdAbs=r(e.cwd)?e.cwd:makeAbs(e,e.cwd),e.nomount=!!i.nomount,"win32"===process.platform&&(e.root=e.root.replace(/\\/g,"/"),e.cwd=e.cwd.replace(/\\/g,"/"),e.cwdAbs=e.cwdAbs.replace(/\\/g,"/"));i.nonegate=!0,i.nocomment=!0,i.allowWindowsEscape=!0,e.minimatch=new o(t,i),e.options=e.minimatch.options},t.ownProp=ownProp,t.makeAbs=makeAbs,t.finish=function finish(e){for(var t=e.nounique,i=t?[]:Object.create(null),s=0,n=e.matches.length;s<n;s++){var a=e.matches[s];if(a&&0!==Object.keys(a).length){var r=Object.keys(a);t?i.push.apply(i,r):r.forEach((function(e){i[e]=!0}))}else if(e.nonull){var o=e.minimatch.globSet[s];t?i.push(o):i[o]=!0}}t||(i=Object.keys(i));e.nosort||(i=i.sort(alphasort));if(e.mark){for(s=0;s<i.length;s++)i[s]=e._mark(i[s]);e.nodir&&(i=i.filter((function(t){var i=!/\/$/.test(t),s=e.cache[t]||e.cache[makeAbs(e,t)];return i&&s&&(i="DIR"!==s&&!Array.isArray(s)),i})))}e.ignore.length&&(i=i.filter((function(t){return!isIgnored(e,t)})));e.found=i},t.mark=function mark(e,t){var i=makeAbs(e,t),s=e.cache[i],n=t;if(s){var a="DIR"===s||Array.isArray(s),r="/"===t.slice(-1);if(a&&!r?n+="/":!a&&r&&(n=n.slice(0,-1)),n!==t){var o=makeAbs(e,n);e.statCache[o]=e.statCache[i],e.cache[o]=e.cache[i]}}return n},t.isIgnored=isIgnored,t.childrenIgnored=function childrenIgnored(e,t){return!!e.ignore.length&&e.ignore.some((function(e){return!(!e.gmatcher||!e.gmatcher.match(t))}))};var s=i(7147),n=i(1017),a=i(9437),r=i(1017).isAbsolute,o=a.Minimatch;function alphasort(e,t){return e.localeCompare(t,"en")}function ignoreMap(e){var t=null;if("/**"===e.slice(-3)){var i=e.replace(/(\/\*\*)+$/,"");t=new o(i,{dot:!0})}return{matcher:new o(e,{dot:!0}),gmatcher:t}}function makeAbs(e,t){var i=t;return i="/"===t.charAt(0)?n.join(e.root,t):r(t)||""===t?t:e.changedCwd?n.resolve(e.cwd,t):n.resolve(t),"win32"===process.platform&&(i=i.replace(/\\/g,"/")),i}function isIgnored(e,t){return!!e.ignore.length&&e.ignore.some((function(e){return e.matcher.match(t)||!(!e.gmatcher||!e.gmatcher.match(t))}))}},8285:(e,t,i)=>{e.exports=glob;var s=i(7334),n=i(9437),a=(n.Minimatch,i(4378)),r=i(2361).EventEmitter,o=i(1017),c=i(9491),l=i(1017).isAbsolute,p=i(5714),d=i(5492),h=d.setopts,u=d.ownProp,g=i(7844),v=(i(3837),d.childrenIgnored),y=d.isIgnored,x=i(778);function glob(e,t,i){if("function"==typeof t&&(i=t,t={}),t||(t={}),t.sync){if(i)throw new TypeError("callback provided to sync glob");return p(e,t)}return new Glob(e,t,i)}glob.sync=p;var _=glob.GlobSync=p.GlobSync;function Glob(e,t,i){if("function"==typeof t&&(i=t,t=null),t&&t.sync){if(i)throw new TypeError("callback provided to sync glob");return new _(e,t)}if(!(this instanceof Glob))return new Glob(e,t,i);h(this,e,t),this._didRealPath=!1;var s=this.minimatch.set.length;this.matches=new Array(s),"function"==typeof i&&(i=x(i),this.on("error",i),this.on("end",(function(e){i(null,e)})));var n=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===s)return done();for(var a=0;a<s;a++)this._process(this.minimatch.set[a],a,!1,done);function done(){--n._processing,n._processing<=0&&n._finish()}}glob.glob=glob,glob.hasMagic=function(e,t){var i=function extend(e,t){if(null===t||"object"!=typeof t)return e;for(var i=Object.keys(t),s=i.length;s--;)e[i[s]]=t[i[s]];return e}({},t);i.noprocess=!0;var s=new Glob(e,i).minimatch.set;if(!e)return!1;if(s.length>1)return!0;for(var n=0;n<s[0].length;n++)if("string"!=typeof s[0][n])return!0;return!1},glob.Glob=Glob,a(Glob,r),Glob.prototype._finish=function(){if(c(this instanceof Glob),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();d.finish(this),this.emit("end",this.found)}},Glob.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var e=this.matches.length;if(0===e)return this._finish();for(var t=this,i=0;i<this.matches.length;i++)this._realpathSet(i,next)}function next(){0==--e&&t._finish()}},Glob.prototype._realpathSet=function(e,t){var i=this.matches[e];if(!i)return t();var n=Object.keys(i),a=this,r=n.length;if(0===r)return t();var o=this.matches[e]=Object.create(null);n.forEach((function(i,n){i=a._makeAbs(i),s.realpath(i,a.realpathCache,(function(s,n){s?"stat"===s.syscall?o[i]=!0:a.emit("error",s):o[n]=!0,0==--r&&(a.matches[e]=o,t())}))}))},Glob.prototype._mark=function(e){return d.mark(this,e)},Glob.prototype._makeAbs=function(e){return d.makeAbs(this,e)},Glob.prototype.abort=function(){this.aborted=!0,this.emit("abort")},Glob.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},Glob.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var e=this._emitQueue.slice(0);this._emitQueue.length=0;for(var t=0;t<e.length;t++){var i=e[t];this._emitMatch(i[0],i[1])}}if(this._processQueue.length){var s=this._processQueue.slice(0);this._processQueue.length=0;for(t=0;t<s.length;t++){var n=s[t];this._processing--,this._process(n[0],n[1],n[2],n[3])}}}},Glob.prototype._process=function(e,t,i,s){if(c(this instanceof Glob),c("function"==typeof s),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([e,t,i,s]);else{for(var a,r=0;"string"==typeof e[r];)r++;switch(r){case e.length:return void this._processSimple(e.join("/"),t,s);case 0:a=null;break;default:a=e.slice(0,r).join("/")}var o,p=e.slice(r);null===a?o=".":l(a)||l(e.map((function(e){return"string"==typeof e?e:"[*]"})).join("/"))?(a&&l(a)||(a="/"+a),o=a):o=a;var d=this._makeAbs(o);if(v(this,o))return s();p[0]===n.GLOBSTAR?this._processGlobStar(a,o,d,p,t,i,s):this._processReaddir(a,o,d,p,t,i,s)}},Glob.prototype._processReaddir=function(e,t,i,s,n,a,r){var o=this;this._readdir(i,a,(function(c,l){return o._processReaddir2(e,t,i,s,n,a,l,r)}))},Glob.prototype._processReaddir2=function(e,t,i,s,n,a,r,c){if(!r)return c();for(var l=s[0],p=!!this.minimatch.negate,d=l._glob,h=this.dot||"."===d.charAt(0),u=[],g=0;g<r.length;g++){if("."!==(y=r[g]).charAt(0)||h)(p&&!e?!y.match(l):y.match(l))&&u.push(y)}var v=u.length;if(0===v)return c();if(1===s.length&&!this.mark&&!this.stat){this.matches[n]||(this.matches[n]=Object.create(null));for(g=0;g<v;g++){var y=u[g];e&&(y="/"!==e?e+"/"+y:e+y),"/"!==y.charAt(0)||this.nomount||(y=o.join(this.root,y)),this._emitMatch(n,y)}return c()}s.shift();for(g=0;g<v;g++){y=u[g];e&&(y="/"!==e?e+"/"+y:e+y),this._process([y].concat(s),n,a,c)}c()},Glob.prototype._emitMatch=function(e,t){if(!this.aborted&&!y(this,t))if(this.paused)this._emitQueue.push([e,t]);else{var i=l(t)?t:this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=i),!this.matches[e][t]){if(this.nodir){var s=this.cache[i];if("DIR"===s||Array.isArray(s))return}this.matches[e][t]=!0;var n=this.statCache[i];n&&this.emit("stat",t,n),this.emit("match",t)}}},Glob.prototype._readdirInGlobStar=function(e,t){if(!this.aborted){if(this.follow)return this._readdir(e,!1,t);var i=this,s=g("lstat\0"+e,(function lstatcb_(s,n){if(s&&"ENOENT"===s.code)return t();var a=n&&n.isSymbolicLink();i.symlinks[e]=a,a||!n||n.isDirectory()?i._readdir(e,!1,t):(i.cache[e]="FILE",t())}));s&&i.fs.lstat(e,s)}},Glob.prototype._readdir=function(e,t,i){if(!this.aborted&&(i=g("readdir\0"+e+"\0"+t,i))){if(t&&!u(this.symlinks,e))return this._readdirInGlobStar(e,i);if(u(this.cache,e)){var s=this.cache[e];if(!s||"FILE"===s)return i();if(Array.isArray(s))return i(null,s)}this.fs.readdir(e,function readdirCb(e,t,i){return function(s,n){s?e._readdirError(t,s,i):e._readdirEntries(t,n,i)}}(this,e,i))}},Glob.prototype._readdirEntries=function(e,t,i){if(!this.aborted){if(!this.mark&&!this.stat)for(var s=0;s<t.length;s++){var n=t[s];n="/"===e?e+n:e+"/"+n,this.cache[n]=!0}return this.cache[e]=t,i(null,t)}},Glob.prototype._readdirError=function(e,t,i){if(!this.aborted){switch(t.code){case"ENOTSUP":case"ENOTDIR":var s=this._makeAbs(e);if(this.cache[s]="FILE",s===this.cwdAbs){var n=new Error(t.code+" invalid cwd "+this.cwd);n.path=this.cwd,n.code=t.code,this.emit("error",n),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:this.cache[this._makeAbs(e)]=!1,this.strict&&(this.emit("error",t),this.abort()),this.silent||console.error("glob error",t)}return i()}},Glob.prototype._processGlobStar=function(e,t,i,s,n,a,r){var o=this;this._readdir(i,a,(function(c,l){o._processGlobStar2(e,t,i,s,n,a,l,r)}))},Glob.prototype._processGlobStar2=function(e,t,i,s,n,a,r,o){if(!r)return o();var c=s.slice(1),l=e?[e]:[],p=l.concat(c);this._process(p,n,!1,o);var d=this.symlinks[i],h=r.length;if(d&&a)return o();for(var u=0;u<h;u++){if("."!==r[u].charAt(0)||this.dot){var g=l.concat(r[u],c);this._process(g,n,!0,o);var v=l.concat(r[u],s);this._process(v,n,!0,o)}}o()},Glob.prototype._processSimple=function(e,t,i){var s=this;this._stat(e,(function(n,a){s._processSimple2(e,t,n,a,i)}))},Glob.prototype._processSimple2=function(e,t,i,s,n){if(this.matches[t]||(this.matches[t]=Object.create(null)),!s)return n();if(e&&l(e)&&!this.nomount){var a=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=o.join(this.root,e):(e=o.resolve(this.root,e),a&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e),n()},Glob.prototype._stat=function(e,t){var i=this._makeAbs(e),s="/"===e.slice(-1);if(e.length>this.maxLength)return t();if(!this.stat&&u(this.cache,i)){var n=this.cache[i];if(Array.isArray(n)&&(n="DIR"),!s||"DIR"===n)return t(null,n);if(s&&"FILE"===n)return t()}var a=this.statCache[i];if(void 0!==a){if(!1===a)return t(null,a);var r=a.isDirectory()?"DIR":"FILE";return s&&"FILE"===r?t():t(null,r,a)}var o=this,c=g("stat\0"+i,(function lstatcb_(s,n){if(n&&n.isSymbolicLink())return o.fs.stat(i,(function(s,a){s?o._stat2(e,i,null,n,t):o._stat2(e,i,s,a,t)}));o._stat2(e,i,s,n,t)}));c&&o.fs.lstat(i,c)},Glob.prototype._stat2=function(e,t,i,s,n){if(i&&("ENOENT"===i.code||"ENOTDIR"===i.code))return this.statCache[t]=!1,n();var a="/"===e.slice(-1);if(this.statCache[t]=s,"/"===t.slice(-1)&&s&&!s.isDirectory())return n(null,!1,s);var r=!0;return s&&(r=s.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||r,a&&"FILE"===r?n():n(null,r,s)}},5714:(e,t,i)=>{e.exports=globSync,globSync.GlobSync=GlobSync;var s=i(7334),n=i(9437),a=(n.Minimatch,i(8285).Glob,i(3837),i(1017)),r=i(9491),o=i(1017).isAbsolute,c=i(5492),l=c.setopts,p=c.ownProp,d=c.childrenIgnored,h=c.isIgnored;function globSync(e,t){if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new GlobSync(e,t).found}function GlobSync(e,t){if(!e)throw new Error("must provide pattern");if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof GlobSync))return new GlobSync(e,t);if(l(this,e,t),this.noprocess)return this;var i=this.minimatch.set.length;this.matches=new Array(i);for(var s=0;s<i;s++)this._process(this.minimatch.set[s],s,!1);this._finish()}GlobSync.prototype._finish=function(){if(r.ok(this instanceof GlobSync),this.realpath){var e=this;this.matches.forEach((function(t,i){var n=e.matches[i]=Object.create(null);for(var a in t)try{a=e._makeAbs(a),n[s.realpathSync(a,e.realpathCache)]=!0}catch(t){if("stat"!==t.syscall)throw t;n[e._makeAbs(a)]=!0}}))}c.finish(this)},GlobSync.prototype._process=function(e,t,i){r.ok(this instanceof GlobSync);for(var s,a=0;"string"==typeof e[a];)a++;switch(a){case e.length:return void this._processSimple(e.join("/"),t);case 0:s=null;break;default:s=e.slice(0,a).join("/")}var c,l=e.slice(a);null===s?c=".":o(s)||o(e.map((function(e){return"string"==typeof e?e:"[*]"})).join("/"))?(s&&o(s)||(s="/"+s),c=s):c=s;var p=this._makeAbs(c);d(this,c)||(l[0]===n.GLOBSTAR?this._processGlobStar(s,c,p,l,t,i):this._processReaddir(s,c,p,l,t,i))},GlobSync.prototype._processReaddir=function(e,t,i,s,n,r){var o=this._readdir(i,r);if(o){for(var c=s[0],l=!!this.minimatch.negate,p=c._glob,d=this.dot||"."===p.charAt(0),h=[],u=0;u<o.length;u++){if("."!==(y=o[u]).charAt(0)||d)(l&&!e?!y.match(c):y.match(c))&&h.push(y)}var g=h.length;if(0!==g)if(1!==s.length||this.mark||this.stat){s.shift();for(u=0;u<g;u++){var v;y=h[u];v=e?[e,y]:[y],this._process(v.concat(s),n,r)}}else{this.matches[n]||(this.matches[n]=Object.create(null));for(var u=0;u<g;u++){var y=h[u];e&&(y="/"!==e.slice(-1)?e+"/"+y:e+y),"/"!==y.charAt(0)||this.nomount||(y=a.join(this.root,y)),this._emitMatch(n,y)}}}},GlobSync.prototype._emitMatch=function(e,t){if(!h(this,t)){var i=this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=i),!this.matches[e][t]){if(this.nodir){var s=this.cache[i];if("DIR"===s||Array.isArray(s))return}this.matches[e][t]=!0,this.stat&&this._stat(t)}}},GlobSync.prototype._readdirInGlobStar=function(e){if(this.follow)return this._readdir(e,!1);var t,i;try{i=this.fs.lstatSync(e)}catch(e){if("ENOENT"===e.code)return null}var s=i&&i.isSymbolicLink();return this.symlinks[e]=s,s||!i||i.isDirectory()?t=this._readdir(e,!1):this.cache[e]="FILE",t},GlobSync.prototype._readdir=function(e,t){if(t&&!p(this.symlinks,e))return this._readdirInGlobStar(e);if(p(this.cache,e)){var i=this.cache[e];if(!i||"FILE"===i)return null;if(Array.isArray(i))return i}try{return this._readdirEntries(e,this.fs.readdirSync(e))}catch(t){return this._readdirError(e,t),null}},GlobSync.prototype._readdirEntries=function(e,t){if(!this.mark&&!this.stat)for(var i=0;i<t.length;i++){var s=t[i];s="/"===e?e+s:e+"/"+s,this.cache[s]=!0}return this.cache[e]=t,t},GlobSync.prototype._readdirError=function(e,t){switch(t.code){case"ENOTSUP":case"ENOTDIR":var i=this._makeAbs(e);if(this.cache[i]="FILE",i===this.cwdAbs){var s=new Error(t.code+" invalid cwd "+this.cwd);throw s.path=this.cwd,s.code=t.code,s}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:if(this.cache[this._makeAbs(e)]=!1,this.strict)throw t;this.silent||console.error("glob error",t)}},GlobSync.prototype._processGlobStar=function(e,t,i,s,n,a){var r=this._readdir(i,a);if(r){var o=s.slice(1),c=e?[e]:[],l=c.concat(o);this._process(l,n,!1);var p=r.length;if(!this.symlinks[i]||!a)for(var d=0;d<p;d++){if("."!==r[d].charAt(0)||this.dot){var h=c.concat(r[d],o);this._process(h,n,!0);var u=c.concat(r[d],s);this._process(u,n,!0)}}}},GlobSync.prototype._processSimple=function(e,t){var i=this._stat(e);if(this.matches[t]||(this.matches[t]=Object.create(null)),i){if(e&&o(e)&&!this.nomount){var s=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=a.join(this.root,e):(e=a.resolve(this.root,e),s&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e)}},GlobSync.prototype._stat=function(e){var t=this._makeAbs(e),i="/"===e.slice(-1);if(e.length>this.maxLength)return!1;if(!this.stat&&p(this.cache,t)){var s=this.cache[t];if(Array.isArray(s)&&(s="DIR"),!i||"DIR"===s)return s;if(i&&"FILE"===s)return!1}var n=this.statCache[t];if(!n){var a;try{a=this.fs.lstatSync(t)}catch(e){if(e&&("ENOENT"===e.code||"ENOTDIR"===e.code))return this.statCache[t]=!1,!1}if(a&&a.isSymbolicLink())try{n=this.fs.statSync(t)}catch(e){n=a}else n=a}this.statCache[t]=n;s=!0;return n&&(s=n.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||s,(!i||"FILE"!==s)&&s},GlobSync.prototype._mark=function(e){return c.mark(this,e)},GlobSync.prototype._makeAbs=function(e){return c.makeAbs(this,e)}},4453:e=>{const t="object"==typeof process&&process&&"win32"===process.platform;e.exports=t?{sep:"\\"}:{sep:"/"}},9437:(e,t,i)=>{const s=e.exports=(e,t,i={})=>(assertValidPattern(t),!(!i.nocomment&&"#"===t.charAt(0))&&new Minimatch(t,i).match(e));e.exports=s;const n=i(4453);s.sep=n.sep;const a=Symbol("globstar **");s.GLOBSTAR=a;const r=i(2359),o={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},c="[^/]",l="[^/]*?",charSet=e=>e.split("").reduce(((e,t)=>(e[t]=!0,e)),{}),p=charSet("().*{}+?[]^$\\!"),d=charSet("[.("),h=/\/+/;s.filter=(e,t={})=>(i,n,a)=>s(i,e,t);const ext=(e,t={})=>{const i={};return Object.keys(e).forEach((t=>i[t]=e[t])),Object.keys(t).forEach((e=>i[e]=t[e])),i};s.defaults=e=>{if(!e||"object"!=typeof e||!Object.keys(e).length)return s;const t=s,m=(i,s,n)=>t(i,s,ext(e,n));return(m.Minimatch=class Minimatch extends t.Minimatch{constructor(t,i){super(t,ext(e,i))}}).defaults=i=>t.defaults(ext(e,i)).Minimatch,m.filter=(i,s)=>t.filter(i,ext(e,s)),m.defaults=i=>t.defaults(ext(e,i)),m.makeRe=(i,s)=>t.makeRe(i,ext(e,s)),m.braceExpand=(i,s)=>t.braceExpand(i,ext(e,s)),m.match=(i,s,n)=>t.match(i,s,ext(e,n)),m},s.braceExpand=(e,t)=>braceExpand(e,t);const braceExpand=(e,t={})=>(assertValidPattern(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:r(e)),assertValidPattern=e=>{if("string"!=typeof e)throw new TypeError("invalid pattern");if(e.length>65536)throw new TypeError("pattern is too long")},u=Symbol("subparse");s.makeRe=(e,t)=>new Minimatch(e,t||{}).makeRe(),s.match=(e,t,i={})=>{const s=new Minimatch(t,i);return e=e.filter((e=>s.match(e))),s.options.nonull&&!e.length&&e.push(t),e};class Minimatch{constructor(e,t){assertValidPattern(e),t||(t={}),this.options=t,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||!1===t.allowWindowsEscape,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}debug(){}make(){const e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();let i=this.globSet=this.braceExpand();t.debug&&(this.debug=(...e)=>console.error(...e)),this.debug(this.pattern,i),i=this.globParts=i.map((e=>e.split(h))),this.debug(this.pattern,i),i=i.map(((e,t,i)=>e.map(this.parse,this))),this.debug(this.pattern,i),i=i.filter((e=>-1===e.indexOf(!1))),this.debug(this.pattern,i),this.set=i}parseNegate(){if(this.options.nonegate)return;const e=this.pattern;let t=!1,i=0;for(let s=0;s<e.length&&"!"===e.charAt(s);s++)t=!t,i++;i&&(this.pattern=e.substr(i)),this.negate=t}matchOne(e,t,i){var s=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var n=0,r=0,o=e.length,c=t.length;n<o&&r<c;n++,r++){this.debug("matchOne loop");var l,p=t[r],d=e[n];if(this.debug(t,p,d),!1===p)return!1;if(p===a){this.debug("GLOBSTAR",[t,p,d]);var h=n,u=r+1;if(u===c){for(this.debug("** at the end");n<o;n++)if("."===e[n]||".."===e[n]||!s.dot&&"."===e[n].charAt(0))return!1;return!0}for(;h<o;){var g=e[h];if(this.debug("\nglobstar while",e,h,t,u,g),this.matchOne(e.slice(h),t.slice(u),i))return this.debug("globstar found match!",h,o,g),!0;if("."===g||".."===g||!s.dot&&"."===g.charAt(0)){this.debug("dot detected!",e,h,t,u);break}this.debug("globstar swallow a segment, and continue"),h++}return!(!i||(this.debug("\n>>> no match, partial?",e,h,t,u),h!==o))}if("string"==typeof p?(l=d===p,this.debug("string match",p,d,l)):(l=d.match(p),this.debug("pattern match",p,d,l)),!l)return!1}if(n===o&&r===c)return!0;if(n===o)return i;if(r===c)return n===o-1&&""===e[n];throw new Error("wtf?")}braceExpand(){return braceExpand(this.pattern,this.options)}parse(e,t){assertValidPattern(e);const i=this.options;if("**"===e){if(!i.noglobstar)return a;e="*"}if(""===e)return"";let s="",n=!!i.nocase,r=!1;const h=[],g=[];let v,y,x,_,b=!1,w=-1,E=-1;const k="."===e.charAt(0)?"":i.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",clearStateChar=()=>{if(v){switch(v){case"*":s+=l,n=!0;break;case"?":s+=c,n=!0;break;default:s+="\\"+v}this.debug("clearStateChar %j %j",v,s),v=!1}};for(let t,a=0;a<e.length&&(t=e.charAt(a));a++)if(this.debug("%s\t%s %s %j",e,a,s,t),r){if("/"===t)return!1;p[t]&&(s+="\\"),s+=t,r=!1}else switch(t){case"/":return!1;case"\\":clearStateChar(),r=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,a,s,t),b){this.debug("  in class"),"!"===t&&a===E+1&&(t="^"),s+=t;continue}this.debug("call clearStateChar %j",v),clearStateChar(),v=t,i.noext&&clearStateChar();continue;case"(":if(b){s+="(";continue}if(!v){s+="\\(";continue}h.push({type:v,start:a-1,reStart:s.length,open:o[v].open,close:o[v].close}),s+="!"===v?"(?:(?!(?:":"(?:",this.debug("plType %j %j",v,s),v=!1;continue;case")":if(b||!h.length){s+="\\)";continue}clearStateChar(),n=!0,x=h.pop(),s+=x.close,"!"===x.type&&g.push(x),x.reEnd=s.length;continue;case"|":if(b||!h.length){s+="\\|";continue}clearStateChar(),s+="|";continue;case"[":if(clearStateChar(),b){s+="\\"+t;continue}b=!0,E=a,w=s.length,s+=t;continue;case"]":if(a===E+1||!b){s+="\\"+t;continue}y=e.substring(E+1,a);try{RegExp("["+y+"]")}catch(e){_=this.parse(y,u),s=s.substr(0,w)+"\\["+_[0]+"\\]",n=n||_[1],b=!1;continue}n=!0,b=!1,s+=t;continue;default:clearStateChar(),!p[t]||"^"===t&&b||(s+="\\"),s+=t}for(b&&(y=e.substr(E+1),_=this.parse(y,u),s=s.substr(0,w)+"\\["+_[0],n=n||_[1]),x=h.pop();x;x=h.pop()){let e;e=s.slice(x.reStart+x.open.length),this.debug("setting tail",s,x),e=e.replace(/((?:\\{2}){0,64})(\\?)\|/g,((e,t,i)=>(i||(i="\\"),t+t+i+"|"))),this.debug("tail=%j\n   %s",e,e,x,s);const t="*"===x.type?l:"?"===x.type?c:"\\"+x.type;n=!0,s=s.slice(0,x.reStart)+t+"\\("+e}clearStateChar(),r&&(s+="\\\\");const S=d[s.charAt(0)];for(let e=g.length-1;e>-1;e--){const i=g[e],n=s.slice(0,i.reStart),a=s.slice(i.reStart,i.reEnd-8);let r=s.slice(i.reEnd);const o=s.slice(i.reEnd-8,i.reEnd)+r,c=n.split("(").length-1;let l=r;for(let e=0;e<c;e++)l=l.replace(/\)[+*?]?/,"");r=l;s=n+a+r+(""===r&&t!==u?"$":"")+o}if(""!==s&&n&&(s="(?=.)"+s),S&&(s=k+s),t===u)return[s,n];if(!n)return e.replace(/\\(.)/g,"$1");const T=i.nocase?"i":"";try{return Object.assign(new RegExp("^"+s+"$",T),{_glob:e,_src:s})}catch(e){return new RegExp("$.")}}makeRe(){if(this.regexp||!1===this.regexp)return this.regexp;const e=this.set;if(!e.length)return this.regexp=!1,this.regexp;const t=this.options,i=t.noglobstar?l:t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",s=t.nocase?"i":"";let n=e.map((e=>(e=e.map((e=>"string"==typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e===a?a:e._src)).reduce(((e,t)=>(e[e.length-1]===a&&t===a||e.push(t),e)),[]),e.forEach(((t,s)=>{t===a&&e[s-1]!==a&&(0===s?e.length>1?e[s+1]="(?:\\/|"+i+"\\/)?"+e[s+1]:e[s]=i:s===e.length-1?e[s-1]+="(?:\\/|"+i+")?":(e[s-1]+="(?:\\/|\\/"+i+"\\/)"+e[s+1],e[s+1]=a))})),e.filter((e=>e!==a)).join("/")))).join("|");n="^(?:"+n+")$",this.negate&&(n="^(?!"+n+").*$");try{this.regexp=new RegExp(n,s)}catch(e){this.regexp=!1}return this.regexp}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;const i=this.options;"/"!==n.sep&&(e=e.split(n.sep).join("/")),e=e.split(h),this.debug(this.pattern,"split",e);const s=this.set;let a;this.debug(this.pattern,"set",s);for(let t=e.length-1;t>=0&&(a=e[t],!a);t--);for(let n=0;n<s.length;n++){const r=s[n];let o=e;i.matchBase&&1===r.length&&(o=[a]);if(this.matchOne(o,r,t))return!!i.flipNegate||!this.negate}return!i.flipNegate&&this.negate}static defaults(e){return s.defaults(e).Minimatch}}s.Minimatch=Minimatch},9170:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(9444),n=i(3171),a={returnIndex:!1},matchPatterns=(e,t,i,s)=>{const a=Array.isArray(i),r=a?i[0]:i;if(!a&&"string"!=typeof r)throw new TypeError("anymatch: second argument must be a string: got "+Object.prototype.toString.call(r));const o=n(r);for(let e=0;e<t.length;e++){if((0,t[e])(o))return!!s&&-1}const c=a&&[o].concat(i.slice(1));for(let t=0;t<e.length;t++){const i=e[t];if(a?i(...c):i(o))return!s||t}return!!s&&-1},anymatch=(e,t,i=a)=>{if(null==e)throw new TypeError("anymatch: specify first argument");const n="boolean"==typeof i?{returnIndex:i}:i,r=n.returnIndex||!1,o=(c=e,Array.isArray(c)?c:[c]);var c;const l=o.filter((e=>"string"==typeof e&&"!"===e.charAt(0))).map((e=>e.slice(1))).map((e=>s(e,n))),p=o.filter((e=>"string"!=typeof e||"string"==typeof e&&"!"!==e.charAt(0))).map((e=>((e,t)=>{if("function"==typeof e)return e;if("string"==typeof e){const i=s(e,t);return t=>e===t||i(t)}return e instanceof RegExp?t=>e.test(t):e=>!1})(e,n)));return null==t?(e,t=!1)=>matchPatterns(p,l,e,"boolean"==typeof t&&t):matchPatterns(p,l,t,r)};anymatch.default=anymatch,e.exports=anymatch},5623:e=>{"use strict";function balanced(e,t,i){e instanceof RegExp&&(e=maybeMatch(e,i)),t instanceof RegExp&&(t=maybeMatch(t,i));var s=range(e,t,i);return s&&{start:s[0],end:s[1],pre:i.slice(0,s[0]),body:i.slice(s[0]+e.length,s[1]),post:i.slice(s[1]+t.length)}}function maybeMatch(e,t){var i=t.match(e);return i?i[0]:null}function range(e,t,i){var s,n,a,r,o,c=i.indexOf(e),l=i.indexOf(t,c+1),p=c;if(c>=0&&l>0){if(e===t)return[c,l];for(s=[],a=i.length;p>=0&&!o;)p==c?(s.push(p),c=i.indexOf(e,p+1)):1==s.length?o=[s.pop(),l]:((n=s.pop())<a&&(a=n,r=l),l=i.indexOf(t,p+1)),p=c<l&&c>=0?c:l;s.length&&(o=[a,r])}return o}e.exports=balanced,balanced.range=range},5487:(e,t,i)=>{e.exports=i(5133)},6744:(e,t,i)=>{"use strict";const s=i(3349),n=i(7529),a=i(8050),r=i(4339),braces=(e,t={})=>{let i=[];if(Array.isArray(e))for(let s of e){let e=braces.create(s,t);Array.isArray(e)?i.push(...e):i.push(e)}else i=[].concat(braces.create(e,t));return t&&!0===t.expand&&!0===t.nodupes&&(i=[...new Set(i)]),i};braces.parse=(e,t={})=>r(e,t),braces.stringify=(e,t={})=>s("string"==typeof e?braces.parse(e,t):e,t),braces.compile=(e,t={})=>("string"==typeof e&&(e=braces.parse(e,t)),n(e,t)),braces.expand=(e,t={})=>{"string"==typeof e&&(e=braces.parse(e,t));let i=a(e,t);return!0===t.noempty&&(i=i.filter(Boolean)),!0===t.nodupes&&(i=[...new Set(i)]),i},braces.create=(e,t={})=>""===e||e.length<3?[e]:!0!==t.expand?braces.compile(e,t):braces.expand(e,t),e.exports=braces},7529:(e,t,i)=>{"use strict";const s=i(2664),n=i(3083);e.exports=(e,t={})=>{let walk=(e,i={})=>{let a=n.isInvalidBrace(i),r=!0===e.invalid&&!0===t.escapeInvalid,o=!0===a||!0===r,c=!0===t.escapeInvalid?"\\":"",l="";if(!0===e.isOpen)return c+e.value;if(!0===e.isClose)return c+e.value;if("open"===e.type)return o?c+e.value:"(";if("close"===e.type)return o?c+e.value:")";if("comma"===e.type)return"comma"===e.prev.type?"":o?e.value:"|";if(e.value)return e.value;if(e.nodes&&e.ranges>0){let i=n.reduce(e.nodes),a=s(...i,{...t,wrap:!1,toRegex:!0});if(0!==a.length)return i.length>1&&a.length>1?`(${a})`:a}if(e.nodes)for(let t of e.nodes)l+=walk(t,e);return l};return walk(e)}},6611:e=>{"use strict";e.exports={MAX_LENGTH:65536,CHAR_0:"0",CHAR_9:"9",CHAR_UPPERCASE_A:"A",CHAR_LOWERCASE_A:"a",CHAR_UPPERCASE_Z:"Z",CHAR_LOWERCASE_Z:"z",CHAR_LEFT_PARENTHESES:"(",CHAR_RIGHT_PARENTHESES:")",CHAR_ASTERISK:"*",CHAR_AMPERSAND:"&",CHAR_AT:"@",CHAR_BACKSLASH:"\\",CHAR_BACKTICK:"`",CHAR_CARRIAGE_RETURN:"\r",CHAR_CIRCUMFLEX_ACCENT:"^",CHAR_COLON:":",CHAR_COMMA:",",CHAR_DOLLAR:"$",CHAR_DOT:".",CHAR_DOUBLE_QUOTE:'"',CHAR_EQUAL:"=",CHAR_EXCLAMATION_MARK:"!",CHAR_FORM_FEED:"\f",CHAR_FORWARD_SLASH:"/",CHAR_HASH:"#",CHAR_HYPHEN_MINUS:"-",CHAR_LEFT_ANGLE_BRACKET:"<",CHAR_LEFT_CURLY_BRACE:"{",CHAR_LEFT_SQUARE_BRACKET:"[",CHAR_LINE_FEED:"\n",CHAR_NO_BREAK_SPACE:" ",CHAR_PERCENT:"%",CHAR_PLUS:"+",CHAR_QUESTION_MARK:"?",CHAR_RIGHT_ANGLE_BRACKET:">",CHAR_RIGHT_CURLY_BRACE:"}",CHAR_RIGHT_SQUARE_BRACKET:"]",CHAR_SEMICOLON:";",CHAR_SINGLE_QUOTE:"'",CHAR_SPACE:" ",CHAR_TAB:"\t",CHAR_UNDERSCORE:"_",CHAR_VERTICAL_LINE:"|",CHAR_ZERO_WIDTH_NOBREAK_SPACE:"\ufeff"}},8050:(e,t,i)=>{"use strict";const s=i(2664),n=i(3349),a=i(3083),append=(e="",t="",i=!1)=>{let s=[];if(e=[].concat(e),!(t=[].concat(t)).length)return e;if(!e.length)return i?a.flatten(t).map((e=>`{${e}}`)):t;for(let n of e)if(Array.isArray(n))for(let e of n)s.push(append(e,t,i));else for(let e of t)!0===i&&"string"==typeof e&&(e=`{${e}}`),s.push(Array.isArray(e)?append(n,e,i):n+e);return a.flatten(s)};e.exports=(e,t={})=>{let i=void 0===t.rangeLimit?1e3:t.rangeLimit,walk=(e,r={})=>{e.queue=[];let o=r,c=r.queue;for(;"brace"!==o.type&&"root"!==o.type&&o.parent;)o=o.parent,c=o.queue;if(e.invalid||e.dollar)return void c.push(append(c.pop(),n(e,t)));if("brace"===e.type&&!0!==e.invalid&&2===e.nodes.length)return void c.push(append(c.pop(),["{}"]));if(e.nodes&&e.ranges>0){let r=a.reduce(e.nodes);if(a.exceedsLimit(...r,t.step,i))throw new RangeError("expanded array length exceeds range limit. Use options.rangeLimit to increase or disable the limit.");let o=s(...r,t);return 0===o.length&&(o=n(e,t)),c.push(append(c.pop(),o)),void(e.nodes=[])}let l=a.encloseBrace(e),p=e.queue,d=e;for(;"brace"!==d.type&&"root"!==d.type&&d.parent;)d=d.parent,p=d.queue;for(let t=0;t<e.nodes.length;t++){let i=e.nodes[t];"comma"!==i.type||"brace"!==e.type?"close"!==i.type?i.value&&"open"!==i.type?p.push(append(p.pop(),i.value)):i.nodes&&walk(i,e):c.push(append(c.pop(),p,l)):(1===t&&p.push(""),p.push(""))}return p};return a.flatten(walk(e))}},4339:(e,t,i)=>{"use strict";const s=i(3349),{MAX_LENGTH:n,CHAR_BACKSLASH:a,CHAR_BACKTICK:r,CHAR_COMMA:o,CHAR_DOT:c,CHAR_LEFT_PARENTHESES:l,CHAR_RIGHT_PARENTHESES:p,CHAR_LEFT_CURLY_BRACE:d,CHAR_RIGHT_CURLY_BRACE:h,CHAR_LEFT_SQUARE_BRACKET:u,CHAR_RIGHT_SQUARE_BRACKET:g,CHAR_DOUBLE_QUOTE:v,CHAR_SINGLE_QUOTE:y,CHAR_NO_BREAK_SPACE:x,CHAR_ZERO_WIDTH_NOBREAK_SPACE:_}=i(6611);e.exports=(e,t={})=>{if("string"!=typeof e)throw new TypeError("Expected a string");let i=t||{},b="number"==typeof i.maxLength?Math.min(n,i.maxLength):n;if(e.length>b)throw new SyntaxError(`Input length (${e.length}), exceeds max characters (${b})`);let w,E={type:"root",input:e,nodes:[]},k=[E],S=E,T=E,A=0,O=e.length,C=0,N=0;const advance=()=>e[C++],push=e=>{if("text"===e.type&&"dot"===T.type&&(T.type="text"),!T||"text"!==T.type||"text"!==e.type)return S.nodes.push(e),e.parent=S,e.prev=T,T=e,e;T.value+=e.value};for(push({type:"bos"});C<O;)if(S=k[k.length-1],w=advance(),w!==_&&w!==x)if(w!==a)if(w!==g)if(w!==u)if(w!==l)if(w!==p)if(w!==v&&w!==y&&w!==r)if(w!==d)if(w!==h)if(w===o&&N>0){if(S.ranges>0){S.ranges=0;let e=S.nodes.shift();S.nodes=[e,{type:"text",value:s(S)}]}push({type:"comma",value:w}),S.commas++}else if(w===c&&N>0&&0===S.commas){let e=S.nodes;if(0===N||0===e.length){push({type:"text",value:w});continue}if("dot"===T.type){if(S.range=[],T.value+=w,T.type="range",3!==S.nodes.length&&5!==S.nodes.length){S.invalid=!0,S.ranges=0,T.type="text";continue}S.ranges++,S.args=[];continue}if("range"===T.type){e.pop();let t=e[e.length-1];t.value+=T.value+w,T=t,S.ranges--;continue}push({type:"dot",value:w})}else push({type:"text",value:w});else{if("brace"!==S.type){push({type:"text",value:w});continue}let e="close";S=k.pop(),S.close=!0,push({type:e,value:w}),N--,S=k[k.length-1]}else{N++;let e=T.value&&"$"===T.value.slice(-1)||!0===S.dollar;S=push({type:"brace",open:!0,close:!1,dollar:e,depth:N,commas:0,ranges:0,nodes:[]}),k.push(S),push({type:"open",value:w})}else{let e,i=w;for(!0!==t.keepQuotes&&(w="");C<O&&(e=advance());)if(e!==a){if(e===i){!0===t.keepQuotes&&(w+=e);break}w+=e}else w+=e+advance();push({type:"text",value:w})}else{if("paren"!==S.type){push({type:"text",value:w});continue}S=k.pop(),push({type:"text",value:w}),S=k[k.length-1]}else S=push({type:"paren",nodes:[]}),k.push(S),push({type:"text",value:w});else{A++;let e;for(;C<O&&(e=advance());)if(w+=e,e!==u)if(e!==a){if(e===g&&(A--,0===A))break}else w+=advance();else A++;push({type:"text",value:w})}else push({type:"text",value:"\\"+w});else push({type:"text",value:(t.keepEscaping?w:"")+advance()});do{if(S=k.pop(),"root"!==S.type){S.nodes.forEach((e=>{e.nodes||("open"===e.type&&(e.isOpen=!0),"close"===e.type&&(e.isClose=!0),e.nodes||(e.type="text"),e.invalid=!0)}));let e=k[k.length-1],t=e.nodes.indexOf(S);e.nodes.splice(t,1,...S.nodes)}}while(k.length>0);return push({type:"eos"}),E}},3349:(e,t,i)=>{"use strict";const s=i(3083);e.exports=(e,t={})=>{let stringify=(e,i={})=>{let n=t.escapeInvalid&&s.isInvalidBrace(i),a=!0===e.invalid&&!0===t.escapeInvalid,r="";if(e.value)return(n||a)&&s.isOpenOrClose(e)?"\\"+e.value:e.value;if(e.value)return e.value;if(e.nodes)for(let t of e.nodes)r+=stringify(t);return r};return stringify(e)}},3083:(e,t)=>{"use strict";t.isInteger=e=>"number"==typeof e?Number.isInteger(e):"string"==typeof e&&""!==e.trim()&&Number.isInteger(Number(e)),t.find=(e,t)=>e.nodes.find((e=>e.type===t)),t.exceedsLimit=(e,i,s=1,n)=>!1!==n&&(!(!t.isInteger(e)||!t.isInteger(i))&&(Number(i)-Number(e))/Number(s)>=n),t.escapeNode=(e,t=0,i)=>{let s=e.nodes[t];s&&(i&&s.type===i||"open"===s.type||"close"===s.type)&&!0!==s.escaped&&(s.value="\\"+s.value,s.escaped=!0)},t.encloseBrace=e=>"brace"===e.type&&(e.commas>>0+e.ranges>>0==0&&(e.invalid=!0,!0)),t.isInvalidBrace=e=>"brace"===e.type&&(!(!0!==e.invalid&&!e.dollar)||(e.commas>>0+e.ranges>>0==0||!0!==e.open||!0!==e.close)&&(e.invalid=!0,!0)),t.isOpenOrClose=e=>"open"===e.type||"close"===e.type||(!0===e.open||!0===e.close),t.reduce=e=>e.reduce(((e,t)=>("text"===t.type&&e.push(t.value),"range"===t.type&&(t.type="text"),e)),[]),t.flatten=(...e)=>{const t=[],flat=e=>{for(let i=0;i<e.length;i++){let s=e[i];Array.isArray(s)?flat(s,t):void 0!==s&&t.push(s)}return t};return flat(e),t}},7954:(e,t,i)=>{"use strict";const{EventEmitter:s}=i(2361),n=i(7147),a=i(1017),{promisify:r}=i(3837),o=i(8356),c=i(9170).default,l=i(7647),p=i(6830),d=i(6744),h=i(3171),u=i(3221),g=i(1215),{EV_ALL:v,EV_READY:y,EV_ADD:x,EV_CHANGE:_,EV_UNLINK:b,EV_ADD_DIR:w,EV_UNLINK_DIR:E,EV_RAW:k,EV_ERROR:S,STR_CLOSE:T,STR_END:A,BACK_SLASH_RE:O,DOUBLE_SLASH_RE:C,SLASH_OR_BACK_SLASH_RE:N,DOT_RE:R,REPLACER_RE:I,SLASH:D,SLASH_SLASH:L,BRACE_START:j,BANG:M,ONE_DOT:P,TWO_DOTS:U,GLOBSTAR:$,SLASH_GLOBSTAR:H,ANYMATCH_OPTS:B,STRING_TYPE:q,FUNCTION_TYPE:F,EMPTY_STR:Q,EMPTY_FN:z,isWindows:G,isMacos:W,isIBMi:V}=i(1318),K=r(n.stat),Y=r(n.readdir),arrify=(e=[])=>Array.isArray(e)?e:[e],flatten=(e,t=[])=>(e.forEach((e=>{Array.isArray(e)?flatten(e,t):t.push(e)})),t),unifyPaths=e=>{const t=flatten(arrify(e));if(!t.every((e=>typeof e===q)))throw new TypeError(`Non-string provided as watch path: ${t}`);return t.map(normalizePathToUnix)},toUnix=e=>{let t=e.replace(O,D),i=!1;for(t.startsWith(L)&&(i=!0);t.match(C);)t=t.replace(C,D);return i&&(t=D+t),t},normalizePathToUnix=e=>toUnix(a.normalize(toUnix(e))),normalizeIgnored=(e=Q)=>t=>typeof t!==q?t:normalizePathToUnix(a.isAbsolute(t)?t:a.join(e,t)),undef=(e,t)=>void 0===e[t];class DirEntry{constructor(e,t){this.path=e,this._removeWatcher=t,this.items=new Set}add(e){const{items:t}=this;t&&e!==P&&e!==U&&t.add(e)}async remove(e){const{items:t}=this;if(!t)return;if(t.delete(e),t.size>0)return;const i=this.path;try{await Y(i)}catch(e){this._removeWatcher&&this._removeWatcher(a.dirname(i),a.basename(i))}}has(e){const{items:t}=this;if(t)return t.has(e)}getChildren(){const{items:e}=this;if(e)return[...e.values()]}dispose(){this.items.clear(),delete this.path,delete this._removeWatcher,delete this.items,Object.freeze(this)}}class WatchHelper{constructor(e,t,i,s){this.fsw=s,this.path=e=e.replace(I,Q),this.watchPath=t,this.fullWatchPath=a.resolve(t),this.hasGlob=t!==e,e===Q&&(this.hasGlob=!1),this.globSymlink=!(!this.hasGlob||!i)&&void 0,this.globFilter=!!this.hasGlob&&c(e,void 0,B),this.dirParts=this.getDirParts(e),this.dirParts.forEach((e=>{e.length>1&&e.pop()})),this.followSymlinks=i,this.statMethod=i?"stat":"lstat"}checkGlobSymlink(e){return void 0===this.globSymlink&&(this.globSymlink=e.fullParentDir!==this.fullWatchPath&&{realPath:e.fullParentDir,linkPath:this.fullWatchPath}),this.globSymlink?e.fullPath.replace(this.globSymlink.realPath,this.globSymlink.linkPath):e.fullPath}entryPath(e){return a.join(this.watchPath,a.relative(this.watchPath,this.checkGlobSymlink(e)))}filterPath(e){const{stats:t}=e;if(t&&t.isSymbolicLink())return this.filterDir(e);const i=this.entryPath(e);return(!this.hasGlob||typeof this.globFilter!==F||this.globFilter(i))&&this.fsw._isntIgnored(i,t)&&this.fsw._hasReadPermissions(t)}getDirParts(e){if(!this.hasGlob)return[];const t=[];return(e.includes(j)?d.expand(e):[e]).forEach((e=>{t.push(a.relative(this.watchPath,e).split(N))})),t}filterDir(e){if(this.hasGlob){const t=this.getDirParts(this.checkGlobSymlink(e));let i=!1;this.unmatchedGlob=!this.dirParts.some((e=>e.every(((e,s)=>(e===$&&(i=!0),i||!t[0][s]||c(e,t[0][s],B))))))}return!this.unmatchedGlob&&this.fsw._isntIgnored(this.entryPath(e),e.stats)}}class FSWatcher extends s{constructor(e){super();const t={};e&&Object.assign(t,e),this._watched=new Map,this._closers=new Map,this._ignoredPaths=new Set,this._throttled=new Map,this._symlinkPaths=new Map,this._streams=new Set,this.closed=!1,undef(t,"persistent")&&(t.persistent=!0),undef(t,"ignoreInitial")&&(t.ignoreInitial=!1),undef(t,"ignorePermissionErrors")&&(t.ignorePermissionErrors=!1),undef(t,"interval")&&(t.interval=100),undef(t,"binaryInterval")&&(t.binaryInterval=300),undef(t,"disableGlobbing")&&(t.disableGlobbing=!1),t.enableBinaryInterval=t.binaryInterval!==t.interval,undef(t,"useFsEvents")&&(t.useFsEvents=!t.usePolling);g.canUse()||(t.useFsEvents=!1),undef(t,"usePolling")&&!t.useFsEvents&&(t.usePolling=W),V&&(t.usePolling=!0);const i=process.env.CHOKIDAR_USEPOLLING;if(void 0!==i){const e=i.toLowerCase();t.usePolling="false"!==e&&"0"!==e&&("true"===e||"1"===e||!!e)}const s=process.env.CHOKIDAR_INTERVAL;s&&(t.interval=Number.parseInt(s,10)),undef(t,"atomic")&&(t.atomic=!t.usePolling&&!t.useFsEvents),t.atomic&&(this._pendingUnlinks=new Map),undef(t,"followSymlinks")&&(t.followSymlinks=!0),undef(t,"awaitWriteFinish")&&(t.awaitWriteFinish=!1),!0===t.awaitWriteFinish&&(t.awaitWriteFinish={});const n=t.awaitWriteFinish;n&&(n.stabilityThreshold||(n.stabilityThreshold=2e3),n.pollInterval||(n.pollInterval=100),this._pendingWrites=new Map),t.ignored&&(t.ignored=arrify(t.ignored));let a=0;this._emitReady=()=>{a++,a>=this._readyCount&&(this._emitReady=z,this._readyEmitted=!0,process.nextTick((()=>this.emit(y))))},this._emitRaw=(...e)=>this.emit(k,...e),this._readyEmitted=!1,this.options=t,t.useFsEvents?this._fsEventsHandler=new g(this):this._nodeFsHandler=new u(this),Object.freeze(t)}add(e,t,i){const{cwd:s,disableGlobbing:n}=this.options;this.closed=!1;let r=unifyPaths(e);return s&&(r=r.map((e=>{const t=((e,t)=>a.isAbsolute(e)?e:e.startsWith(M)?M+a.join(t,e.slice(1)):a.join(t,e))(e,s);return n||!p(e)?t:h(t)}))),r=r.filter((e=>e.startsWith(M)?(this._ignoredPaths.add(e.slice(1)),!1):(this._ignoredPaths.delete(e),this._ignoredPaths.delete(e+H),this._userIgnored=void 0,!0))),this.options.useFsEvents&&this._fsEventsHandler?(this._readyCount||(this._readyCount=r.length),this.options.persistent&&(this._readyCount*=2),r.forEach((e=>this._fsEventsHandler._addToFsEvents(e)))):(this._readyCount||(this._readyCount=0),this._readyCount+=r.length,Promise.all(r.map((async e=>{const s=await this._nodeFsHandler._addToNodeFs(e,!i,0,0,t);return s&&this._emitReady(),s}))).then((e=>{this.closed||e.filter((e=>e)).forEach((e=>{this.add(a.dirname(e),a.basename(t||e))}))}))),this}unwatch(e){if(this.closed)return this;const t=unifyPaths(e),{cwd:i}=this.options;return t.forEach((e=>{a.isAbsolute(e)||this._closers.has(e)||(i&&(e=a.join(i,e)),e=a.resolve(e)),this._closePath(e),this._ignoredPaths.add(e),this._watched.has(e)&&this._ignoredPaths.add(e+H),this._userIgnored=void 0})),this}close(){if(this.closed)return this._closePromise;this.closed=!0,this.removeAllListeners();const e=[];return this._closers.forEach((t=>t.forEach((t=>{const i=t();i instanceof Promise&&e.push(i)})))),this._streams.forEach((e=>e.destroy())),this._userIgnored=void 0,this._readyCount=0,this._readyEmitted=!1,this._watched.forEach((e=>e.dispose())),["closers","watched","streams","symlinkPaths","throttled"].forEach((e=>{this[`_${e}`].clear()})),this._closePromise=e.length?Promise.all(e).then((()=>{})):Promise.resolve(),this._closePromise}getWatched(){const e={};return this._watched.forEach(((t,i)=>{const s=this.options.cwd?a.relative(this.options.cwd,i):i;e[s||P]=t.getChildren().sort()})),e}emitWithAll(e,t){this.emit(...t),e!==S&&this.emit(v,...t)}async _emit(e,t,i,s,n){if(this.closed)return;const r=this.options;G&&(t=a.normalize(t)),r.cwd&&(t=a.relative(r.cwd,t));const o=[e,t];void 0!==n?o.push(i,s,n):void 0!==s?o.push(i,s):void 0!==i&&o.push(i);const c=r.awaitWriteFinish;let l;if(c&&(l=this._pendingWrites.get(t)))return l.lastChange=new Date,this;if(r.atomic){if(e===b)return this._pendingUnlinks.set(t,o),setTimeout((()=>{this._pendingUnlinks.forEach(((e,t)=>{this.emit(...e),this.emit(v,...e),this._pendingUnlinks.delete(t)}))}),"number"==typeof r.atomic?r.atomic:100),this;e===x&&this._pendingUnlinks.has(t)&&(e=o[0]=_,this._pendingUnlinks.delete(t))}if(c&&(e===x||e===_)&&this._readyEmitted){const awfEmit=(t,i)=>{t?(e=o[0]=S,o[1]=t,this.emitWithAll(e,o)):i&&(o.length>2?o[2]=i:o.push(i),this.emitWithAll(e,o))};return this._awaitWriteFinish(t,c.stabilityThreshold,e,awfEmit),this}if(e===_){if(!this._throttle(_,t,50))return this}if(r.alwaysStat&&void 0===i&&(e===x||e===w||e===_)){const e=r.cwd?a.join(r.cwd,t):t;let i;try{i=await K(e)}catch(e){}if(!i||this.closed)return;o.push(i)}return this.emitWithAll(e,o),this}_handleError(e){const t=e&&e.code;return e&&"ENOENT"!==t&&"ENOTDIR"!==t&&(!this.options.ignorePermissionErrors||"EPERM"!==t&&"EACCES"!==t)&&this.emit(S,e),e||this.closed}_throttle(e,t,i){this._throttled.has(e)||this._throttled.set(e,new Map);const s=this._throttled.get(e),n=s.get(t);if(n)return n.count++,!1;let a;const clear=()=>{const e=s.get(t),i=e?e.count:0;return s.delete(t),clearTimeout(a),e&&clearTimeout(e.timeoutObject),i};a=setTimeout(clear,i);const r={timeoutObject:a,clear,count:0};return s.set(t,r),r}_incrReadyCount(){return this._readyCount++}_awaitWriteFinish(e,t,i,s){let r,o=e;this.options.cwd&&!a.isAbsolute(e)&&(o=a.join(this.options.cwd,e));const c=new Date,awaitWriteFinish=i=>{n.stat(o,((n,a)=>{if(n||!this._pendingWrites.has(e))return void(n&&"ENOENT"!==n.code&&s(n));const o=Number(new Date);i&&a.size!==i.size&&(this._pendingWrites.get(e).lastChange=o);o-this._pendingWrites.get(e).lastChange>=t?(this._pendingWrites.delete(e),s(void 0,a)):r=setTimeout(awaitWriteFinish,this.options.awaitWriteFinish.pollInterval,a)}))};this._pendingWrites.has(e)||(this._pendingWrites.set(e,{lastChange:c,cancelWait:()=>(this._pendingWrites.delete(e),clearTimeout(r),i)}),r=setTimeout(awaitWriteFinish,this.options.awaitWriteFinish.pollInterval))}_getGlobIgnored(){return[...this._ignoredPaths.values()]}_isIgnored(e,t){if(this.options.atomic&&R.test(e))return!0;if(!this._userIgnored){const{cwd:e}=this.options,t=this.options.ignored,i=t&&t.map(normalizeIgnored(e)),s=arrify(i).filter((e=>typeof e===q&&!p(e))).map((e=>e+H)),n=this._getGlobIgnored().map(normalizeIgnored(e)).concat(i,s);this._userIgnored=c(n,void 0,B)}return this._userIgnored([e,t])}_isntIgnored(e,t){return!this._isIgnored(e,t)}_getWatchHelpers(e,t){const i=t||this.options.disableGlobbing||!p(e)?e:l(e),s=this.options.followSymlinks;return new WatchHelper(e,i,s,this)}_getWatchedDir(e){this._boundRemove||(this._boundRemove=this._remove.bind(this));const t=a.resolve(e);return this._watched.has(t)||this._watched.set(t,new DirEntry(t,this._boundRemove)),this._watched.get(t)}_hasReadPermissions(e){if(this.options.ignorePermissionErrors)return!0;const t=511&(e&&Number.parseInt(e.mode,10)),i=Number.parseInt(t.toString(8)[0],10);return Boolean(4&i)}_remove(e,t,i){const s=a.join(e,t),n=a.resolve(s);if(i=null!=i?i:this._watched.has(s)||this._watched.has(n),!this._throttle("remove",s,100))return;i||this.options.useFsEvents||1!==this._watched.size||this.add(e,t,!0);this._getWatchedDir(s).getChildren().forEach((e=>this._remove(s,e)));const r=this._getWatchedDir(e),o=r.has(t);r.remove(t),this._symlinkPaths.has(n)&&this._symlinkPaths.delete(n);let c=s;if(this.options.cwd&&(c=a.relative(this.options.cwd,s)),this.options.awaitWriteFinish&&this._pendingWrites.has(c)){if(this._pendingWrites.get(c).cancelWait()===x)return}this._watched.delete(s),this._watched.delete(n);const l=i?E:b;o&&!this._isIgnored(s)&&this._emit(l,s),this.options.useFsEvents||this._closePath(s)}_closePath(e){this._closeFile(e);const t=a.dirname(e);this._getWatchedDir(t).remove(a.basename(e))}_closeFile(e){const t=this._closers.get(e);t&&(t.forEach((e=>e())),this._closers.delete(e))}_addPathCloser(e,t){if(!t)return;let i=this._closers.get(e);i||(i=[],this._closers.set(e,i)),i.push(t)}_readdirp(e,t){if(this.closed)return;const i={type:v,alwaysStat:!0,lstat:!0,...t};let s=o(e,i);return this._streams.add(s),s.once(T,(()=>{s=void 0})),s.once(A,(()=>{s&&(this._streams.delete(s),s=void 0)})),s}}t.FSWatcher=FSWatcher;t.watch=(e,t)=>{const i=new FSWatcher(t);return i.add(e),i}},1318:(e,t,i)=>{"use strict";const{sep:s}=i(1017),{platform:n}=process,a=i(2037);t.EV_ALL="all",t.EV_READY="ready",t.EV_ADD="add",t.EV_CHANGE="change",t.EV_ADD_DIR="addDir",t.EV_UNLINK="unlink",t.EV_UNLINK_DIR="unlinkDir",t.EV_RAW="raw",t.EV_ERROR="error",t.STR_DATA="data",t.STR_END="end",t.STR_CLOSE="close",t.FSEVENT_CREATED="created",t.FSEVENT_MODIFIED="modified",t.FSEVENT_DELETED="deleted",t.FSEVENT_MOVED="moved",t.FSEVENT_CLONED="cloned",t.FSEVENT_UNKNOWN="unknown",t.FSEVENT_TYPE_FILE="file",t.FSEVENT_TYPE_DIRECTORY="directory",t.FSEVENT_TYPE_SYMLINK="symlink",t.KEY_LISTENERS="listeners",t.KEY_ERR="errHandlers",t.KEY_RAW="rawEmitters",t.HANDLER_KEYS=[t.KEY_LISTENERS,t.KEY_ERR,t.KEY_RAW],t.DOT_SLASH=`.${s}`,t.BACK_SLASH_RE=/\\/g,t.DOUBLE_SLASH_RE=/\/\//,t.SLASH_OR_BACK_SLASH_RE=/[/\\]/,t.DOT_RE=/\..*\.(sw[px])$|~$|\.subl.*\.tmp/,t.REPLACER_RE=/^\.[/\\]/,t.SLASH="/",t.SLASH_SLASH="//",t.BRACE_START="{",t.BANG="!",t.ONE_DOT=".",t.TWO_DOTS="..",t.STAR="*",t.GLOBSTAR="**",t.ROOT_GLOBSTAR="/**/*",t.SLASH_GLOBSTAR="/**",t.DIR_SUFFIX="Dir",t.ANYMATCH_OPTS={dot:!0},t.STRING_TYPE="string",t.FUNCTION_TYPE="function",t.EMPTY_STR="",t.EMPTY_FN=()=>{},t.IDENTITY_FN=e=>e,t.isWindows="win32"===n,t.isMacos="darwin"===n,t.isLinux="linux"===n,t.isIBMi="OS400"===a.type()},1215:(e,t,i)=>{"use strict";const s=i(7147),n=i(1017),{promisify:a}=i(3837);let r;try{r=i(4943)}catch(e){process.env.CHOKIDAR_PRINT_FSEVENTS_REQUIRE_ERROR&&console.error(e)}if(r){const e=process.version.match(/v(\d+)\.(\d+)/);if(e&&e[1]&&e[2]){const t=Number.parseInt(e[1],10),i=Number.parseInt(e[2],10);8===t&&i<16&&(r=void 0)}}const{EV_ADD:o,EV_CHANGE:c,EV_ADD_DIR:l,EV_UNLINK:p,EV_ERROR:d,STR_DATA:h,STR_END:u,FSEVENT_CREATED:g,FSEVENT_MODIFIED:v,FSEVENT_DELETED:y,FSEVENT_MOVED:x,FSEVENT_UNKNOWN:_,FSEVENT_TYPE_FILE:b,FSEVENT_TYPE_DIRECTORY:w,FSEVENT_TYPE_SYMLINK:E,ROOT_GLOBSTAR:k,DIR_SUFFIX:S,DOT_SLASH:T,FUNCTION_TYPE:A,EMPTY_FN:O,IDENTITY_FN:C}=i(1318),N=a(s.stat),R=a(s.lstat),I=a(s.realpath),D={stat:N,lstat:R},L=new Map,j=new Set([69888,70400,71424,72704,73472,131328,131840,262912]),createFSEventsInstance=(e,t)=>({stop:r.watch(e,t)});const couldConsolidate=e=>{let t=0;for(const i of L.keys())if(0===i.indexOf(e)&&(t++,t>=10))return!0;return!1},calcDepth=(e,t)=>{let i=0;for(;!e.indexOf(t)&&(e=n.dirname(e))!==t;)i++;return i},sameTypes=(e,t)=>e.type===w&&t.isDirectory()||e.type===E&&t.isSymbolicLink()||e.type===b&&t.isFile();e.exports=class FsEventsHandler{constructor(e){this.fsw=e}checkIgnored(e,t){const i=this.fsw._ignoredPaths;if(this.fsw._isIgnored(e,t))return i.add(e),t&&t.isDirectory()&&i.add(e+k),!0;i.delete(e),i.delete(e+k)}addOrChange(e,t,i,s,n,a,r,l){const p=n.has(a)?c:o;this.handleEvent(p,e,t,i,s,n,a,r,l)}async checkExists(e,t,i,s,n,a,r,o){try{const c=await N(e);if(this.fsw.closed)return;sameTypes(r,c)?this.addOrChange(e,t,i,s,n,a,r,o):this.handleEvent(p,e,t,i,s,n,a,r,o)}catch(c){"EACCES"===c.code?this.addOrChange(e,t,i,s,n,a,r,o):this.handleEvent(p,e,t,i,s,n,a,r,o)}}handleEvent(e,t,i,s,n,a,r,c,d){if(!this.fsw.closed&&!this.checkIgnored(t))if(e===p){const e=c.type===w;(e||a.has(r))&&this.fsw._remove(n,r,e)}else{if(e===o){if(c.type===w&&this.fsw._getWatchedDir(t),c.type===E&&d.followSymlinks){const e=void 0===d.depth?void 0:calcDepth(i,s)+1;return this._addToFsEvents(t,!1,!0,e)}this.fsw._getWatchedDir(n).add(r)}const a=c.type===w?e+S:e;this.fsw._emit(a,t),a===l&&this._addToFsEvents(t,!1,!0)}}_watchWithFsEvents(e,t,i,s){if(this.fsw.closed||this.fsw._isIgnored(e))return;const a=this.fsw.options,o=function setFSEventsListener(e,t,i,s){let a=n.extname(t)?n.dirname(t):t;const o=n.dirname(a);let c=L.get(a);couldConsolidate(o)&&(a=o);const l=n.resolve(e),p=l!==t,filteredListener=(e,s,a)=>{p&&(e=e.replace(t,l)),e!==l&&e.indexOf(l+n.sep)||i(e,s,a)};let d=!1;for(const e of L.keys())if(0===t.indexOf(n.resolve(e)+n.sep)){a=e,c=L.get(a),d=!0;break}return c||d?c.listeners.add(filteredListener):(c={listeners:new Set([filteredListener]),rawEmitter:s,watcher:createFSEventsInstance(a,((e,t)=>{if(!c.listeners.size)return;const i=r.getInfo(e,t);c.listeners.forEach((s=>{s(e,t,i)})),c.rawEmitter(i.event,e,i)}))},L.set(a,c)),()=>{const e=c.listeners;if(e.delete(filteredListener),!e.size&&(L.delete(a),c.watcher))return c.watcher.stop().then((()=>{c.rawEmitter=c.watcher=void 0,Object.freeze(c)}))}}(e,t,(async(r,o,c)=>{if(this.fsw.closed)return;if(void 0!==a.depth&&calcDepth(r,t)>a.depth)return;const l=i(n.join(e,n.relative(e,r)));if(s&&!s(l))return;const d=n.dirname(l),h=n.basename(l),u=this.fsw._getWatchedDir(c.type===w?l:d);if(j.has(o)||c.event===_)if(typeof a.ignored===A){let e;try{e=await N(l)}catch(e){}if(this.fsw.closed)return;if(this.checkIgnored(l,e))return;sameTypes(c,e)?this.addOrChange(l,r,t,d,u,h,c,a):this.handleEvent(p,l,r,t,d,u,h,c,a)}else this.checkExists(l,r,t,d,u,h,c,a);else switch(c.event){case g:case v:return this.addOrChange(l,r,t,d,u,h,c,a);case y:case x:return this.checkExists(l,r,t,d,u,h,c,a)}}),this.fsw._emitRaw);return this.fsw._emitReady(),o}async _handleFsEventsSymlink(e,t,i,s){if(!this.fsw.closed&&!this.fsw._symlinkPaths.has(t)){this.fsw._symlinkPaths.set(t,!0),this.fsw._incrReadyCount();try{const t=await I(e);if(this.fsw.closed)return;if(this.fsw._isIgnored(t))return this.fsw._emitReady();this.fsw._incrReadyCount(),this._addToFsEvents(t||e,(s=>{let a=e;return t&&t!==T?a=s.replace(t,e):s!==T&&(a=n.join(e,s)),i(a)}),!1,s)}catch(e){if(this.fsw._handleError(e))return this.fsw._emitReady()}}}emitAdd(e,t,i,s,a){const r=i(e),c=t.isDirectory(),p=this.fsw._getWatchedDir(n.dirname(r)),d=n.basename(r);c&&this.fsw._getWatchedDir(r),p.has(d)||(p.add(d),s.ignoreInitial&&!0!==a||this.fsw._emit(c?l:o,r,t))}initWatch(e,t,i,s){if(this.fsw.closed)return;const a=this._watchWithFsEvents(i.watchPath,n.resolve(e||i.watchPath),s,i.globFilter);this.fsw._addPathCloser(t,a)}async _addToFsEvents(e,t,i,s){if(this.fsw.closed)return;const a=this.fsw.options,r=typeof t===A?t:C,o=this.fsw._getWatchHelpers(e);try{const t=await D[o.statMethod](o.watchPath);if(this.fsw.closed)return;if(this.fsw._isIgnored(o.watchPath,t))throw null;if(t.isDirectory()){if(o.globFilter||this.emitAdd(r(e),t,r,a,i),s&&s>a.depth)return;this.fsw._readdirp(o.watchPath,{fileFilter:e=>o.filterPath(e),directoryFilter:e=>o.filterDir(e),...(c=a.depth-(s||0),isNaN(c)?{}:{depth:c})}).on(h,(e=>{if(this.fsw.closed)return;if(e.stats.isDirectory()&&!o.filterPath(e))return;const t=n.join(o.watchPath,e.path),{fullPath:s}=e;if(o.followSymlinks&&e.stats.isSymbolicLink()){const e=void 0===a.depth?void 0:calcDepth(t,n.resolve(o.watchPath))+1;this._handleFsEventsSymlink(t,s,r,e)}else this.emitAdd(t,e.stats,r,a,i)})).on(d,O).on(u,(()=>{this.fsw._emitReady()}))}else this.emitAdd(o.watchPath,t,r,a,i),this.fsw._emitReady()}catch(e){e&&!this.fsw._handleError(e)||(this.fsw._emitReady(),this.fsw._emitReady())}var c;if(a.persistent&&!0!==i)if(typeof t===A)this.initWatch(void 0,e,o,r);else{let t;try{t=await I(o.watchPath)}catch(e){}this.initWatch(t,e,o,r)}}},e.exports.canUse=()=>r&&L.size<128},3221:(e,t,i)=>{"use strict";const s=i(7147),n=i(1017),{promisify:a}=i(3837),r=i(6259),{isWindows:o,isLinux:c,EMPTY_FN:l,EMPTY_STR:p,KEY_LISTENERS:d,KEY_ERR:h,KEY_RAW:u,HANDLER_KEYS:g,EV_CHANGE:v,EV_ADD:y,EV_ADD_DIR:x,EV_ERROR:_,STR_DATA:b,STR_END:w,BRACE_START:E,STAR:k}=i(1318),S=a(s.open),T=a(s.stat),A=a(s.lstat),O=a(s.close),C=a(s.realpath),N={lstat:A,stat:T},foreach=(e,t)=>{e instanceof Set?e.forEach(t):t(e)},addAndConvert=(e,t,i)=>{let s=e[t];s instanceof Set||(e[t]=s=new Set([s])),s.add(i)},delFromSet=(e,t,i)=>{const s=e[t];s instanceof Set?s.delete(i):s===i&&delete e[t]},isEmptySet=e=>e instanceof Set?0===e.size:!e,R=new Map;function createFsWatchInstance(e,t,i,a,r){const handleEvent=(t,s)=>{i(e),r(t,s,{watchedPath:e}),s&&e!==s&&fsWatchBroadcast(n.resolve(e,s),d,n.join(e,s))};try{return s.watch(e,t,handleEvent)}catch(e){a(e)}}const fsWatchBroadcast=(e,t,i,s,n)=>{const a=R.get(e);a&&foreach(a[t],(e=>{e(i,s,n)}))},setFsWatchListener=(e,t,i,s)=>{const{listener:n,errHandler:a,rawEmitter:r}=s;let c,l=R.get(t);if(!i.persistent)return c=createFsWatchInstance(e,i,n,a,r),c.close.bind(c);if(l)addAndConvert(l,d,n),addAndConvert(l,h,a),addAndConvert(l,u,r);else{if(c=createFsWatchInstance(e,i,fsWatchBroadcast.bind(null,t,d),a,fsWatchBroadcast.bind(null,t,u)),!c)return;c.on(_,(async i=>{const s=fsWatchBroadcast.bind(null,t,h);if(l.watcherUnusable=!0,o&&"EPERM"===i.code)try{const t=await S(e,"r");await O(t),s(i)}catch(e){}else s(i)})),l={listeners:n,errHandlers:a,rawEmitters:r,watcher:c},R.set(t,l)}return()=>{delFromSet(l,d,n),delFromSet(l,h,a),delFromSet(l,u,r),isEmptySet(l.listeners)&&(l.watcher.close(),R.delete(t),g.forEach((e=>t=>{const i=e[t];i instanceof Set?i.clear():delete e[t]})(l)),l.watcher=void 0,Object.freeze(l))}},I=new Map;e.exports=class NodeFsHandler{constructor(e){this.fsw=e,this._boundHandleError=t=>e._handleError(t)}_watchWithNodeFs(e,t){const i=this.fsw.options,a=n.dirname(e),o=n.basename(e);this.fsw._getWatchedDir(a).add(o);const c=n.resolve(e),p={persistent:i.persistent};let h;return t||(t=l),i.usePolling?(p.interval=i.enableBinaryInterval&&r(o)?i.binaryInterval:i.interval,h=((e,t,i,n)=>{const{listener:a,rawEmitter:r}=n;let o=I.get(t),c=new Set,l=new Set;const p=o&&o.options;return p&&(p.persistent<i.persistent||p.interval>i.interval)&&(c=o.listeners,l=o.rawEmitters,s.unwatchFile(t),o=void 0),o?(addAndConvert(o,d,a),addAndConvert(o,u,r)):(o={listeners:a,rawEmitters:r,options:i,watcher:s.watchFile(t,i,((i,s)=>{foreach(o.rawEmitters,(e=>{e(v,t,{curr:i,prev:s})}));const n=i.mtimeMs;(i.size!==s.size||n>s.mtimeMs||0===n)&&foreach(o.listeners,(t=>t(e,i)))}))},I.set(t,o)),()=>{delFromSet(o,d,a),delFromSet(o,u,r),isEmptySet(o.listeners)&&(I.delete(t),s.unwatchFile(t),o.options=o.watcher=void 0,Object.freeze(o))}})(e,c,p,{listener:t,rawEmitter:this.fsw._emitRaw})):h=setFsWatchListener(e,c,p,{listener:t,errHandler:this._boundHandleError,rawEmitter:this.fsw._emitRaw}),h}_handleFile(e,t,i){if(this.fsw.closed)return;const s=n.dirname(e),a=n.basename(e),r=this.fsw._getWatchedDir(s);let o=t;if(r.has(a))return;const listener=async(t,i)=>{if(this.fsw._throttle("watch",e,5))if(i&&0!==i.mtimeMs){if(r.has(a)){const t=i.atimeMs,s=i.mtimeMs;(!t||t<=s||s!==o.mtimeMs)&&this.fsw._emit(v,e,i),o=i}}else try{const i=await T(e);if(this.fsw.closed)return;const s=i.atimeMs,n=i.mtimeMs;(!s||s<=n||n!==o.mtimeMs)&&this.fsw._emit(v,e,i),c&&o.ino!==i.ino?(this.fsw._closeFile(t),o=i,this.fsw._addPathCloser(t,this._watchWithNodeFs(e,listener))):o=i}catch(e){this.fsw._remove(s,a)}},l=this._watchWithNodeFs(e,listener);if((!i||!this.fsw.options.ignoreInitial)&&this.fsw._isntIgnored(e)){if(!this.fsw._throttle(y,e,0))return;this.fsw._emit(y,e,t)}return l}async _handleSymlink(e,t,i,s){if(this.fsw.closed)return;const n=e.fullPath,a=this.fsw._getWatchedDir(t);if(!this.fsw.options.followSymlinks){let t;this.fsw._incrReadyCount();try{t=await C(i)}catch(e){return this.fsw._emitReady(),!0}if(this.fsw.closed)return;return a.has(s)?this.fsw._symlinkPaths.get(n)!==t&&(this.fsw._symlinkPaths.set(n,t),this.fsw._emit(v,i,e.stats)):(a.add(s),this.fsw._symlinkPaths.set(n,t),this.fsw._emit(y,i,e.stats)),this.fsw._emitReady(),!0}if(this.fsw._symlinkPaths.has(n))return!0;this.fsw._symlinkPaths.set(n,!0)}_handleRead(e,t,i,s,a,r,o){if(e=n.join(e,p),!i.hasGlob&&!(o=this.fsw._throttle("readdir",e,1e3)))return;const c=this.fsw._getWatchedDir(i.path),l=new Set;let d=this.fsw._readdirp(e,{fileFilter:e=>i.filterPath(e),directoryFilter:e=>i.filterDir(e),depth:0}).on(b,(async o=>{if(this.fsw.closed)return void(d=void 0);const p=o.path;let h=n.join(e,p);l.add(p),o.stats.isSymbolicLink()&&await this._handleSymlink(o,e,h,p)||(this.fsw.closed?d=void 0:p!==s&&(s||c.has(p))||(this.fsw._incrReadyCount(),h=n.join(a,n.relative(a,h)),this._addToNodeFs(h,t,i,r+1)))})).on(_,this._boundHandleError);return new Promise((t=>d.once(w,(()=>{if(this.fsw.closed)return void(d=void 0);const p=!!o&&o.clear();t(),c.getChildren().filter((t=>t!==e&&!l.has(t)&&(!i.hasGlob||i.filterPath({fullPath:n.resolve(e,t)})))).forEach((t=>{this.fsw._remove(e,t)})),d=void 0,p&&this._handleRead(e,!1,i,s,a,r,o)}))))}async _handleDir(e,t,i,s,a,r,o){const c=this.fsw._getWatchedDir(n.dirname(e)),l=c.has(n.basename(e));let p,d;i&&this.fsw.options.ignoreInitial||a||l||r.hasGlob&&!r.globFilter(e)||this.fsw._emit(x,e,t),c.add(n.basename(e)),this.fsw._getWatchedDir(e);const h=this.fsw.options.depth;if((null==h||s<=h)&&!this.fsw._symlinkPaths.has(o)){if(!a&&(await this._handleRead(e,i,r,a,e,s,p),this.fsw.closed))return;d=this._watchWithNodeFs(e,((t,i)=>{i&&0===i.mtimeMs||this._handleRead(t,!1,r,a,e,s,p)}))}return d}async _addToNodeFs(e,t,i,s,a){const r=this.fsw._emitReady;if(this.fsw._isIgnored(e)||this.fsw.closed)return r(),!1;const o=this.fsw._getWatchHelpers(e,s);!o.hasGlob&&i&&(o.hasGlob=i.hasGlob,o.globFilter=i.globFilter,o.filterPath=e=>i.filterPath(e),o.filterDir=e=>i.filterDir(e));try{const i=await N[o.statMethod](o.watchPath);if(this.fsw.closed)return;if(this.fsw._isIgnored(o.watchPath,i))return r(),!1;const c=this.fsw.options.followSymlinks&&!e.includes(k)&&!e.includes(E);let l;if(i.isDirectory()){const r=n.resolve(e),p=c?await C(e):e;if(this.fsw.closed)return;if(l=await this._handleDir(o.watchPath,i,t,s,a,o,p),this.fsw.closed)return;r!==p&&void 0!==p&&this.fsw._symlinkPaths.set(r,p)}else if(i.isSymbolicLink()){const a=c?await C(e):e;if(this.fsw.closed)return;const r=n.dirname(o.watchPath);if(this.fsw._getWatchedDir(r).add(o.watchPath),this.fsw._emit(y,o.watchPath,i),l=await this._handleDir(r,i,t,s,e,o,a),this.fsw.closed)return;void 0!==a&&this.fsw._symlinkPaths.set(n.resolve(e),a)}else l=this._handleFile(o.watchPath,i,t);return r(),this.fsw._addPathCloser(e,l),!1}catch(t){if(this.fsw._handleError(t))return r(),e}}}},2664:(e,t,i)=>{"use strict";const s=i(3837),n=i(5702),isObject=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),isValidValue=e=>"number"==typeof e||"string"==typeof e&&""!==e,isNumber=e=>Number.isInteger(+e),zeros=e=>{let t=`${e}`,i=-1;if("-"===t[0]&&(t=t.slice(1)),"0"===t)return!1;for(;"0"===t[++i];);return i>0},pad=(e,t,i)=>{if(t>0){let i="-"===e[0]?"-":"";i&&(e=e.slice(1)),e=i+e.padStart(i?t-1:t,"0")}return!1===i?String(e):e},toMaxLen=(e,t)=>{let i="-"===e[0]?"-":"";for(i&&(e=e.slice(1),t--);e.length<t;)e="0"+e;return i?"-"+e:e},toRange=(e,t,i,s)=>{if(i)return n(e,t,{wrap:!1,...s});let a=String.fromCharCode(e);return e===t?a:`[${a}-${String.fromCharCode(t)}]`},toRegex=(e,t,i)=>{if(Array.isArray(e)){let t=!0===i.wrap,s=i.capture?"":"?:";return t?`(${s}${e.join("|")})`:e.join("|")}return n(e,t,i)},rangeError=(...e)=>new RangeError("Invalid range arguments: "+s.inspect(...e)),invalidRange=(e,t,i)=>{if(!0===i.strictRanges)throw rangeError([e,t]);return[]},fillNumbers=(e,t,i=1,s={})=>{let n=Number(e),a=Number(t);if(!Number.isInteger(n)||!Number.isInteger(a)){if(!0===s.strictRanges)throw rangeError([e,t]);return[]}0===n&&(n=0),0===a&&(a=0);let r=n>a,o=String(e),c=String(t),l=String(i);i=Math.max(Math.abs(i),1);let p=zeros(o)||zeros(c)||zeros(l),d=p?Math.max(o.length,c.length,l.length):0,h=!1===p&&!1===((e,t,i)=>"string"==typeof e||"string"==typeof t||!0===i.stringify)(e,t,s),u=s.transform||(e=>t=>!0===e?Number(t):String(t))(h);if(s.toRegex&&1===i)return toRange(toMaxLen(e,d),toMaxLen(t,d),!0,s);let g={negatives:[],positives:[]},v=[],y=0;for(;r?n>=a:n<=a;)!0===s.toRegex&&i>1?g[(x=n)<0?"negatives":"positives"].push(Math.abs(x)):v.push(pad(u(n,y),d,h)),n=r?n-i:n+i,y++;var x;return!0===s.toRegex?i>1?((e,t)=>{e.negatives.sort(((e,t)=>e<t?-1:e>t?1:0)),e.positives.sort(((e,t)=>e<t?-1:e>t?1:0));let i,s=t.capture?"":"?:",n="",a="";return e.positives.length&&(n=e.positives.join("|")),e.negatives.length&&(a=`-(${s}${e.negatives.join("|")})`),i=n&&a?`${n}|${a}`:n||a,t.wrap?`(${s}${i})`:i})(g,s):toRegex(v,null,{wrap:!1,...s}):v},fill=(e,t,i,s={})=>{if(null==t&&isValidValue(e))return[e];if(!isValidValue(e)||!isValidValue(t))return invalidRange(e,t,s);if("function"==typeof i)return fill(e,t,1,{transform:i});if(isObject(i))return fill(e,t,0,i);let n={...s};return!0===n.capture&&(n.wrap=!0),i=i||n.step||1,isNumber(i)?isNumber(e)&&isNumber(t)?fillNumbers(e,t,i,n):((e,t,i=1,s={})=>{if(!isNumber(e)&&e.length>1||!isNumber(t)&&t.length>1)return invalidRange(e,t,s);let n=s.transform||(e=>String.fromCharCode(e)),a=`${e}`.charCodeAt(0),r=`${t}`.charCodeAt(0),o=a>r,c=Math.min(a,r),l=Math.max(a,r);if(s.toRegex&&1===i)return toRange(c,l,!1,s);let p=[],d=0;for(;o?a>=r:a<=r;)p.push(n(a,d)),a=o?a-i:a+i,d++;return!0===s.toRegex?toRegex(p,null,{wrap:!1,options:s}):p})(e,t,Math.max(Math.abs(i),1),n):null==i||isObject(i)?fill(e,t,1,i):((e,t)=>{if(!0===t.strictRanges)throw new TypeError(`Expected step "${e}" to be a number`);return[]})(i,n)};e.exports=fill},7334:(e,t,i)=>{e.exports=realpath,realpath.realpath=realpath,realpath.sync=realpathSync,realpath.realpathSync=realpathSync,realpath.monkeypatch=function monkeypatch(){s.realpath=realpath,s.realpathSync=realpathSync},realpath.unmonkeypatch=function unmonkeypatch(){s.realpath=n,s.realpathSync=a};var s=i(7147),n=s.realpath,a=s.realpathSync,r=process.version,o=/^v[0-5]\./.test(r),c=i(7059);function newError(e){return e&&"realpath"===e.syscall&&("ELOOP"===e.code||"ENOMEM"===e.code||"ENAMETOOLONG"===e.code)}function realpath(e,t,i){if(o)return n(e,t,i);"function"==typeof t&&(i=t,t=null),n(e,t,(function(s,n){newError(s)?c.realpath(e,t,i):i(s,n)}))}function realpathSync(e,t){if(o)return a(e,t);try{return a(e,t)}catch(i){if(newError(i))return c.realpathSync(e,t);throw i}}},7059:(e,t,i)=>{var s=i(1017),n="win32"===process.platform,a=i(7147),r=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function maybeCallback(e){return"function"==typeof e?e:function rethrow(){var e;if(r){var t=new Error;e=function debugCallback(e){e&&(t.message=e.message,missingCallback(e=t))}}else e=missingCallback;return e;function missingCallback(e){if(e){if(process.throwDeprecation)throw e;if(!process.noDeprecation){var t="fs: missing callback "+(e.stack||e.message);process.traceDeprecation?console.trace(t):console.error(t)}}}}()}s.normalize;if(n)var o=/(.*?)(?:[\/\\]+|$)/g;else o=/(.*?)(?:[\/]+|$)/g;if(n)var c=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else c=/^[\/]*/;t.realpathSync=function realpathSync(e,t){if(e=s.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return t[e];var i,r,l,p,d=e,h={},u={};function start(){var t=c.exec(e);i=t[0].length,r=t[0],l=t[0],p="",n&&!u[l]&&(a.lstatSync(l),u[l]=!0)}for(start();i<e.length;){o.lastIndex=i;var g=o.exec(e);if(p=r,r+=g[0],l=p+g[1],i=o.lastIndex,!(u[l]||t&&t[l]===l)){var v;if(t&&Object.prototype.hasOwnProperty.call(t,l))v=t[l];else{var y=a.lstatSync(l);if(!y.isSymbolicLink()){u[l]=!0,t&&(t[l]=l);continue}var x=null;if(!n){var _=y.dev.toString(32)+":"+y.ino.toString(32);h.hasOwnProperty(_)&&(x=h[_])}null===x&&(a.statSync(l),x=a.readlinkSync(l)),v=s.resolve(p,x),t&&(t[l]=v),n||(h[_]=x)}e=s.resolve(v,e.slice(i)),start()}}return t&&(t[d]=e),e},t.realpath=function realpath(e,t,i){if("function"!=typeof i&&(i=maybeCallback(t),t=null),e=s.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return process.nextTick(i.bind(null,null,t[e]));var r,l,p,d,h=e,u={},g={};function start(){var t=c.exec(e);r=t[0].length,l=t[0],p=t[0],d="",n&&!g[p]?a.lstat(p,(function(e){if(e)return i(e);g[p]=!0,LOOP()})):process.nextTick(LOOP)}function LOOP(){if(r>=e.length)return t&&(t[h]=e),i(null,e);o.lastIndex=r;var s=o.exec(e);return d=l,l+=s[0],p=d+s[1],r=o.lastIndex,g[p]||t&&t[p]===p?process.nextTick(LOOP):t&&Object.prototype.hasOwnProperty.call(t,p)?gotResolvedLink(t[p]):a.lstat(p,gotStat)}function gotStat(e,s){if(e)return i(e);if(!s.isSymbolicLink())return g[p]=!0,t&&(t[p]=p),process.nextTick(LOOP);if(!n){var r=s.dev.toString(32)+":"+s.ino.toString(32);if(u.hasOwnProperty(r))return gotTarget(null,u[r],p)}a.stat(p,(function(e){if(e)return i(e);a.readlink(p,(function(e,t){n||(u[r]=t),gotTarget(e,t)}))}))}function gotTarget(e,n,a){if(e)return i(e);var r=s.resolve(d,n);t&&(t[a]=r),gotResolvedLink(r)}function gotResolvedLink(t){e=s.resolve(t,e.slice(r)),start()}start()}},7647:(e,t,i)=>{"use strict";var s=i(6830),n=i(1017).posix.dirname,a="win32"===i(2037).platform(),r=/\\/g,o=/[\{\[].*[\}\]]$/,c=/(^|[^\\])([\{\[]|\([^\)]+$)/,l=/\\([\!\*\?\|\[\]\(\)\{\}])/g;e.exports=function globParent(e,t){Object.assign({flipBackslashes:!0},t).flipBackslashes&&a&&e.indexOf("/")<0&&(e=e.replace(r,"/")),o.test(e)&&(e+="/"),e+="a";do{e=n(e)}while(s(e)||c.test(e));return e.replace(l,"$1")}},7844:(e,t,i)=>{var s=i(2479),n=Object.create(null),a=i(778);function slice(e){for(var t=e.length,i=[],s=0;s<t;s++)i[s]=e[s];return i}e.exports=s((function inflight(e,t){return n[e]?(n[e].push(t),null):(n[e]=[t],function makeres(e){return a((function RES(){var t=n[e],i=t.length,s=slice(arguments);try{for(var a=0;a<i;a++)t[a].apply(null,s)}finally{t.length>i?(t.splice(0,i),process.nextTick((function(){RES.apply(null,s)}))):delete n[e]}}))}(e))}))},4378:(e,t,i)=>{try{var s=i(3837);if("function"!=typeof s.inherits)throw"";e.exports=s.inherits}catch(t){e.exports=i(5717)}},5717:e=>{"function"==typeof Object.create?e.exports=function inherits(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function inherits(e,t){if(t){e.super_=t;var TempCtor=function(){};TempCtor.prototype=t.prototype,e.prototype=new TempCtor,e.prototype.constructor=e}}},6259:(e,t,i)=>{"use strict";const s=i(1017),n=i(5487),a=new Set(n);e.exports=e=>a.has(s.extname(e).slice(1).toLowerCase())},2428:e=>{e.exports=function isExtglob(e){if("string"!=typeof e||""===e)return!1;for(var t;t=/(\\).|([@?!+*]\(.*\))/g.exec(e);){if(t[2])return!0;e=e.slice(t.index+t[0].length)}return!1}},6830:(e,t,i)=>{var s=i(2428),n={"{":"}","(":")","[":"]"},strictCheck=function(e){if("!"===e[0])return!0;for(var t=0,i=-2,s=-2,a=-2,r=-2,o=-2;t<e.length;){if("*"===e[t])return!0;if("?"===e[t+1]&&/[\].+)]/.test(e[t]))return!0;if(-1!==s&&"["===e[t]&&"]"!==e[t+1]&&(s<t&&(s=e.indexOf("]",t)),s>t)){if(-1===o||o>s)return!0;if(-1===(o=e.indexOf("\\",t))||o>s)return!0}if(-1!==a&&"{"===e[t]&&"}"!==e[t+1]&&(a=e.indexOf("}",t))>t&&(-1===(o=e.indexOf("\\",t))||o>a))return!0;if(-1!==r&&"("===e[t]&&"?"===e[t+1]&&/[:!=]/.test(e[t+2])&&")"!==e[t+3]&&(r=e.indexOf(")",t))>t&&(-1===(o=e.indexOf("\\",t))||o>r))return!0;if(-1!==i&&"("===e[t]&&"|"!==e[t+1]&&(i<t&&(i=e.indexOf("|",t)),-1!==i&&")"!==e[i+1]&&(r=e.indexOf(")",i))>i&&(-1===(o=e.indexOf("\\",i))||o>r)))return!0;if("\\"===e[t]){var c=e[t+1];t+=2;var l=n[c];if(l){var p=e.indexOf(l,t);-1!==p&&(t=p+1)}if("!"===e[t])return!0}else t++}return!1},relaxedCheck=function(e){if("!"===e[0])return!0;for(var t=0;t<e.length;){if(/[*?{}()[\]]/.test(e[t]))return!0;if("\\"===e[t]){var i=e[t+1];t+=2;var s=n[i];if(s){var a=e.indexOf(s,t);-1!==a&&(t=a+1)}if("!"===e[t])return!0}else t++}return!1};e.exports=function isGlob(e,t){if("string"!=typeof e||""===e)return!1;if(s(e))return!0;var i=strictCheck;return t&&!1===t.strict&&(i=relaxedCheck),i(e)}},9924:e=>{"use strict";e.exports=function(e){return"number"==typeof e?e-e==0:"string"==typeof e&&""!==e.trim()&&(Number.isFinite?Number.isFinite(+e):isFinite(+e))}},9593:(e,t,i)=>{"use strict";const s=i(4411),n=Symbol("max"),a=Symbol("length"),r=Symbol("lengthCalculator"),o=Symbol("allowStale"),c=Symbol("maxAge"),l=Symbol("dispose"),p=Symbol("noDisposeOnSet"),d=Symbol("lruList"),h=Symbol("cache"),u=Symbol("updateAgeOnGet"),naiveLength=()=>1;const get=(e,t,i)=>{const s=e[h].get(t);if(s){const t=s.value;if(isStale(e,t)){if(del(e,s),!e[o])return}else i&&(e[u]&&(s.value.now=Date.now()),e[d].unshiftNode(s));return t.value}},isStale=(e,t)=>{if(!t||!t.maxAge&&!e[c])return!1;const i=Date.now()-t.now;return t.maxAge?i>t.maxAge:e[c]&&i>e[c]},trim=e=>{if(e[a]>e[n])for(let t=e[d].tail;e[a]>e[n]&&null!==t;){const i=t.prev;del(e,t),t=i}},del=(e,t)=>{if(t){const i=t.value;e[l]&&e[l](i.key,i.value),e[a]-=i.length,e[h].delete(i.key),e[d].removeNode(t)}};class Entry{constructor(e,t,i,s,n){this.key=e,this.value=t,this.length=i,this.now=s,this.maxAge=n||0}}const forEachStep=(e,t,i,s)=>{let n=i.value;isStale(e,n)&&(del(e,i),e[o]||(n=void 0)),n&&t.call(s,n.value,n.key,e)};e.exports=class LRUCache{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[n]=e.max||1/0;const t=e.length||naiveLength;if(this[r]="function"!=typeof t?naiveLength:t,this[o]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[c]=e.maxAge||0,this[l]=e.dispose,this[p]=e.noDisposeOnSet||!1,this[u]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[n]=e||1/0,trim(this)}get max(){return this[n]}set allowStale(e){this[o]=!!e}get allowStale(){return this[o]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[c]=e,trim(this)}get maxAge(){return this[c]}set lengthCalculator(e){"function"!=typeof e&&(e=naiveLength),e!==this[r]&&(this[r]=e,this[a]=0,this[d].forEach((e=>{e.length=this[r](e.value,e.key),this[a]+=e.length}))),trim(this)}get lengthCalculator(){return this[r]}get length(){return this[a]}get itemCount(){return this[d].length}rforEach(e,t){t=t||this;for(let i=this[d].tail;null!==i;){const s=i.prev;forEachStep(this,e,i,t),i=s}}forEach(e,t){t=t||this;for(let i=this[d].head;null!==i;){const s=i.next;forEachStep(this,e,i,t),i=s}}keys(){return this[d].toArray().map((e=>e.key))}values(){return this[d].toArray().map((e=>e.value))}reset(){this[l]&&this[d]&&this[d].length&&this[d].forEach((e=>this[l](e.key,e.value))),this[h]=new Map,this[d]=new s,this[a]=0}dump(){return this[d].map((e=>!isStale(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[d]}set(e,t,i){if((i=i||this[c])&&"number"!=typeof i)throw new TypeError("maxAge must be a number");const s=i?Date.now():0,o=this[r](t,e);if(this[h].has(e)){if(o>this[n])return del(this,this[h].get(e)),!1;const r=this[h].get(e).value;return this[l]&&(this[p]||this[l](e,r.value)),r.now=s,r.maxAge=i,r.value=t,this[a]+=o-r.length,r.length=o,this.get(e),trim(this),!0}const u=new Entry(e,t,o,s,i);return u.length>this[n]?(this[l]&&this[l](e,t),!1):(this[a]+=u.length,this[d].unshift(u),this[h].set(e,this[d].head),trim(this),!0)}has(e){if(!this[h].has(e))return!1;const t=this[h].get(e).value;return!isStale(this,t)}get(e){return get(this,e,!0)}peek(e){return get(this,e,!1)}pop(){const e=this[d].tail;return e?(del(this,e),e.value):null}del(e){del(this,this[h].get(e))}load(e){this.reset();const t=Date.now();for(let i=e.length-1;i>=0;i--){const s=e[i],n=s.e||0;if(0===n)this.set(s.k,s.v);else{const e=n-t;e>0&&this.set(s.k,s.v,e)}}}prune(){this[h].forEach(((e,t)=>get(this,t,!1)))}}},9146:e=>{"use strict";function Mime(){this._types=Object.create(null),this._extensions=Object.create(null);for(let e=0;e<arguments.length;e++)this.define(arguments[e]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}Mime.prototype.define=function(e,t){for(let i in e){let s=e[i].map((function(e){return e.toLowerCase()}));i=i.toLowerCase();for(let e=0;e<s.length;e++){const n=s[e];if("*"!==n[0]){if(!t&&n in this._types)throw new Error('Attempt to change mapping for "'+n+'" extension from "'+this._types[n]+'" to "'+i+'". Pass `force=true` to allow this, otherwise remove "'+n+'" from the list of extensions for "'+i+'".');this._types[n]=i}}if(t||!this._extensions[i]){const e=s[0];this._extensions[i]="*"!==e[0]?e:e.substr(1)}}},Mime.prototype.getType=function(e){let t=(e=String(e)).replace(/^.*[/\\]/,"").toLowerCase(),i=t.replace(/^.*\./,"").toLowerCase(),s=t.length<e.length;return(i.length<t.length-1||!s)&&this._types[i]||null},Mime.prototype.getExtension=function(e){return(e=/^\s*([^;\s]*)/.test(e)&&RegExp.$1)&&this._extensions[e.toLowerCase()]||null},e.exports=Mime},3893:(e,t,i)=>{"use strict";let s=i(9146);e.exports=new s(i(4415),i(3014))},3014:e=>{e.exports={"application/prs.cww":["cww"],"application/vnd.1000minds.decision-model+xml":["1km"],"application/vnd.3gpp.pic-bw-large":["plb"],"application/vnd.3gpp.pic-bw-small":["psb"],"application/vnd.3gpp.pic-bw-var":["pvb"],"application/vnd.3gpp2.tcap":["tcap"],"application/vnd.3m.post-it-notes":["pwn"],"application/vnd.accpac.simply.aso":["aso"],"application/vnd.accpac.simply.imp":["imp"],"application/vnd.acucobol":["acu"],"application/vnd.acucorp":["atc","acutc"],"application/vnd.adobe.air-application-installer-package+zip":["air"],"application/vnd.adobe.formscentral.fcdt":["fcdt"],"application/vnd.adobe.fxp":["fxp","fxpl"],"application/vnd.adobe.xdp+xml":["xdp"],"application/vnd.adobe.xfdf":["xfdf"],"application/vnd.ahead.space":["ahead"],"application/vnd.airzip.filesecure.azf":["azf"],"application/vnd.airzip.filesecure.azs":["azs"],"application/vnd.amazon.ebook":["azw"],"application/vnd.americandynamics.acc":["acc"],"application/vnd.amiga.ami":["ami"],"application/vnd.android.package-archive":["apk"],"application/vnd.anser-web-certificate-issue-initiation":["cii"],"application/vnd.anser-web-funds-transfer-initiation":["fti"],"application/vnd.antix.game-component":["atx"],"application/vnd.apple.installer+xml":["mpkg"],"application/vnd.apple.keynote":["key"],"application/vnd.apple.mpegurl":["m3u8"],"application/vnd.apple.numbers":["numbers"],"application/vnd.apple.pages":["pages"],"application/vnd.apple.pkpass":["pkpass"],"application/vnd.aristanetworks.swi":["swi"],"application/vnd.astraea-software.iota":["iota"],"application/vnd.audiograph":["aep"],"application/vnd.balsamiq.bmml+xml":["bmml"],"application/vnd.blueice.multipass":["mpm"],"application/vnd.bmi":["bmi"],"application/vnd.businessobjects":["rep"],"application/vnd.chemdraw+xml":["cdxml"],"application/vnd.chipnuts.karaoke-mmd":["mmd"],"application/vnd.cinderella":["cdy"],"application/vnd.citationstyles.style+xml":["csl"],"application/vnd.claymore":["cla"],"application/vnd.cloanto.rp9":["rp9"],"application/vnd.clonk.c4group":["c4g","c4d","c4f","c4p","c4u"],"application/vnd.cluetrust.cartomobile-config":["c11amc"],"application/vnd.cluetrust.cartomobile-config-pkg":["c11amz"],"application/vnd.commonspace":["csp"],"application/vnd.contact.cmsg":["cdbcmsg"],"application/vnd.cosmocaller":["cmc"],"application/vnd.crick.clicker":["clkx"],"application/vnd.crick.clicker.keyboard":["clkk"],"application/vnd.crick.clicker.palette":["clkp"],"application/vnd.crick.clicker.template":["clkt"],"application/vnd.crick.clicker.wordbank":["clkw"],"application/vnd.criticaltools.wbs+xml":["wbs"],"application/vnd.ctc-posml":["pml"],"application/vnd.cups-ppd":["ppd"],"application/vnd.curl.car":["car"],"application/vnd.curl.pcurl":["pcurl"],"application/vnd.dart":["dart"],"application/vnd.data-vision.rdz":["rdz"],"application/vnd.dbf":["dbf"],"application/vnd.dece.data":["uvf","uvvf","uvd","uvvd"],"application/vnd.dece.ttml+xml":["uvt","uvvt"],"application/vnd.dece.unspecified":["uvx","uvvx"],"application/vnd.dece.zip":["uvz","uvvz"],"application/vnd.denovo.fcselayout-link":["fe_launch"],"application/vnd.dna":["dna"],"application/vnd.dolby.mlp":["mlp"],"application/vnd.dpgraph":["dpg"],"application/vnd.dreamfactory":["dfac"],"application/vnd.ds-keypoint":["kpxx"],"application/vnd.dvb.ait":["ait"],"application/vnd.dvb.service":["svc"],"application/vnd.dynageo":["geo"],"application/vnd.ecowin.chart":["mag"],"application/vnd.enliven":["nml"],"application/vnd.epson.esf":["esf"],"application/vnd.epson.msf":["msf"],"application/vnd.epson.quickanime":["qam"],"application/vnd.epson.salt":["slt"],"application/vnd.epson.ssf":["ssf"],"application/vnd.eszigno3+xml":["es3","et3"],"application/vnd.ezpix-album":["ez2"],"application/vnd.ezpix-package":["ez3"],"application/vnd.fdf":["fdf"],"application/vnd.fdsn.mseed":["mseed"],"application/vnd.fdsn.seed":["seed","dataless"],"application/vnd.flographit":["gph"],"application/vnd.fluxtime.clip":["ftc"],"application/vnd.framemaker":["fm","frame","maker","book"],"application/vnd.frogans.fnc":["fnc"],"application/vnd.frogans.ltf":["ltf"],"application/vnd.fsc.weblaunch":["fsc"],"application/vnd.fujitsu.oasys":["oas"],"application/vnd.fujitsu.oasys2":["oa2"],"application/vnd.fujitsu.oasys3":["oa3"],"application/vnd.fujitsu.oasysgp":["fg5"],"application/vnd.fujitsu.oasysprs":["bh2"],"application/vnd.fujixerox.ddd":["ddd"],"application/vnd.fujixerox.docuworks":["xdw"],"application/vnd.fujixerox.docuworks.binder":["xbd"],"application/vnd.fuzzysheet":["fzs"],"application/vnd.genomatix.tuxedo":["txd"],"application/vnd.geogebra.file":["ggb"],"application/vnd.geogebra.tool":["ggt"],"application/vnd.geometry-explorer":["gex","gre"],"application/vnd.geonext":["gxt"],"application/vnd.geoplan":["g2w"],"application/vnd.geospace":["g3w"],"application/vnd.gmx":["gmx"],"application/vnd.google-apps.document":["gdoc"],"application/vnd.google-apps.presentation":["gslides"],"application/vnd.google-apps.spreadsheet":["gsheet"],"application/vnd.google-earth.kml+xml":["kml"],"application/vnd.google-earth.kmz":["kmz"],"application/vnd.grafeq":["gqf","gqs"],"application/vnd.groove-account":["gac"],"application/vnd.groove-help":["ghf"],"application/vnd.groove-identity-message":["gim"],"application/vnd.groove-injector":["grv"],"application/vnd.groove-tool-message":["gtm"],"application/vnd.groove-tool-template":["tpl"],"application/vnd.groove-vcard":["vcg"],"application/vnd.hal+xml":["hal"],"application/vnd.handheld-entertainment+xml":["zmm"],"application/vnd.hbci":["hbci"],"application/vnd.hhe.lesson-player":["les"],"application/vnd.hp-hpgl":["hpgl"],"application/vnd.hp-hpid":["hpid"],"application/vnd.hp-hps":["hps"],"application/vnd.hp-jlyt":["jlt"],"application/vnd.hp-pcl":["pcl"],"application/vnd.hp-pclxl":["pclxl"],"application/vnd.hydrostatix.sof-data":["sfd-hdstx"],"application/vnd.ibm.minipay":["mpy"],"application/vnd.ibm.modcap":["afp","listafp","list3820"],"application/vnd.ibm.rights-management":["irm"],"application/vnd.ibm.secure-container":["sc"],"application/vnd.iccprofile":["icc","icm"],"application/vnd.igloader":["igl"],"application/vnd.immervision-ivp":["ivp"],"application/vnd.immervision-ivu":["ivu"],"application/vnd.insors.igm":["igm"],"application/vnd.intercon.formnet":["xpw","xpx"],"application/vnd.intergeo":["i2g"],"application/vnd.intu.qbo":["qbo"],"application/vnd.intu.qfx":["qfx"],"application/vnd.ipunplugged.rcprofile":["rcprofile"],"application/vnd.irepository.package+xml":["irp"],"application/vnd.is-xpr":["xpr"],"application/vnd.isac.fcs":["fcs"],"application/vnd.jam":["jam"],"application/vnd.jcp.javame.midlet-rms":["rms"],"application/vnd.jisp":["jisp"],"application/vnd.joost.joda-archive":["joda"],"application/vnd.kahootz":["ktz","ktr"],"application/vnd.kde.karbon":["karbon"],"application/vnd.kde.kchart":["chrt"],"application/vnd.kde.kformula":["kfo"],"application/vnd.kde.kivio":["flw"],"application/vnd.kde.kontour":["kon"],"application/vnd.kde.kpresenter":["kpr","kpt"],"application/vnd.kde.kspread":["ksp"],"application/vnd.kde.kword":["kwd","kwt"],"application/vnd.kenameaapp":["htke"],"application/vnd.kidspiration":["kia"],"application/vnd.kinar":["kne","knp"],"application/vnd.koan":["skp","skd","skt","skm"],"application/vnd.kodak-descriptor":["sse"],"application/vnd.las.las+xml":["lasxml"],"application/vnd.llamagraphics.life-balance.desktop":["lbd"],"application/vnd.llamagraphics.life-balance.exchange+xml":["lbe"],"application/vnd.lotus-1-2-3":["123"],"application/vnd.lotus-approach":["apr"],"application/vnd.lotus-freelance":["pre"],"application/vnd.lotus-notes":["nsf"],"application/vnd.lotus-organizer":["org"],"application/vnd.lotus-screencam":["scm"],"application/vnd.lotus-wordpro":["lwp"],"application/vnd.macports.portpkg":["portpkg"],"application/vnd.mapbox-vector-tile":["mvt"],"application/vnd.mcd":["mcd"],"application/vnd.medcalcdata":["mc1"],"application/vnd.mediastation.cdkey":["cdkey"],"application/vnd.mfer":["mwf"],"application/vnd.mfmp":["mfm"],"application/vnd.micrografx.flo":["flo"],"application/vnd.micrografx.igx":["igx"],"application/vnd.mif":["mif"],"application/vnd.mobius.daf":["daf"],"application/vnd.mobius.dis":["dis"],"application/vnd.mobius.mbk":["mbk"],"application/vnd.mobius.mqy":["mqy"],"application/vnd.mobius.msl":["msl"],"application/vnd.mobius.plc":["plc"],"application/vnd.mobius.txf":["txf"],"application/vnd.mophun.application":["mpn"],"application/vnd.mophun.certificate":["mpc"],"application/vnd.mozilla.xul+xml":["xul"],"application/vnd.ms-artgalry":["cil"],"application/vnd.ms-cab-compressed":["cab"],"application/vnd.ms-excel":["xls","xlm","xla","xlc","xlt","xlw"],"application/vnd.ms-excel.addin.macroenabled.12":["xlam"],"application/vnd.ms-excel.sheet.binary.macroenabled.12":["xlsb"],"application/vnd.ms-excel.sheet.macroenabled.12":["xlsm"],"application/vnd.ms-excel.template.macroenabled.12":["xltm"],"application/vnd.ms-fontobject":["eot"],"application/vnd.ms-htmlhelp":["chm"],"application/vnd.ms-ims":["ims"],"application/vnd.ms-lrm":["lrm"],"application/vnd.ms-officetheme":["thmx"],"application/vnd.ms-outlook":["msg"],"application/vnd.ms-pki.seccat":["cat"],"application/vnd.ms-pki.stl":["*stl"],"application/vnd.ms-powerpoint":["ppt","pps","pot"],"application/vnd.ms-powerpoint.addin.macroenabled.12":["ppam"],"application/vnd.ms-powerpoint.presentation.macroenabled.12":["pptm"],"application/vnd.ms-powerpoint.slide.macroenabled.12":["sldm"],"application/vnd.ms-powerpoint.slideshow.macroenabled.12":["ppsm"],"application/vnd.ms-powerpoint.template.macroenabled.12":["potm"],"application/vnd.ms-project":["mpp","mpt"],"application/vnd.ms-word.document.macroenabled.12":["docm"],"application/vnd.ms-word.template.macroenabled.12":["dotm"],"application/vnd.ms-works":["wps","wks","wcm","wdb"],"application/vnd.ms-wpl":["wpl"],"application/vnd.ms-xpsdocument":["xps"],"application/vnd.mseq":["mseq"],"application/vnd.musician":["mus"],"application/vnd.muvee.style":["msty"],"application/vnd.mynfc":["taglet"],"application/vnd.neurolanguage.nlu":["nlu"],"application/vnd.nitf":["ntf","nitf"],"application/vnd.noblenet-directory":["nnd"],"application/vnd.noblenet-sealer":["nns"],"application/vnd.noblenet-web":["nnw"],"application/vnd.nokia.n-gage.ac+xml":["*ac"],"application/vnd.nokia.n-gage.data":["ngdat"],"application/vnd.nokia.n-gage.symbian.install":["n-gage"],"application/vnd.nokia.radio-preset":["rpst"],"application/vnd.nokia.radio-presets":["rpss"],"application/vnd.novadigm.edm":["edm"],"application/vnd.novadigm.edx":["edx"],"application/vnd.novadigm.ext":["ext"],"application/vnd.oasis.opendocument.chart":["odc"],"application/vnd.oasis.opendocument.chart-template":["otc"],"application/vnd.oasis.opendocument.database":["odb"],"application/vnd.oasis.opendocument.formula":["odf"],"application/vnd.oasis.opendocument.formula-template":["odft"],"application/vnd.oasis.opendocument.graphics":["odg"],"application/vnd.oasis.opendocument.graphics-template":["otg"],"application/vnd.oasis.opendocument.image":["odi"],"application/vnd.oasis.opendocument.image-template":["oti"],"application/vnd.oasis.opendocument.presentation":["odp"],"application/vnd.oasis.opendocument.presentation-template":["otp"],"application/vnd.oasis.opendocument.spreadsheet":["ods"],"application/vnd.oasis.opendocument.spreadsheet-template":["ots"],"application/vnd.oasis.opendocument.text":["odt"],"application/vnd.oasis.opendocument.text-master":["odm"],"application/vnd.oasis.opendocument.text-template":["ott"],"application/vnd.oasis.opendocument.text-web":["oth"],"application/vnd.olpc-sugar":["xo"],"application/vnd.oma.dd2+xml":["dd2"],"application/vnd.openblox.game+xml":["obgx"],"application/vnd.openofficeorg.extension":["oxt"],"application/vnd.openstreetmap.data+xml":["osm"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"application/vnd.openxmlformats-officedocument.presentationml.slide":["sldx"],"application/vnd.openxmlformats-officedocument.presentationml.slideshow":["ppsx"],"application/vnd.openxmlformats-officedocument.presentationml.template":["potx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.template":["xltx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.template":["dotx"],"application/vnd.osgeo.mapguide.package":["mgp"],"application/vnd.osgi.dp":["dp"],"application/vnd.osgi.subsystem":["esa"],"application/vnd.palm":["pdb","pqa","oprc"],"application/vnd.pawaafile":["paw"],"application/vnd.pg.format":["str"],"application/vnd.pg.osasli":["ei6"],"application/vnd.picsel":["efif"],"application/vnd.pmi.widget":["wg"],"application/vnd.pocketlearn":["plf"],"application/vnd.powerbuilder6":["pbd"],"application/vnd.previewsystems.box":["box"],"application/vnd.proteus.magazine":["mgz"],"application/vnd.publishare-delta-tree":["qps"],"application/vnd.pvi.ptid1":["ptid"],"application/vnd.quark.quarkxpress":["qxd","qxt","qwd","qwt","qxl","qxb"],"application/vnd.rar":["rar"],"application/vnd.realvnc.bed":["bed"],"application/vnd.recordare.musicxml":["mxl"],"application/vnd.recordare.musicxml+xml":["musicxml"],"application/vnd.rig.cryptonote":["cryptonote"],"application/vnd.rim.cod":["cod"],"application/vnd.rn-realmedia":["rm"],"application/vnd.rn-realmedia-vbr":["rmvb"],"application/vnd.route66.link66+xml":["link66"],"application/vnd.sailingtracker.track":["st"],"application/vnd.seemail":["see"],"application/vnd.sema":["sema"],"application/vnd.semd":["semd"],"application/vnd.semf":["semf"],"application/vnd.shana.informed.formdata":["ifm"],"application/vnd.shana.informed.formtemplate":["itp"],"application/vnd.shana.informed.interchange":["iif"],"application/vnd.shana.informed.package":["ipk"],"application/vnd.simtech-mindmapper":["twd","twds"],"application/vnd.smaf":["mmf"],"application/vnd.smart.teacher":["teacher"],"application/vnd.software602.filler.form+xml":["fo"],"application/vnd.solent.sdkm+xml":["sdkm","sdkd"],"application/vnd.spotfire.dxp":["dxp"],"application/vnd.spotfire.sfs":["sfs"],"application/vnd.stardivision.calc":["sdc"],"application/vnd.stardivision.draw":["sda"],"application/vnd.stardivision.impress":["sdd"],"application/vnd.stardivision.math":["smf"],"application/vnd.stardivision.writer":["sdw","vor"],"application/vnd.stardivision.writer-global":["sgl"],"application/vnd.stepmania.package":["smzip"],"application/vnd.stepmania.stepchart":["sm"],"application/vnd.sun.wadl+xml":["wadl"],"application/vnd.sun.xml.calc":["sxc"],"application/vnd.sun.xml.calc.template":["stc"],"application/vnd.sun.xml.draw":["sxd"],"application/vnd.sun.xml.draw.template":["std"],"application/vnd.sun.xml.impress":["sxi"],"application/vnd.sun.xml.impress.template":["sti"],"application/vnd.sun.xml.math":["sxm"],"application/vnd.sun.xml.writer":["sxw"],"application/vnd.sun.xml.writer.global":["sxg"],"application/vnd.sun.xml.writer.template":["stw"],"application/vnd.sus-calendar":["sus","susp"],"application/vnd.svd":["svd"],"application/vnd.symbian.install":["sis","sisx"],"application/vnd.syncml+xml":["xsm"],"application/vnd.syncml.dm+wbxml":["bdm"],"application/vnd.syncml.dm+xml":["xdm"],"application/vnd.syncml.dmddf+xml":["ddf"],"application/vnd.tao.intent-module-archive":["tao"],"application/vnd.tcpdump.pcap":["pcap","cap","dmp"],"application/vnd.tmobile-livetv":["tmo"],"application/vnd.trid.tpt":["tpt"],"application/vnd.triscape.mxs":["mxs"],"application/vnd.trueapp":["tra"],"application/vnd.ufdl":["ufd","ufdl"],"application/vnd.uiq.theme":["utz"],"application/vnd.umajin":["umj"],"application/vnd.unity":["unityweb"],"application/vnd.uoml+xml":["uoml"],"application/vnd.vcx":["vcx"],"application/vnd.visio":["vsd","vst","vss","vsw"],"application/vnd.visionary":["vis"],"application/vnd.vsf":["vsf"],"application/vnd.wap.wbxml":["wbxml"],"application/vnd.wap.wmlc":["wmlc"],"application/vnd.wap.wmlscriptc":["wmlsc"],"application/vnd.webturbo":["wtb"],"application/vnd.wolfram.player":["nbp"],"application/vnd.wordperfect":["wpd"],"application/vnd.wqd":["wqd"],"application/vnd.wt.stf":["stf"],"application/vnd.xara":["xar"],"application/vnd.xfdl":["xfdl"],"application/vnd.yamaha.hv-dic":["hvd"],"application/vnd.yamaha.hv-script":["hvs"],"application/vnd.yamaha.hv-voice":["hvp"],"application/vnd.yamaha.openscoreformat":["osf"],"application/vnd.yamaha.openscoreformat.osfpvg+xml":["osfpvg"],"application/vnd.yamaha.smaf-audio":["saf"],"application/vnd.yamaha.smaf-phrase":["spf"],"application/vnd.yellowriver-custom-menu":["cmp"],"application/vnd.zul":["zir","zirz"],"application/vnd.zzazz.deck+xml":["zaz"],"application/x-7z-compressed":["7z"],"application/x-abiword":["abw"],"application/x-ace-compressed":["ace"],"application/x-apple-diskimage":["*dmg"],"application/x-arj":["arj"],"application/x-authorware-bin":["aab","x32","u32","vox"],"application/x-authorware-map":["aam"],"application/x-authorware-seg":["aas"],"application/x-bcpio":["bcpio"],"application/x-bdoc":["*bdoc"],"application/x-bittorrent":["torrent"],"application/x-blorb":["blb","blorb"],"application/x-bzip":["bz"],"application/x-bzip2":["bz2","boz"],"application/x-cbr":["cbr","cba","cbt","cbz","cb7"],"application/x-cdlink":["vcd"],"application/x-cfs-compressed":["cfs"],"application/x-chat":["chat"],"application/x-chess-pgn":["pgn"],"application/x-chrome-extension":["crx"],"application/x-cocoa":["cco"],"application/x-conference":["nsc"],"application/x-cpio":["cpio"],"application/x-csh":["csh"],"application/x-debian-package":["*deb","udeb"],"application/x-dgc-compressed":["dgc"],"application/x-director":["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"],"application/x-doom":["wad"],"application/x-dtbncx+xml":["ncx"],"application/x-dtbook+xml":["dtb"],"application/x-dtbresource+xml":["res"],"application/x-dvi":["dvi"],"application/x-envoy":["evy"],"application/x-eva":["eva"],"application/x-font-bdf":["bdf"],"application/x-font-ghostscript":["gsf"],"application/x-font-linux-psf":["psf"],"application/x-font-pcf":["pcf"],"application/x-font-snf":["snf"],"application/x-font-type1":["pfa","pfb","pfm","afm"],"application/x-freearc":["arc"],"application/x-futuresplash":["spl"],"application/x-gca-compressed":["gca"],"application/x-glulx":["ulx"],"application/x-gnumeric":["gnumeric"],"application/x-gramps-xml":["gramps"],"application/x-gtar":["gtar"],"application/x-hdf":["hdf"],"application/x-httpd-php":["php"],"application/x-install-instructions":["install"],"application/x-iso9660-image":["*iso"],"application/x-iwork-keynote-sffkey":["*key"],"application/x-iwork-numbers-sffnumbers":["*numbers"],"application/x-iwork-pages-sffpages":["*pages"],"application/x-java-archive-diff":["jardiff"],"application/x-java-jnlp-file":["jnlp"],"application/x-keepass2":["kdbx"],"application/x-latex":["latex"],"application/x-lua-bytecode":["luac"],"application/x-lzh-compressed":["lzh","lha"],"application/x-makeself":["run"],"application/x-mie":["mie"],"application/x-mobipocket-ebook":["prc","mobi"],"application/x-ms-application":["application"],"application/x-ms-shortcut":["lnk"],"application/x-ms-wmd":["wmd"],"application/x-ms-wmz":["wmz"],"application/x-ms-xbap":["xbap"],"application/x-msaccess":["mdb"],"application/x-msbinder":["obd"],"application/x-mscardfile":["crd"],"application/x-msclip":["clp"],"application/x-msdos-program":["*exe"],"application/x-msdownload":["*exe","*dll","com","bat","*msi"],"application/x-msmediaview":["mvb","m13","m14"],"application/x-msmetafile":["*wmf","*wmz","*emf","emz"],"application/x-msmoney":["mny"],"application/x-mspublisher":["pub"],"application/x-msschedule":["scd"],"application/x-msterminal":["trm"],"application/x-mswrite":["wri"],"application/x-netcdf":["nc","cdf"],"application/x-ns-proxy-autoconfig":["pac"],"application/x-nzb":["nzb"],"application/x-perl":["pl","pm"],"application/x-pilot":["*prc","*pdb"],"application/x-pkcs12":["p12","pfx"],"application/x-pkcs7-certificates":["p7b","spc"],"application/x-pkcs7-certreqresp":["p7r"],"application/x-rar-compressed":["*rar"],"application/x-redhat-package-manager":["rpm"],"application/x-research-info-systems":["ris"],"application/x-sea":["sea"],"application/x-sh":["sh"],"application/x-shar":["shar"],"application/x-shockwave-flash":["swf"],"application/x-silverlight-app":["xap"],"application/x-sql":["sql"],"application/x-stuffit":["sit"],"application/x-stuffitx":["sitx"],"application/x-subrip":["srt"],"application/x-sv4cpio":["sv4cpio"],"application/x-sv4crc":["sv4crc"],"application/x-t3vm-image":["t3"],"application/x-tads":["gam"],"application/x-tar":["tar"],"application/x-tcl":["tcl","tk"],"application/x-tex":["tex"],"application/x-tex-tfm":["tfm"],"application/x-texinfo":["texinfo","texi"],"application/x-tgif":["*obj"],"application/x-ustar":["ustar"],"application/x-virtualbox-hdd":["hdd"],"application/x-virtualbox-ova":["ova"],"application/x-virtualbox-ovf":["ovf"],"application/x-virtualbox-vbox":["vbox"],"application/x-virtualbox-vbox-extpack":["vbox-extpack"],"application/x-virtualbox-vdi":["vdi"],"application/x-virtualbox-vhd":["vhd"],"application/x-virtualbox-vmdk":["vmdk"],"application/x-wais-source":["src"],"application/x-web-app-manifest+json":["webapp"],"application/x-x509-ca-cert":["der","crt","pem"],"application/x-xfig":["fig"],"application/x-xliff+xml":["*xlf"],"application/x-xpinstall":["xpi"],"application/x-xz":["xz"],"application/x-zmachine":["z1","z2","z3","z4","z5","z6","z7","z8"],"audio/vnd.dece.audio":["uva","uvva"],"audio/vnd.digital-winds":["eol"],"audio/vnd.dra":["dra"],"audio/vnd.dts":["dts"],"audio/vnd.dts.hd":["dtshd"],"audio/vnd.lucent.voice":["lvp"],"audio/vnd.ms-playready.media.pya":["pya"],"audio/vnd.nuera.ecelp4800":["ecelp4800"],"audio/vnd.nuera.ecelp7470":["ecelp7470"],"audio/vnd.nuera.ecelp9600":["ecelp9600"],"audio/vnd.rip":["rip"],"audio/x-aac":["aac"],"audio/x-aiff":["aif","aiff","aifc"],"audio/x-caf":["caf"],"audio/x-flac":["flac"],"audio/x-m4a":["*m4a"],"audio/x-matroska":["mka"],"audio/x-mpegurl":["m3u"],"audio/x-ms-wax":["wax"],"audio/x-ms-wma":["wma"],"audio/x-pn-realaudio":["ram","ra"],"audio/x-pn-realaudio-plugin":["rmp"],"audio/x-realaudio":["*ra"],"audio/x-wav":["*wav"],"chemical/x-cdx":["cdx"],"chemical/x-cif":["cif"],"chemical/x-cmdf":["cmdf"],"chemical/x-cml":["cml"],"chemical/x-csml":["csml"],"chemical/x-xyz":["xyz"],"image/prs.btif":["btif"],"image/prs.pti":["pti"],"image/vnd.adobe.photoshop":["psd"],"image/vnd.airzip.accelerator.azv":["azv"],"image/vnd.dece.graphic":["uvi","uvvi","uvg","uvvg"],"image/vnd.djvu":["djvu","djv"],"image/vnd.dvb.subtitle":["*sub"],"image/vnd.dwg":["dwg"],"image/vnd.dxf":["dxf"],"image/vnd.fastbidsheet":["fbs"],"image/vnd.fpx":["fpx"],"image/vnd.fst":["fst"],"image/vnd.fujixerox.edmics-mmr":["mmr"],"image/vnd.fujixerox.edmics-rlc":["rlc"],"image/vnd.microsoft.icon":["ico"],"image/vnd.ms-dds":["dds"],"image/vnd.ms-modi":["mdi"],"image/vnd.ms-photo":["wdp"],"image/vnd.net-fpx":["npx"],"image/vnd.pco.b16":["b16"],"image/vnd.tencent.tap":["tap"],"image/vnd.valve.source.texture":["vtf"],"image/vnd.wap.wbmp":["wbmp"],"image/vnd.xiff":["xif"],"image/vnd.zbrush.pcx":["pcx"],"image/x-3ds":["3ds"],"image/x-cmu-raster":["ras"],"image/x-cmx":["cmx"],"image/x-freehand":["fh","fhc","fh4","fh5","fh7"],"image/x-icon":["*ico"],"image/x-jng":["jng"],"image/x-mrsid-image":["sid"],"image/x-ms-bmp":["*bmp"],"image/x-pcx":["*pcx"],"image/x-pict":["pic","pct"],"image/x-portable-anymap":["pnm"],"image/x-portable-bitmap":["pbm"],"image/x-portable-graymap":["pgm"],"image/x-portable-pixmap":["ppm"],"image/x-rgb":["rgb"],"image/x-tga":["tga"],"image/x-xbitmap":["xbm"],"image/x-xpixmap":["xpm"],"image/x-xwindowdump":["xwd"],"message/vnd.wfa.wsc":["wsc"],"model/vnd.collada+xml":["dae"],"model/vnd.dwf":["dwf"],"model/vnd.gdl":["gdl"],"model/vnd.gtw":["gtw"],"model/vnd.mts":["mts"],"model/vnd.opengex":["ogex"],"model/vnd.parasolid.transmit.binary":["x_b"],"model/vnd.parasolid.transmit.text":["x_t"],"model/vnd.sap.vds":["vds"],"model/vnd.usdz+zip":["usdz"],"model/vnd.valve.source.compiled-map":["bsp"],"model/vnd.vtu":["vtu"],"text/prs.lines.tag":["dsc"],"text/vnd.curl":["curl"],"text/vnd.curl.dcurl":["dcurl"],"text/vnd.curl.mcurl":["mcurl"],"text/vnd.curl.scurl":["scurl"],"text/vnd.dvb.subtitle":["sub"],"text/vnd.fly":["fly"],"text/vnd.fmi.flexstor":["flx"],"text/vnd.graphviz":["gv"],"text/vnd.in3d.3dml":["3dml"],"text/vnd.in3d.spot":["spot"],"text/vnd.sun.j2me.app-descriptor":["jad"],"text/vnd.wap.wml":["wml"],"text/vnd.wap.wmlscript":["wmls"],"text/x-asm":["s","asm"],"text/x-c":["c","cc","cxx","cpp","h","hh","dic"],"text/x-component":["htc"],"text/x-fortran":["f","for","f77","f90"],"text/x-handlebars-template":["hbs"],"text/x-java-source":["java"],"text/x-lua":["lua"],"text/x-markdown":["mkd"],"text/x-nfo":["nfo"],"text/x-opml":["opml"],"text/x-org":["*org"],"text/x-pascal":["p","pas"],"text/x-processing":["pde"],"text/x-sass":["sass"],"text/x-scss":["scss"],"text/x-setext":["etx"],"text/x-sfv":["sfv"],"text/x-suse-ymp":["ymp"],"text/x-uuencode":["uu"],"text/x-vcalendar":["vcs"],"text/x-vcard":["vcf"],"video/vnd.dece.hd":["uvh","uvvh"],"video/vnd.dece.mobile":["uvm","uvvm"],"video/vnd.dece.pd":["uvp","uvvp"],"video/vnd.dece.sd":["uvs","uvvs"],"video/vnd.dece.video":["uvv","uvvv"],"video/vnd.dvb.file":["dvb"],"video/vnd.fvt":["fvt"],"video/vnd.mpegurl":["mxu","m4u"],"video/vnd.ms-playready.media.pyv":["pyv"],"video/vnd.uvvu.mp4":["uvu","uvvu"],"video/vnd.vivo":["viv"],"video/x-f4v":["f4v"],"video/x-fli":["fli"],"video/x-flv":["flv"],"video/x-m4v":["m4v"],"video/x-matroska":["mkv","mk3d","mks"],"video/x-mng":["mng"],"video/x-ms-asf":["asf","asx"],"video/x-ms-vob":["vob"],"video/x-ms-wm":["wm"],"video/x-ms-wmv":["wmv"],"video/x-ms-wmx":["wmx"],"video/x-ms-wvx":["wvx"],"video/x-msvideo":["avi"],"video/x-sgi-movie":["movie"],"video/x-smv":["smv"],"x-conference/x-cooltalk":["ice"]}},4415:e=>{e.exports={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}},424:e=>{"use strict";class Tokenizer{constructor(e){this.str=(e||"").toString(),this.operatorCurrent="",this.operatorExpecting="",this.node=null,this.escaped=!1,this.list=[],this.operators={'"':'"',"(":")","<":">",",":"",":":";",";":""}}tokenize(){let e,t=[];for(let t=0,i=this.str.length;t<i;t++)e=this.str.charAt(t),this.checkChar(e);return this.list.forEach((e=>{e.value=(e.value||"").toString().trim(),e.value&&t.push(e)})),t}checkChar(e){if(this.escaped);else{if(e===this.operatorExpecting)return this.node={type:"operator",value:e},this.list.push(this.node),this.node=null,this.operatorExpecting="",void(this.escaped=!1);if(!this.operatorExpecting&&e in this.operators)return this.node={type:"operator",value:e},this.list.push(this.node),this.node=null,this.operatorExpecting=this.operators[e],void(this.escaped=!1);if(['"',"'"].includes(this.operatorExpecting)&&"\\"===e)return void(this.escaped=!0)}this.node||(this.node={type:"text",value:""},this.list.push(this.node)),"\n"===e&&(e=" "),(e.charCodeAt(0)>=33||[" ","\t"].includes(e))&&(this.node.value+=e),this.escaped=!1}}function addressparser(e,t){t=t||{};let i=new Tokenizer(e).tokenize(),s=[],n=[],a=[];if(i.forEach((e=>{"operator"!==e.type||","!==e.value&&";"!==e.value?n.push(e):(n.length&&s.push(n),n=[])})),n.length&&s.push(n),s.forEach((e=>{e=function _handleAddress(e){let t,i,s,n,a=!1,r="text",o=[],c={address:[],comment:[],group:[],text:[]};for(s=0,n=e.length;s<n;s++)if(t=e[s],"operator"===t.type)switch(t.value){case"<":r="address";break;case"(":r="comment";break;case":":r="group",a=!0;break;default:r="text"}else t.value&&("address"===r&&(t.value=t.value.replace(/^[^<]*<\s*/,"")),c[r].push(t.value));if(!c.text.length&&c.comment.length&&(c.text=c.comment,c.comment=[]),a)c.text=c.text.join(" "),o.push({name:c.text||i&&i.name,group:c.group.length?addressparser(c.group.join(",")):[]});else{if(!c.address.length&&c.text.length){for(s=c.text.length-1;s>=0;s--)if(c.text[s].match(/^[^@\s]+@[^@\s]+$/)){c.address=c.text.splice(s,1);break}let _regexHandler=function(e){return c.address.length?e:(c.address=[e.trim()]," ")};if(!c.address.length)for(s=c.text.length-1;s>=0&&(c.text[s]=c.text[s].replace(/\s*\b[^@\s]+@[^\s]+\b\s*/,_regexHandler).trim(),!c.address.length);s--);}if(!c.text.length&&c.comment.length&&(c.text=c.comment,c.comment=[]),c.address.length>1&&(c.text=c.text.concat(c.address.splice(1))),c.text=c.text.join(" "),c.address=c.address.join(" "),!c.address&&a)return[];i={address:c.address||c.text||"",name:c.text||c.address||""},i.address===i.name&&((i.address||"").match(/@/)?i.name="":i.address=""),o.push(i)}return o}(e),e.length&&(a=a.concat(e))})),t.flatten){let e=[],walkAddressList=t=>{t.forEach((t=>{if(t.group)return walkAddressList(t.group);e.push(t)}))};return walkAddressList(a),e}return a}e.exports=addressparser},5108:(e,t,i)=>{"use strict";const s=i(2781).Transform;function encode(e){return"string"==typeof e&&(e=Buffer.from(e,"utf-8")),e.toString("base64")}function wrap(e,t){if(t=t||76,(e=(e||"").toString()).length<=t)return e;let i=[],s=0,n=1024*t;for(;s<e.length;){let a=e.substr(s,n).replace(new RegExp(".{"+t+"}","g"),"$&\r\n").trim();i.push(a),s+=n}return i.join("\r\n").trim()}e.exports={encode,wrap,Encoder:class Encoder extends s{constructor(e){super(),this.options=e||{},!1!==this.options.lineLength&&(this.options.lineLength=this.options.lineLength||76),this._curLine="",this._remainingBytes=!1,this.inputBytes=0,this.outputBytes=0}_transform(e,t,i){if("buffer"!==t&&(e=Buffer.from(e,t)),!e||!e.length)return setImmediate(i);this.inputBytes+=e.length,this._remainingBytes&&this._remainingBytes.length&&(e=Buffer.concat([this._remainingBytes,e],this._remainingBytes.length+e.length),this._remainingBytes=!1),e.length%3?(this._remainingBytes=e.slice(e.length-e.length%3),e=e.slice(0,e.length-e.length%3)):this._remainingBytes=!1;let s=this._curLine+encode(e);if(this.options.lineLength){s=wrap(s,this.options.lineLength);let e=s.lastIndexOf("\n");e<0?(this._curLine=s,s=""):e===s.length-1?this._curLine="":(this._curLine=s.substr(e+1),s=s.substr(0,e+1))}s&&(this.outputBytes+=s.length,this.push(Buffer.from(s,"ascii"))),setImmediate(i)}_flush(e){this._remainingBytes&&this._remainingBytes.length&&(this._curLine+=encode(this._remainingBytes)),this._curLine&&(this._curLine=wrap(this._curLine,this.options.lineLength),this.outputBytes+=this._curLine.length,this.push(this._curLine,"ascii"),this._curLine=""),e()}}}},1211:(e,t,i)=>{"use strict";const s=i(1121),n=i(7364),a=i(5235),r=i(2781).PassThrough,o=i(7147),c=i(1017),l=i(6113);class DKIMSigner{constructor(e,t,i,s){this.options=e||{},this.keys=t,this.cacheTreshold=Number(this.options.cacheTreshold)||131072,this.hashAlgo=this.options.hashAlgo||"sha256",this.cacheDir=this.options.cacheDir||!1,this.chunks=[],this.chunklen=0,this.readPos=0,this.cachePath=!!this.cacheDir&&c.join(this.cacheDir,"message."+Date.now()+"-"+l.randomBytes(14).toString("hex")),this.cache=!1,this.headers=!1,this.bodyHash=!1,this.parser=!1,this.relaxedBody=!1,this.input=i,this.output=s,this.output.usingCache=!1,this.hasErrored=!1,this.input.on("error",(e=>{this.hasErrored=!0,this.cleanup(),s.emit("error",e)}))}cleanup(){this.cache&&this.cachePath&&o.unlink(this.cachePath,(()=>!1))}createReadCache(){this.cache=o.createReadStream(this.cachePath),this.cache.once("error",(e=>{this.cleanup(),this.output.emit("error",e)})),this.cache.once("close",(()=>{this.cleanup()})),this.cache.pipe(this.output)}sendNextChunk(){if(this.hasErrored)return;if(this.readPos>=this.chunks.length)return this.cache?this.createReadCache():this.output.end();let e=this.chunks[this.readPos++];if(!1===this.output.write(e))return this.output.once("drain",(()=>{this.sendNextChunk()}));setImmediate((()=>this.sendNextChunk()))}sendSignedOutput(){let e=0,signNextKey=()=>{if(e>=this.keys.length)return this.output.write(this.parser.rawHeaders),setImmediate((()=>this.sendNextChunk()));let t=this.keys[e++],i=a(this.headers,this.hashAlgo,this.bodyHash,{domainName:t.domainName,keySelector:t.keySelector,privateKey:t.privateKey,headerFieldNames:this.options.headerFieldNames,skipFields:this.options.skipFields});return i&&this.output.write(Buffer.from(i+"\r\n")),setImmediate(signNextKey)};if(this.bodyHash&&this.headers)return signNextKey();this.output.write(this.parser.rawHeaders),this.sendNextChunk()}createWriteCache(){this.output.usingCache=!0,this.cache=o.createWriteStream(this.cachePath),this.cache.once("error",(e=>{this.cleanup(),this.relaxedBody.unpipe(this.cache),this.relaxedBody.on("readable",(()=>{for(;null!==this.relaxedBody.read(););})),this.hasErrored=!0,this.output.emit("error",e)})),this.cache.once("close",(()=>{this.sendSignedOutput()})),this.relaxedBody.removeAllListeners("readable"),this.relaxedBody.pipe(this.cache)}signStream(){this.parser=new s,this.relaxedBody=new n({hashAlgo:this.hashAlgo}),this.parser.on("headers",(e=>{this.headers=e})),this.relaxedBody.on("hash",(e=>{this.bodyHash=e})),this.relaxedBody.on("readable",(()=>{let e;if(!this.cache)for(;null!==(e=this.relaxedBody.read());)if(this.chunks.push(e),this.chunklen+=e.length,this.chunklen>=this.cacheTreshold&&this.cachePath)return this.createWriteCache()})),this.relaxedBody.on("end",(()=>{this.cache||this.sendSignedOutput()})),this.parser.pipe(this.relaxedBody),setImmediate((()=>this.input.pipe(this.parser)))}}e.exports=class DKIM{constructor(e){this.options=e||{},this.keys=[].concat(this.options.keys||{domainName:e.domainName,keySelector:e.keySelector,privateKey:e.privateKey})}sign(e,t){let i=new r,s=e,n=!1;Buffer.isBuffer(e)?(n=e,s=new r):"string"==typeof e&&(n=Buffer.from(e),s=new r);let a=this.options;t&&Object.keys(t).length&&(a={},Object.keys(this.options||{}).forEach((e=>{a[e]=this.options[e]})),Object.keys(t||{}).forEach((e=>{e in a||(a[e]=t[e])})));let o=new DKIMSigner(a,this.keys,s,i);return setImmediate((()=>{o.signStream(),n&&setImmediate((()=>{s.end(n)}))})),i}}},1121:(e,t,i)=>{"use strict";const s=i(2781).Transform;e.exports=class MessageParser extends s{constructor(e){super(e),this.lastBytes=Buffer.alloc(4),this.headersParsed=!1,this.headerBytes=0,this.headerChunks=[],this.rawHeaders=!1,this.bodySize=0}updateLastBytes(e){let t=this.lastBytes.length,i=Math.min(e.length,t);for(let e=0,s=t-i;e<s;e++)this.lastBytes[e]=this.lastBytes[e+i];for(let s=1;s<=i;s++)this.lastBytes[t-s]=e[e.length-s]}checkHeaders(e){if(this.headersParsed)return!0;let t=this.lastBytes.length,i=0;this.curLinePos=0;for(let s=0,n=this.lastBytes.length+e.length;s<n;s++){let n;if(n=s<t?this.lastBytes[s]:e[s-t],10===n&&s){let n=s-1<t?this.lastBytes[s-1]:e[s-1-t],a=s>1&&(s-2<t?this.lastBytes[s-2]:e[s-2-t]);if(10===n){this.headersParsed=!0,i=s-t+1,this.headerBytes+=i;break}if(13===n&&10===a){this.headersParsed=!0,i=s-t+1,this.headerBytes+=i;break}}}if(this.headersParsed){if(this.headerChunks.push(e.slice(0,i)),this.rawHeaders=Buffer.concat(this.headerChunks,this.headerBytes),this.headerChunks=null,this.emit("headers",this.parseHeaders()),e.length-1>i){let t=e.slice(i);this.bodySize+=t.length,setImmediate((()=>this.push(t)))}return!1}return this.headerBytes+=e.length,this.headerChunks.push(e),this.updateLastBytes(e),!1}_transform(e,t,i){if(!e||!e.length)return i();let s;"string"==typeof e&&(e=Buffer.from(e,t));try{s=this.checkHeaders(e)}catch(e){return i(e)}s&&(this.bodySize+=e.length,this.push(e)),setImmediate(i)}_flush(e){if(this.headerChunks){let e=Buffer.concat(this.headerChunks,this.headerBytes);this.bodySize+=e.length,this.push(e),this.headerChunks=null}e()}parseHeaders(){let e=(this.rawHeaders||"").toString().split(/\r?\n/);for(let t=e.length-1;t>0;t--)/^\s/.test(e[t])&&(e[t-1]+="\n"+e[t],e.splice(t,1));return e.filter((e=>e.trim())).map((e=>({key:e.substr(0,e.indexOf(":")).trim().toLowerCase(),line:e})))}}},7364:(e,t,i)=>{"use strict";const s=i(2781).Transform,n=i(6113);e.exports=class RelaxedBody extends s{constructor(e){super(),e=e||{},this.chunkBuffer=[],this.chunkBufferLen=0,this.bodyHash=n.createHash(e.hashAlgo||"sha1"),this.remainder="",this.byteLength=0,this.debug=e.debug,this._debugBody=!!e.debug&&[]}updateHash(e){let t,i="",s="file";for(let t=e.length-1;t>=0;t--){let n=e[t];if("file"!==s||10!==n&&13!==n)if("file"!==s||9!==n&&32!==n)if("line"!==s||9!==n&&32!==n){if(("file"===s||"line"===s)&&(s="body",t===e.length-1))break}else;else s="line";else;if(0===t){if("file"===s&&(!this.remainder||/[\r\n]$/.test(this.remainder))||"line"===s&&(!this.remainder||/[ \t]$/.test(this.remainder)))return void(this.remainder+=e.toString("binary"));if("line"===s||"file"===s){i=e.toString("binary"),e=!1;break}}if("body"===s){i=e.slice(t+1).toString("binary"),e=e.slice(0,t+1);break}}let n=!!this.remainder;if(e&&!n)for(let t=0,i=e.length;t<i;t++){if(t&&10===e[t]&&13!==e[t-1]){n=!0;break}if(t&&13===e[t]&&32===e[t-1]){n=!0;break}if(t&&32===e[t]&&32===e[t-1]){n=!0;break}if(9===e[t]){n=!0;break}}n?(t=this.remainder+(e?e.toString("binary"):""),this.remainder=i,t=t.replace(/\r?\n/g,"\n").replace(/[ \t]*$/gm,"").replace(/[ \t]+/gm," ").replace(/\n/g,"\r\n"),e=Buffer.from(t,"binary")):i&&(this.remainder=i),this.debug&&this._debugBody.push(e),this.bodyHash.update(e)}_transform(e,t,i){if(!e||!e.length)return i();"string"==typeof e&&(e=Buffer.from(e,t)),this.updateHash(e),this.byteLength+=e.length,this.push(e),i()}_flush(e){/[\r\n]$/.test(this.remainder)&&this.byteLength>2&&this.bodyHash.update(Buffer.from("\r\n")),this.byteLength||this.push(Buffer.from("\r\n")),this.emit("hash",this.bodyHash.digest("base64"),!!this.debug&&Buffer.concat(this._debugBody)),e()}}},5235:(e,t,i)=>{"use strict";const s=i(5477),n=i(2641),a=i(6113);function relaxedHeaders(e,t,i){let s=new Set,n=new Set,a=new Map;(i||"").toLowerCase().split(":").forEach((e=>{n.add(e.trim())})),(t||"").toLowerCase().split(":").filter((e=>!n.has(e.trim()))).forEach((e=>{s.add(e.trim())}));for(let t=e.length-1;t>=0;t--){let i=e[t];s.has(i.key)&&!a.has(i.key)&&a.set(i.key,relaxedHeaderLine(i.line))}let r=[],o=[];return s.forEach((e=>{a.has(e)&&(o.push(e),r.push(e+":"+a.get(e)))})),{headers:r.join("\r\n")+"\r\n",fieldNames:o.join(":")}}function relaxedHeaderLine(e){return e.substr(e.indexOf(":")+1).replace(/\r?\n/g,"").replace(/\s+/g," ").trim()}e.exports=(e,t,i,r)=>{let o,c,l=relaxedHeaders(e,(r=r||{}).headerFieldNames||"From:Sender:Reply-To:Subject:Date:Message-ID:To:Cc:MIME-Version:Content-Type:Content-Transfer-Encoding:Content-ID:Content-Description:Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:In-Reply-To:References:List-Id:List-Help:List-Unsubscribe:List-Subscribe:List-Post:List-Owner:List-Archive",r.skipFields),p=function generateDKIMHeader(e,t,i,a,r){let o=["v=1","a=rsa-"+a,"c=relaxed/relaxed","d="+s.toASCII(e),"q=dns/txt","s="+t,"bh="+r,"h="+i].join("; ");return n.foldLines("DKIM-Signature: "+o,76)+";\r\n b="}(r.domainName,r.keySelector,l.fieldNames,t,i);l.headers+="dkim-signature:"+relaxedHeaderLine(p),o=a.createSign(("rsa-"+t).toUpperCase()),o.update(l.headers);try{c=o.sign(r.privateKey,"base64")}catch(e){return!1}return p+c.replace(/(^.{73}|.{75}(?!\r?\n|\r))/g,"$&\r\n ").trim()},e.exports.relaxedHeaders=relaxedHeaders},6408:(e,t,i)=>{"use strict";const s=i(7310);e.exports=class Cookies{constructor(e){this.options=e||{},this.cookies=[]}set(e,t){let i,n=s.parse(t||""),a=this.parse(e);return a.domain?(i=a.domain.replace(/^\./,""),(n.hostname.length<i.length||("."+n.hostname).substr(1-i.length)!=="."+i)&&(a.domain=n.hostname)):a.domain=n.hostname,a.path||(a.path=this.getPath(n.pathname)),a.expires||(a.expires=new Date(Date.now()+1e3*(Number(this.options.sessionTimeout||1800)||1800))),this.add(a)}get(e){return this.list(e).map((e=>e.name+"="+e.value)).join("; ")}list(e){let t,i,s=[];for(t=this.cookies.length-1;t>=0;t--)i=this.cookies[t],this.isExpired(i)?this.cookies.splice(t,t):this.match(i,e)&&s.unshift(i);return s}parse(e){let t={};return(e||"").toString().split(";").forEach((e=>{let i,s=e.split("="),n=s.shift().trim().toLowerCase(),a=s.join("=").trim();if(n)switch(n){case"expires":a=new Date(a),"Invalid Date"!==a.toString()&&(t.expires=a);break;case"path":t.path=a;break;case"domain":i=a.toLowerCase(),i.length&&"."!==i.charAt(0)&&(i="."+i),t.domain=i;break;case"max-age":t.expires=new Date(Date.now()+1e3*(Number(a)||0));break;case"secure":t.secure=!0;break;case"httponly":t.httponly=!0;break;default:t.name||(t.name=n,t.value=a)}})),t}match(e,t){let i=s.parse(t||"");return(i.hostname===e.domain||"."===e.domain.charAt(0)&&("."+i.hostname).substr(-e.domain.length)===e.domain)&&(this.getPath(i.pathname).substr(0,e.path.length)===e.path&&(!e.secure||"https:"===i.protocol))}add(e){let t,i;if(!e||!e.name)return!1;for(t=0,i=this.cookies.length;t<i;t++)if(this.compare(this.cookies[t],e))return this.isExpired(e)?(this.cookies.splice(t,1),!1):(this.cookies[t]=e,!0);return this.isExpired(e)||this.cookies.push(e),!0}compare(e,t){return e.name===t.name&&e.path===t.path&&e.domain===t.domain&&e.secure===t.secure&&e.httponly==e.httponly}isExpired(e){return e.expires&&e.expires<new Date||!e.value}getPath(e){let t=(e||"/").split("/");return t.pop(),t=t.join("/").trim(),"/"!==t.charAt(0)&&(t="/"+t),"/"!==t.substr(-1)&&(t+="/"),t}}},338:(e,t,i)=>{"use strict";const s=i(3685),n=i(5687),a=i(7310),r=i(9796),o=i(2781).PassThrough,c=i(6408),l=i(4129);function nmfetch(e,t){(t=t||{}).fetchRes=t.fetchRes||new o,t.cookies=t.cookies||new c,t.redirects=t.redirects||0,t.maxRedirects=isNaN(t.maxRedirects)?5:t.maxRedirects,t.cookie&&([].concat(t.cookie||[]).forEach((i=>{t.cookies.set(i,e)})),t.cookie=!1);let i,p,d,h=t.fetchRes,u=a.parse(e),g=(t.method||"").toString().trim().toUpperCase()||"GET",v=!1,y="https:"===u.protocol?n:s,x={"accept-encoding":"gzip,deflate","user-agent":"nodemailer/"+l.version};if(Object.keys(t.headers||{}).forEach((e=>{x[e.toLowerCase().trim()]=t.headers[e]})),t.userAgent&&(x["user-agent"]=t.userAgent),u.auth&&(x.Authorization="Basic "+Buffer.from(u.auth).toString("base64")),(i=t.cookies.get(e))&&(x.cookie=i),t.body){if(!1!==t.contentType&&(x["Content-Type"]=t.contentType||"application/x-www-form-urlencoded"),"function"==typeof t.body.pipe)x["Transfer-Encoding"]="chunked",p=t.body,p.on("error",(t=>{v||(v=!0,t.type="FETCH",t.sourceUrl=e,h.emit("error",t))}));else{if(t.body instanceof Buffer)p=t.body;else if("object"==typeof t.body)try{p=Buffer.from(Object.keys(t.body).map((e=>{let i=t.body[e].toString().trim();return encodeURIComponent(e)+"="+encodeURIComponent(i)})).join("&"))}catch(t){if(v)return;return v=!0,t.type="FETCH",t.sourceUrl=e,void h.emit("error",t)}else p=Buffer.from(t.body.toString().trim());x["Content-Type"]=t.contentType||"application/x-www-form-urlencoded",x["Content-Length"]=p.length}g=(t.method||"").toString().trim().toUpperCase()||"POST"}let _={method:g,host:u.hostname,path:u.path,port:u.port?u.port:"https:"===u.protocol?443:80,headers:x,rejectUnauthorized:!1,agent:!1};t.tls&&Object.keys(t.tls).forEach((e=>{_[e]=t.tls[e]}));try{d=y.request(_)}catch(t){return v=!0,setImmediate((()=>{t.type="FETCH",t.sourceUrl=e,h.emit("error",t)})),h}return t.timeout&&d.setTimeout(t.timeout,(()=>{if(v)return;v=!0,d.abort();let t=new Error("Request Timeout");t.type="FETCH",t.sourceUrl=e,h.emit("error",t)})),d.on("error",(t=>{v||(v=!0,t.type="FETCH",t.sourceUrl=e,h.emit("error",t))})),d.on("response",(i=>{let s;if(!v){switch(i.headers["content-encoding"]){case"gzip":case"deflate":s=r.createUnzip()}if(i.headers["set-cookie"]&&[].concat(i.headers["set-cookie"]||[]).forEach((i=>{t.cookies.set(i,e)})),[301,302,303,307,308].includes(i.statusCode)&&i.headers.location){if(t.redirects++,t.redirects>t.maxRedirects){v=!0;let t=new Error("Maximum redirect count exceeded");return t.type="FETCH",t.sourceUrl=e,h.emit("error",t),void d.abort()}return t.method="GET",t.body=!1,nmfetch(a.resolve(e,i.headers.location),t)}if(h.statusCode=i.statusCode,h.headers=i.headers,i.statusCode>=300&&!t.allowErrorResponse){v=!0;let t=new Error("Invalid status code "+i.statusCode);return t.type="FETCH",t.sourceUrl=e,h.emit("error",t),void d.abort()}i.on("error",(t=>{v||(v=!0,t.type="FETCH",t.sourceUrl=e,h.emit("error",t),d.abort())})),s?(i.pipe(s).pipe(h),s.on("error",(t=>{v||(v=!0,t.type="FETCH",t.sourceUrl=e,h.emit("error",t),d.abort())}))):i.pipe(h)}})),setImmediate((()=>{if(p)try{if("function"==typeof p.pipe)return p.pipe(d);d.write(p)}catch(t){return v=!0,t.type="FETCH",t.sourceUrl=e,void h.emit("error",t)}d.end()})),h}e.exports=function(e,t){return nmfetch(e,t)},e.exports.Cookies=c},8937:(e,t,i)=>{"use strict";const s=i(4129),n=i(4938);e.exports=class JSONTransport{constructor(e){e=e||{},this.options=e||{},this.name="JSONTransport",this.version=s.version,this.logger=n.getLogger(this.options,{component:this.options.component||"json-transport"})}send(e,t){e.message.keepBcc=!0;let i=e.data.envelope||e.message.getEnvelope(),s=e.message.messageId(),n=[].concat(i.to||[]);n.length>3&&n.push("...and "+n.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:s},"Composing JSON structure of %s to <%s>",s,n.join(", ")),setImmediate((()=>{e.normalize(((e,n)=>e?(this.logger.error({err:e,tnx:"send",messageId:s},"Failed building JSON structure for %s. %s",s,e.message),t(e)):(delete n.envelope,delete n.normalizedHeaders,t(null,{envelope:i,messageId:s,message:this.options.skipEncoding?n:JSON.stringify(n)}))))}))}}},4786:(e,t,i)=>{"use strict";const s=i(7326),n=i(2641);e.exports=class MailComposer{constructor(e){this.mail=e||{},this.message=!1}compile(){return this._alternatives=this.getAlternatives(),this._htmlNode=this._alternatives.filter((e=>/^text\/html\b/i.test(e.contentType))).pop(),this._attachments=this.getAttachments(!!this._htmlNode),this._useRelated=!(!this._htmlNode||!this._attachments.related.length),this._useAlternative=this._alternatives.length>1,this._useMixed=this._attachments.attached.length>1||this._alternatives.length&&1===this._attachments.attached.length,this.mail.raw?this.message=new s("message/rfc822",{newline:this.mail.newline}).setRaw(this.mail.raw):this._useMixed?this.message=this._createMixed():this._useAlternative?this.message=this._createAlternative():this._useRelated?this.message=this._createRelated():this.message=this._createContentNode(!1,[].concat(this._alternatives||[]).concat(this._attachments.attached||[]).shift()||{contentType:"text/plain",content:""}),this.mail.headers&&this.message.addHeader(this.mail.headers),["from","sender","to","cc","bcc","reply-to","in-reply-to","references","subject","message-id","date"].forEach((e=>{let t=e.replace(/-(\w)/g,((e,t)=>t.toUpperCase()));this.mail[t]&&this.message.setHeader(e,this.mail[t])})),this.mail.envelope&&this.message.setEnvelope(this.mail.envelope),this.message.messageId(),this.message}getAttachments(e){let t,i,s=[].concat(this.mail.attachments||[]).map(((e,t)=>{let i,s=/^message\//i.test(e.contentType);return/^data:/i.test(e.path||e.href)&&(e=this._processDataUrl(e)),i={contentType:e.contentType||n.detectMimeType(e.filename||e.path||e.href||"bin"),contentDisposition:e.contentDisposition||(s?"inline":"attachment"),contentTransferEncoding:"contentTransferEncoding"in e?e.contentTransferEncoding:"base64"},e.filename?i.filename=e.filename:s||!1===e.filename||(i.filename=(e.path||e.href||"").split("/").pop().split("?").shift()||"attachment-"+(t+1),i.filename.indexOf(".")<0&&(i.filename+="."+n.detectExtension(i.contentType))),/^https?:\/\//i.test(e.path)&&(e.href=e.path,e.path=void 0),e.cid&&(i.cid=e.cid),e.raw?i.raw=e.raw:e.path?i.content={path:e.path}:e.href?i.content={href:e.href,httpHeaders:e.httpHeaders}:i.content=e.content||"",e.encoding&&(i.encoding=e.encoding),e.headers&&(i.headers=e.headers),i}));return this.mail.icalEvent&&(t="object"==typeof this.mail.icalEvent&&(this.mail.icalEvent.content||this.mail.icalEvent.path||this.mail.icalEvent.href||this.mail.icalEvent.raw)?this.mail.icalEvent:{content:this.mail.icalEvent},i={},Object.keys(t).forEach((e=>{i[e]=t[e]})),i.contentType="application/ics",i.headers||(i.headers={}),i.filename=i.filename||"invite.ics",i.headers["Content-Disposition"]="attachment",i.headers["Content-Transfer-Encoding"]="base64"),e?{attached:s.filter((e=>!e.cid)).concat(i||[]),related:s.filter((e=>!!e.cid))}:{attached:s.concat(i||[]),related:[]}}getAlternatives(){let e,t,i,s,a,r,o=[];return this.mail.text&&(e="object"==typeof this.mail.text&&(this.mail.text.content||this.mail.text.path||this.mail.text.href||this.mail.text.raw)?this.mail.text:{content:this.mail.text},e.contentType="text/plain; charset=utf-8"),this.mail.watchHtml&&(i="object"==typeof this.mail.watchHtml&&(this.mail.watchHtml.content||this.mail.watchHtml.path||this.mail.watchHtml.href||this.mail.watchHtml.raw)?this.mail.watchHtml:{content:this.mail.watchHtml},i.contentType="text/watch-html; charset=utf-8"),this.mail.amp&&(s="object"==typeof this.mail.amp&&(this.mail.amp.content||this.mail.amp.path||this.mail.amp.href||this.mail.amp.raw)?this.mail.amp:{content:this.mail.amp},s.contentType="text/x-amp-html; charset=utf-8"),this.mail.icalEvent&&(a="object"==typeof this.mail.icalEvent&&(this.mail.icalEvent.content||this.mail.icalEvent.path||this.mail.icalEvent.href||this.mail.icalEvent.raw)?this.mail.icalEvent:{content:this.mail.icalEvent},r={},Object.keys(a).forEach((e=>{r[e]=a[e]})),r.content&&"object"==typeof r.content&&(r.content._resolve=!0),r.filename=!1,r.contentType="text/calendar; charset=utf-8; method="+(r.method||"PUBLISH").toString().trim().toUpperCase(),r.headers||(r.headers={})),this.mail.html&&(t="object"==typeof this.mail.html&&(this.mail.html.content||this.mail.html.path||this.mail.html.href||this.mail.html.raw)?this.mail.html:{content:this.mail.html},t.contentType="text/html; charset=utf-8"),[].concat(e||[]).concat(i||[]).concat(s||[]).concat(t||[]).concat(r||[]).concat(this.mail.alternatives||[]).forEach((e=>{let t;/^data:/i.test(e.path||e.href)&&(e=this._processDataUrl(e)),t={contentType:e.contentType||n.detectMimeType(e.filename||e.path||e.href||"txt"),contentTransferEncoding:e.contentTransferEncoding},e.filename&&(t.filename=e.filename),/^https?:\/\//i.test(e.path)&&(e.href=e.path,e.path=void 0),e.raw?t.raw=e.raw:e.path?t.content={path:e.path}:e.href?t.content={href:e.href}:t.content=e.content||"",e.encoding&&(t.encoding=e.encoding),e.headers&&(t.headers=e.headers),o.push(t)})),o}_createMixed(e){let t;return t=e?e.createChild("multipart/mixed",{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):new s("multipart/mixed",{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),this._useAlternative?this._createAlternative(t):this._useRelated&&this._createRelated(t),[].concat(!this._useAlternative&&this._alternatives||[]).concat(this._attachments.attached||[]).forEach((e=>{this._useRelated&&e===this._htmlNode||this._createContentNode(t,e)})),t}_createAlternative(e){let t;return t=e?e.createChild("multipart/alternative",{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):new s("multipart/alternative",{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),this._alternatives.forEach((e=>{this._useRelated&&this._htmlNode===e?this._createRelated(t):this._createContentNode(t,e)})),t}_createRelated(e){let t;return t=e?e.createChild('multipart/related; type="text/html"',{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):new s('multipart/related; type="text/html"',{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),this._createContentNode(t,this._htmlNode),this._attachments.related.forEach((e=>this._createContentNode(t,e))),t}_createContentNode(e,t){let i;(t=t||{}).content=t.content||"";let n=(t.encoding||"utf8").toString().toLowerCase().replace(/[-_\s]/g,"");return i=e?e.createChild(t.contentType,{filename:t.filename,textEncoding:this.mail.textEncoding,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):new s(t.contentType,{filename:t.filename,baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),t.headers&&i.addHeader(t.headers),t.cid&&i.setHeader("Content-Id","<"+t.cid.replace(/[<>]/g,"")+">"),t.contentTransferEncoding?i.setHeader("Content-Transfer-Encoding",t.contentTransferEncoding):this.mail.encoding&&/^text\//i.test(t.contentType)&&i.setHeader("Content-Transfer-Encoding",this.mail.encoding),/^text\//i.test(t.contentType)&&!t.contentDisposition||i.setHeader("Content-Disposition",t.contentDisposition||(t.cid?"inline":"attachment")),"string"!=typeof t.content||["utf8","usascii","ascii"].includes(n)||(t.content=Buffer.from(t.content,n)),t.raw?i.setRaw(t.raw):i.setContent(t.content),i}_processDataUrl(e){let t=(e.path||e.href).match(/^data:((?:[^;]*;)*(?:[^,]*)),(.*)$/i);return t?(e.content=/\bbase64$/i.test(t[1])?Buffer.from(t[2],"base64"):Buffer.from(decodeURIComponent(t[2])),"path"in e&&(e.path=!1),"href"in e&&(e.href=!1),t[1].split(";").forEach((t=>{/^\w+\/[^/]+$/i.test(t)&&(e.contentType=e.contentType||t.toLowerCase())})),e):e}}},4051:(e,t,i)=>{"use strict";const s=i(2361),n=i(4938),a=i(8497),r=i(4786),o=i(1211),c=i(6438),l=i(3837),p=i(7310),d=i(4129),h=i(8938),u=i(1808),g=i(9523),v=i(6113);e.exports=class Mail extends s{constructor(e,t,i){super(),this.options=t||{},this._defaults=i||{},this._defaultPlugins={compile:[(...e)=>this._convertDataImages(...e)],stream:[]},this._userPlugins={compile:[],stream:[]},this.meta=new Map,this.dkim=!!this.options.dkim&&new o(this.options.dkim),this.transporter=e,this.transporter.mailer=this,this.logger=n.getLogger(this.options,{component:this.options.component||"mail"}),this.logger.debug({tnx:"create"},"Creating transport: %s",this.getVersionString()),"function"==typeof this.transporter.on&&(this.transporter.on("log",(e=>{this.logger.debug({tnx:"transport"},"%s: %s",e.type,e.message)})),this.transporter.on("error",(e=>{this.logger.error({err:e,tnx:"transport"},"Transport Error: %s",e.message),this.emit("error",e)})),this.transporter.on("idle",((...e)=>{this.emit("idle",...e)}))),["close","isIdle","verify"].forEach((e=>{this[e]=(...t)=>"function"==typeof this.transporter[e]?("verify"===e&&"function"==typeof this.getSocket&&(this.transporter.getSocket=this.getSocket,this.getSocket=!1),this.transporter[e](...t)):(this.logger.warn({tnx:"transport",methodName:e},"Non existing method %s called for transport",e),!1)})),this.options.proxy&&"string"==typeof this.options.proxy&&this.setupProxy(this.options.proxy)}use(e,t){return e=(e||"").toString(),this._userPlugins.hasOwnProperty(e)?this._userPlugins[e].push(t):this._userPlugins[e]=[t],this}sendMail(e,t){let i;t||(i=new Promise(((e,i)=>{t=n.callbackPromise(e,i)}))),"function"==typeof this.getSocket&&(this.transporter.getSocket=this.getSocket,this.getSocket=!1);let s=new h(this,e);return this.logger.debug({tnx:"transport",name:this.transporter.name,version:this.transporter.version,action:"send"},"Sending mail using %s/%s",this.transporter.name,this.transporter.version),this._processPlugins("compile",s,(e=>{if(e)return this.logger.error({err:e,tnx:"plugin",action:"compile"},"PluginCompile Error: %s",e.message),t(e);s.message=new r(s.data).compile(),s.setMailerHeader(),s.setPriorityHeaders(),s.setListHeaders(),this._processPlugins("stream",s,(e=>{if(e)return this.logger.error({err:e,tnx:"plugin",action:"stream"},"PluginStream Error: %s",e.message),t(e);(s.data.dkim||this.dkim)&&s.message.processFunc((e=>{let t=s.data.dkim?new o(s.data.dkim):this.dkim;return this.logger.debug({tnx:"DKIM",messageId:s.message.messageId(),dkimDomains:t.keys.map((e=>e.keySelector+"."+e.domainName)).join(", ")},"Signing outgoing message with %s keys",t.keys.length),t.sign(e,s.data._dkim)})),this.transporter.send(s,((...e)=>{e[0]&&this.logger.error({err:e[0],tnx:"transport",action:"send"},"Send Error: %s",e[0].message),t(...e)}))}))})),i}getVersionString(){return l.format("%s (%s; +%s; %s/%s)",d.name,d.version,d.homepage,this.transporter.name,this.transporter.version)}_processPlugins(e,t,i){if(e=(e||"").toString(),!this._userPlugins.hasOwnProperty(e))return i();let s=this._userPlugins[e]||[],n=this._defaultPlugins[e]||[];if(s.length&&this.logger.debug({tnx:"transaction",pluginCount:s.length,step:e},"Using %s plugins for %s",s.length,e),s.length+n.length===0)return i();let a=0,r="default",processPlugins=()=>{let e="default"===r?n:s;if(a>=e.length){if("default"!==r||!s.length)return i();r="user",a=0,e=s}(0,e[a++])(t,(e=>{if(e)return i(e);processPlugins()}))};processPlugins()}setupProxy(e){let t=p.parse(e);this.getSocket=(e,i)=>{let s=t.protocol.replace(/:$/,"").toLowerCase();if(this.meta.has("proxy_handler_"+s))return this.meta.get("proxy_handler_"+s)(t,e,i);switch(s){case"http":case"https":return void c(t.href,e.port,e.host,((e,t)=>e?i(e):i(null,{connection:t})));case"socks":case"socks5":case"socks4":case"socks4a":{if(!this.meta.has("proxy_socks_module"))return i(new Error("Socks module not loaded"));let connect=s=>{let n=!!this.meta.get("proxy_socks_module").SocksClient,a=n?this.meta.get("proxy_socks_module").SocksClient:this.meta.get("proxy_socks_module"),r=Number(t.protocol.replace(/\D/g,""))||5,o={proxy:{ipaddress:s,port:Number(t.port),type:r},[n?"destination":"target"]:{host:e.host,port:e.port},command:"connect"};if(t.auth){let e=decodeURIComponent(t.auth.split(":").shift()),i=decodeURIComponent(t.auth.split(":").pop());n?(o.proxy.userId=e,o.proxy.password=i):4===r?o.userid=e:o.authentication={username:e,password:i}}a.createConnection(o,((e,t)=>e?i(e):i(null,{connection:t.socket||t})))};return u.isIP(t.hostname)?connect(t.hostname):g.resolve(t.hostname,((e,t)=>{if(e)return i(e);connect(Array.isArray(t)?t[0]:t)}))}}i(new Error("Unknown proxy configuration"))}}_convertDataImages(e,t){if(!this.options.attachDataUrls&&!e.data.attachDataUrls||!e.data.html)return t();e.resolveContent(e.data,"html",((i,s)=>{if(i)return t(i);let n=0;s=(s||"").toString().replace(/(<img\b[^>]* src\s*=[\s"']*)(data:([^;]+);[^"'>\s]+)/gi,((t,i,s,r)=>{let o=v.randomBytes(10).toString("hex")+"@localhost";return e.data.attachments||(e.data.attachments=[]),Array.isArray(e.data.attachments)||(e.data.attachments=[].concat(e.data.attachments||[])),e.data.attachments.push({path:s,cid:o,filename:"image-"+ ++n+"."+a.detectExtension(r)}),i+"cid:"+o})),e.data.html=s,t()}))}set(e,t){return this.meta.set(e,t)}get(e){return this.meta.get(e)}}},8938:(e,t,i)=>{"use strict";const s=i(4938),n=i(7326),a=i(2641);e.exports=class MailMessage{constructor(e,t){this.mailer=e,this.data={},this.message=null,t=t||{};let i=e.options||{},s=e._defaults||{};Object.keys(t).forEach((e=>{this.data[e]=t[e]})),this.data.headers=this.data.headers||{},Object.keys(s).forEach((e=>{e in this.data?"headers"===e&&Object.keys(s.headers).forEach((e=>{e in this.data.headers||(this.data.headers[e]=s.headers[e])})):this.data[e]=s[e]})),["disableFileAccess","disableUrlAccess","normalizeHeaderKey"].forEach((e=>{e in i&&(this.data[e]=i[e])}))}resolveContent(...e){return s.resolveContent(...e)}resolveAll(e){let t=[[this.data,"html"],[this.data,"text"],[this.data,"watchHtml"],[this.data,"amp"],[this.data,"icalEvent"]];this.data.alternatives&&this.data.alternatives.length&&this.data.alternatives.forEach(((e,i)=>{t.push([this.data.alternatives,i])})),this.data.attachments&&this.data.attachments.length&&this.data.attachments.forEach(((e,i)=>{e.filename||(e.filename=(e.path||e.href||"").split("/").pop().split("?").shift()||"attachment-"+(i+1),e.filename.indexOf(".")<0&&(e.filename+="."+a.detectExtension(e.contentType))),e.contentType||(e.contentType=a.detectMimeType(e.filename||e.path||e.href||"bin")),t.push([this.data.attachments,i])}));let i=new n;["from","to","cc","bcc","sender","replyTo"].forEach((e=>{let t;this.message?t=[].concat(i._parseAddresses(this.message.getHeader("replyTo"===e?"reply-to":e))||[]):this.data[e]&&(t=[].concat(i._parseAddresses(this.data[e])||[])),t&&t.length?this.data[e]=t:e in this.data&&(this.data[e]=null)}));["from","sender"].forEach((e=>{this.data[e]&&(this.data[e]=this.data[e].shift())}));let r=0,resolveNext=()=>{if(r>=t.length)return e(null,this.data);let i=t[r++];if(!i[0]||!i[0][i[1]])return resolveNext();s.resolveContent(...i,((t,s)=>{if(t)return e(t);let n={content:s};i[0][i[1]]&&"object"==typeof i[0][i[1]]&&!Buffer.isBuffer(i[0][i[1]])&&Object.keys(i[0][i[1]]).forEach((e=>{e in n||["content","path","href","raw"].includes(e)||(n[e]=i[0][i[1]][e])})),i[0][i[1]]=n,resolveNext()}))};setImmediate((()=>resolveNext()))}normalize(e){let t=this.data.envelope||this.message.getEnvelope(),i=this.message.messageId();this.resolveAll(((s,n)=>{if(s)return e(s);if(n.envelope=t,n.messageId=i,["html","text","watchHtml","amp"].forEach((e=>{n[e]&&n[e].content&&("string"==typeof n[e].content?n[e]=n[e].content:Buffer.isBuffer(n[e].content)&&(n[e]=n[e].content.toString()))})),n.icalEvent&&Buffer.isBuffer(n.icalEvent.content)&&(n.icalEvent.content=n.icalEvent.content.toString("base64"),n.icalEvent.encoding="base64"),n.alternatives&&n.alternatives.length&&n.alternatives.forEach((e=>{e&&e.content&&Buffer.isBuffer(e.content)&&(e.content=e.content.toString("base64"),e.encoding="base64")})),n.attachments&&n.attachments.length&&n.attachments.forEach((e=>{e&&e.content&&Buffer.isBuffer(e.content)&&(e.content=e.content.toString("base64"),e.encoding="base64")})),n.normalizedHeaders={},Object.keys(n.headers||{}).forEach((e=>{let t=[].concat(n.headers[e]||[]).shift();t=t&&t.value||t,t&&(["references","in-reply-to","message-id","content-id"].includes(e)&&(t=this.message._encodeHeaderValue(e,t)),n.normalizedHeaders[e]=t)})),n.list&&"object"==typeof n.list){this._getListHeaders(n.list).forEach((e=>{n.normalizedHeaders[e.key]=e.value.map((e=>e&&e.value||e)).join(", ")}))}return n.references&&(n.normalizedHeaders.references=this.message._encodeHeaderValue("references",n.references)),n.inReplyTo&&(n.normalizedHeaders["in-reply-to"]=this.message._encodeHeaderValue("in-reply-to",n.inReplyTo)),e(null,n)}))}setMailerHeader(){this.message&&this.data.xMailer&&this.message.setHeader("X-Mailer",this.data.xMailer)}setPriorityHeaders(){if(this.message&&this.data.priority)switch((this.data.priority||"").toString().toLowerCase()){case"high":this.message.setHeader("X-Priority","1 (Highest)"),this.message.setHeader("X-MSMail-Priority","High"),this.message.setHeader("Importance","High");break;case"low":this.message.setHeader("X-Priority","5 (Lowest)"),this.message.setHeader("X-MSMail-Priority","Low"),this.message.setHeader("Importance","Low")}}setListHeaders(){this.message&&this.data.list&&"object"==typeof this.data.list&&this.data.list&&"object"==typeof this.data.list&&this._getListHeaders(this.data.list).forEach((e=>{e.value.forEach((t=>{this.message.addHeader(e.key,t)}))}))}_getListHeaders(e){return Object.keys(e).map((t=>({key:"list-"+t.toLowerCase().trim(),value:[].concat(e[t]||[]).map((e=>({prepared:!0,foldLines:!0,value:[].concat(e||[]).map((e=>{if("string"==typeof e&&(e={url:e}),e&&e.url){if("id"===t.toLowerCase().trim()){let t=e.comment||"";return t=a.isPlainText(t)?'"'+t+'"':a.encodeWord(t),(e.comment?t+" ":"")+this._formatListUrl(e.url).replace(/^<[^:]+\/{,2}/,"")}let i=e.comment||"";return a.isPlainText(i)||(i=a.encodeWord(i)),this._formatListUrl(e.url)+(e.comment?" ("+i+")":"")}return""})).filter((e=>e)).join(", ")})))})))}_formatListUrl(e){return e=e.replace(/[\s<]+|[\s>]+/g,""),/^(https?|mailto|ftp):/.test(e)?"<"+e+">":/^[^@]+@[^@]+$/.test(e)?"<mailto:"+e+">":"<http://"+e+">"}}},2641:(e,t,i)=>{"use strict";const s=i(5108),n=i(4507),a=i(8497);e.exports={isPlainText:(e,t)=>"string"==typeof e&&!(t?/[\x00-\x08\x0b\x0c\x0e-\x1f"\u0080-\uFFFF]/:/[\x00-\x08\x0b\x0c\x0e-\x1f\u0080-\uFFFF]/).test(e),hasLongerLines:(e,t)=>e.length>131072||new RegExp("^.{"+(t+1)+",}","m").test(e),encodeWord(e,t,i){let a;t=(t||"Q").toString().toUpperCase().trim().charAt(0);let r="UTF-8";if((i=i||0)&&i>7+r.length&&(i-=7+r.length),"Q"===t?a=n.encode(e).replace(/[^a-z0-9!*+\-/=]/gi,(e=>{let t=e.charCodeAt(0).toString(16).toUpperCase();return" "===e?"_":"="+(1===t.length?"0"+t:t)})):"B"===t&&(a="string"==typeof e?e:s.encode(e),i=i?Math.max(3,(i-i%4)/4*3):0),i&&("B"!==t?a:s.encode(e)).length>i)if("Q"===t)a=this.splitMimeEncodedString(a,i).join("?= =?UTF-8?"+t+"?");else{let e=[],n="";for(let t=0,r=a.length;t<r;t++){let r=a.charAt(t);Buffer.byteLength(n+r)<=i||0===t?n+=r:(e.push(s.encode(n)),n=r)}n&&e.push(s.encode(n)),a=e.length>1?e.join("?= =?UTF-8?"+t+"?"):e.join("")}else"B"===t&&(a=s.encode(e));return"=?UTF-8?"+t+"?"+a+("?="===a.substr(-2)?"":"?=")},encodeWords(e,t,i,s){let n;i=i||0;let a=e.match(/(?:^|\s)([^\s]*["\u0080-\uFFFF])/);if(!a)return e;if(s)return this.encodeWord(e,t,i);let r=e.match(/(["\u0080-\uFFFF][^\s]*)[^"\u0080-\uFFFF]*$/);if(!r)return e;let o=a.index+(a[0].match(/[^\s]/)||{index:0}).index,c=r.index+(r[1]||"").length;return n=(o?e.substr(0,o):"")+this.encodeWord(e.substring(o,c),t||"Q",i)+(c<e.length?e.substr(c):""),n},buildHeaderValue(e){let t=[];return Object.keys(e.params||{}).forEach((i=>{let s=e.params[i];!this.isPlainText(s,!0)||s.length>=75?this.buildHeaderParam(i,s,50).forEach((e=>{/[\s"\\;:/=(),<>@[\]?]|^[-']|'$/.test(e.value)&&"*"!==e.key.substr(-1)?t.push(e.key+"="+JSON.stringify(e.value)):t.push(e.key+"="+e.value)})):/[\s'"\\;:/=(),<>@[\]?]|^-/.test(s)?t.push(i+"="+JSON.stringify(s)):t.push(i+"="+s)})),e.value+(t.length?"; "+t.join("; "):"")},buildHeaderParam(e,t,i){let s,n,a,r,o,c,l=[],p="string"==typeof t?t:(t||"").toString(),d=0;if(i=i||50,this.isPlainText(t,!0)){if(p.length<=i)return[{key:e,value:p}];p=p.replace(new RegExp(".{"+i+"}","g"),(e=>(l.push({line:e}),""))),p&&l.push({line:p})}else{if(/[\uD800-\uDBFF]/.test(p)){for(s=[],o=0,c=p.length;o<c;o++)n=p.charAt(o),a=n.charCodeAt(0),a>=55296&&a<=56319&&o<c-1?(n+=p.charAt(o+1),s.push(n),o++):s.push(n);p=s}r="utf-8''";let e=!0;for(d=0,o=0,c=p.length;o<c;o++){if(n=p[o],e)n=this.safeEncodeURIComponent(n);else if(n=" "===n?n:this.safeEncodeURIComponent(n),n!==p[o]){if(!((this.safeEncodeURIComponent(r)+n).length>=i)){e=!0,o=d,r="";continue}l.push({line:r,encoded:e}),r="",d=o-1}(r+n).length>=i?(l.push({line:r,encoded:e}),r=n=" "===p[o]?" ":this.safeEncodeURIComponent(p[o]),n===p[o]?(e=!1,d=o-1):e=!0):r+=n}r&&l.push({line:r,encoded:e})}return l.map(((t,i)=>({key:e+"*"+i+(t.encoded?"*":""),value:t.line})))},parseHeaderValue(e){let t,i={value:!1,params:{}},s=!1,n="",a="value",r=!1,o=!1;for(let c=0,l=e.length;c<l;c++)if(t=e.charAt(c),"key"===a){if("="===t){s=n.trim().toLowerCase(),a="value",n="";continue}n+=t}else{if(o)n+=t;else{if("\\"===t){o=!0;continue}r&&t===r?r=!1:r||'"'!==t?r||";"!==t?n+=t:(!1===s?i.value=n.trim():i.params[s]=n.trim(),a="key",n=""):r=t}o=!1}return"value"===a?!1===s?i.value=n.trim():i.params[s]=n.trim():n.trim()&&(i.params[n.trim().toLowerCase()]=""),Object.keys(i.params).forEach((e=>{let t,s,n,a;(n=e.match(/(\*(\d+)|\*(\d+)\*|\*)$/))&&(t=e.substr(0,n.index),s=Number(n[2]||n[3])||0,i.params[t]&&"object"==typeof i.params[t]||(i.params[t]={charset:!1,values:[]}),a=i.params[e],0===s&&"*"===n[0].substr(-1)&&(n=a.match(/^([^']*)'[^']*'(.*)$/))&&(i.params[t].charset=n[1]||"iso-8859-1",a=n[2]),i.params[t].values[s]=a,delete i.params[e])})),Object.keys(i.params).forEach((e=>{let t;i.params[e]&&Array.isArray(i.params[e].values)&&(t=i.params[e].values.map((e=>e||"")).join(""),i.params[e].charset?i.params[e]="=?"+i.params[e].charset+"?Q?"+t.replace(/[=?_\s]/g,(e=>{let t=e.charCodeAt(0).toString(16);return" "===e?"_":"%"+(t.length<2?"0":"")+t})).replace(/%/g,"=")+"?=":i.params[e]=t)})),i},detectExtension:e=>a.detectExtension(e),detectMimeType:e=>a.detectMimeType(e),foldLines(e,t,i){t=t||76;let s,n,a=0,r=(e=(e||"").toString()).length,o="";for(;a<r;){if(s=e.substr(a,t),s.length<t){o+=s;break}(n=s.match(/^[^\n\r]*(\r?\n|\r)/))?(s=n[0],o+=s,a+=s.length):((n=s.match(/(\s+)[^\s]*$/))&&n[0].length-(i?(n[1]||"").length:0)<s.length?s=s.substr(0,s.length-(n[0].length-(i?(n[1]||"").length:0))):(n=e.substr(a+s.length).match(/^[^\s]+(\s*)/))&&(s+=n[0].substr(0,n[0].length-(i?0:(n[1]||"").length))),o+=s,a+=s.length,a<r&&(o+="\r\n"))}return o},splitMimeEncodedString:(e,t)=>{let i,s,n,a,r=[];for(t=Math.max(t||0,12);e.length;){for(i=e.substr(0,t),(s=i.match(/[=][0-9A-F]?$/i))&&(i=i.substr(0,s.index)),a=!1;!a;)a=!0,(s=e.substr(i.length).match(/^[=]([0-9A-F]{2})/i))&&(n=parseInt(s[1],16),n<194&&n>127&&(i=i.substr(0,i.length-3),a=!1));i.length&&r.push(i),e=e.substr(i.length)}return r},encodeURICharComponent:e=>{let t="",i=e.charCodeAt(0).toString(16).toUpperCase();if(i.length%2&&(i="0"+i),i.length>2)for(let e=0,s=i.length/2;e<s;e++)t+="%"+i.substr(e,2);else t+="%"+i;return t},safeEncodeURIComponent(e){e=(e||"").toString();try{e=encodeURIComponent(e)}catch(t){return e.replace(/[^\x00-\x1F *'()<>@,;:\\"[\]?=\u007F-\uFFFF]+/g,"")}return e.replace(/[\x00-\x1F *'()<>@,;:\\"[\]?=\u007F-\uFFFF]/g,(e=>this.encodeURICharComponent(e)))}}},8497:(e,t,i)=>{"use strict";const s=i(1017),n="application/octet-stream",a=new Map([["application/acad","dwg"],["application/applixware","aw"],["application/arj","arj"],["application/atom+xml","xml"],["application/atomcat+xml","atomcat"],["application/atomsvc+xml","atomsvc"],["application/base64",["mm","mme"]],["application/binhex","hqx"],["application/binhex4","hqx"],["application/book",["book","boo"]],["application/ccxml+xml,","ccxml"],["application/cdf","cdf"],["application/cdmi-capability","cdmia"],["application/cdmi-container","cdmic"],["application/cdmi-domain","cdmid"],["application/cdmi-object","cdmio"],["application/cdmi-queue","cdmiq"],["application/clariscad","ccad"],["application/commonground","dp"],["application/cu-seeme","cu"],["application/davmount+xml","davmount"],["application/drafting","drw"],["application/dsptype","tsp"],["application/dssc+der","dssc"],["application/dssc+xml","xdssc"],["application/dxf","dxf"],["application/ecmascript",["js","es"]],["application/emma+xml","emma"],["application/envoy","evy"],["application/epub+zip","epub"],["application/excel",["xls","xl","xla","xlb","xlc","xld","xlk","xll","xlm","xlt","xlv","xlw"]],["application/exi","exi"],["application/font-tdpfr","pfr"],["application/fractals","fif"],["application/freeloader","frl"],["application/futuresplash","spl"],["application/gnutar","tgz"],["application/groupwise","vew"],["application/hlp","hlp"],["application/hta","hta"],["application/hyperstudio","stk"],["application/i-deas","unv"],["application/iges",["iges","igs"]],["application/inf","inf"],["application/internet-property-stream","acx"],["application/ipfix","ipfix"],["application/java","class"],["application/java-archive","jar"],["application/java-byte-code","class"],["application/java-serialized-object","ser"],["application/java-vm","class"],["application/javascript","js"],["application/json","json"],["application/lha","lha"],["application/lzx","lzx"],["application/mac-binary","bin"],["application/mac-binhex","hqx"],["application/mac-binhex40","hqx"],["application/mac-compactpro","cpt"],["application/macbinary","bin"],["application/mads+xml","mads"],["application/marc","mrc"],["application/marcxml+xml","mrcx"],["application/mathematica","ma"],["application/mathml+xml","mathml"],["application/mbedlet","mbd"],["application/mbox","mbox"],["application/mcad","mcd"],["application/mediaservercontrol+xml","mscml"],["application/metalink4+xml","meta4"],["application/mets+xml","mets"],["application/mime","aps"],["application/mods+xml","mods"],["application/mp21","m21"],["application/mp4","mp4"],["application/mspowerpoint",["ppt","pot","pps","ppz"]],["application/msword",["doc","dot","w6w","wiz","word"]],["application/mswrite","wri"],["application/mxf","mxf"],["application/netmc","mcp"],["application/octet-stream",["*"]],["application/oda","oda"],["application/oebps-package+xml","opf"],["application/ogg","ogx"],["application/olescript","axs"],["application/onenote","onetoc"],["application/patch-ops-error+xml","xer"],["application/pdf","pdf"],["application/pgp-encrypted","asc"],["application/pgp-signature","pgp"],["application/pics-rules","prf"],["application/pkcs-12","p12"],["application/pkcs-crl","crl"],["application/pkcs10","p10"],["application/pkcs7-mime",["p7c","p7m"]],["application/pkcs7-signature","p7s"],["application/pkcs8","p8"],["application/pkix-attr-cert","ac"],["application/pkix-cert",["cer","crt"]],["application/pkix-crl","crl"],["application/pkix-pkipath","pkipath"],["application/pkixcmp","pki"],["application/plain","text"],["application/pls+xml","pls"],["application/postscript",["ps","ai","eps"]],["application/powerpoint","ppt"],["application/pro_eng",["part","prt"]],["application/prs.cww","cww"],["application/pskc+xml","pskcxml"],["application/rdf+xml","rdf"],["application/reginfo+xml","rif"],["application/relax-ng-compact-syntax","rnc"],["application/resource-lists+xml","rl"],["application/resource-lists-diff+xml","rld"],["application/ringing-tones","rng"],["application/rls-services+xml","rs"],["application/rsd+xml","rsd"],["application/rss+xml","xml"],["application/rtf",["rtf","rtx"]],["application/sbml+xml","sbml"],["application/scvp-cv-request","scq"],["application/scvp-cv-response","scs"],["application/scvp-vp-request","spq"],["application/scvp-vp-response","spp"],["application/sdp","sdp"],["application/sea","sea"],["application/set","set"],["application/set-payment-initiation","setpay"],["application/set-registration-initiation","setreg"],["application/shf+xml","shf"],["application/sla","stl"],["application/smil",["smi","smil"]],["application/smil+xml","smi"],["application/solids","sol"],["application/sounder","sdr"],["application/sparql-query","rq"],["application/sparql-results+xml","srx"],["application/srgs","gram"],["application/srgs+xml","grxml"],["application/sru+xml","sru"],["application/ssml+xml","ssml"],["application/step",["step","stp"]],["application/streamingmedia","ssm"],["application/tei+xml","tei"],["application/thraud+xml","tfi"],["application/timestamped-data","tsd"],["application/toolbook","tbk"],["application/vda","vda"],["application/vnd.3gpp.pic-bw-large","plb"],["application/vnd.3gpp.pic-bw-small","psb"],["application/vnd.3gpp.pic-bw-var","pvb"],["application/vnd.3gpp2.tcap","tcap"],["application/vnd.3m.post-it-notes","pwn"],["application/vnd.accpac.simply.aso","aso"],["application/vnd.accpac.simply.imp","imp"],["application/vnd.acucobol","acu"],["application/vnd.acucorp","atc"],["application/vnd.adobe.air-application-installer-package+zip","air"],["application/vnd.adobe.fxp","fxp"],["application/vnd.adobe.xdp+xml","xdp"],["application/vnd.adobe.xfdf","xfdf"],["application/vnd.ahead.space","ahead"],["application/vnd.airzip.filesecure.azf","azf"],["application/vnd.airzip.filesecure.azs","azs"],["application/vnd.amazon.ebook","azw"],["application/vnd.americandynamics.acc","acc"],["application/vnd.amiga.ami","ami"],["application/vnd.android.package-archive","apk"],["application/vnd.anser-web-certificate-issue-initiation","cii"],["application/vnd.anser-web-funds-transfer-initiation","fti"],["application/vnd.antix.game-component","atx"],["application/vnd.apple.installer+xml","mpkg"],["application/vnd.apple.mpegurl","m3u8"],["application/vnd.aristanetworks.swi","swi"],["application/vnd.audiograph","aep"],["application/vnd.blueice.multipass","mpm"],["application/vnd.bmi","bmi"],["application/vnd.businessobjects","rep"],["application/vnd.chemdraw+xml","cdxml"],["application/vnd.chipnuts.karaoke-mmd","mmd"],["application/vnd.cinderella","cdy"],["application/vnd.claymore","cla"],["application/vnd.cloanto.rp9","rp9"],["application/vnd.clonk.c4group","c4g"],["application/vnd.cluetrust.cartomobile-config","c11amc"],["application/vnd.cluetrust.cartomobile-config-pkg","c11amz"],["application/vnd.commonspace","csp"],["application/vnd.contact.cmsg","cdbcmsg"],["application/vnd.cosmocaller","cmc"],["application/vnd.crick.clicker","clkx"],["application/vnd.crick.clicker.keyboard","clkk"],["application/vnd.crick.clicker.palette","clkp"],["application/vnd.crick.clicker.template","clkt"],["application/vnd.crick.clicker.wordbank","clkw"],["application/vnd.criticaltools.wbs+xml","wbs"],["application/vnd.ctc-posml","pml"],["application/vnd.cups-ppd","ppd"],["application/vnd.curl.car","car"],["application/vnd.curl.pcurl","pcurl"],["application/vnd.data-vision.rdz","rdz"],["application/vnd.denovo.fcselayout-link","fe_launch"],["application/vnd.dna","dna"],["application/vnd.dolby.mlp","mlp"],["application/vnd.dpgraph","dpg"],["application/vnd.dreamfactory","dfac"],["application/vnd.dvb.ait","ait"],["application/vnd.dvb.service","svc"],["application/vnd.dynageo","geo"],["application/vnd.ecowin.chart","mag"],["application/vnd.enliven","nml"],["application/vnd.epson.esf","esf"],["application/vnd.epson.msf","msf"],["application/vnd.epson.quickanime","qam"],["application/vnd.epson.salt","slt"],["application/vnd.epson.ssf","ssf"],["application/vnd.eszigno3+xml","es3"],["application/vnd.ezpix-album","ez2"],["application/vnd.ezpix-package","ez3"],["application/vnd.fdf","fdf"],["application/vnd.fdsn.seed","seed"],["application/vnd.flographit","gph"],["application/vnd.fluxtime.clip","ftc"],["application/vnd.framemaker","fm"],["application/vnd.frogans.fnc","fnc"],["application/vnd.frogans.ltf","ltf"],["application/vnd.fsc.weblaunch","fsc"],["application/vnd.fujitsu.oasys","oas"],["application/vnd.fujitsu.oasys2","oa2"],["application/vnd.fujitsu.oasys3","oa3"],["application/vnd.fujitsu.oasysgp","fg5"],["application/vnd.fujitsu.oasysprs","bh2"],["application/vnd.fujixerox.ddd","ddd"],["application/vnd.fujixerox.docuworks","xdw"],["application/vnd.fujixerox.docuworks.binder","xbd"],["application/vnd.fuzzysheet","fzs"],["application/vnd.genomatix.tuxedo","txd"],["application/vnd.geogebra.file","ggb"],["application/vnd.geogebra.tool","ggt"],["application/vnd.geometry-explorer","gex"],["application/vnd.geonext","gxt"],["application/vnd.geoplan","g2w"],["application/vnd.geospace","g3w"],["application/vnd.gmx","gmx"],["application/vnd.google-earth.kml+xml","kml"],["application/vnd.google-earth.kmz","kmz"],["application/vnd.grafeq","gqf"],["application/vnd.groove-account","gac"],["application/vnd.groove-help","ghf"],["application/vnd.groove-identity-message","gim"],["application/vnd.groove-injector","grv"],["application/vnd.groove-tool-message","gtm"],["application/vnd.groove-tool-template","tpl"],["application/vnd.groove-vcard","vcg"],["application/vnd.hal+xml","hal"],["application/vnd.handheld-entertainment+xml","zmm"],["application/vnd.hbci","hbci"],["application/vnd.hhe.lesson-player","les"],["application/vnd.hp-hpgl",["hgl","hpg","hpgl"]],["application/vnd.hp-hpid","hpid"],["application/vnd.hp-hps","hps"],["application/vnd.hp-jlyt","jlt"],["application/vnd.hp-pcl","pcl"],["application/vnd.hp-pclxl","pclxl"],["application/vnd.hydrostatix.sof-data","sfd-hdstx"],["application/vnd.hzn-3d-crossword","x3d"],["application/vnd.ibm.minipay","mpy"],["application/vnd.ibm.modcap","afp"],["application/vnd.ibm.rights-management","irm"],["application/vnd.ibm.secure-container","sc"],["application/vnd.iccprofile","icc"],["application/vnd.igloader","igl"],["application/vnd.immervision-ivp","ivp"],["application/vnd.immervision-ivu","ivu"],["application/vnd.insors.igm","igm"],["application/vnd.intercon.formnet","xpw"],["application/vnd.intergeo","i2g"],["application/vnd.intu.qbo","qbo"],["application/vnd.intu.qfx","qfx"],["application/vnd.ipunplugged.rcprofile","rcprofile"],["application/vnd.irepository.package+xml","irp"],["application/vnd.is-xpr","xpr"],["application/vnd.isac.fcs","fcs"],["application/vnd.jam","jam"],["application/vnd.jcp.javame.midlet-rms","rms"],["application/vnd.jisp","jisp"],["application/vnd.joost.joda-archive","joda"],["application/vnd.kahootz","ktz"],["application/vnd.kde.karbon","karbon"],["application/vnd.kde.kchart","chrt"],["application/vnd.kde.kformula","kfo"],["application/vnd.kde.kivio","flw"],["application/vnd.kde.kontour","kon"],["application/vnd.kde.kpresenter","kpr"],["application/vnd.kde.kspread","ksp"],["application/vnd.kde.kword","kwd"],["application/vnd.kenameaapp","htke"],["application/vnd.kidspiration","kia"],["application/vnd.kinar","kne"],["application/vnd.koan","skp"],["application/vnd.kodak-descriptor","sse"],["application/vnd.las.las+xml","lasxml"],["application/vnd.llamagraphics.life-balance.desktop","lbd"],["application/vnd.llamagraphics.life-balance.exchange+xml","lbe"],["application/vnd.lotus-1-2-3","123"],["application/vnd.lotus-approach","apr"],["application/vnd.lotus-freelance","pre"],["application/vnd.lotus-notes","nsf"],["application/vnd.lotus-organizer","org"],["application/vnd.lotus-screencam","scm"],["application/vnd.lotus-wordpro","lwp"],["application/vnd.macports.portpkg","portpkg"],["application/vnd.mcd","mcd"],["application/vnd.medcalcdata","mc1"],["application/vnd.mediastation.cdkey","cdkey"],["application/vnd.mfer","mwf"],["application/vnd.mfmp","mfm"],["application/vnd.micrografx.flo","flo"],["application/vnd.micrografx.igx","igx"],["application/vnd.mif","mif"],["application/vnd.mobius.daf","daf"],["application/vnd.mobius.dis","dis"],["application/vnd.mobius.mbk","mbk"],["application/vnd.mobius.mqy","mqy"],["application/vnd.mobius.msl","msl"],["application/vnd.mobius.plc","plc"],["application/vnd.mobius.txf","txf"],["application/vnd.mophun.application","mpn"],["application/vnd.mophun.certificate","mpc"],["application/vnd.mozilla.xul+xml","xul"],["application/vnd.ms-artgalry","cil"],["application/vnd.ms-cab-compressed","cab"],["application/vnd.ms-excel",["xls","xla","xlc","xlm","xlt","xlw","xlb","xll"]],["application/vnd.ms-excel.addin.macroenabled.12","xlam"],["application/vnd.ms-excel.sheet.binary.macroenabled.12","xlsb"],["application/vnd.ms-excel.sheet.macroenabled.12","xlsm"],["application/vnd.ms-excel.template.macroenabled.12","xltm"],["application/vnd.ms-fontobject","eot"],["application/vnd.ms-htmlhelp","chm"],["application/vnd.ms-ims","ims"],["application/vnd.ms-lrm","lrm"],["application/vnd.ms-officetheme","thmx"],["application/vnd.ms-outlook","msg"],["application/vnd.ms-pki.certstore","sst"],["application/vnd.ms-pki.pko","pko"],["application/vnd.ms-pki.seccat","cat"],["application/vnd.ms-pki.stl","stl"],["application/vnd.ms-pkicertstore","sst"],["application/vnd.ms-pkiseccat","cat"],["application/vnd.ms-pkistl","stl"],["application/vnd.ms-powerpoint",["ppt","pot","pps","ppa","pwz"]],["application/vnd.ms-powerpoint.addin.macroenabled.12","ppam"],["application/vnd.ms-powerpoint.presentation.macroenabled.12","pptm"],["application/vnd.ms-powerpoint.slide.macroenabled.12","sldm"],["application/vnd.ms-powerpoint.slideshow.macroenabled.12","ppsm"],["application/vnd.ms-powerpoint.template.macroenabled.12","potm"],["application/vnd.ms-project","mpp"],["application/vnd.ms-word.document.macroenabled.12","docm"],["application/vnd.ms-word.template.macroenabled.12","dotm"],["application/vnd.ms-works",["wks","wcm","wdb","wps"]],["application/vnd.ms-wpl","wpl"],["application/vnd.ms-xpsdocument","xps"],["application/vnd.mseq","mseq"],["application/vnd.musician","mus"],["application/vnd.muvee.style","msty"],["application/vnd.neurolanguage.nlu","nlu"],["application/vnd.noblenet-directory","nnd"],["application/vnd.noblenet-sealer","nns"],["application/vnd.noblenet-web","nnw"],["application/vnd.nokia.configuration-message","ncm"],["application/vnd.nokia.n-gage.data","ngdat"],["application/vnd.nokia.n-gage.symbian.install","n-gage"],["application/vnd.nokia.radio-preset","rpst"],["application/vnd.nokia.radio-presets","rpss"],["application/vnd.nokia.ringing-tone","rng"],["application/vnd.novadigm.edm","edm"],["application/vnd.novadigm.edx","edx"],["application/vnd.novadigm.ext","ext"],["application/vnd.oasis.opendocument.chart","odc"],["application/vnd.oasis.opendocument.chart-template","otc"],["application/vnd.oasis.opendocument.database","odb"],["application/vnd.oasis.opendocument.formula","odf"],["application/vnd.oasis.opendocument.formula-template","odft"],["application/vnd.oasis.opendocument.graphics","odg"],["application/vnd.oasis.opendocument.graphics-template","otg"],["application/vnd.oasis.opendocument.image","odi"],["application/vnd.oasis.opendocument.image-template","oti"],["application/vnd.oasis.opendocument.presentation","odp"],["application/vnd.oasis.opendocument.presentation-template","otp"],["application/vnd.oasis.opendocument.spreadsheet","ods"],["application/vnd.oasis.opendocument.spreadsheet-template","ots"],["application/vnd.oasis.opendocument.text","odt"],["application/vnd.oasis.opendocument.text-master","odm"],["application/vnd.oasis.opendocument.text-template","ott"],["application/vnd.oasis.opendocument.text-web","oth"],["application/vnd.olpc-sugar","xo"],["application/vnd.oma.dd2+xml","dd2"],["application/vnd.openofficeorg.extension","oxt"],["application/vnd.openxmlformats-officedocument.presentationml.presentation","pptx"],["application/vnd.openxmlformats-officedocument.presentationml.slide","sldx"],["application/vnd.openxmlformats-officedocument.presentationml.slideshow","ppsx"],["application/vnd.openxmlformats-officedocument.presentationml.template","potx"],["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","xlsx"],["application/vnd.openxmlformats-officedocument.spreadsheetml.template","xltx"],["application/vnd.openxmlformats-officedocument.wordprocessingml.document","docx"],["application/vnd.openxmlformats-officedocument.wordprocessingml.template","dotx"],["application/vnd.osgeo.mapguide.package","mgp"],["application/vnd.osgi.dp","dp"],["application/vnd.palm","pdb"],["application/vnd.pawaafile","paw"],["application/vnd.pg.format","str"],["application/vnd.pg.osasli","ei6"],["application/vnd.picsel","efif"],["application/vnd.pmi.widget","wg"],["application/vnd.pocketlearn","plf"],["application/vnd.powerbuilder6","pbd"],["application/vnd.previewsystems.box","box"],["application/vnd.proteus.magazine","mgz"],["application/vnd.publishare-delta-tree","qps"],["application/vnd.pvi.ptid1","ptid"],["application/vnd.quark.quarkxpress","qxd"],["application/vnd.realvnc.bed","bed"],["application/vnd.recordare.musicxml","mxl"],["application/vnd.recordare.musicxml+xml","musicxml"],["application/vnd.rig.cryptonote","cryptonote"],["application/vnd.rim.cod","cod"],["application/vnd.rn-realmedia","rm"],["application/vnd.rn-realplayer","rnx"],["application/vnd.route66.link66+xml","link66"],["application/vnd.sailingtracker.track","st"],["application/vnd.seemail","see"],["application/vnd.sema","sema"],["application/vnd.semd","semd"],["application/vnd.semf","semf"],["application/vnd.shana.informed.formdata","ifm"],["application/vnd.shana.informed.formtemplate","itp"],["application/vnd.shana.informed.interchange","iif"],["application/vnd.shana.informed.package","ipk"],["application/vnd.simtech-mindmapper","twd"],["application/vnd.smaf","mmf"],["application/vnd.smart.teacher","teacher"],["application/vnd.solent.sdkm+xml","sdkm"],["application/vnd.spotfire.dxp","dxp"],["application/vnd.spotfire.sfs","sfs"],["application/vnd.stardivision.calc","sdc"],["application/vnd.stardivision.draw","sda"],["application/vnd.stardivision.impress","sdd"],["application/vnd.stardivision.math","smf"],["application/vnd.stardivision.writer","sdw"],["application/vnd.stardivision.writer-global","sgl"],["application/vnd.stepmania.stepchart","sm"],["application/vnd.sun.xml.calc","sxc"],["application/vnd.sun.xml.calc.template","stc"],["application/vnd.sun.xml.draw","sxd"],["application/vnd.sun.xml.draw.template","std"],["application/vnd.sun.xml.impress","sxi"],["application/vnd.sun.xml.impress.template","sti"],["application/vnd.sun.xml.math","sxm"],["application/vnd.sun.xml.writer","sxw"],["application/vnd.sun.xml.writer.global","sxg"],["application/vnd.sun.xml.writer.template","stw"],["application/vnd.sus-calendar","sus"],["application/vnd.svd","svd"],["application/vnd.symbian.install","sis"],["application/vnd.syncml+xml","xsm"],["application/vnd.syncml.dm+wbxml","bdm"],["application/vnd.syncml.dm+xml","xdm"],["application/vnd.tao.intent-module-archive","tao"],["application/vnd.tmobile-livetv","tmo"],["application/vnd.trid.tpt","tpt"],["application/vnd.triscape.mxs","mxs"],["application/vnd.trueapp","tra"],["application/vnd.ufdl","ufd"],["application/vnd.uiq.theme","utz"],["application/vnd.umajin","umj"],["application/vnd.unity","unityweb"],["application/vnd.uoml+xml","uoml"],["application/vnd.vcx","vcx"],["application/vnd.visio","vsd"],["application/vnd.visionary","vis"],["application/vnd.vsf","vsf"],["application/vnd.wap.wbxml","wbxml"],["application/vnd.wap.wmlc","wmlc"],["application/vnd.wap.wmlscriptc","wmlsc"],["application/vnd.webturbo","wtb"],["application/vnd.wolfram.player","nbp"],["application/vnd.wordperfect","wpd"],["application/vnd.wqd","wqd"],["application/vnd.wt.stf","stf"],["application/vnd.xara",["web","xar"]],["application/vnd.xfdl","xfdl"],["application/vnd.yamaha.hv-dic","hvd"],["application/vnd.yamaha.hv-script","hvs"],["application/vnd.yamaha.hv-voice","hvp"],["application/vnd.yamaha.openscoreformat","osf"],["application/vnd.yamaha.openscoreformat.osfpvg+xml","osfpvg"],["application/vnd.yamaha.smaf-audio","saf"],["application/vnd.yamaha.smaf-phrase","spf"],["application/vnd.yellowriver-custom-menu","cmp"],["application/vnd.zul","zir"],["application/vnd.zzazz.deck+xml","zaz"],["application/vocaltec-media-desc","vmd"],["application/vocaltec-media-file","vmf"],["application/voicexml+xml","vxml"],["application/widget","wgt"],["application/winhlp","hlp"],["application/wordperfect",["wp","wp5","wp6","wpd"]],["application/wordperfect6.0",["w60","wp5"]],["application/wordperfect6.1","w61"],["application/wsdl+xml","wsdl"],["application/wspolicy+xml","wspolicy"],["application/x-123","wk1"],["application/x-7z-compressed","7z"],["application/x-abiword","abw"],["application/x-ace-compressed","ace"],["application/x-aim","aim"],["application/x-authorware-bin","aab"],["application/x-authorware-map","aam"],["application/x-authorware-seg","aas"],["application/x-bcpio","bcpio"],["application/x-binary","bin"],["application/x-binhex40","hqx"],["application/x-bittorrent","torrent"],["application/x-bsh",["bsh","sh","shar"]],["application/x-bytecode.elisp","elc"],["application/x-bytecode.python","pyc"],["application/x-bzip","bz"],["application/x-bzip2",["boz","bz2"]],["application/x-cdf","cdf"],["application/x-cdlink","vcd"],["application/x-chat",["cha","chat"]],["application/x-chess-pgn","pgn"],["application/x-cmu-raster","ras"],["application/x-cocoa","cco"],["application/x-compactpro","cpt"],["application/x-compress","z"],["application/x-compressed",["tgz","gz","z","zip"]],["application/x-conference","nsc"],["application/x-cpio","cpio"],["application/x-cpt","cpt"],["application/x-csh","csh"],["application/x-debian-package","deb"],["application/x-deepv","deepv"],["application/x-director",["dir","dcr","dxr"]],["application/x-doom","wad"],["application/x-dtbncx+xml","ncx"],["application/x-dtbook+xml","dtb"],["application/x-dtbresource+xml","res"],["application/x-dvi","dvi"],["application/x-elc","elc"],["application/x-envoy",["env","evy"]],["application/x-esrehber","es"],["application/x-excel",["xls","xla","xlb","xlc","xld","xlk","xll","xlm","xlt","xlv","xlw"]],["application/x-font-bdf","bdf"],["application/x-font-ghostscript","gsf"],["application/x-font-linux-psf","psf"],["application/x-font-otf","otf"],["application/x-font-pcf","pcf"],["application/x-font-snf","snf"],["application/x-font-ttf","ttf"],["application/x-font-type1","pfa"],["application/x-font-woff","woff"],["application/x-frame","mif"],["application/x-freelance","pre"],["application/x-futuresplash","spl"],["application/x-gnumeric","gnumeric"],["application/x-gsp","gsp"],["application/x-gss","gss"],["application/x-gtar","gtar"],["application/x-gzip",["gz","gzip"]],["application/x-hdf","hdf"],["application/x-helpfile",["help","hlp"]],["application/x-httpd-imap","imap"],["application/x-ima","ima"],["application/x-internet-signup",["ins","isp"]],["application/x-internett-signup","ins"],["application/x-inventor","iv"],["application/x-ip2","ip"],["application/x-iphone","iii"],["application/x-java-class","class"],["application/x-java-commerce","jcm"],["application/x-java-jnlp-file","jnlp"],["application/x-javascript","js"],["application/x-koan",["skd","skm","skp","skt"]],["application/x-ksh","ksh"],["application/x-latex",["latex","ltx"]],["application/x-lha","lha"],["application/x-lisp","lsp"],["application/x-livescreen","ivy"],["application/x-lotus","wq1"],["application/x-lotusscreencam","scm"],["application/x-lzh","lzh"],["application/x-lzx","lzx"],["application/x-mac-binhex40","hqx"],["application/x-macbinary","bin"],["application/x-magic-cap-package-1.0","mc$"],["application/x-mathcad","mcd"],["application/x-meme","mm"],["application/x-midi",["mid","midi"]],["application/x-mif","mif"],["application/x-mix-transfer","nix"],["application/x-mobipocket-ebook","prc"],["application/x-mplayer2","asx"],["application/x-ms-application","application"],["application/x-ms-wmd","wmd"],["application/x-ms-wmz","wmz"],["application/x-ms-xbap","xbap"],["application/x-msaccess","mdb"],["application/x-msbinder","obd"],["application/x-mscardfile","crd"],["application/x-msclip","clp"],["application/x-msdownload",["exe","dll"]],["application/x-msexcel",["xls","xla","xlw"]],["application/x-msmediaview",["mvb","m13","m14"]],["application/x-msmetafile","wmf"],["application/x-msmoney","mny"],["application/x-mspowerpoint","ppt"],["application/x-mspublisher","pub"],["application/x-msschedule","scd"],["application/x-msterminal","trm"],["application/x-mswrite","wri"],["application/x-navi-animation","ani"],["application/x-navidoc","nvd"],["application/x-navimap","map"],["application/x-navistyle","stl"],["application/x-netcdf",["cdf","nc"]],["application/x-newton-compatible-pkg","pkg"],["application/x-nokia-9000-communicator-add-on-software","aos"],["application/x-omc","omc"],["application/x-omcdatamaker","omcd"],["application/x-omcregerator","omcr"],["application/x-pagemaker",["pm4","pm5"]],["application/x-pcl","pcl"],["application/x-perfmon",["pma","pmc","pml","pmr","pmw"]],["application/x-pixclscript","plx"],["application/x-pkcs10","p10"],["application/x-pkcs12",["p12","pfx"]],["application/x-pkcs7-certificates",["p7b","spc"]],["application/x-pkcs7-certreqresp","p7r"],["application/x-pkcs7-mime",["p7m","p7c"]],["application/x-pkcs7-signature",["p7s","p7a"]],["application/x-pointplus","css"],["application/x-portable-anymap","pnm"],["application/x-project",["mpc","mpt","mpv","mpx"]],["application/x-qpro","wb1"],["application/x-rar-compressed","rar"],["application/x-rtf","rtf"],["application/x-sdp","sdp"],["application/x-sea","sea"],["application/x-seelogo","sl"],["application/x-sh","sh"],["application/x-shar",["shar","sh"]],["application/x-shockwave-flash","swf"],["application/x-silverlight-app","xap"],["application/x-sit","sit"],["application/x-sprite",["spr","sprite"]],["application/x-stuffit","sit"],["application/x-stuffitx","sitx"],["application/x-sv4cpio","sv4cpio"],["application/x-sv4crc","sv4crc"],["application/x-tar","tar"],["application/x-tbook",["sbk","tbk"]],["application/x-tcl","tcl"],["application/x-tex","tex"],["application/x-tex-tfm","tfm"],["application/x-texinfo",["texi","texinfo"]],["application/x-troff",["roff","t","tr"]],["application/x-troff-man","man"],["application/x-troff-me","me"],["application/x-troff-ms","ms"],["application/x-troff-msvideo","avi"],["application/x-ustar","ustar"],["application/x-visio",["vsd","vst","vsw"]],["application/x-vnd.audioexplosion.mzz","mzz"],["application/x-vnd.ls-xpix","xpix"],["application/x-vrml","vrml"],["application/x-wais-source",["src","wsrc"]],["application/x-winhelp","hlp"],["application/x-wintalk","wtk"],["application/x-world",["wrl","svr"]],["application/x-wpwin","wpd"],["application/x-wri","wri"],["application/x-x509-ca-cert",["cer","crt","der"]],["application/x-x509-user-cert","crt"],["application/x-xfig","fig"],["application/x-xpinstall","xpi"],["application/x-zip-compressed","zip"],["application/xcap-diff+xml","xdf"],["application/xenc+xml","xenc"],["application/xhtml+xml","xhtml"],["application/xml","xml"],["application/xml-dtd","dtd"],["application/xop+xml","xop"],["application/xslt+xml","xslt"],["application/xspf+xml","xspf"],["application/xv+xml","mxml"],["application/yang","yang"],["application/yin+xml","yin"],["application/ynd.ms-pkipko","pko"],["application/zip","zip"],["audio/adpcm","adp"],["audio/aiff",["aiff","aif","aifc"]],["audio/basic",["snd","au"]],["audio/it","it"],["audio/make",["funk","my","pfunk"]],["audio/make.my.funk","pfunk"],["audio/mid",["mid","rmi"]],["audio/midi",["midi","kar","mid"]],["audio/mod","mod"],["audio/mp4","mp4a"],["audio/mpeg",["mpga","mp3","m2a","mp2","mpa","mpg"]],["audio/mpeg3","mp3"],["audio/nspaudio",["la","lma"]],["audio/ogg","oga"],["audio/s3m","s3m"],["audio/tsp-audio","tsi"],["audio/tsplayer","tsp"],["audio/vnd.dece.audio","uva"],["audio/vnd.digital-winds","eol"],["audio/vnd.dra","dra"],["audio/vnd.dts","dts"],["audio/vnd.dts.hd","dtshd"],["audio/vnd.lucent.voice","lvp"],["audio/vnd.ms-playready.media.pya","pya"],["audio/vnd.nuera.ecelp4800","ecelp4800"],["audio/vnd.nuera.ecelp7470","ecelp7470"],["audio/vnd.nuera.ecelp9600","ecelp9600"],["audio/vnd.qcelp","qcp"],["audio/vnd.rip","rip"],["audio/voc","voc"],["audio/voxware","vox"],["audio/wav","wav"],["audio/webm","weba"],["audio/x-aac","aac"],["audio/x-adpcm","snd"],["audio/x-aiff",["aiff","aif","aifc"]],["audio/x-au","au"],["audio/x-gsm",["gsd","gsm"]],["audio/x-jam","jam"],["audio/x-liveaudio","lam"],["audio/x-mid",["mid","midi"]],["audio/x-midi",["midi","mid"]],["audio/x-mod","mod"],["audio/x-mpeg","mp2"],["audio/x-mpeg-3","mp3"],["audio/x-mpegurl","m3u"],["audio/x-mpequrl","m3u"],["audio/x-ms-wax","wax"],["audio/x-ms-wma","wma"],["audio/x-nspaudio",["la","lma"]],["audio/x-pn-realaudio",["ra","ram","rm","rmm","rmp"]],["audio/x-pn-realaudio-plugin",["ra","rmp","rpm"]],["audio/x-psid","sid"],["audio/x-realaudio","ra"],["audio/x-twinvq","vqf"],["audio/x-twinvq-plugin",["vqe","vql"]],["audio/x-vnd.audioexplosion.mjuicemediafile","mjf"],["audio/x-voc","voc"],["audio/x-wav","wav"],["audio/xm","xm"],["chemical/x-cdx","cdx"],["chemical/x-cif","cif"],["chemical/x-cmdf","cmdf"],["chemical/x-cml","cml"],["chemical/x-csml","csml"],["chemical/x-pdb",["pdb","xyz"]],["chemical/x-xyz","xyz"],["drawing/x-dwf","dwf"],["i-world/i-vrml","ivr"],["image/bmp",["bmp","bm"]],["image/cgm","cgm"],["image/cis-cod","cod"],["image/cmu-raster",["ras","rast"]],["image/fif","fif"],["image/florian",["flo","turbot"]],["image/g3fax","g3"],["image/gif","gif"],["image/ief",["ief","iefs"]],["image/jpeg",["jpeg","jpe","jpg","jfif","jfif-tbnl"]],["image/jutvision","jut"],["image/ktx","ktx"],["image/naplps",["nap","naplps"]],["image/pict",["pic","pict"]],["image/pipeg","jfif"],["image/pjpeg",["jfif","jpe","jpeg","jpg"]],["image/png",["png","x-png"]],["image/prs.btif","btif"],["image/svg+xml","svg"],["image/tiff",["tif","tiff"]],["image/vasa","mcf"],["image/vnd.adobe.photoshop","psd"],["image/vnd.dece.graphic","uvi"],["image/vnd.djvu","djvu"],["image/vnd.dvb.subtitle","sub"],["image/vnd.dwg",["dwg","dxf","svf"]],["image/vnd.dxf","dxf"],["image/vnd.fastbidsheet","fbs"],["image/vnd.fpx","fpx"],["image/vnd.fst","fst"],["image/vnd.fujixerox.edmics-mmr","mmr"],["image/vnd.fujixerox.edmics-rlc","rlc"],["image/vnd.ms-modi","mdi"],["image/vnd.net-fpx",["fpx","npx"]],["image/vnd.rn-realflash","rf"],["image/vnd.rn-realpix","rp"],["image/vnd.wap.wbmp","wbmp"],["image/vnd.xiff","xif"],["image/webp","webp"],["image/x-cmu-raster","ras"],["image/x-cmx","cmx"],["image/x-dwg",["dwg","dxf","svf"]],["image/x-freehand","fh"],["image/x-icon","ico"],["image/x-jg","art"],["image/x-jps","jps"],["image/x-niff",["niff","nif"]],["image/x-pcx","pcx"],["image/x-pict",["pct","pic"]],["image/x-portable-anymap","pnm"],["image/x-portable-bitmap","pbm"],["image/x-portable-graymap","pgm"],["image/x-portable-greymap","pgm"],["image/x-portable-pixmap","ppm"],["image/x-quicktime",["qif","qti","qtif"]],["image/x-rgb","rgb"],["image/x-tiff",["tif","tiff"]],["image/x-windows-bmp","bmp"],["image/x-xbitmap","xbm"],["image/x-xbm","xbm"],["image/x-xpixmap",["xpm","pm"]],["image/x-xwd","xwd"],["image/x-xwindowdump","xwd"],["image/xbm","xbm"],["image/xpm","xpm"],["message/rfc822",["eml","mht","mhtml","nws","mime"]],["model/iges",["iges","igs"]],["model/mesh","msh"],["model/vnd.collada+xml","dae"],["model/vnd.dwf","dwf"],["model/vnd.gdl","gdl"],["model/vnd.gtw","gtw"],["model/vnd.mts","mts"],["model/vnd.vtu","vtu"],["model/vrml",["vrml","wrl","wrz"]],["model/x-pov","pov"],["multipart/x-gzip","gzip"],["multipart/x-ustar","ustar"],["multipart/x-zip","zip"],["music/crescendo",["mid","midi"]],["music/x-karaoke","kar"],["paleovu/x-pv","pvu"],["text/asp","asp"],["text/calendar","ics"],["text/css","css"],["text/csv","csv"],["text/ecmascript","js"],["text/h323","323"],["text/html",["html","htm","stm","acgi","htmls","htx","shtml"]],["text/iuls","uls"],["text/javascript","js"],["text/mcf","mcf"],["text/n3","n3"],["text/pascal","pas"],["text/plain",["txt","bas","c","h","c++","cc","com","conf","cxx","def","f","f90","for","g","hh","idc","jav","java","list","log","lst","m","mar","pl","sdml","text"]],["text/plain-bas","par"],["text/prs.lines.tag","dsc"],["text/richtext",["rtx","rt","rtf"]],["text/scriplet","wsc"],["text/scriptlet","sct"],["text/sgml",["sgm","sgml"]],["text/tab-separated-values","tsv"],["text/troff","t"],["text/turtle","ttl"],["text/uri-list",["uni","unis","uri","uris"]],["text/vnd.abc","abc"],["text/vnd.curl","curl"],["text/vnd.curl.dcurl","dcurl"],["text/vnd.curl.mcurl","mcurl"],["text/vnd.curl.scurl","scurl"],["text/vnd.fly","fly"],["text/vnd.fmi.flexstor","flx"],["text/vnd.graphviz","gv"],["text/vnd.in3d.3dml","3dml"],["text/vnd.in3d.spot","spot"],["text/vnd.rn-realtext","rt"],["text/vnd.sun.j2me.app-descriptor","jad"],["text/vnd.wap.wml","wml"],["text/vnd.wap.wmlscript","wmls"],["text/webviewhtml","htt"],["text/x-asm",["asm","s"]],["text/x-audiosoft-intra","aip"],["text/x-c",["c","cc","cpp"]],["text/x-component","htc"],["text/x-fortran",["for","f","f77","f90"]],["text/x-h",["h","hh"]],["text/x-java-source",["java","jav"]],["text/x-java-source,java","java"],["text/x-la-asf","lsx"],["text/x-m","m"],["text/x-pascal","p"],["text/x-script","hlb"],["text/x-script.csh","csh"],["text/x-script.elisp","el"],["text/x-script.guile","scm"],["text/x-script.ksh","ksh"],["text/x-script.lisp","lsp"],["text/x-script.perl","pl"],["text/x-script.perl-module","pm"],["text/x-script.phyton","py"],["text/x-script.rexx","rexx"],["text/x-script.scheme","scm"],["text/x-script.sh","sh"],["text/x-script.tcl","tcl"],["text/x-script.tcsh","tcsh"],["text/x-script.zsh","zsh"],["text/x-server-parsed-html",["shtml","ssi"]],["text/x-setext","etx"],["text/x-sgml",["sgm","sgml"]],["text/x-speech",["spc","talk"]],["text/x-uil","uil"],["text/x-uuencode",["uu","uue"]],["text/x-vcalendar","vcs"],["text/x-vcard","vcf"],["text/xml","xml"],["video/3gpp","3gp"],["video/3gpp2","3g2"],["video/animaflex","afl"],["video/avi","avi"],["video/avs-video","avs"],["video/dl","dl"],["video/fli","fli"],["video/gl","gl"],["video/h261","h261"],["video/h263","h263"],["video/h264","h264"],["video/jpeg","jpgv"],["video/jpm","jpm"],["video/mj2","mj2"],["video/mp4","mp4"],["video/mpeg",["mpeg","mp2","mpa","mpe","mpg","mpv2","m1v","m2v","mp3"]],["video/msvideo","avi"],["video/ogg","ogv"],["video/quicktime",["mov","qt","moov"]],["video/vdo","vdo"],["video/vivo",["viv","vivo"]],["video/vnd.dece.hd","uvh"],["video/vnd.dece.mobile","uvm"],["video/vnd.dece.pd","uvp"],["video/vnd.dece.sd","uvs"],["video/vnd.dece.video","uvv"],["video/vnd.fvt","fvt"],["video/vnd.mpegurl","mxu"],["video/vnd.ms-playready.media.pyv","pyv"],["video/vnd.rn-realvideo","rv"],["video/vnd.uvvu.mp4","uvu"],["video/vnd.vivo",["viv","vivo"]],["video/vosaic","vos"],["video/webm","webm"],["video/x-amt-demorun","xdr"],["video/x-amt-showrun","xsr"],["video/x-atomic3d-feature","fmf"],["video/x-dl","dl"],["video/x-dv",["dif","dv"]],["video/x-f4v","f4v"],["video/x-fli","fli"],["video/x-flv","flv"],["video/x-gl","gl"],["video/x-isvideo","isu"],["video/x-la-asf",["lsf","lsx"]],["video/x-m4v","m4v"],["video/x-motion-jpeg","mjpg"],["video/x-mpeg",["mp3","mp2"]],["video/x-mpeq2a","mp2"],["video/x-ms-asf",["asf","asr","asx"]],["video/x-ms-asf-plugin","asx"],["video/x-ms-wm","wm"],["video/x-ms-wmv","wmv"],["video/x-ms-wmx","wmx"],["video/x-ms-wvx","wvx"],["video/x-msvideo","avi"],["video/x-qtc","qtc"],["video/x-scm","scm"],["video/x-sgi-movie",["movie","mv"]],["windows/metafile","wmf"],["www/mime","mime"],["x-conference/x-cooltalk","ice"],["x-music/x-midi",["mid","midi"]],["x-world/x-3dmf",["3dm","3dmf","qd3","qd3d"]],["x-world/x-svr","svr"],["x-world/x-vrml",["flr","vrml","wrl","wrz","xaf","xof"]],["x-world/x-vrt","vrt"],["xgl/drawing","xgz"],["xgl/movie","xmz"]]),r=new Map([["123","application/vnd.lotus-1-2-3"],["323","text/h323"],["*","application/octet-stream"],["3dm","x-world/x-3dmf"],["3dmf","x-world/x-3dmf"],["3dml","text/vnd.in3d.3dml"],["3g2","video/3gpp2"],["3gp","video/3gpp"],["7z","application/x-7z-compressed"],["a","application/octet-stream"],["aab","application/x-authorware-bin"],["aac","audio/x-aac"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abc","text/vnd.abc"],["abw","application/x-abiword"],["ac","application/pkix-attr-cert"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acgi","text/html"],["acu","application/vnd.acucobol"],["acx","application/internet-property-stream"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afl","video/animaflex"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/postscript"],["aif",["audio/aiff","audio/x-aiff"]],["aifc",["audio/aiff","audio/x-aiff"]],["aiff",["audio/aiff","audio/x-aiff"]],["aim","application/x-aim"],["aip","text/x-audiosoft-intra"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["ani","application/x-navi-animation"],["aos","application/x-nokia-9000-communicator-add-on-software"],["apk","application/vnd.android.package-archive"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["aps","application/mime"],["arc","application/octet-stream"],["arj",["application/arj","application/octet-stream"]],["art","image/x-jg"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asp","text/asp"],["asr","video/x-ms-asf"],["asx",["video/x-ms-asf","application/x-mplayer2","video/x-ms-asf-plugin"]],["atc","application/vnd.acucorp"],["atomcat","application/atomcat+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au",["audio/basic","audio/x-au"]],["avi",["video/avi","video/msvideo","application/x-troff-msvideo","video/x-msvideo"]],["avs","video/avs-video"],["aw","application/applixware"],["axs","application/olescript"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azw","application/vnd.amazon.ebook"],["bas","text/plain"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin",["application/octet-stream","application/mac-binary","application/macbinary","application/x-macbinary","application/x-binary"]],["bm","image/bmp"],["bmi","application/vnd.bmi"],["bmp",["image/bmp","image/x-windows-bmp"]],["boo","application/book"],["book","application/book"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bsh","application/x-bsh"],["btif","image/prs.btif"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c",["text/plain","text/x-c"]],["c++","text/plain"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["c4g","application/vnd.clonk.c4group"],["cab","application/vnd.ms-cab-compressed"],["car","application/vnd.curl.car"],["cat",["application/vnd.ms-pkiseccat","application/vnd.ms-pki.seccat"]],["cc",["text/plain","text/x-c"]],["ccad","application/clariscad"],["cco","application/x-cocoa"],["ccxml","application/ccxml+xml,"],["cdbcmsg","application/vnd.contact.cmsg"],["cdf",["application/cdf","application/x-cdf","application/x-netcdf"]],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer",["application/pkix-cert","application/x-x509-ca-cert"]],["cgm","image/cgm"],["cha","application/x-chat"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cla","application/vnd.claymore"],["class",["application/octet-stream","application/java","application/java-byte-code","application/java-vm","application/x-java-class"]],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod",["image/cis-cod","application/vnd.rim.cod"]],["com",["application/octet-stream","text/plain"]],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt",["application/mac-compactpro","application/x-compactpro","application/x-cpt"]],["crd","application/x-mscardfile"],["crl",["application/pkix-crl","application/pkcs-crl"]],["crt",["application/pkix-cert","application/x-x509-user-cert","application/x-x509-ca-cert"]],["cryptonote","application/vnd.rig.cryptonote"],["csh",["text/x-script.csh","application/x-csh"]],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["css",["text/css","application/x-pointplus"]],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxx","text/plain"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["davmount","application/davmount+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["deb","application/x-debian-package"],["deepv","application/x-deepv"],["def","text/plain"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dif","video/x-dv"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["djvu","image/vnd.djvu"],["dl",["video/dl","video/x-dl"]],["dll","application/x-msdownload"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.document.macroenabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroenabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp",["application/commonground","application/vnd.osgi.dp"]],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drw","application/drafting"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dv","video/x-dv"],["dvi","application/x-dvi"],["dwf",["model/vnd.dwf","drawing/x-dwf"]],["dwg",["application/acad","image/vnd.dwg","image/x-dwg"]],["dxf",["application/dxf","image/vnd.dwg","image/vnd.dxf","image/x-dwg"]],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["el","text/x-script.elisp"],["elc",["application/x-elc","application/x-bytecode.elisp"]],["eml","message/rfc822"],["emma","application/emma+xml"],["env","application/x-envoy"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es",["application/ecmascript","application/x-esrehber"]],["es3","application/vnd.eszigno3+xml"],["esf","application/vnd.epson.esf"],["etx","text/x-setext"],["evy",["application/envoy","application/x-envoy"]],["exe",["application/octet-stream","application/x-msdownload"]],["exi","application/exi"],["ext","application/vnd.novadigm.ext"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f",["text/plain","text/x-fortran"]],["f4v","video/x-f4v"],["f77","text/x-fortran"],["f90",["text/plain","text/x-fortran"]],["fbs","image/vnd.fastbidsheet"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fh","image/x-freehand"],["fif",["application/fractals","image/fif"]],["fig","application/x-xfig"],["fli",["video/fli","video/x-fli"]],["flo",["image/florian","application/vnd.micrografx.flo"]],["flr","x-world/x-vrml"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fmf","video/x-atomic3d-feature"],["fnc","application/vnd.frogans.fnc"],["for",["text/plain","text/x-fortran"]],["fpx",["image/vnd.fpx","image/vnd.net-fpx"]],["frl","application/freeloader"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["funk","audio/make"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g","text/plain"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gdl","model/vnd.gdl"],["geo","application/vnd.dynageo"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["gl",["video/gl","video/x-gl"]],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gph","application/vnd.flographit"],["gqf","application/vnd.grafeq"],["gram","application/srgs"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsd","audio/x-gsm"],["gsf","application/x-font-ghostscript"],["gsm","audio/x-gsm"],["gsp","application/x-gsp"],["gss","application/x-gss"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxt","application/vnd.geonext"],["gz",["application/x-gzip","application/x-compressed"]],["gzip",["multipart/x-gzip","application/x-gzip"]],["h",["text/plain","text/x-h"]],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hdf","application/x-hdf"],["help","application/x-helpfile"],["hgl","application/vnd.hp-hpgl"],["hh",["text/plain","text/x-h"]],["hlb","text/x-script"],["hlp",["application/winhlp","application/hlp","application/x-helpfile","application/x-winhelp"]],["hpg","application/vnd.hp-hpgl"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx",["application/mac-binhex40","application/binhex","application/binhex4","application/mac-binhex","application/x-binhex40","application/x-mac-binhex40"]],["hta","application/hta"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["htmls","text/html"],["htt","text/webviewhtml"],["htx","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["ico","image/x-icon"],["ics","text/calendar"],["idc","text/plain"],["ief","image/ief"],["iefs","image/ief"],["ifm","application/vnd.shana.informed.formdata"],["iges",["application/iges","model/iges"]],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs",["application/iges","model/iges"]],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["iii","application/x-iphone"],["ima","application/x-ima"],["imap","application/x-httpd-imap"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["inf","application/inf"],["ins",["application/x-internet-signup","application/x-internett-signup"]],["ip","application/x-ip2"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["isp","application/x-internet-signup"],["isu","video/x-isvideo"],["it","audio/it"],["itp","application/vnd.shana.informed.formtemplate"],["iv","application/x-inventor"],["ivp","application/vnd.immervision-ivp"],["ivr","i-world/i-vrml"],["ivu","application/vnd.immervision-ivu"],["ivy","application/x-livescreen"],["jad","text/vnd.sun.j2me.app-descriptor"],["jam",["application/vnd.jam","audio/x-jam"]],["jar","application/java-archive"],["jav",["text/plain","text/x-java-source"]],["java",["text/plain","text/x-java-source,java","text/x-java-source"]],["jcm","application/x-java-commerce"],["jfif",["image/pipeg","image/jpeg","image/pjpeg"]],["jfif-tbnl","image/jpeg"],["jisp","application/vnd.jisp"],["jlt","application/vnd.hp-jlyt"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jpe",["image/jpeg","image/pjpeg"]],["jpeg",["image/jpeg","image/pjpeg"]],["jpg",["image/jpeg","image/pjpeg"]],["jpgv","video/jpeg"],["jpm","video/jpm"],["jps","image/x-jps"],["js",["application/javascript","application/ecmascript","text/javascript","text/ecmascript","application/x-javascript"]],["json","application/json"],["jut","image/jutvision"],["kar",["audio/midi","music/x-karaoke"]],["karbon","application/vnd.kde.karbon"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["ksh",["application/x-ksh","text/x-script.ksh"]],["ksp","application/vnd.kde.kspread"],["ktx","image/ktx"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["la",["audio/nspaudio","audio/x-nspaudio"]],["lam","audio/x-liveaudio"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["lha",["application/octet-stream","application/lha","application/x-lha"]],["lhx","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["lma",["audio/nspaudio","audio/x-nspaudio"]],["log","text/plain"],["lrm","application/vnd.ms-lrm"],["lsf","video/x-la-asf"],["lsp",["application/x-lisp","text/x-script.lisp"]],["lst","text/plain"],["lsx",["video/x-la-asf","text/x-la-asf"]],["ltf","application/vnd.frogans.ltf"],["ltx","application/x-latex"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh",["application/octet-stream","application/x-lzh"]],["lzx",["application/lzx","application/octet-stream","application/x-lzx"]],["m",["text/plain","text/x-m"]],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m1v","video/mpeg"],["m21","application/mp21"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3u",["audio/x-mpegurl","audio/x-mpequrl"]],["m3u8","application/vnd.apple.mpegurl"],["m4v","video/x-m4v"],["ma","application/mathematica"],["mads","application/mads+xml"],["mag","application/vnd.ecowin.chart"],["man","application/x-troff-man"],["map","application/x-navimap"],["mar","text/plain"],["mathml","application/mathml+xml"],["mbd","application/mbedlet"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc$","application/x-magic-cap-package-1.0"],["mc1","application/vnd.medcalcdata"],["mcd",["application/mcad","application/vnd.mcd","application/x-mathcad"]],["mcf",["image/vasa","text/mcf"]],["mcp","application/netmc"],["mcurl","text/vnd.curl.mcurl"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["me","application/x-troff-me"],["meta4","application/metalink4+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mht","message/rfc822"],["mhtml","message/rfc822"],["mid",["audio/mid","audio/midi","music/crescendo","x-music/x-midi","audio/x-midi","application/x-midi","audio/x-mid"]],["midi",["audio/midi","music/crescendo","x-music/x-midi","audio/x-midi","application/x-midi","audio/x-mid"]],["mif",["application/vnd.mif","application/x-mif","application/x-frame"]],["mime",["message/rfc822","www/mime"]],["mj2","video/mj2"],["mjf","audio/x-vnd.audioexplosion.mjuicemediafile"],["mjpg","video/x-motion-jpeg"],["mlp","application/vnd.dolby.mlp"],["mm",["application/base64","application/x-meme"]],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mme","application/base64"],["mmf","application/vnd.smaf"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mny","application/x-msmoney"],["mod",["audio/mod","audio/x-mod"]],["mods","application/mods+xml"],["moov","video/quicktime"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2",["video/mpeg","audio/mpeg","video/x-mpeg","audio/x-mpeg","video/x-mpeq2a"]],["mp3",["audio/mpeg","audio/mpeg3","video/mpeg","audio/x-mpeg-3","video/x-mpeg"]],["mp4",["video/mp4","application/mp4"]],["mp4a","audio/mp4"],["mpa",["video/mpeg","audio/mpeg"]],["mpc",["application/vnd.mophun.certificate","application/x-project"]],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg",["video/mpeg","audio/mpeg"]],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/x-project"],["mpv","application/x-project"],["mpv2","video/mpeg"],["mpx","application/x-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","application/x-troff-ms"],["mscml","application/mediaservercontrol+xml"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msl","application/vnd.mobius.msl"],["msty","application/vnd.muvee.style"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musicxml","application/vnd.recordare.musicxml+xml"],["mv","video/x-sgi-movie"],["mvb","application/x-msmediaview"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["my","audio/make"],["mzz","application/x-vnd.audioexplosion.mzz"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nap","image/naplps"],["naplps","image/naplps"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncm","application/vnd.nokia.configuration-message"],["ncx","application/x-dtbncx+xml"],["ngdat","application/vnd.nokia.n-gage.data"],["nif","image/x-niff"],["niff","image/x-niff"],["nix","application/x-mix-transfer"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nvd","application/x-navidoc"],["nws","message/rfc822"],["o","application/octet-stream"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omc","application/x-omc"],["omcd","application/x-omcdatamaker"],["omcr","application/x-omcregerator"],["onetoc","application/onenote"],["opf","application/oebps-package+xml"],["org","application/vnd.lotus-organizer"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","application/x-font-otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p10",["application/pkcs10","application/x-pkcs10"]],["p12",["application/pkcs-12","application/x-pkcs12"]],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c",["application/pkcs7-mime","application/x-pkcs7-mime"]],["p7m",["application/pkcs7-mime","application/x-pkcs7-mime"]],["p7r","application/x-pkcs7-certreqresp"],["p7s",["application/pkcs7-signature","application/x-pkcs7-signature"]],["p8","application/pkcs8"],["par","text/plain-bas"],["part","application/pro_eng"],["pas","text/pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcf","application/x-font-pcf"],["pcl",["application/vnd.hp-pcl","application/x-pcl"]],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb",["application/vnd.palm","chemical/x-pdb"]],["pdf","application/pdf"],["pfa","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfunk",["audio/make","audio/make.my.funk"]],["pfx","application/x-pkcs12"],["pgm",["image/x-portable-graymap","image/x-portable-greymap"]],["pgn","application/x-chess-pgn"],["pgp","application/pgp-signature"],["pic",["image/pict","image/x-pict"]],["pict","image/pict"],["pkg","application/x-newton-compatible-pkg"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pko",["application/ynd.ms-pkipko","application/vnd.ms-pki.pko"]],["pl",["text/plain","text/x-script.perl"]],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["plx","application/x-pixclscript"],["pm",["text/x-script.perl-module","image/x-xpixmap"]],["pm4","application/x-pagemaker"],["pm5","application/x-pagemaker"],["pma","application/x-perfmon"],["pmc","application/x-perfmon"],["pml",["application/vnd.ctc-posml","application/x-perfmon"]],["pmr","application/x-perfmon"],["pmw","application/x-perfmon"],["png","image/png"],["pnm",["application/x-portable-anymap","image/x-portable-anymap"]],["portpkg","application/vnd.macports.portpkg"],["pot",["application/vnd.ms-powerpoint","application/mspowerpoint"]],["potm","application/vnd.ms-powerpoint.template.macroenabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["pov","model/x-pov"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroenabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps",["application/vnd.ms-powerpoint","application/mspowerpoint"]],["ppsm","application/vnd.ms-powerpoint.slideshow.macroenabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt",["application/vnd.ms-powerpoint","application/mspowerpoint","application/powerpoint","application/x-mspowerpoint"]],["pptm","application/vnd.ms-powerpoint.presentation.macroenabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["ppz","application/mspowerpoint"],["prc","application/x-mobipocket-ebook"],["pre",["application/vnd.lotus-freelance","application/x-freelance"]],["prf","application/pics-rules"],["prt","application/pro_eng"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd",["application/octet-stream","image/vnd.adobe.photoshop"]],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pvu","paleovu/x-pv"],["pwn","application/vnd.3m.post-it-notes"],["pwz","application/vnd.ms-powerpoint"],["py","text/x-script.phyton"],["pya","audio/vnd.ms-playready.media.pya"],["pyc","application/x-bytecode.python"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qcp","audio/vnd.qcelp"],["qd3","x-world/x-3dmf"],["qd3d","x-world/x-3dmf"],["qfx","application/vnd.intu.qfx"],["qif","image/x-quicktime"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qtc","video/x-qtc"],["qti","image/x-quicktime"],["qtif","image/x-quicktime"],["qxd","application/vnd.quark.quarkxpress"],["ra",["audio/x-realaudio","audio/x-pn-realaudio","audio/x-pn-realaudio-plugin"]],["ram","audio/x-pn-realaudio"],["rar","application/x-rar-compressed"],["ras",["image/cmu-raster","application/x-cmu-raster","image/x-cmu-raster"]],["rast","image/cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rexx","text/x-script.rexx"],["rf","image/vnd.rn-realflash"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm",["application/vnd.rn-realmedia","audio/x-pn-realaudio"]],["rmi","audio/mid"],["rmm","audio/x-pn-realaudio"],["rmp",["audio/x-pn-realaudio-plugin","audio/x-pn-realaudio"]],["rms","application/vnd.jcp.javame.midlet-rms"],["rnc","application/relax-ng-compact-syntax"],["rng",["application/ringing-tones","application/vnd.nokia.ringing-tone"]],["rnx","application/vnd.rn-realplayer"],["roff","application/x-troff"],["rp","image/vnd.rn-realpix"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsd","application/rsd+xml"],["rt",["text/richtext","text/vnd.rn-realtext"]],["rtf",["application/rtf","text/richtext","application/x-rtf"]],["rtx",["text/richtext","application/rtf"]],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["saveme","application/octet-stream"],["sbk","application/x-tbook"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm",["application/vnd.lotus-screencam","video/x-scm","text/x-script.guile","application/x-lotusscreencam","text/x-script.scheme"]],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["sct","text/scriptlet"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkm","application/vnd.solent.sdkm+xml"],["sdml","text/plain"],["sdp",["application/sdp","application/x-sdp"]],["sdr","application/sounder"],["sdw","application/vnd.stardivision.writer"],["sea",["application/sea","application/x-sea"]],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["ser","application/java-serialized-object"],["set","application/set"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sgl","application/vnd.stardivision.writer-global"],["sgm",["text/sgml","text/x-sgml"]],["sgml",["text/sgml","text/x-sgml"]],["sh",["application/x-shar","application/x-bsh","application/x-sh","text/x-script.sh"]],["shar",["application/x-bsh","application/x-shar"]],["shf","application/shf+xml"],["shtml",["text/html","text/x-server-parsed-html"]],["sid","audio/x-psid"],["sis","application/vnd.symbian.install"],["sit",["application/x-stuffit","application/x-sit"]],["sitx","application/x-stuffitx"],["skd","application/x-koan"],["skm","application/x-koan"],["skp",["application/vnd.koan","application/x-koan"]],["skt","application/x-koan"],["sl","application/x-seelogo"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi",["application/smil","application/smil+xml"]],["smil","application/smil"],["snd",["audio/basic","audio/x-adpcm"]],["snf","application/x-font-snf"],["sol","application/solids"],["spc",["text/x-speech","application/x-pkcs7-certificates"]],["spf","application/vnd.yamaha.smaf-phrase"],["spl",["application/futuresplash","application/x-futuresplash"]],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spr","application/x-sprite"],["sprite","application/x-sprite"],["src","application/x-wais-source"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssi","text/x-server-parsed-html"],["ssm","application/streamingmedia"],["ssml","application/ssml+xml"],["sst",["application/vnd.ms-pkicertstore","application/vnd.ms-pki.certstore"]],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["step","application/step"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl",["application/vnd.ms-pkistl","application/sla","application/vnd.ms-pki.stl","application/x-navistyle"]],["stm","text/html"],["stp","application/step"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["sub","image/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svf",["image/vnd.dwg","image/x-dwg"]],["svg","image/svg+xml"],["svr",["x-world/x-svr","application/x-world"]],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t",["text/troff","application/x-troff"]],["talk","text/x-speech"],["tao","application/vnd.tao.intent-module-archive"],["tar","application/x-tar"],["tbk",["application/toolbook","application/x-tbook"]],["tcap","application/vnd.3gpp2.tcap"],["tcl",["text/x-script.tcl","application/x-tcl"]],["tcsh","text/x-script.tcsh"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text",["application/plain","text/plain"]],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tgz",["application/gnutar","application/x-compressed"]],["thmx","application/vnd.ms-officetheme"],["tif",["image/tiff","image/x-tiff"]],["tiff",["image/tiff","image/x-tiff"]],["tmo","application/vnd.tmobile-livetv"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","application/x-troff"],["tra","application/vnd.trueapp"],["trm","application/x-msterminal"],["tsd","application/timestamped-data"],["tsi","audio/tsp-audio"],["tsp",["application/dsptype","audio/tsplayer"]],["tsv","text/tab-separated-values"],["ttf","application/x-font-ttf"],["ttl","text/turtle"],["turbot","image/florian"],["twd","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["ufd","application/vnd.ufdl"],["uil","text/x-uil"],["uls","text/iuls"],["umj","application/vnd.umajin"],["uni","text/uri-list"],["unis","text/uri-list"],["unityweb","application/vnd.unity"],["unv","application/i-deas"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["ustar",["application/x-ustar","multipart/x-ustar"]],["utz","application/vnd.uiq.theme"],["uu",["application/octet-stream","text/x-uuencode"]],["uue","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vda","application/vda"],["vdo","video/vdo"],["vew","application/groupwise"],["vis","application/vnd.visionary"],["viv",["video/vivo","video/vnd.vivo"]],["vivo",["video/vivo","video/vnd.vivo"]],["vmd","application/vocaltec-media-desc"],["vmf","application/vocaltec-media-file"],["voc",["audio/voc","audio/x-voc"]],["vos","video/vosaic"],["vox","audio/voxware"],["vqe","audio/x-twinvq-plugin"],["vqf","audio/x-twinvq"],["vql","audio/x-twinvq-plugin"],["vrml",["model/vrml","x-world/x-vrml","application/x-vrml"]],["vrt","x-world/x-vrt"],["vsd",["application/vnd.visio","application/x-visio"]],["vsf","application/vnd.vsf"],["vst","application/x-visio"],["vsw","application/x-visio"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w60","application/wordperfect6.0"],["w61","application/wordperfect6.1"],["w6w","application/msword"],["wad","application/x-doom"],["wav",["audio/wav","audio/x-wav"]],["wax","audio/x-ms-wax"],["wb1","application/x-qpro"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/vnd.wap.wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["web","application/vnd.xara"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wiz","application/msword"],["wk1","application/x-123"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf",["windows/metafile","application/x-msmetafile"]],["wml","text/vnd.wap.wml"],["wmlc","application/vnd.wap.wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-ms-wmz"],["woff","application/x-font-woff"],["word","application/msword"],["wp","application/wordperfect"],["wp5",["application/wordperfect","application/wordperfect6.0"]],["wp6","application/wordperfect"],["wpd",["application/wordperfect","application/vnd.wordperfect","application/x-wpwin"]],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wq1","application/x-lotus"],["wqd","application/vnd.wqd"],["wri",["application/mswrite","application/x-wri","application/x-mswrite"]],["wrl",["model/vrml","x-world/x-vrml","application/x-world"]],["wrz",["model/vrml","x-world/x-vrml"]],["wsc","text/scriplet"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wsrc","application/x-wais-source"],["wtb","application/vnd.webturbo"],["wtk","application/x-wintalk"],["wvx","video/x-ms-wvx"],["x-png","image/png"],["x3d","application/vnd.hzn-3d-crossword"],["xaf","x-world/x-vrml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm",["image/xbm","image/x-xbm","image/x-xbitmap"]],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdr","video/x-amt-demorun"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xgz","xgl/drawing"],["xhtml","application/xhtml+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xlam","application/vnd.ms-excel.addin.macroenabled.12"],["xlb",["application/excel","application/vnd.ms-excel","application/x-excel"]],["xlc",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xld",["application/excel","application/x-excel"]],["xlk",["application/excel","application/x-excel"]],["xll",["application/excel","application/vnd.ms-excel","application/x-excel"]],["xlm",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xls",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xlsb","application/vnd.ms-excel.sheet.binary.macroenabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroenabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xltm","application/vnd.ms-excel.template.macroenabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlv",["application/excel","application/x-excel"]],["xlw",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xm","audio/xm"],["xml",["application/xml","text/xml","application/atom+xml","application/rss+xml"]],["xmz","xgl/movie"],["xo","application/vnd.olpc-sugar"],["xof","x-world/x-vrml"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpix","application/x-vnd.ls-xpix"],["xpm",["image/xpm","image/x-xpixmap"]],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xsr","video/x-amt-showrun"],["xul","application/vnd.mozilla.xul+xml"],["xwd",["image/x-xwd","image/x-xwindowdump"]],["xyz",["chemical/x-xyz","chemical/x-pdb"]],["yang","application/yang"],["yin","application/yin+xml"],["z",["application/x-compressed","application/x-compress"]],["zaz","application/vnd.zzazz.deck+xml"],["zip",["application/zip","multipart/x-zip","application/x-zip-compressed","application/x-compressed"]],["zir","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zoo","application/octet-stream"],["zsh","text/x-script.zsh"]]);e.exports={detectMimeType(e){if(!e)return n;let t=s.parse(e),i=(t.ext.substr(1)||t.name||"").split("?").shift().trim().toLowerCase(),a=n;return r.has(i)&&(a=r.get(i)),Array.isArray(a)?a[0]:a},detectExtension(e){if(!e)return"bin";let t=(e||"").toLowerCase().trim().split("/"),i=t.shift().trim(),s=t.join("/").trim();if(a.has(i+"/"+s)){let e=a.get(i+"/"+s);return Array.isArray(e)?e[0]:e}return"text"===i?"txt":"bin"}}},7326:(e,t,i)=>{"use strict";const s=i(6113),n=i(7147),a=i(5477),r=i(2781).PassThrough,o=i(4938),c=i(2641),l=i(4507),p=i(5108),d=i(424),h=i(338),u=i(0),g=i(3343),v=i(3701);class MimeNode{constructor(e,t){this.nodeCounter=0,t=t||{},this.baseBoundary=t.baseBoundary||s.randomBytes(8).toString("hex"),this.boundaryPrefix=t.boundaryPrefix||"--_NmP",this.disableFileAccess=!!t.disableFileAccess,this.disableUrlAccess=!!t.disableUrlAccess,this.normalizeHeaderKey=t.normalizeHeaderKey,this.date=new Date,this.rootNode=t.rootNode||this,this.keepBcc=!!t.keepBcc,t.filename&&(this.filename=t.filename,e||(e=c.detectMimeType(this.filename.split(".").pop()))),this.textEncoding=(t.textEncoding||"").toString().trim().charAt(0).toUpperCase(),this.parentNode=t.parentNode,this.hostname=t.hostname,this.newline=t.newline,this.childNodes=[],this._nodeId=++this.rootNode.nodeCounter,this._headers=[],this._isPlainText=!1,this._hasLongLines=!1,this._envelope=!1,this._raw=!1,this._transforms=[],this._processFuncs=[],e&&this.setHeader("Content-Type",e)}createChild(e,t){t||"object"!=typeof e||(t=e,e=void 0);let i=new MimeNode(e,t);return this.appendChild(i),i}appendChild(e){return e.rootNode!==this.rootNode&&(e.rootNode=this.rootNode,e._nodeId=++this.rootNode.nodeCounter),e.parentNode=this,this.childNodes.push(e),e}replace(e){return e===this?this:(this.parentNode.childNodes.forEach(((t,i)=>{t===this&&(e.rootNode=this.rootNode,e.parentNode=this.parentNode,e._nodeId=this._nodeId,this.rootNode=this,this.parentNode=void 0,e.parentNode.childNodes[i]=e)})),e)}remove(){if(!this.parentNode)return this;for(let e=this.parentNode.childNodes.length-1;e>=0;e--)if(this.parentNode.childNodes[e]===this)return this.parentNode.childNodes.splice(e,1),this.parentNode=void 0,this.rootNode=this,this}setHeader(e,t){let i,s=!1;if(!t&&e&&"object"==typeof e)return e.key&&"value"in e?this.setHeader(e.key,e.value):Array.isArray(e)?e.forEach((e=>{this.setHeader(e.key,e.value)})):Object.keys(e).forEach((t=>{this.setHeader(t,e[t])})),this;i={key:e=this._normalizeHeaderKey(e),value:t};for(let t=0,n=this._headers.length;t<n;t++)this._headers[t].key===e&&(s?(this._headers.splice(t,1),t--,n--):(this._headers[t]=i,s=!0));return s||this._headers.push(i),this}addHeader(e,t){return!t&&e&&"object"==typeof e?(e.key&&e.value?this.addHeader(e.key,e.value):Array.isArray(e)?e.forEach((e=>{this.addHeader(e.key,e.value)})):Object.keys(e).forEach((t=>{this.addHeader(t,e[t])})),this):Array.isArray(t)?(t.forEach((t=>{this.addHeader(e,t)})),this):(this._headers.push({key:this._normalizeHeaderKey(e),value:t}),this)}getHeader(e){e=this._normalizeHeaderKey(e);for(let t=0,i=this._headers.length;t<i;t++)if(this._headers[t].key===e)return this._headers[t].value}setContent(e){return this.content=e,"function"==typeof this.content.pipe?(this._contentErrorHandler=e=>{this.content.removeListener("error",this._contentErrorHandler),this.content=e},this.content.once("error",this._contentErrorHandler)):"string"==typeof this.content&&(this._isPlainText=c.isPlainText(this.content),this._isPlainText&&c.hasLongerLines(this.content,76)&&(this._hasLongLines=!0)),this}build(e){let t;e||(t=new Promise(((t,i)=>{e=o.callbackPromise(t,i)})));let i=this.createReadStream(),s=[],n=0,a=!1;return i.on("readable",(()=>{let e;for(;null!==(e=i.read());)s.push(e),n+=e.length})),i.once("error",(t=>{if(!a)return a=!0,e(t)})),i.once("end",(t=>{if(!a)return a=!0,t&&t.length&&(s.push(t),n+=t.length),e(null,Buffer.concat(s,n))})),t}getTransferEncoding(){let e=!1,t=(this.getHeader("Content-Type")||"").toString().toLowerCase().trim();return this.content&&(e=(this.getHeader("Content-Transfer-Encoding")||"").toString().toLowerCase().trim(),e&&["base64","quoted-printable"].includes(e)||(/^text\//i.test(t)?e=this._isPlainText&&!this._hasLongLines?"7bit":"string"==typeof this.content||this.content instanceof Buffer?"Q"===this._getTextEncoding(this.content)?"quoted-printable":"base64":"B"===this.textEncoding?"base64":"quoted-printable":/^(multipart|message)\//i.test(t)||(e=e||"base64"))),e}buildHeaders(){let e=this.getTransferEncoding(),t=[];return e&&this.setHeader("Content-Transfer-Encoding",e),this.filename&&!this.getHeader("Content-Disposition")&&this.setHeader("Content-Disposition","attachment"),this.rootNode===this&&(this.getHeader("Date")||this.setHeader("Date",this.date.toUTCString().replace(/GMT/,"+0000")),this.messageId(),this.getHeader("MIME-Version")||this.setHeader("MIME-Version","1.0")),this._headers.forEach((e=>{let i,s,n=e.key,a=e.value,r={};if(!a||"object"!=typeof a||["From","Sender","To","Cc","Bcc","Reply-To","Date","References"].includes(n)||(Object.keys(a).forEach((e=>{"value"!==e&&(r[e]=a[e])})),a=(a.value||"").toString(),a.trim()))if(r.prepared)r.foldLines?t.push(c.foldLines(n+": "+a)):t.push(n+": "+a);else{switch(e.key){case"Content-Disposition":i=c.parseHeaderValue(a),this.filename&&(i.params.filename=this.filename),a=c.buildHeaderValue(i);break;case"Content-Type":i=c.parseHeaderValue(a),this._handleContentType(i),i.value.match(/^text\/plain\b/)&&"string"==typeof this.content&&/[\u0080-\uFFFF]/.test(this.content)&&(i.params.charset="utf-8"),a=c.buildHeaderValue(i),this.filename&&(s=this._encodeWords(this.filename),(s!==this.filename||/[\s'"\\;:/=(),<>@[\]?]|^-/.test(s))&&(s='"'+s+'"'),a+="; name="+s);break;case"Bcc":if(!this.keepBcc)return}if(a=this._encodeHeaderValue(n,a),(a||"").toString().trim()){if("function"==typeof this.normalizeHeaderKey){let e=this.normalizeHeaderKey(n,a);e&&"string"==typeof e&&e.length&&(n=e)}t.push(c.foldLines(n+": "+a,76))}}})),t.join("\r\n")}createReadStream(e){let t,i=new r(e=e||{}),s=i;this.stream(i,e,(e=>{e?s.emit("error",e):i.end()}));for(let e=0,i=this._transforms.length;e<i;e++)t="function"==typeof this._transforms[e]?this._transforms[e]():this._transforms[e],s.once("error",(e=>{t.emit("error",e)})),s=s.pipe(t);t=new u,s.once("error",(e=>{t.emit("error",e)})),s=s.pipe(t);for(let e=0,i=this._processFuncs.length;e<i;e++)t=this._processFuncs[e],s=t(s);if(this.newline){const e=["win","windows","dos","\r\n"].includes(this.newline.toString().toLowerCase())?new g:new v,t=s.pipe(e);return s.on("error",(e=>t.emit("error",e))),t}return s}transform(e){this._transforms.push(e)}processFunc(e){this._processFuncs.push(e)}stream(e,t,i){let s,n,a=this.getTransferEncoding(),r=!1,callback=e=>{r||(r=!0,i(e))},finalize=()=>{let i=0,processChildNode=()=>{if(i>=this.childNodes.length)return e.write("\r\n--"+this.boundary+"--\r\n"),callback();let s=this.childNodes[i++];e.write((i>1?"\r\n":"")+"--"+this.boundary+"\r\n"),s.stream(e,t,(e=>{if(e)return callback(e);setImmediate(processChildNode)}))};if(!this.multipart)return callback();setImmediate(processChildNode)},sendContent=()=>{if(!this.content)return setImmediate(finalize);{if("[object Error]"===Object.prototype.toString.call(this.content))return callback(this.content);"function"==typeof this.content.pipe&&(this.content.removeListener("error",this._contentErrorHandler),this._contentErrorHandler=e=>callback(e),this.content.once("error",this._contentErrorHandler));let createStream=()=>{["quoted-printable","base64"].includes(a)?(s=new("base64"===a?p:l).Encoder(t),s.pipe(e,{end:!1}),s.once("end",finalize),s.once("error",(e=>callback(e))),n=this._getStream(this.content),n.pipe(s)):(n=this._getStream(this.content),n.pipe(e,{end:!1}),n.once("end",finalize)),n.once("error",(e=>callback(e)))};if(this.content._resolve){let e=[],t=0,i=!1,s=this._getStream(this.content);s.on("error",(e=>{i||(i=!0,callback(e))})),s.on("readable",(()=>{let i;for(;null!==(i=s.read());)e.push(i),t+=i.length})),s.on("end",(()=>{i||(i=!0,this.content._resolve=!1,this.content._resolvedValue=Buffer.concat(e,t),setImmediate(createStream))}))}else setImmediate(createStream)}};this._raw?setImmediate((()=>{if("[object Error]"===Object.prototype.toString.call(this._raw))return callback(this._raw);"function"==typeof this._raw.pipe&&this._raw.removeListener("error",this._contentErrorHandler);let t=this._getStream(this._raw);t.pipe(e,{end:!1}),t.on("error",(t=>e.emit("error",t))),t.on("end",finalize)})):(e.write(this.buildHeaders()+"\r\n\r\n"),setImmediate(sendContent))}setEnvelope(e){let t;this._envelope={from:!1,to:[]},e.from&&(t=[],this._convertAddresses(this._parseAddresses(e.from),t),t=t.filter((e=>e&&e.address)),t.length&&t[0]&&(this._envelope.from=t[0].address)),["to","cc","bcc"].forEach((t=>{e[t]&&this._convertAddresses(this._parseAddresses(e[t]),this._envelope.to)})),this._envelope.to=this._envelope.to.map((e=>e.address)).filter((e=>e));let i=["to","cc","bcc","from"];return Object.keys(e).forEach((t=>{i.includes(t)||(this._envelope[t]=e[t])})),this}getAddresses(){let e={};return this._headers.forEach((t=>{let i=t.key.toLowerCase();["from","sender","reply-to","to","cc","bcc"].includes(i)&&(Array.isArray(e[i])||(e[i]=[]),this._convertAddresses(this._parseAddresses(t.value),e[i]))})),e}getEnvelope(){if(this._envelope)return this._envelope;let e={from:!1,to:[]};return this._headers.forEach((t=>{let i=[];"From"===t.key||!e.from&&["Reply-To","Sender"].includes(t.key)?(this._convertAddresses(this._parseAddresses(t.value),i),i.length&&i[0]&&(e.from=i[0].address)):["To","Cc","Bcc"].includes(t.key)&&this._convertAddresses(this._parseAddresses(t.value),e.to)})),e.to=e.to.map((e=>e.address)),e}messageId(){let e=this.getHeader("Message-ID");return e||(e=this._generateMessageId(),this.setHeader("Message-ID",e)),e}setRaw(e){return this._raw=e,this._raw&&"function"==typeof this._raw.pipe&&(this._contentErrorHandler=e=>{this._raw.removeListener("error",this._contentErrorHandler),this._raw=e},this._raw.once("error",this._contentErrorHandler)),this}_getStream(e){let t;return e._resolvedValue?(t=new r,setImmediate((()=>t.end(e._resolvedValue))),t):"function"==typeof e.pipe?e:e&&"string"==typeof e.path&&!e.href?this.disableFileAccess?(t=new r,setImmediate((()=>t.emit("error",new Error("File access rejected for "+e.path)))),t):n.createReadStream(e.path):e&&"string"==typeof e.href?this.disableUrlAccess?(t=new r,setImmediate((()=>t.emit("error",new Error("Url access rejected for "+e.href)))),t):h(e.href,{headers:e.httpHeaders}):(t=new r,setImmediate((()=>t.end(e||""))),t)}_parseAddresses(e){return[].concat.apply([],[].concat(e).map((e=>e&&e.address?(e.address=this._normalizeAddress(e.address),e.name=e.name||"",[e]):d(e))))}_normalizeHeaderKey(e){return e=(e||"").toString().replace(/\r?\n|\r/g," ").trim().toLowerCase().replace(/^X-SMTPAPI$|^(MIME|DKIM|ARC|BIMI)\b|^[a-z]|-(SPF|FBL|ID|MD5)$|-[a-z]/gi,(e=>e.toUpperCase())).replace(/^Content-Features$/i,"Content-features")}_handleContentType(e){this.contentType=e.value.trim().toLowerCase(),this.multipart=!!/^multipart\//i.test(this.contentType)&&this.contentType.substr(this.contentType.indexOf("/")+1),this.multipart?this.boundary=e.params.boundary=e.params.boundary||this.boundary||this._generateBoundary():this.boundary=!1}_generateBoundary(){return this.rootNode.boundaryPrefix+"-"+this.rootNode.baseBoundary+"-Part_"+this._nodeId}_encodeHeaderValue(e,t){switch(e=this._normalizeHeaderKey(e)){case"From":case"Sender":case"To":case"Cc":case"Bcc":case"Reply-To":return this._convertAddresses(this._parseAddresses(t));case"Message-ID":case"In-Reply-To":case"Content-Id":return"<"!==(t=(t||"").toString().replace(/\r?\n|\r/g," ")).charAt(0)&&(t="<"+t),">"!==t.charAt(t.length-1)&&(t+=">"),t;case"References":return(t=[].concat.apply([],[].concat(t||"").map((e=>(e=(e||"").toString().replace(/\r?\n|\r/g," ").trim()).replace(/<[^>]*>/g,(e=>e.replace(/\s/g,""))).split(/\s+/)))).map((e=>("<"!==e.charAt(0)&&(e="<"+e),">"!==e.charAt(e.length-1)&&(e+=">"),e)))).join(" ").trim();case"Date":return"[object Date]"===Object.prototype.toString.call(t)?t.toUTCString().replace(/GMT/,"+0000"):(t=(t||"").toString().replace(/\r?\n|\r/g," "),this._encodeWords(t));case"Content-Type":case"Content-Disposition":return(t||"").toString().replace(/\r?\n|\r/g," ");default:return t=(t||"").toString().replace(/\r?\n|\r/g," "),this._encodeWords(t)}}_convertAddresses(e,t){let i=[];return t=t||[],[].concat(e||[]).forEach((e=>{if(e.address)e.address=this._normalizeAddress(e.address),e.name?e.name&&i.push(`${this._encodeAddressName(e.name)} <${e.address}>`):i.push(e.address.indexOf(" ")>=0?`<${e.address}>`:`${e.address}`),e.address&&(t.filter((t=>t.address===e.address)).length||t.push(e));else if(e.group){let s=(e.group.length?this._convertAddresses(e.group,t):"").trim();i.push(`${this._encodeAddressName(e.name)}:${s};`)}})),i.join(", ")}_normalizeAddress(e){let t=(e=(e||"").toString().replace(/[\x00-\x1F<>]+/g," ").trim()).lastIndexOf("@");if(t<0)return e;let i,s=e.substr(0,t),n=e.substr(t+1);try{i=a.toASCII(n.toLowerCase())}catch(e){}return s.indexOf(" ")>=0&&('"'!==s.charAt(0)&&(s='"'+s),'"'!==s.substr(-1)&&(s+='"')),`${s}@${i}`}_encodeAddressName(e){return/^[\w ']*$/.test(e)?e:/^[\x20-\x7e]*$/.test(e)?'"'+e.replace(/([\\"])/g,"\\$1")+'"':c.encodeWord(e,this._getTextEncoding(e),52)}_encodeWords(e){return c.encodeWords(e,this._getTextEncoding(e),52,!0)}_getTextEncoding(e){e=(e||"").toString();let t,i,s=this.textEncoding;return s||(i=(e.match(/[\x00-\x08\x0B\x0C\x0E-\x1F\u0080-\uFFFF]/g)||[]).length,t=(e.match(/[a-z]/gi)||[]).length,s=i<t?"Q":"B"),s}_generateMessageId(){return"<"+[2,2,2,6].reduce(((e,t)=>e+"-"+s.randomBytes(t).toString("hex")),s.randomBytes(4).toString("hex"))+"@"+(this.getEnvelope().from||this.hostname||"localhost").split("@").pop()+">"}}e.exports=MimeNode},0:(e,t,i)=>{"use strict";const s=i(2781).Transform;e.exports=class LastNewline extends s{constructor(){super(),this.lastByte=!1}_transform(e,t,i){e.length&&(this.lastByte=e[e.length-1]),this.push(e),i()}_flush(e){return 10===this.lastByte?e():13===this.lastByte?(this.push(Buffer.from("\n")),e()):(this.push(Buffer.from("\r\n")),e())}}},3701:(e,t,i)=>{"use strict";const s=i(2781).Transform;e.exports=class LeWindows extends s{constructor(e){super(e),this.options=e||{}}_transform(e,t,i){let s,n=0;for(let t=0,i=e.length;t<i;t++)13===e[t]&&(s=e.slice(n,t),n=t+1,this.push(s));n&&n<e.length?(s=e.slice(n),this.push(s)):n||this.push(e),i()}}},3343:(e,t,i)=>{"use strict";const s=i(2781).Transform;e.exports=class LeWindows extends s{constructor(e){super(e),this.options=e||{},this.lastByte=!1}_transform(e,t,i){let s,n=0;for(let t=0,i=e.length;t<i;t++)10===e[t]&&(t&&13!==e[t-1]||!t&&13!==this.lastByte)&&(t>n&&(s=e.slice(n,t),this.push(s)),this.push(Buffer.from("\r\n")),n=t+1);n&&n<e.length?(s=e.slice(n),this.push(s)):n||this.push(e),this.lastByte=e[e.length-1],i()}}},162:(e,t,i)=>{"use strict";const s=i(4051),n=i(4938),a=i(1887),r=i(9468),o=i(2895),c=i(8103),l=i(8937),p=i(8214),d=i(338),h=i(4129),u=(process.env.ETHEREAL_API||"https://api.nodemailer.com").replace(/\/+$/,""),g=(process.env.ETHEREAL_WEB||"https://ethereal.email").replace(/\/+$/,""),v=["true","yes","y","1"].includes((process.env.ETHEREAL_CACHE||"yes").toString().trim().toLowerCase());let y=!1;e.exports.createTransport=function(e,t){let i,d,h;return("object"==typeof e&&"function"!=typeof e.send||"string"==typeof e&&/^(smtps?|direct):/i.test(e))&&(d=(i="string"==typeof e?e:e.url)?n.parseConnectionUrl(i):e,e=d.pool?new a(d):d.sendmail?new o(d):d.streamTransport?new c(d):d.jsonTransport?new l(d):d.SES?new p(d):new r(d)),h=new s(e,d,t),h},e.exports.createTestAccount=function(e,t){let i;if(t||"function"!=typeof e||(t=e,e=!1),t||(i=new Promise(((e,i)=>{t=n.callbackPromise(e,i)}))),v&&y)return setImmediate((()=>t(null,y))),i;let s=[],a=0,r=d((e=e||u)+"/user",{contentType:"application/json",method:"POST",body:Buffer.from(JSON.stringify({requestor:h.name,version:h.version}))});return r.on("readable",(()=>{let e;for(;null!==(e=r.read());)s.push(e),a+=e.length})),r.once("error",(e=>t(e))),r.once("end",(()=>{let e,i,n=Buffer.concat(s,a);try{e=JSON.parse(n.toString())}catch(e){i=e}return i?t(i):"success"!==e.status||e.error?t(new Error(e.error||"Request failed")):(delete e.status,y=e,void t(null,y))})),i},e.exports.getTestMessageUrl=function(e){if(!e||!e.response)return!1;let t=new Map;return e.response.replace(/\[([^\]]+)\]$/,((e,i)=>{i.replace(/\b([A-Z0-9]+)=([^\s]+)/g,((e,i,s)=>{t.set(i,s)}))})),!(!t.has("STATUS")||!t.has("MSGID"))&&(y.web||g)+"/message/"+t.get("MSGID")}},4507:(e,t,i)=>{"use strict";const s=i(2781).Transform;function encode(e){"string"==typeof e&&(e=Buffer.from(e,"utf-8"));let t,i=[[9],[10],[13],[32,60],[62,126]],s="";for(let n=0,a=e.length;n<a;n++)t=e[n],checkRanges(t,i)&&(32!==t&&9!==t||n!==a-1&&10!==e[n+1]&&13!==e[n+1])?s+=String.fromCharCode(t):s+="="+(t<16?"0":"")+t.toString(16).toUpperCase();return s}function wrap(e,t){if(t=t||76,(e=(e||"").toString()).length<=t)return e;let i,s,n,a=0,r=e.length,o=Math.floor(t/3),c="";for(;a<r;)if(n=e.substr(a,t),i=n.match(/\r\n/))n=n.substr(0,i.index+i[0].length),c+=n,a+=n.length;else if("\n"!==n.substr(-1))if(i=n.substr(-o).match(/\n.*?$/))n=n.substr(0,n.length-(i[0].length-1)),c+=n,a+=n.length;else{if(n.length>t-o&&(i=n.substr(-o).match(/[ \t.,!?][^ \t.,!?]*$/)))n=n.substr(0,n.length-(i[0].length-1));else if(n.match(/[=][\da-f]{0,2}$/i))for((i=n.match(/[=][\da-f]{0,1}$/i))&&(n=n.substr(0,n.length-i[0].length));n.length>3&&n.length<r-a&&!n.match(/^(?:=[\da-f]{2}){1,4}$/i)&&(i=n.match(/[=][\da-f]{2}$/gi))&&(s=parseInt(i[0].substr(1,2),16),!(s<128))&&(n=n.substr(0,n.length-3),!(s>=192)););a+n.length<r&&"\n"!==n.substr(-1)?(n.length===t&&n.match(/[=][\da-f]{2}$/i)?n=n.substr(0,n.length-3):n.length===t&&(n=n.substr(0,n.length-1)),a+=n.length,n+="=\r\n"):a+=n.length,c+=n}else c+=n,a+=n.length;return c}function checkRanges(e,t){for(let i=t.length-1;i>=0;i--)if(t[i].length){if(1===t[i].length&&e===t[i][0])return!0;if(2===t[i].length&&e>=t[i][0]&&e<=t[i][1])return!0}return!1}e.exports={encode,wrap,Encoder:class Encoder extends s{constructor(e){super(),this.options=e||{},!1!==this.options.lineLength&&(this.options.lineLength=this.options.lineLength||76),this._curLine="",this.inputBytes=0,this.outputBytes=0}_transform(e,t,i){let s;if("buffer"!==t&&(e=Buffer.from(e,t)),!e||!e.length)return i();this.inputBytes+=e.length,this.options.lineLength?(s=this._curLine+encode(e),s=wrap(s,this.options.lineLength),s=s.replace(/(^|\n)([^\n]*)$/,((e,t,i)=>(this._curLine=i,t))),s&&(this.outputBytes+=s.length,this.push(s))):(s=encode(e),this.outputBytes+=s.length,this.push(s,"ascii")),i()}_flush(e){this._curLine&&(this.outputBytes+=this._curLine.length,this.push(this._curLine,"ascii")),e()}}}},2895:(e,t,i)=>{"use strict";const s=i(2081).spawn,n=i(4129),a=i(4938);e.exports=class SendmailTransport{constructor(e){e=e||{},this._spawn=s,this.options=e||{},this.name="Sendmail",this.version=n.version,this.path="sendmail",this.args=!1,this.winbreak=!1,this.logger=a.getLogger(this.options,{component:this.options.component||"sendmail"}),e&&("string"==typeof e?this.path=e:"object"==typeof e&&(e.path&&(this.path=e.path),Array.isArray(e.args)&&(this.args=e.args),this.winbreak=["win","windows","dos","\r\n"].includes((e.newline||"").toString().toLowerCase())))}send(e,t){e.message.keepBcc=!0;let i,s,n,a=e.data.envelope||e.message.getEnvelope(),r=e.message.messageId();if([].concat(a.from||[]).concat(a.to||[]).some((e=>/^-/.test(e))))return t(new Error("Can not send mail. Invalid envelope addresses."));i=this.args?["-i"].concat(this.args).concat(a.to):["-i"].concat(a.from?["-f",a.from]:[]).concat(a.to);let callback=i=>{if(!n)return n=!0,"function"==typeof t?i?t(i):t(null,{envelope:e.data.envelope||e.message.getEnvelope(),messageId:r,response:"Messages queued for delivery"}):void 0};try{s=this._spawn(this.path,i)}catch(e){return this.logger.error({err:e,tnx:"spawn",messageId:r},"Error occurred while spawning sendmail. %s",e.message),callback(e)}if(!s)return callback(new Error("sendmail was not found"));{s.on("error",(e=>{this.logger.error({err:e,tnx:"spawn",messageId:r},"Error occurred when sending message %s. %s",r,e.message),callback(e)})),s.once("exit",(e=>{if(!e)return callback();let t;t=127===e?new Error("Sendmail command not found, process exited with code "+e):new Error("Sendmail exited with code "+e),this.logger.error({err:t,tnx:"stdin",messageId:r},"Error sending message %s to sendmail. %s",r,t.message),callback(t)})),s.once("close",callback),s.stdin.on("error",(e=>{this.logger.error({err:e,tnx:"stdin",messageId:r},"Error occurred when piping message %s to sendmail. %s",r,e.message),callback(e)}));let t=[].concat(a.to||[]);t.length>3&&t.push("...and "+t.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:r},"Sending message %s to <%s>",r,t.join(", "));let i=e.message.createReadStream();i.once("error",(e=>{this.logger.error({err:e,tnx:"stdin",messageId:r},"Error occurred when generating message %s. %s",r,e.message),s.kill("SIGINT"),callback(e)})),i.pipe(s.stdin)}}}},8214:(e,t,i)=>{"use strict";const s=i(2361),n=i(4129),a=i(4938),r=i(3343);e.exports=class SESTransport extends s{constructor(e){super(),e=e||{},this.options=e||{},this.ses=this.options.SES,this.name="SESTransport",this.version=n.version,this.logger=a.getLogger(this.options,{component:this.options.component||"ses-transport"}),this.maxConnections=Number(this.options.maxConnections)||1/0,this.connections=0,this.sendingRate=Number(this.options.sendingRate)||1/0,this.sendingRateTTL=null,this.rateInterval=1e3,this.rateMessages=[],this.pending=[],this.idling=!0,setImmediate((()=>{this.idling&&this.emit("idle")}))}send(e,t){return this.connections>=this.maxConnections?(this.idling=!1,this.pending.push({mail:e,callback:t})):this._checkSendingRate()?void this._send(e,((...e)=>{setImmediate((()=>t(...e))),this._sent()})):(this.idling=!1,this.pending.push({mail:e,callback:t}))}_checkRatedQueue(){if(this.connections>=this.maxConnections||!this._checkSendingRate())return;if(!this.pending.length)return void(this.idling||(this.idling=!0,this.emit("idle")));let e=this.pending.shift();this._send(e.mail,((...t)=>{setImmediate((()=>e.callback(...t))),this._sent()}))}_checkSendingRate(){clearTimeout(this.sendingRateTTL);let e=Date.now(),t=!1;for(let i=this.rateMessages.length-1;i>=0;i--)this.rateMessages[i].ts>=e-this.rateInterval&&(!t||this.rateMessages[i].ts<t)&&(t=this.rateMessages[i].ts),this.rateMessages[i].ts<e-this.rateInterval&&!this.rateMessages[i].pending&&this.rateMessages.splice(i,1);if(this.rateMessages.length<this.sendingRate)return!0;let i=Math.max(t+1001,e+20);this.sendingRateTTL=setTimeout((()=>this._checkRatedQueue()),e-i);try{this.sendingRateTTL.unref()}catch(e){}return!1}_sent(){this.connections--,this._checkRatedQueue()}isIdle(){return this.idling}_send(e,t){let i={ts:Date.now(),pending:!0};this.connections++,this.rateMessages.push(i);let s=e.data.envelope||e.message.getEnvelope(),n=e.message.messageId(),a=[].concat(s.to||[]);a.length>3&&a.push("...and "+a.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:n},"Sending message %s to <%s>",n,a.join(", "));setImmediate((()=>(t=>{e.data._dkim||(e.data._dkim={}),e.data._dkim.skipFields&&"string"==typeof e.data._dkim.skipFields?e.data._dkim.skipFields+=":date:message-id":e.data._dkim.skipFields="date:message-id";let i=e.message.createReadStream(),s=i.pipe(new r),n=[],a=0;s.on("readable",(()=>{let e;for(;null!==(e=s.read());)n.push(e),a+=e.length})),i.once("error",(e=>s.emit("error",e))),s.once("error",(e=>{t(e)})),s.once("end",(()=>t(null,Buffer.concat(n,a))))})(((a,r)=>{if(a)return this.logger.error({err:a,tnx:"send",messageId:n},"Failed creating message for %s. %s",n,a.message),i.pending=!1,t(a);let o={RawMessage:{Data:r},Source:s.from,Destinations:s.to};Object.keys(e.data.ses||{}).forEach((t=>{o[t]=e.data.ses[t]}));let c=(this.ses.aws?this.ses.ses:this.ses)||{},l=this.ses.aws||{};var p;p=(e,a)=>{let p;!e&&a||(a="us-east-1"),p="function"==typeof c.send&&l.SendRawEmailCommand?c.send(new l.SendRawEmailCommand(o)):c.sendRawEmail(o).promise(),p.then((e=>{"us-east-1"===a&&(a="email"),i.pending=!1,t(null,{envelope:{from:s.from,to:s.to},messageId:"<"+e.MessageId+(/@/.test(e.MessageId)?"":"@"+a+".amazonses.com")+">",response:e.MessageId,raw:r})})).catch((e=>{this.logger.error({err:e,tnx:"send"},"Send error for %s: %s",n,e.message),i.pending=!1,t(e)}))},c.config&&"function"==typeof c.config.region?c.config.region().then((e=>p(null,e))).catch((e=>p(e))):p(null,c.config&&c.config.region||"us-east-1")}))))}verify(e){let t,i=(this.ses.aws?this.ses.ses:this.ses)||{},s=this.ses.aws||{};const n={RawMessage:{Data:"From: invalid@invalid\r\nTo: invalid@invalid\r\n Subject: Invalid\r\n\r\nInvalid"},Source:"invalid@invalid",Destinations:["invalid@invalid"]};e||(t=new Promise(((t,i)=>{e=a.callbackPromise(t,i)})));const cb=t=>t&&"InvalidParameterValue"!==(t.code||t.Code)?e(t):e(null,!0);return"function"==typeof i.send&&s.SendRawEmailCommand?(n.RawMessage.Data=Buffer.from(n.RawMessage.Data),i.send(new s.SendRawEmailCommand(n),cb)):i.sendRawEmail(n,cb),t}}},4938:(e,t,i)=>{"use strict";const s=i(7310),n=i(3837),a=i(7147),r=i(338),o=i(9523),c=i(1808),l=i(2037),p=3e5;let d;try{d=l.networkInterfaces()}catch(e){}e.exports.networkInterfaces=d;const isFamilySupported=(t,i)=>{let s=e.exports.networkInterfaces;if(!s)return!0;return Object.keys(s).map((e=>s[e])).reduce(((e,t)=>e.concat(t)),[]).filter((e=>!e.internal||i)).filter((e=>e.family==="IPv"+t||e.family===t)).length>0},resolver=(e,t,i,s)=>{if(!isFamilySupported(e,(i=i||{}).allowInternalNetworkInterfaces))return s(null,[]);o["resolve"+e](t,((e,t)=>{if(e){switch(e.code){case o.NODATA:case o.NOTFOUND:case o.NOTIMP:case o.SERVFAIL:case o.CONNREFUSED:case"EAI_AGAIN":return s(null,[])}return s(e)}return s(null,Array.isArray(t)?t:[].concat(t||[]))}))},h=e.exports.dnsCache=new Map,formatDNSValue=(e,t)=>e?Object.assign({servername:e.servername,host:e.addresses&&e.addresses.length?1===e.addresses.length?e.addresses[0]:e.addresses[Math.floor(Math.random()*e.addresses.length)]:null},t||{}):Object.assign({},t||{});function resolveStream(e,t){let i=!1,s=[],n=0;e.on("error",(e=>{i||(i=!0,t(e))})),e.on("readable",(()=>{let t;for(;null!==(t=e.read());)s.push(t),n+=t.length})),e.on("end",(()=>{if(i)return;let e;i=!0;try{e=Buffer.concat(s,n)}catch(e){return t(e)}t(null,e)}))}e.exports.resolveHostname=(e,t)=>{if(!(e=e||{}).host&&e.servername&&(e.host=e.servername),!e.host||c.isIP(e.host)){let i={addresses:[e.host],servername:e.servername||!1};return t(null,formatDNSValue(i,{cached:!1}))}let i;if(h.has(e.host)&&(i=h.get(e.host),!i.expires||i.expires>=Date.now()))return t(null,formatDNSValue(i.value,{cached:!0}));resolver(4,e.host,e,((s,n)=>{if(s)return i?t(null,formatDNSValue(i.value,{cached:!0,error:s})):t(s);if(n&&n.length){let i={addresses:n,servername:e.servername||e.host};return h.set(e.host,{value:i,expires:Date.now()+(e.dnsTtl||p)}),t(null,formatDNSValue(i,{cached:!1}))}resolver(6,e.host,e,((s,n)=>{if(s)return i?t(null,formatDNSValue(i.value,{cached:!0,error:s})):t(s);if(n&&n.length){let i={addresses:n,servername:e.servername||e.host};return h.set(e.host,{value:i,expires:Date.now()+(e.dnsTtl||p)}),t(null,formatDNSValue(i,{cached:!1}))}try{o.lookup(e.host,{all:!0},((s,n)=>{if(s)return i?t(null,formatDNSValue(i.value,{cached:!0,error:s})):t(s);let a=!!n&&n.filter((e=>isFamilySupported(e.family))).map((e=>e.address)).shift();if(n&&n.length&&!a){let e=new Error(`Can not use IPv${n[0].family} addresses with current network`);return t(e)}if(!a&&i)return t(null,formatDNSValue(i.value,{cached:!0}));let r={addresses:a?[a]:[e.host],servername:e.servername||e.host};return h.set(e.host,{value:r,expires:Date.now()+(e.dnsTtl||p)}),t(null,formatDNSValue(r,{cached:!1}))}))}catch(s){return i?t(null,formatDNSValue(i.value,{cached:!0,error:s})):t(s)}}))}))},e.exports.parseConnectionUrl=e=>{e=e||"";let t={};return[s.parse(e,!0)].forEach((e=>{let i;switch(e.protocol){case"smtp:":t.secure=!1;break;case"smtps:":t.secure=!0;break;case"direct:":t.direct=!0}!isNaN(e.port)&&Number(e.port)&&(t.port=Number(e.port)),e.hostname&&(t.host=e.hostname),e.auth&&(i=e.auth.split(":"),t.auth||(t.auth={}),t.auth.user=i.shift(),t.auth.pass=i.join(":")),Object.keys(e.query||{}).forEach((i=>{let s=t,n=i,a=e.query[i];switch(isNaN(a)||(a=Number(a)),a){case"true":a=!0;break;case"false":a=!1}if(0===i.indexOf("tls."))n=i.substr(4),t.tls||(t.tls={}),s=t.tls;else if(i.indexOf(".")>=0)return;n in s||(s[n]=a)}))})),t},e.exports._logFunc=(e,t,i,s,n,...a)=>{let r={};Object.keys(i||{}).forEach((e=>{"level"!==e&&(r[e]=i[e])})),Object.keys(s||{}).forEach((e=>{"level"!==e&&(r[e]=s[e])})),e[t](r,n,...a)},e.exports.getLogger=(t,i)=>{let s={},a=["trace","debug","info","warn","error","fatal"];if(!(t=t||{}).logger)return a.forEach((e=>{s[e]=()=>!1})),s;let r=t.logger;return!0===t.logger&&(r=function createDefaultLogger(e){let t=0,i=new Map;e.forEach((e=>{e.length>t&&(t=e.length)})),e.forEach((e=>{let s=e.toUpperCase();s.length<t&&(s+=" ".repeat(t-s.length)),i.set(e,s)}));let print=(e,t,s,...a)=>{let r="";t&&("server"===t.tnx?r="S: ":"client"===t.tnx&&(r="C: "),t.sid&&(r="["+t.sid+"] "+r),t.cid&&(r="[#"+t.cid+"] "+r)),(s=n.format(s,...a)).split(/\r?\n/).forEach((t=>{console.log("[%s] %s %s",(new Date).toISOString().substr(0,19).replace(/T/," "),i.get(e),r+t)}))},s={};return e.forEach((e=>{s[e]=print.bind(null,e)})),s}(a)),a.forEach((t=>{s[t]=(s,n,...a)=>{e.exports._logFunc(r,t,i,s,n,...a)}})),s},e.exports.callbackPromise=(e,t)=>function(){let i=Array.from(arguments),s=i.shift();s?t(s):e(...i)},e.exports.resolveContent=(t,i,s)=>{let n;s||(n=new Promise(((t,i)=>{s=e.exports.callbackPromise(t,i)})));let o,c=t&&t[i]&&t[i].content||t[i],l=("object"==typeof t[i]&&t[i].encoding||"utf8").toString().toLowerCase().replace(/[-_\s]/g,"");if(!c)return s(null,c);if("object"==typeof c){if("function"==typeof c.pipe)return resolveStream(c,((e,n)=>{if(e)return s(e);t[i].content?t[i].content=n:t[i]=n,s(null,n)}));if(/^https?:\/\//i.test(c.path||c.href))return o=r(c.path||c.href),resolveStream(o,s);if(/^data:/i.test(c.path||c.href)){let e=(c.path||c.href).match(/^data:((?:[^;]*;)*(?:[^,]*)),(.*)$/i);return s(null,e?/\bbase64$/i.test(e[1])?Buffer.from(e[2],"base64"):Buffer.from(decodeURIComponent(e[2])):Buffer.from(0))}if(c.path)return resolveStream(a.createReadStream(c.path),s)}return"string"!=typeof t[i].content||["utf8","usascii","ascii"].includes(l)||(c=Buffer.from(t[i].content,l)),setImmediate((()=>s(null,c))),n},e.exports.assign=function(){let e=Array.from(arguments),t=e.shift()||{};return e.forEach((e=>{Object.keys(e||{}).forEach((i=>{["tls","auth"].includes(i)&&e[i]&&"object"==typeof e[i]?(t[i]||(t[i]={}),Object.keys(e[i]).forEach((s=>{t[i][s]=e[i][s]}))):t[i]=e[i]}))})),t},e.exports.encodeXText=e=>{if(!/[^\x21-\x2A\x2C-\x3C\x3E-\x7E]/.test(e))return e;let t=Buffer.from(e),i="";for(let e=0,s=t.length;e<s;e++){let s=t[e];i+=s<33||s>126||43===s||61===s?"+"+(s<16?"0":"")+s.toString(16).toUpperCase():String.fromCharCode(s)}return i}},5245:(e,t,i)=>{"use strict";const s=i(2781).Transform;e.exports=class DataStream extends s{constructor(e){super(e),this.options=e||{},this._curLine="",this.inByteCount=0,this.outByteCount=0,this.lastByte=!1}_transform(e,t,i){let s,n,a,r=[],o=0,c=0;if(!e||!e.length)return i();for("string"==typeof e&&(e=Buffer.from(e)),this.inByteCount+=e.length,s=0,n=e.length;s<n;s++)46===e[s]?(s&&10===e[s-1]||!s&&(!this.lastByte||10===this.lastByte))&&(a=e.slice(c,s+1),r.push(a),r.push(Buffer.from(".")),o+=a.length+1,c=s+1):10===e[s]&&(s&&13!==e[s-1]||!s&&13!==this.lastByte)&&(s>c?(a=e.slice(c,s),r.push(a),o+=a.length+2):o+=2,r.push(Buffer.from("\r\n")),c=s+1);o?(c<e.length&&(a=e.slice(c),r.push(a),o+=a.length),this.outByteCount+=o,this.push(Buffer.concat(r,o))):(this.outByteCount+=e.length,this.push(e)),this.lastByte=e[e.length-1],i()}_flush(e){let t;t=10===this.lastByte?Buffer.from(".\r\n"):13===this.lastByte?Buffer.from("\n.\r\n"):Buffer.from("\r\n.\r\n"),this.outByteCount+=t.length,this.push(t),e()}}},6438:(e,t,i)=>{"use strict";const s=i(1808),n=i(4404),a=i(7310);e.exports=function httpProxyClient(e,t,i,r){let o,c,l,p=a.parse(e);o={host:p.hostname,port:Number(p.port)?Number(p.port):"https:"===p.protocol?443:80},"https:"===p.protocol?(o.rejectUnauthorized=!1,c=n.connect.bind(n)):c=s.connect.bind(s);let d=!1,tempSocketErr=e=>{if(!d){d=!0;try{l.destroy()}catch(e){}r(e)}},timeoutErr=()=>{let e=new Error("Proxy socket timed out");e.code="ETIMEDOUT",tempSocketErr(e)};l=c(o,(()=>{if(d)return;let e={Host:i+":"+t,Connection:"close"};p.auth&&(e["Proxy-Authorization"]="Basic "+Buffer.from(p.auth).toString("base64")),l.write("CONNECT "+i+":"+t+" HTTP/1.1\r\n"+Object.keys(e).map((t=>t+": "+e[t])).join("\r\n")+"\r\n\r\n");let s="",onSocketData=e=>{let t,i;if(!d&&(s+=e.toString("binary"),t=s.match(/\r\n\r\n/))){if(l.removeListener("data",onSocketData),i=s.substr(t.index+t[0].length),s=s.substr(0,t.index),i&&l.unshift(Buffer.from(i,"binary")),d=!0,t=s.match(/^HTTP\/\d+\.\d+ (\d+)/i),!t||"2"!==(t[1]||"").charAt(0)){try{l.destroy()}catch(e){}return r(new Error("Invalid response from proxy"+(t&&": "+t[1]||"")))}return l.removeListener("error",tempSocketErr),l.removeListener("timeout",timeoutErr),l.setTimeout(0),r(null,l)}};l.on("data",onSocketData)})),l.setTimeout(httpProxyClient.timeout||3e4),l.on("timeout",timeoutErr),l.once("error",tempSocketErr)}},7343:(e,t,i)=>{"use strict";const s=i(4129),n=i(2361).EventEmitter,a=i(1808),r=i(4404),o=i(2037),c=i(6113),l=i(5245),p=i(2781).PassThrough,d=i(4938),h=6e5;e.exports=class SMTPConnection extends n{constructor(e){super(e),this.id=c.randomBytes(8).toString("base64").replace(/\W/g,""),this.stage="init",this.options=e||{},this.secureConnection=!!this.options.secure,this.alreadySecured=!!this.options.secured,this.port=Number(this.options.port)||(this.secureConnection?465:587),this.host=this.options.host||"localhost",this.allowInternalNetworkInterfaces=this.options.allowInternalNetworkInterfaces||!1,void 0===this.options.secure&&465===this.port&&(this.secureConnection=!0),this.name=this.options.name||this._getHostname(),this.logger=d.getLogger(this.options,{component:this.options.component||"smtp-connection",sid:this.id}),this.customAuth=new Map,Object.keys(this.options.customAuth||{}).forEach((e=>{let t=(e||"").toString().trim().toUpperCase();t&&this.customAuth.set(t,this.options.customAuth[e])})),this.version=s.version,this.authenticated=!1,this.destroyed=!1,this.secure=!!this.secureConnection,this._remainder="",this._responseQueue=[],this.lastServerResponse=!1,this._socket=!1,this._supportedAuth=[],this.allowsAuth=!1,this._envelope=!1,this._supportedExtensions=[],this._maxAllowedSize=0,this._responseActions=[],this._recipientQueue=[],this._greetingTimeout=!1,this._connectionTimeout=!1,this._destroyed=!1,this._closing=!1,this._onSocketData=e=>this._onData(e),this._onSocketError=e=>this._onError(e,"ESOCKET",!1,"CONN"),this._onSocketClose=()=>this._onClose(),this._onSocketEnd=()=>this._onEnd(),this._onSocketTimeout=()=>this._onTimeout()}connect(e){if("function"==typeof e){this.once("connect",(()=>{this.logger.debug({tnx:"smtp"},"SMTP handshake finished"),e()}));const t=this._isDestroyedMessage("connect");if(t)return e(this._formatError(t,"ECONNECTION",!1,"CONN"))}let t={port:this.port,host:this.host,allowInternalNetworkInterfaces:this.allowInternalNetworkInterfaces};this.options.localAddress&&(t.localAddress=this.options.localAddress);let setupConnectionHandlers=()=>{this._connectionTimeout=setTimeout((()=>{this._onError("Connection timeout","ETIMEDOUT",!1,"CONN")}),this.options.connectionTimeout||12e4),this._socket.on("error",this._onSocketError)};return this.options.connection?(this._socket=this.options.connection,void(this.secureConnection&&!this.alreadySecured?setImmediate((()=>this._upgradeConnection((e=>{e?this._onError(new Error("Error initiating TLS - "+(e.message||e)),"ETLS",!1,"CONN"):this._onConnect()})))):setImmediate((()=>this._onConnect())))):this.options.socket?(this._socket=this.options.socket,d.resolveHostname(t,((e,i)=>{if(e)return setImmediate((()=>this._onError(e,"EDNS",!1,"CONN")));this.logger.debug({tnx:"dns",source:t.host,resolved:i.host,cached:!!i.cached},"Resolved %s as %s [cache %s]",t.host,i.host,i.cached?"hit":"miss"),Object.keys(i).forEach((e=>{"_"!==e.charAt(0)&&i[e]&&(t[e]=i[e])}));try{this._socket.connect(this.port,this.host,(()=>{this._socket.setKeepAlive(!0),this._onConnect()})),setupConnectionHandlers()}catch(e){return setImmediate((()=>this._onError(e,"ECONNECTION",!1,"CONN")))}}))):this.secureConnection?(this.options.tls&&Object.keys(this.options.tls).forEach((e=>{t[e]=this.options.tls[e]})),d.resolveHostname(t,((e,i)=>{if(e)return setImmediate((()=>this._onError(e,"EDNS",!1,"CONN")));this.logger.debug({tnx:"dns",source:t.host,resolved:i.host,cached:!!i.cached},"Resolved %s as %s [cache %s]",t.host,i.host,i.cached?"hit":"miss"),Object.keys(i).forEach((e=>{"_"!==e.charAt(0)&&i[e]&&(t[e]=i[e])}));try{this._socket=r.connect(t,(()=>{this._socket.setKeepAlive(!0),this._onConnect()})),setupConnectionHandlers()}catch(e){return setImmediate((()=>this._onError(e,"ECONNECTION",!1,"CONN")))}}))):d.resolveHostname(t,((e,i)=>{if(e)return setImmediate((()=>this._onError(e,"EDNS",!1,"CONN")));this.logger.debug({tnx:"dns",source:t.host,resolved:i.host,cached:!!i.cached},"Resolved %s as %s [cache %s]",t.host,i.host,i.cached?"hit":"miss"),Object.keys(i).forEach((e=>{"_"!==e.charAt(0)&&i[e]&&(t[e]=i[e])}));try{this._socket=a.connect(t,(()=>{this._socket.setKeepAlive(!0),this._onConnect()})),setupConnectionHandlers()}catch(e){return setImmediate((()=>this._onError(e,"ECONNECTION",!1,"CONN")))}}))}quit(){this._sendCommand("QUIT"),this._responseActions.push(this.close)}close(){if(clearTimeout(this._connectionTimeout),clearTimeout(this._greetingTimeout),this._responseActions=[],this._closing)return;this._closing=!0;let e="end";"init"===this.stage&&(e="destroy"),this.logger.debug({tnx:"smtp"},'Closing connection to the server using "%s"',e);let t=this._socket&&this._socket.socket||this._socket;if(t&&!t.destroyed)try{this._socket[e]()}catch(e){}this._destroy()}login(e,t){const i=this._isDestroyedMessage("login");if(i)return t(this._formatError(i,"ECONNECTION",!1,"API"));if(this._auth=e||{},this._authMethod=(this._auth.method||"").toString().trim().toUpperCase()||!1,this._authMethod||!this._auth.oauth2||this._auth.credentials?this._authMethod&&("XOAUTH2"!==this._authMethod||this._auth.oauth2)||(this._authMethod=(this._supportedAuth[0]||"PLAIN").toUpperCase().trim()):this._authMethod="XOAUTH2",!("XOAUTH2"===this._authMethod||this._auth.credentials&&this._auth.credentials.user&&this._auth.credentials.pass)){if(!this._auth.user||!this._auth.pass)return t(this._formatError('Missing credentials for "'+this._authMethod+'"',"EAUTH",!1,"API"));this._auth.credentials={user:this._auth.user,pass:this._auth.pass,options:this._auth.options}}if(!this.customAuth.has(this._authMethod)){switch(this._authMethod){case"XOAUTH2":return void this._handleXOauth2Token(!1,t);case"LOGIN":return this._responseActions.push((e=>{this._actionAUTH_LOGIN_USER(e,t)})),void this._sendCommand("AUTH LOGIN");case"PLAIN":return this._responseActions.push((e=>{this._actionAUTHComplete(e,t)})),void this._sendCommand("AUTH PLAIN "+Buffer.from("\0"+this._auth.credentials.user+"\0"+this._auth.credentials.pass,"utf-8").toString("base64"),"AUTH PLAIN "+Buffer.from("\0"+this._auth.credentials.user+"\0/* secret */","utf-8").toString("base64"));case"CRAM-MD5":return this._responseActions.push((e=>{this._actionAUTH_CRAM_MD5(e,t)})),void this._sendCommand("AUTH CRAM-MD5")}return t(this._formatError('Unknown authentication method "'+this._authMethod+'"',"EAUTH",!1,"API"))}{let e,i=this.customAuth.get(this._authMethod),s=!1,resolve=()=>{s||(s=!0,this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user)),this.authenticated=!0,t(null,!0))},reject=i=>{s||(s=!0,t(this._formatError(i,"EAUTH",e,"AUTH "+this._authMethod)))},n=i({auth:this._auth,method:this._authMethod,extensions:[].concat(this._supportedExtensions),authMethods:[].concat(this._supportedAuth),maxAllowedSize:this._maxAllowedSize||!1,sendCommand:(t,i)=>{let s;return i||(s=new Promise(((e,t)=>{i=d.callbackPromise(e,t)}))),this._responseActions.push((s=>{e=s;let n=s.match(/^(\d+)(?:\s(\d+\.\d+\.\d+))?\s/),a={command:t,response:s};n?(a.status=Number(n[1])||0,n[2]&&(a.code=n[2]),a.text=s.substr(n[0].length)):(a.text=s,a.status=0),i(null,a)})),setImmediate((()=>this._sendCommand(t))),s},resolve,reject});n&&"function"==typeof n.catch&&n.then(resolve).catch(reject)}}send(e,t,i){if(!t)return i(this._formatError("Empty message","EMESSAGE",!1,"API"));const s=this._isDestroyedMessage("send message");if(s)return i(this._formatError(s,"ECONNECTION",!1,"API"));if(this._maxAllowedSize&&e.size>this._maxAllowedSize)return setImmediate((()=>{i(this._formatError("Message size larger than allowed "+this._maxAllowedSize,"EMESSAGE",!1,"MAIL FROM"))}));let n=!1,callback=function(){n||(n=!0,i(...arguments))};"function"==typeof t.on&&t.on("error",(e=>callback(this._formatError(e,"ESTREAM",!1,"API"))));let a=Date.now();this._setEnvelope(e,((e,i)=>{if(e)return callback(e);let s=Date.now(),n=this._createSendStream(((e,t)=>e?callback(e):(i.envelopeTime=s-a,i.messageTime=Date.now()-s,i.messageSize=n.outByteCount,i.response=t,callback(null,i))));"function"==typeof t.pipe?t.pipe(n):(n.write(t),n.end())}))}reset(e){this._sendCommand("RSET"),this._responseActions.push((t=>"2"!==t.charAt(0)?e(this._formatError("Could not reset session state. response="+t,"EPROTOCOL",t,"RSET")):(this._envelope=!1,e(null,!0))))}_onConnect(){clearTimeout(this._connectionTimeout),this.logger.info({tnx:"network",localAddress:this._socket.localAddress,localPort:this._socket.localPort,remoteAddress:this._socket.remoteAddress,remotePort:this._socket.remotePort},"%s established to %s:%s",this.secure?"Secure connection":"Connection",this._socket.remoteAddress,this._socket.remotePort),this._destroyed?this.close():(this.stage="connected",this._socket.removeListener("data",this._onSocketData),this._socket.removeListener("timeout",this._onSocketTimeout),this._socket.removeListener("close",this._onSocketClose),this._socket.removeListener("end",this._onSocketEnd),this._socket.on("data",this._onSocketData),this._socket.once("close",this._onSocketClose),this._socket.once("end",this._onSocketEnd),this._socket.setTimeout(this.options.socketTimeout||h),this._socket.on("timeout",this._onSocketTimeout),this._greetingTimeout=setTimeout((()=>{this._socket&&!this._destroyed&&this._responseActions[0]===this._actionGreeting&&this._onError("Greeting never received","ETIMEDOUT",!1,"CONN")}),this.options.greetingTimeout||3e4),this._responseActions.push(this._actionGreeting),this._socket.resume())}_onData(e){if(this._destroyed||!e||!e.length)return;let t,i=(e||"").toString("binary"),s=(this._remainder+i).split(/\r?\n/);this._remainder=s.pop();for(let e=0,i=s.length;e<i;e++)this._responseQueue.length&&(t=this._responseQueue[this._responseQueue.length-1],/^\d+-/.test(t.split("\n").pop()))?this._responseQueue[this._responseQueue.length-1]+="\n"+s[e]:this._responseQueue.push(s[e]);this._responseQueue.length&&(t=this._responseQueue[this._responseQueue.length-1],/^\d+-/.test(t.split("\n").pop()))||this._processResponse()}_onError(e,t,i,s){clearTimeout(this._connectionTimeout),clearTimeout(this._greetingTimeout),this._destroyed||(e=this._formatError(e,t,i,s),this.logger.error(i,e.message),this.emit("error",e),this.close())}_formatError(e,t,i,s){let n;n=/Error\]$/i.test(Object.prototype.toString.call(e))?e:new Error(e),t&&"Error"!==t&&(n.code=t),i&&(n.response=i,n.message+=": "+i);let a="string"==typeof i&&Number((i.match(/^\d+/)||[])[0])||!1;return a&&(n.responseCode=a),s&&(n.command=s),n}_onClose(){return this.logger.info({tnx:"network"},"Connection closed"),this.upgrading&&!this._destroyed?this._onError(new Error("Connection closed unexpectedly"),"ETLS",!1,"CONN"):[this._actionGreeting,this.close].includes(this._responseActions[0])||this._destroyed?void this._destroy():this._onError(new Error("Connection closed unexpectedly"),"ECONNECTION",!1,"CONN")}_onEnd(){this._socket&&!this._socket.destroyed&&this._socket.destroy()}_onTimeout(){return this._onError(new Error("Timeout"),"ETIMEDOUT",!1,"CONN")}_destroy(){this._destroyed||(this._destroyed=!0,this.emit("end"))}_upgradeConnection(e){this._socket.removeListener("data",this._onSocketData),this._socket.removeListener("timeout",this._onSocketTimeout);let t=this._socket,i={socket:this._socket,host:this.host};Object.keys(this.options.tls||{}).forEach((e=>{i[e]=this.options.tls[e]})),this.upgrading=!0;try{this._socket=r.connect(i,(()=>(this.secure=!0,this.upgrading=!1,this._socket.on("data",this._onSocketData),t.removeListener("close",this._onSocketClose),t.removeListener("end",this._onSocketEnd),e(null,!0))))}catch(t){return e(t)}this._socket.on("error",this._onSocketError),this._socket.once("close",this._onSocketClose),this._socket.once("end",this._onSocketEnd),this._socket.setTimeout(this.options.socketTimeout||h),this._socket.on("timeout",this._onSocketTimeout),t.resume()}_processResponse(){if(!this._responseQueue.length)return!1;let e=this.lastServerResponse=(this._responseQueue.shift()||"").toString();if(/^\d+-/.test(e.split("\n").pop()))return;(this.options.debug||this.options.transactionLog)&&this.logger.debug({tnx:"server"},e.replace(/\r?\n$/,"")),e.trim()||setImmediate((()=>this._processResponse(!0)));let t=this._responseActions.shift();if("function"!=typeof t)return this._onError(new Error("Unexpected Response"),"EPROTOCOL",e,"CONN");t.call(this,e),setImmediate((()=>this._processResponse(!0)))}_sendCommand(e,t){if(!this._destroyed){if(this._socket.destroyed)return this.close();(this.options.debug||this.options.transactionLog)&&this.logger.debug({tnx:"client"},(t||e||"").toString().replace(/\r?\n$/,"")),this._socket.write(Buffer.from(e+"\r\n","utf-8"))}}_setEnvelope(e,t){let i=[],s=!1;if(this._envelope=e||{},this._envelope.from=(this._envelope.from&&this._envelope.from.address||this._envelope.from||"").toString().trim(),this._envelope.to=[].concat(this._envelope.to||[]).map((e=>(e&&e.address||e||"").toString().trim())),!this._envelope.to.length)return t(this._formatError("No recipients defined","EENVELOPE",!1,"API"));if(this._envelope.from&&/[\r\n<>]/.test(this._envelope.from))return t(this._formatError("Invalid sender "+JSON.stringify(this._envelope.from),"EENVELOPE",!1,"API"));/[\x80-\uFFFF]/.test(this._envelope.from)&&(s=!0);for(let e=0,i=this._envelope.to.length;e<i;e++){if(!this._envelope.to[e]||/[\r\n<>]/.test(this._envelope.to[e]))return t(this._formatError("Invalid recipient "+JSON.stringify(this._envelope.to[e]),"EENVELOPE",!1,"API"));/[\x80-\uFFFF]/.test(this._envelope.to[e])&&(s=!0)}if(this._envelope.rcptQueue=JSON.parse(JSON.stringify(this._envelope.to||[])),this._envelope.rejected=[],this._envelope.rejectedErrors=[],this._envelope.accepted=[],this._envelope.dsn)try{this._envelope.dsn=this._setDsnEnvelope(this._envelope.dsn)}catch(e){return t(this._formatError("Invalid DSN "+e.message,"EENVELOPE",!1,"API"))}this._responseActions.push((e=>{this._actionMAIL(e,t)})),s&&this._supportedExtensions.includes("SMTPUTF8")&&(i.push("SMTPUTF8"),this._usingSmtpUtf8=!0),this._envelope.use8BitMime&&this._supportedExtensions.includes("8BITMIME")&&(i.push("BODY=8BITMIME"),this._using8BitMime=!0),this._envelope.size&&this._supportedExtensions.includes("SIZE")&&i.push("SIZE="+this._envelope.size),this._envelope.dsn&&this._supportedExtensions.includes("DSN")&&(this._envelope.dsn.ret&&i.push("RET="+d.encodeXText(this._envelope.dsn.ret)),this._envelope.dsn.envid&&i.push("ENVID="+d.encodeXText(this._envelope.dsn.envid))),this._sendCommand("MAIL FROM:<"+this._envelope.from+">"+(i.length?" "+i.join(" "):""))}_setDsnEnvelope(e){let t=(e.ret||e.return||"").toString().toUpperCase()||null;if(t)switch(t){case"HDRS":case"HEADERS":t="HDRS";break;case"FULL":case"BODY":t="FULL"}if(t&&!["FULL","HDRS"].includes(t))throw new Error("ret: "+JSON.stringify(t));let i=(e.envid||e.id||"").toString()||null,s=e.notify||null;if(s){"string"==typeof s&&(s=s.split(",")),s=s.map((e=>e.trim().toUpperCase()));let e=["NEVER","SUCCESS","FAILURE","DELAY"];if(s.filter((t=>!e.includes(t))).length||s.length>1&&s.includes("NEVER"))throw new Error("notify: "+JSON.stringify(s.join(",")));s=s.join(",")}let n=(e.recipient||e.orcpt||"").toString()||null;return n&&n.indexOf(";")<0&&(n="rfc822;"+n),{ret:t,envid:i,notify:s,orcpt:n}}_getDsnRcptToArgs(){let e=[];return this._envelope.dsn&&this._supportedExtensions.includes("DSN")&&(this._envelope.dsn.notify&&e.push("NOTIFY="+d.encodeXText(this._envelope.dsn.notify)),this._envelope.dsn.orcpt&&e.push("ORCPT="+d.encodeXText(this._envelope.dsn.orcpt))),e.length?" "+e.join(" "):""}_createSendStream(e){let t,i=new l;return this.options.lmtp?this._envelope.accepted.forEach(((t,i)=>{let s=i===this._envelope.accepted.length-1;this._responseActions.push((i=>{this._actionLMTPStream(t,s,i,e)}))})):this._responseActions.push((t=>{this._actionSMTPStream(t,e)})),i.pipe(this._socket,{end:!1}),this.options.debug&&(t=new p,t.on("readable",(()=>{let e;for(;e=t.read();)this.logger.debug({tnx:"message"},e.toString("binary").replace(/\r?\n$/,""))})),i.pipe(t)),i.once("end",(()=>{this.logger.info({tnx:"message",inByteCount:i.inByteCount,outByteCount:i.outByteCount},"<%s bytes encoded mime message (source size %s bytes)>",i.outByteCount,i.inByteCount)})),i}_actionGreeting(e){clearTimeout(this._greetingTimeout),"220"===e.substr(0,3)?this.options.lmtp?(this._responseActions.push(this._actionLHLO),this._sendCommand("LHLO "+this.name)):(this._responseActions.push(this._actionEHLO),this._sendCommand("EHLO "+this.name)):this._onError(new Error("Invalid greeting. response="+e),"EPROTOCOL",e,"CONN")}_actionLHLO(e){"2"===e.charAt(0)?this._actionEHLO(e):this._onError(new Error("Invalid LHLO. response="+e),"EPROTOCOL",e,"LHLO")}_actionEHLO(e){let t;if("421"!==e.substr(0,3)){if("2"!==e.charAt(0))return this.options.requireTLS?void this._onError(new Error("EHLO failed but HELO does not support required STARTTLS. response="+e),"ECONNECTION",e,"EHLO"):(this._responseActions.push(this._actionHELO),void this._sendCommand("HELO "+this.name));if(!this.secure&&!this.options.ignoreTLS&&(/[ -]STARTTLS\b/im.test(e)||this.options.requireTLS))return this._sendCommand("STARTTLS"),void this._responseActions.push(this._actionSTARTTLS);/[ -]SMTPUTF8\b/im.test(e)&&this._supportedExtensions.push("SMTPUTF8"),/[ -]DSN\b/im.test(e)&&this._supportedExtensions.push("DSN"),/[ -]8BITMIME\b/im.test(e)&&this._supportedExtensions.push("8BITMIME"),/[ -]PIPELINING\b/im.test(e)&&this._supportedExtensions.push("PIPELINING"),/[ -]AUTH\b/i.test(e)&&(this.allowsAuth=!0),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)PLAIN/i.test(e)&&this._supportedAuth.push("PLAIN"),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)LOGIN/i.test(e)&&this._supportedAuth.push("LOGIN"),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)CRAM-MD5/i.test(e)&&this._supportedAuth.push("CRAM-MD5"),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)XOAUTH2/i.test(e)&&this._supportedAuth.push("XOAUTH2"),(t=e.match(/[ -]SIZE(?:[ \t]+(\d+))?/im))&&(this._supportedExtensions.push("SIZE"),this._maxAllowedSize=Number(t[1])||0),this.emit("connect")}else this._onError(new Error("Server terminates connection. response="+e),"ECONNECTION",e,"EHLO")}_actionHELO(e){"2"===e.charAt(0)?(this.allowsAuth=!0,this.emit("connect")):this._onError(new Error("Invalid HELO. response="+e),"EPROTOCOL",e,"HELO")}_actionSTARTTLS(e){if("2"!==e.charAt(0))return this.options.opportunisticTLS?(this.logger.info({tnx:"smtp"},"Failed STARTTLS upgrade, continuing unencrypted"),this.emit("connect")):void this._onError(new Error("Error upgrading connection with STARTTLS"),"ETLS",e,"STARTTLS");this._upgradeConnection(((e,t)=>{e?this._onError(new Error("Error initiating TLS - "+(e.message||e)),"ETLS",!1,"STARTTLS"):(this.logger.info({tnx:"smtp"},"Connection upgraded with STARTTLS"),t?this.options.lmtp?(this._responseActions.push(this._actionLHLO),this._sendCommand("LHLO "+this.name)):(this._responseActions.push(this._actionEHLO),this._sendCommand("EHLO "+this.name)):this.emit("connect"))}))}_actionAUTH_LOGIN_USER(e,t){/^334[ -]/.test(e)?(this._responseActions.push((e=>{this._actionAUTH_LOGIN_PASS(e,t)})),this._sendCommand(Buffer.from(this._auth.credentials.user+"","utf-8").toString("base64"))):t(this._formatError('Invalid login sequence while waiting for "334 VXNlcm5hbWU6"',"EAUTH",e,"AUTH LOGIN"))}_actionAUTH_CRAM_MD5(e,t){let i=e.match(/^334\s+(.+)$/),s="";if(!i)return t(this._formatError("Invalid login sequence while waiting for server challenge string","EAUTH",e,"AUTH CRAM-MD5"));s=i[1];let n=Buffer.from(s,"base64").toString("ascii"),a=c.createHmac("md5",this._auth.credentials.pass);a.update(n);let r=this._auth.credentials.user+" "+a.digest("hex");this._responseActions.push((e=>{this._actionAUTH_CRAM_MD5_PASS(e,t)})),this._sendCommand(Buffer.from(r).toString("base64"),Buffer.from(this._auth.credentials.user+" /* secret */").toString("base64"))}_actionAUTH_CRAM_MD5_PASS(e,t){if(!e.match(/^235\s+/))return t(this._formatError('Invalid login sequence while waiting for "235"',"EAUTH",e,"AUTH CRAM-MD5"));this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user)),this.authenticated=!0,t(null,!0)}_actionAUTH_LOGIN_PASS(e,t){if(!/^334[ -]/.test(e))return t(this._formatError('Invalid login sequence while waiting for "334 UGFzc3dvcmQ6"',"EAUTH",e,"AUTH LOGIN"));this._responseActions.push((e=>{this._actionAUTHComplete(e,t)})),this._sendCommand(Buffer.from((this._auth.credentials.pass||"").toString(),"utf-8").toString("base64"),Buffer.from("/* secret */","utf-8").toString("base64"))}_actionAUTHComplete(e,t,i){return i||"function"!=typeof t||(i=t,t=!1),"334"===e.substr(0,3)?(this._responseActions.push((e=>{t||"XOAUTH2"!==this._authMethod?this._actionAUTHComplete(e,!0,i):setImmediate((()=>this._handleXOauth2Token(!0,i)))})),void this._sendCommand("")):"2"!==e.charAt(0)?(this.logger.info({tnx:"smtp",username:this._auth.user,action:"authfail",method:this._authMethod},"User %s failed to authenticate",JSON.stringify(this._auth.user)),i(this._formatError("Invalid login","EAUTH",e,"AUTH "+this._authMethod))):(this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user)),this.authenticated=!0,void i(null,!0))}_actionMAIL(e,t){let i,s;if(2!==Number(e.charAt(0)))return i=this._usingSmtpUtf8&&/^550 /.test(e)&&/[\x80-\uFFFF]/.test(this._envelope.from)?"Internationalized mailbox name not allowed":"Mail command failed",t(this._formatError(i,"EENVELOPE",e,"MAIL FROM"));if(!this._envelope.rcptQueue.length)return t(this._formatError("Can't send mail - no recipients defined","EENVELOPE",!1,"API"));if(this._recipientQueue=[],this._supportedExtensions.includes("PIPELINING"))for(;this._envelope.rcptQueue.length;)s=this._envelope.rcptQueue.shift(),this._recipientQueue.push(s),this._responseActions.push((e=>{this._actionRCPT(e,t)})),this._sendCommand("RCPT TO:<"+s+">"+this._getDsnRcptToArgs());else s=this._envelope.rcptQueue.shift(),this._recipientQueue.push(s),this._responseActions.push((e=>{this._actionRCPT(e,t)})),this._sendCommand("RCPT TO:<"+s+">"+this._getDsnRcptToArgs())}_actionRCPT(e,t){let i,s,n=this._recipientQueue.shift();if(2!==Number(e.charAt(0))?(i=this._usingSmtpUtf8&&/^553 /.test(e)&&/[\x80-\uFFFF]/.test(n)?"Internationalized mailbox name not allowed":"Recipient command failed",this._envelope.rejected.push(n),s=this._formatError(i,"EENVELOPE",e,"RCPT TO"),s.recipient=n,this._envelope.rejectedErrors.push(s)):this._envelope.accepted.push(n),this._envelope.rcptQueue.length||this._recipientQueue.length)this._envelope.rcptQueue.length&&(n=this._envelope.rcptQueue.shift(),this._recipientQueue.push(n),this._responseActions.push((e=>{this._actionRCPT(e,t)})),this._sendCommand("RCPT TO:<"+n+">"+this._getDsnRcptToArgs()));else{if(!(this._envelope.rejected.length<this._envelope.to.length))return s=this._formatError("Can't send mail - all recipients were rejected","EENVELOPE",e,"RCPT TO"),s.rejected=this._envelope.rejected,s.rejectedErrors=this._envelope.rejectedErrors,t(s);this._responseActions.push((e=>{this._actionDATA(e,t)})),this._sendCommand("DATA")}}_actionDATA(e,t){if(!/^[23]/.test(e))return t(this._formatError("Data command failed","EENVELOPE",e,"DATA"));let i={accepted:this._envelope.accepted,rejected:this._envelope.rejected};this._envelope.rejectedErrors.length&&(i.rejectedErrors=this._envelope.rejectedErrors),t(null,i)}_actionSMTPStream(e,t){return 2!==Number(e.charAt(0))?t(this._formatError("Message failed","EMESSAGE",e,"DATA")):t(null,e)}_actionLMTPStream(e,t,i,s){let n;if(2!==Number(i.charAt(0))){n=this._formatError("Message failed for recipient "+e,"EMESSAGE",i,"DATA"),n.recipient=e,this._envelope.rejected.push(e),this._envelope.rejectedErrors.push(n);for(let t=0,i=this._envelope.accepted.length;t<i;t++)this._envelope.accepted[t]===e&&this._envelope.accepted.splice(t,1)}if(t)return s(null,i)}_handleXOauth2Token(e,t){this._auth.oauth2.getToken(e,((i,s)=>{if(i)return this.logger.info({tnx:"smtp",username:this._auth.user,action:"authfail",method:this._authMethod},"User %s failed to authenticate",JSON.stringify(this._auth.user)),t(this._formatError(i,"EAUTH",!1,"AUTH XOAUTH2"));this._responseActions.push((i=>{this._actionAUTHComplete(i,e,t)})),this._sendCommand("AUTH XOAUTH2 "+this._auth.oauth2.buildXOAuth2Token(s),"AUTH XOAUTH2 "+this._auth.oauth2.buildXOAuth2Token("/* secret */"))}))}_isDestroyedMessage(e){if(this._destroyed)return"Cannot "+e+" - smtp connection is already destroyed.";if(this._socket){if(this._socket.destroyed)return"Cannot "+e+" - smtp connection socket is already destroyed.";if(!this._socket.writable)return"Cannot "+e+" - smtp connection socket is already half-closed."}}_getHostname(){let e;try{e=o.hostname()||""}catch(t){e="localhost"}return(!e||e.indexOf(".")<0)&&(e="[127.0.0.1]"),e.match(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/)&&(e="["+e+"]"),e}}},1887:(e,t,i)=>{"use strict";const s=i(2361),n=i(212),a=i(7343),r=i(2337),o=i(4938),c=i(4129);e.exports=class SMTPPool extends s{constructor(e){let t;super(),"string"==typeof(e=e||{})&&(e={url:e});let i=e.service;"function"==typeof e.getSocket&&(this.getSocket=e.getSocket),e.url&&(t=o.parseConnectionUrl(e.url),i=i||t.service),this.options=o.assign(!1,e,t,i&&r(i)),this.options.maxConnections=this.options.maxConnections||5,this.options.maxMessages=this.options.maxMessages||100,this.logger=o.getLogger(this.options,{component:this.options.component||"smtp-pool"});let s=new a(this.options);this.name="SMTP (pool)",this.version=c.version+"[client:"+s.version+"]",this._rateLimit={counter:0,timeout:null,waiting:[],checkpoint:!1,delta:Number(this.options.rateDelta)||1e3,limit:Number(this.options.rateLimit)||0},this._closed=!1,this._queue=[],this._connections=[],this._connectionCounter=0,this.idling=!0,setImmediate((()=>{this.idling&&this.emit("idle")}))}getSocket(e,t){return setImmediate((()=>t(null,!1)))}send(e,t){return!this._closed&&(this._queue.push({mail:e,requeueAttempts:0,callback:t}),this.idling&&this._queue.length>=this.options.maxConnections&&(this.idling=!1),setImmediate((()=>this._processMessages())),!0)}close(){let e,t=this._connections.length;if(this._closed=!0,clearTimeout(this._rateLimit.timeout),!t&&!this._queue.length)return;for(let i=t-1;i>=0;i--)this._connections[i]&&this._connections[i].available&&(e=this._connections[i],e.close(),this.logger.info({tnx:"connection",cid:e.id,action:"removed"},"Connection #%s removed",e.id));if(t&&!this._connections.length&&this.logger.debug({tnx:"connection"},"All connections removed"),!this._queue.length)return;let invokeCallbacks=()=>{if(!this._queue.length)return void this.logger.debug({tnx:"connection"},"Pending queue entries cleared");let t=this._queue.shift();if(t&&"function"==typeof t.callback)try{t.callback(new Error("Connection pool was closed"))}catch(t){this.logger.error({err:t,tnx:"callback",cid:e.id},"Callback error for #%s: %s",e.id,t.message)}setImmediate(invokeCallbacks)};setImmediate(invokeCallbacks)}_processMessages(){let e,t,i;if(this._closed)return;if(!this._queue.length)return void(this.idling||(this.idling=!0,this.emit("idle")));for(t=0,i=this._connections.length;t<i;t++)if(this._connections[t].available){e=this._connections[t];break}if(!e&&this._connections.length<this.options.maxConnections&&(e=this._createConnection()),!e)return void(this.idling=!1);!this.idling&&this._queue.length<this.options.maxConnections&&(this.idling=!0,this.emit("idle"));let s=e.queueEntry=this._queue.shift();s.messageId=(e.queueEntry.mail.message.getHeader("message-id")||"").replace(/[<>\s]/g,""),e.available=!1,this.logger.debug({tnx:"pool",cid:e.id,messageId:s.messageId,action:"assign"},"Assigned message <%s> to #%s (%s)",s.messageId,e.id,e.messages+1),this._rateLimit.limit&&(this._rateLimit.counter++,this._rateLimit.checkpoint||(this._rateLimit.checkpoint=Date.now())),e.send(s.mail,((t,i)=>{if(s===e.queueEntry){try{s.callback(t,i)}catch(t){this.logger.error({err:t,tnx:"callback",cid:e.id},"Callback error for #%s: %s",e.id,t.message)}e.queueEntry=!1}}))}_createConnection(){let e=new n(this);return e.id=++this._connectionCounter,this.logger.info({tnx:"pool",cid:e.id,action:"conection"},"Created new pool resource #%s",e.id),e.on("available",(()=>{this.logger.debug({tnx:"connection",cid:e.id,action:"available"},"Connection #%s became available",e.id),this._closed?this.close():this._processMessages()})),e.once("error",(t=>{if("EMAXLIMIT"!==t.code?this.logger.error({err:t,tnx:"pool",cid:e.id},"Pool Error for #%s: %s",e.id,t.message):this.logger.debug({tnx:"pool",cid:e.id,action:"maxlimit"},"Max messages limit exchausted for #%s",e.id),e.queueEntry){try{e.queueEntry.callback(t)}catch(t){this.logger.error({err:t,tnx:"callback",cid:e.id},"Callback error for #%s: %s",e.id,t.message)}e.queueEntry=!1}this._removeConnection(e),this._continueProcessing()})),e.once("close",(()=>{this.logger.info({tnx:"connection",cid:e.id,action:"closed"},"Connection #%s was closed",e.id),this._removeConnection(e),e.queueEntry?setTimeout((()=>{e.queueEntry&&(this._shouldRequeuOnConnectionClose(e.queueEntry)?this._requeueEntryOnConnectionClose(e):this._failDeliveryOnConnectionClose(e)),this._continueProcessing()}),50):this._continueProcessing()})),this._connections.push(e),e}_shouldRequeuOnConnectionClose(e){return void 0===this.options.maxRequeues||this.options.maxRequeues<0||e.requeueAttempts<this.options.maxRequeues}_failDeliveryOnConnectionClose(e){if(e.queueEntry&&e.queueEntry.callback){try{e.queueEntry.callback(new Error("Reached maximum number of retries after connection was closed"))}catch(t){this.logger.error({err:t,tnx:"callback",messageId:e.queueEntry.messageId,cid:e.id},"Callback error for #%s: %s",e.id,t.message)}e.queueEntry=!1}}_requeueEntryOnConnectionClose(e){e.queueEntry.requeueAttempts=e.queueEntry.requeueAttempts+1,this.logger.debug({tnx:"pool",cid:e.id,messageId:e.queueEntry.messageId,action:"requeue"},"Re-queued message <%s> for #%s. Attempt: #%s",e.queueEntry.messageId,e.id,e.queueEntry.requeueAttempts),this._queue.unshift(e.queueEntry),e.queueEntry=!1}_continueProcessing(){this._closed?this.close():setTimeout((()=>this._processMessages()),100)}_removeConnection(e){let t=this._connections.indexOf(e);-1!==t&&this._connections.splice(t,1)}_checkRateLimit(e){if(!this._rateLimit.limit)return e();let t=Date.now();return this._rateLimit.counter<this._rateLimit.limit?e():(this._rateLimit.waiting.push(e),this._rateLimit.checkpoint<=t-this._rateLimit.delta?this._clearRateLimit():void(this._rateLimit.timeout||(this._rateLimit.timeout=setTimeout((()=>this._clearRateLimit()),this._rateLimit.delta-(t-this._rateLimit.checkpoint)),this._rateLimit.checkpoint=t)))}_clearRateLimit(){for(clearTimeout(this._rateLimit.timeout),this._rateLimit.timeout=null,this._rateLimit.counter=0,this._rateLimit.checkpoint=!1;this._rateLimit.waiting.length;){let e=this._rateLimit.waiting.shift();setImmediate(e)}}isIdle(){return this.idling}verify(e){let t;e||(t=new Promise(((t,i)=>{e=o.callbackPromise(t,i)})));let i=new n(this).auth;return this.getSocket(this.options,((t,s)=>{if(t)return e(t);let n=this.options;s&&s.connection&&(this.logger.info({tnx:"proxy",remoteAddress:s.connection.remoteAddress,remotePort:s.connection.remotePort,destHost:n.host||"",destPort:n.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",s.connection.remoteAddress,s.connection.remotePort,n.host||"",n.port||""),n=o.assign(!1,n),Object.keys(s).forEach((e=>{n[e]=s[e]})));let r=new a(n),c=!1;r.once("error",(t=>{if(!c)return c=!0,r.close(),e(t)})),r.once("end",(()=>{if(!c)return c=!0,e(new Error("Connection closed"))}));let finalize=()=>{if(!c)return c=!0,r.quit(),e(null,!0)};r.connect((()=>{if(!c)if(i&&(r.allowsAuth||n.forceAuth))r.login(i,(t=>{if(!c)return t?(c=!0,r.close(),e(t)):void finalize()}));else{if(!i&&r.allowsAuth&&n.forceAuth){let t=new Error("Authentication info was not provided");return t.code="NoAuth",c=!0,r.close(),e(t)}finalize()}}))})),t}}},212:(e,t,i)=>{"use strict";const s=i(7343),n=i(4938).assign,a=i(7107),r=i(2361);e.exports=class PoolResource extends r{constructor(e){if(super(),this.pool=e,this.options=e.options,this.logger=this.pool.logger,this.options.auth)switch((this.options.auth.type||"").toString().toUpperCase()){case"OAUTH2":{let e=new a(this.options.auth,this.logger);e.provisionCallback=this.pool.mailer&&this.pool.mailer.get("oauth2_provision_cb")||e.provisionCallback,this.auth={type:"OAUTH2",user:this.options.auth.user,oauth2:e,method:"XOAUTH2"},e.on("token",(e=>this.pool.mailer.emit("token",e))),e.on("error",(e=>this.emit("error",e)));break}default:if(!this.options.auth.user&&!this.options.auth.pass)break;this.auth={type:(this.options.auth.type||"").toString().toUpperCase()||"LOGIN",user:this.options.auth.user,credentials:{user:this.options.auth.user||"",pass:this.options.auth.pass,options:this.options.auth.options},method:(this.options.auth.method||"").trim().toUpperCase()||this.options.authMethod||!1}}this._connection=!1,this._connected=!1,this.messages=0,this.available=!0}connect(e){this.pool.getSocket(this.options,((t,i)=>{if(t)return e(t);let a=!1,r=this.options;i&&i.connection&&(this.logger.info({tnx:"proxy",remoteAddress:i.connection.remoteAddress,remotePort:i.connection.remotePort,destHost:r.host||"",destPort:r.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",i.connection.remoteAddress,i.connection.remotePort,r.host||"",r.port||""),r=n(!1,r),Object.keys(i).forEach((e=>{r[e]=i[e]}))),this.connection=new s(r),this.connection.once("error",(t=>{if(this.emit("error",t),!a)return a=!0,e(t)})),this.connection.once("end",(()=>{if(this.close(),a)return;a=!0;let t=setTimeout((()=>{if(a)return;let t=new Error("Unexpected socket close");this.connection&&this.connection._socket&&this.connection._socket.upgrading&&(t.code="ETLS"),e(t)}),1e3);try{t.unref()}catch(e){}})),this.connection.connect((()=>{if(!a)return this.auth&&(this.connection.allowsAuth||r.forceAuth)?void this.connection.login(this.auth,(t=>{if(!a){if(a=!0,t)return this.connection.close(),this.emit("error",t),e(t);this._connected=!0,e(null,!0)}})):(a=!0,this._connected=!0,e(null,!0))}))}))}send(e,t){if(!this._connected)return this.connect((i=>i?t(i):this.send(e,t)));let i=e.message.getEnvelope(),s=e.message.messageId(),n=[].concat(i.to||[]);n.length>3&&n.push("...and "+n.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:s,cid:this.id},"Sending message %s using #%s to <%s>",s,this.id,n.join(", ")),e.data.dsn&&(i.dsn=e.data.dsn),this.connection.send(i,e.message.createReadStream(),((e,n)=>{if(this.messages++,e)return this.connection.close(),this.emit("error",e),t(e);n.envelope={from:i.from,to:i.to},n.messageId=s,setImmediate((()=>{let e;this.messages>=this.options.maxMessages?(e=new Error("Resource exhausted"),e.code="EMAXLIMIT",this.connection.close(),this.emit("error",e)):this.pool._checkRateLimit((()=>{this.available=!0,this.emit("available")}))})),t(null,n)}))}close(){this._connected=!1,this.auth&&this.auth.oauth2&&this.auth.oauth2.removeAllListeners(),this.connection&&this.connection.close(),this.emit("close")}}},9468:(e,t,i)=>{"use strict";const s=i(2361),n=i(7343),a=i(2337),r=i(4938),o=i(7107),c=i(4129);e.exports=class SMTPTransport extends s{constructor(e){let t;super(),"string"==typeof(e=e||{})&&(e={url:e});let i=e.service;"function"==typeof e.getSocket&&(this.getSocket=e.getSocket),e.url&&(t=r.parseConnectionUrl(e.url),i=i||t.service),this.options=r.assign(!1,e,t,i&&a(i)),this.logger=r.getLogger(this.options,{component:this.options.component||"smtp-transport"});let s=new n(this.options);this.name="SMTP",this.version=c.version+"[client:"+s.version+"]",this.options.auth&&(this.auth=this.getAuth({}))}getSocket(e,t){return setImmediate((()=>t(null,!1)))}getAuth(e){if(!e)return this.auth;let t=!1,i={};if(this.options.auth&&"object"==typeof this.options.auth&&Object.keys(this.options.auth).forEach((e=>{t=!0,i[e]=this.options.auth[e]})),e&&"object"==typeof e&&Object.keys(e).forEach((s=>{t=!0,i[s]=e[s]})),!t)return!1;if("OAUTH2"===(i.type||"").toString().toUpperCase()){if(!i.service&&!i.user)return!1;let e=new o(i,this.logger);return e.provisionCallback=this.mailer&&this.mailer.get("oauth2_provision_cb")||e.provisionCallback,e.on("token",(e=>this.mailer.emit("token",e))),e.on("error",(e=>this.emit("error",e))),{type:"OAUTH2",user:i.user,oauth2:e,method:"XOAUTH2"}}return{type:(i.type||"").toString().toUpperCase()||"LOGIN",user:i.user,credentials:{user:i.user||"",pass:i.pass,options:i.options},method:(i.method||"").trim().toUpperCase()||this.options.authMethod||!1}}send(e,t){this.getSocket(this.options,((i,s)=>{if(i)return t(i);let a=!1,o=this.options;s&&s.connection&&(this.logger.info({tnx:"proxy",remoteAddress:s.connection.remoteAddress,remotePort:s.connection.remotePort,destHost:o.host||"",destPort:o.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",s.connection.remoteAddress,s.connection.remotePort,o.host||"",o.port||""),o=r.assign(!1,o),Object.keys(s).forEach((e=>{o[e]=s[e]})));let c=new n(o);c.once("error",(e=>{if(!a)return a=!0,c.close(),t(e)})),c.once("end",(()=>{if(a)return;let e=setTimeout((()=>{if(a)return;a=!0;let e=new Error("Unexpected socket close");c&&c._socket&&c._socket.upgrading&&(e.code="ETLS"),t(e)}),1e3);try{e.unref()}catch(e){}}));let sendMessage=()=>{let i=e.message.getEnvelope(),s=e.message.messageId(),n=[].concat(i.to||[]);n.length>3&&n.push("...and "+n.splice(2).length+" more"),e.data.dsn&&(i.dsn=e.data.dsn),this.logger.info({tnx:"send",messageId:s},"Sending message %s to <%s>",s,n.join(", ")),c.send(i,e.message.createReadStream(),((e,n)=>{if(a=!0,c.close(),e)return this.logger.error({err:e,tnx:"send"},"Send error for %s: %s",s,e.message),t(e);n.envelope={from:i.from,to:i.to},n.messageId=s;try{return t(null,n)}catch(e){this.logger.error({err:e,tnx:"callback"},"Callback error for %s: %s",s,e.message)}}))};c.connect((()=>{if(a)return;let i=this.getAuth(e.data.auth);i&&(c.allowsAuth||o.forceAuth)?c.login(i,(e=>{if(i&&i!==this.auth&&i.oauth2&&i.oauth2.removeAllListeners(),!a)return e?(a=!0,c.close(),t(e)):void sendMessage()})):sendMessage()}))}))}verify(e){let t;return e||(t=new Promise(((t,i)=>{e=r.callbackPromise(t,i)}))),this.getSocket(this.options,((t,i)=>{if(t)return e(t);let s=this.options;i&&i.connection&&(this.logger.info({tnx:"proxy",remoteAddress:i.connection.remoteAddress,remotePort:i.connection.remotePort,destHost:s.host||"",destPort:s.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",i.connection.remoteAddress,i.connection.remotePort,s.host||"",s.port||""),s=r.assign(!1,s),Object.keys(i).forEach((e=>{s[e]=i[e]})));let a=new n(s),o=!1;a.once("error",(t=>{if(!o)return o=!0,a.close(),e(t)})),a.once("end",(()=>{if(!o)return o=!0,e(new Error("Connection closed"))}));let finalize=()=>{if(!o)return o=!0,a.quit(),e(null,!0)};a.connect((()=>{if(o)return;let t=this.getAuth({});if(t&&(a.allowsAuth||s.forceAuth))a.login(t,(t=>{if(!o)return t?(o=!0,a.close(),e(t)):void finalize()}));else{if(!t&&a.allowsAuth&&s.forceAuth){let t=new Error("Authentication info was not provided");return t.code="NoAuth",o=!0,a.close(),e(t)}finalize()}}))})),t}close(){this.auth&&this.auth.oauth2&&this.auth.oauth2.removeAllListeners(),this.emit("close")}}},8103:(e,t,i)=>{"use strict";const s=i(4129),n=i(4938);e.exports=class StreamTransport{constructor(e){e=e||{},this.options=e||{},this.name="StreamTransport",this.version=s.version,this.logger=n.getLogger(this.options,{component:this.options.component||"stream-transport"}),this.winbreak=["win","windows","dos","\r\n"].includes((e.newline||"").toString().toLowerCase())}send(e,t){e.message.keepBcc=!0;let i=e.data.envelope||e.message.getEnvelope(),s=e.message.messageId(),n=[].concat(i.to||[]);n.length>3&&n.push("...and "+n.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:s},"Sending message %s to <%s> using %s line breaks",s,n.join(", "),this.winbreak?"<CR><LF>":"<LF>"),setImmediate((()=>{let i;try{i=e.message.createReadStream()}catch(e){return this.logger.error({err:e,tnx:"send",messageId:s},"Creating send stream failed for %s. %s",s,e.message),t(e)}if(!this.options.buffer)return i.once("error",(e=>{this.logger.error({err:e,tnx:"send",messageId:s},"Failed creating message for %s. %s",s,e.message)})),t(null,{envelope:e.data.envelope||e.message.getEnvelope(),messageId:s,message:i});let n=[],a=0;i.on("readable",(()=>{let e;for(;null!==(e=i.read());)n.push(e),a+=e.length})),i.once("error",(e=>(this.logger.error({err:e,tnx:"send",messageId:s},"Failed creating message for %s. %s",s,e.message),t(e)))),i.on("end",(()=>t(null,{envelope:e.data.envelope||e.message.getEnvelope(),messageId:s,message:Buffer.concat(n,a)})))}))}}},2337:(e,t,i)=>{"use strict";const s=i(8249),n={};function normalizeKey(e){return e.replace(/[^a-zA-Z0-9.-]/g,"").toLowerCase()}function normalizeService(e){let t=["domains","aliases"],i={};return Object.keys(e).forEach((s=>{t.indexOf(s)<0&&(i[s]=e[s])})),i}Object.keys(s).forEach((e=>{let t=s[e];n[normalizeKey(e)]=normalizeService(t),[].concat(t.aliases||[]).forEach((e=>{n[normalizeKey(e)]=normalizeService(t)})),[].concat(t.domains||[]).forEach((e=>{n[normalizeKey(e)]=normalizeService(t)}))})),e.exports=function(e){return e=normalizeKey(e.split("@").pop()),n[e]||!1}},7107:(e,t,i)=>{"use strict";const s=i(2781).Stream,n=i(338),a=i(6113),r=i(4938);e.exports=class XOAuth2 extends s{constructor(e,t){if(super(),this.options=e||{},e&&e.serviceClient){if(!e.privateKey||!e.user)return void setImmediate((()=>this.emit("error",new Error('Options "privateKey" and "user" are required for service account!'))));let t=Math.min(Math.max(Number(this.options.serviceRequestTimeout)||0,0),3600);this.options.serviceRequestTimeout=t||300}if(this.logger=r.getLogger({logger:t},{component:this.options.component||"OAuth2"}),this.provisionCallback="function"==typeof this.options.provisionCallback&&this.options.provisionCallback,this.options.accessUrl=this.options.accessUrl||"https://accounts.google.com/o/oauth2/token",this.options.customHeaders=this.options.customHeaders||{},this.options.customParams=this.options.customParams||{},this.accessToken=this.options.accessToken||!1,this.options.expires&&Number(this.options.expires))this.expires=this.options.expires;else{let e=Math.max(Number(this.options.timeout)||0,0);this.expires=e&&Date.now()+1e3*e||0}}getToken(e,t){if(!e&&this.accessToken&&(!this.expires||this.expires>Date.now()))return t(null,this.accessToken);let generateCallback=(...e)=>{e[0]?this.logger.error({err:e[0],tnx:"OAUTH2",user:this.options.user,action:"renew"},"Failed generating new Access Token for %s",this.options.user):this.logger.info({tnx:"OAUTH2",user:this.options.user,action:"renew"},"Generated new Access Token for %s",this.options.user),t(...e)};this.provisionCallback?this.provisionCallback(this.options.user,!!e,((e,t,i)=>{!e&&t&&(this.accessToken=t,this.expires=i||0),generateCallback(e,t)})):this.generateToken(generateCallback)}updateToken(e,t){this.accessToken=e,t=Math.max(Number(t)||0,0),this.expires=t&&Date.now()+1e3*t||0,this.emit("token",{user:this.options.user,accessToken:e||"",expires:this.expires})}generateToken(e){let t,i;if(this.options.serviceClient){let s,n=Math.floor(Date.now()/1e3),a={iss:this.options.serviceClient,scope:this.options.scope||"https://mail.google.com/",sub:this.options.user,aud:this.options.accessUrl,iat:n,exp:n+this.options.serviceRequestTimeout};try{s=this.jwtSignRS256(a)}catch(t){return e(new Error("Can't generate token. Check your auth options"))}t={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:s},i={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:a}}else{if(!this.options.refreshToken)return e(new Error("Can't create new access token for user"));t={client_id:this.options.clientId||"",client_secret:this.options.clientSecret||"",refresh_token:this.options.refreshToken,grant_type:"refresh_token"},i={client_id:this.options.clientId||"",client_secret:(this.options.clientSecret||"").substr(0,6)+"...",refresh_token:(this.options.refreshToken||"").substr(0,6)+"...",grant_type:"refresh_token"}}Object.keys(this.options.customParams).forEach((e=>{t[e]=this.options.customParams[e],i[e]=this.options.customParams[e]})),this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"generate"},"Requesting token using: %s",JSON.stringify(i)),this.postRequest(this.options.accessUrl,t,this.options,((t,i)=>{let s;if(t)return e(t);try{s=JSON.parse(i.toString())}catch(t){return e(t)}if(!s||"object"!=typeof s)return this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"post"},"Response: %s",(i||"").toString()),e(new Error("Invalid authentication response"));let n={};if(Object.keys(s).forEach((e=>{n[e]="access_token"!==e?s[e]:(s[e]||"").toString().substr(0,6)+"..."})),this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"post"},"Response: %s",JSON.stringify(n)),s.error){let t=s.error;return s.error_description&&(t+=": "+s.error_description),s.error_uri&&(t+=" ("+s.error_uri+")"),e(new Error(t))}return s.access_token?(this.updateToken(s.access_token,s.expires_in),e(null,this.accessToken)):e(new Error("No access token"))}))}buildXOAuth2Token(e){let t=["user="+(this.options.user||""),"auth=Bearer "+(e||this.accessToken),"",""];return Buffer.from(t.join(""),"utf-8").toString("base64")}postRequest(e,t,i,s){let a=!1,r=[],o=0,c=n(e,{method:"post",headers:i.customHeaders,body:t,allowErrorResponse:!0});c.on("readable",(()=>{let e;for(;null!==(e=c.read());)r.push(e),o+=e.length})),c.once("error",(e=>{if(!a)return a=!0,s(e)})),c.once("end",(()=>{if(!a)return a=!0,s(null,Buffer.concat(r,o))}))}toBase64URL(e){return"string"==typeof e&&(e=Buffer.from(e)),e.toString("base64").replace(/[=]+/g,"").replace(/\+/g,"-").replace(/\//g,"_")}jwtSignRS256(e){e=['{"alg":"RS256","typ":"JWT"}',JSON.stringify(e)].map((e=>this.toBase64URL(e))).join(".");let t=a.createSign("RSA-SHA256").update(e).sign(this.options.privateKey);return e+"."+this.toBase64URL(t)}}},3171:e=>{e.exports=function(e,t){if("string"!=typeof e)throw new TypeError("expected path to be a string");if("\\"===e||"/"===e)return"/";var i=e.length;if(i<=1)return e;var s="";if(i>4&&"\\"===e[3]){var n=e[2];"?"!==n&&"."!==n||"\\\\"!==e.slice(0,2)||(e=e.slice(2),s="//")}var a=e.split(/[/\\]+/);return!1!==t&&""===a[a.length-1]&&a.pop(),s+a.join("/")}},778:(e,t,i)=>{var s=i(2479);function once(e){var f=function(){return f.called?f.value:(f.called=!0,f.value=e.apply(this,arguments))};return f.called=!1,f}function onceStrict(e){var f=function(){if(f.called)throw new Error(f.onceError);return f.called=!0,f.value=e.apply(this,arguments)},t=e.name||"Function wrapped with `once`";return f.onceError=t+" shouldn't be called more than once",f.called=!1,f}e.exports=s(once),e.exports.strict=s(onceStrict),once.proto=once((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return once(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return onceStrict(this)},configurable:!0})}))},9444:(e,t,i)=>{"use strict";e.exports=i(6087)},1006:(e,t,i)=>{"use strict";const s=i(1017),n="[^\\\\/]",a="\\.",r="\\/",o="[^/]",c="(?:\\/|$)",l="(?:^|\\/)",p="\\.{1,2}(?:\\/|$)",d={DOT_LITERAL:a,PLUS_LITERAL:"\\+",QMARK_LITERAL:"\\?",SLASH_LITERAL:r,ONE_CHAR:"(?=.)",QMARK:o,END_ANCHOR:c,DOTS_SLASH:p,NO_DOT:"(?!\\.)",NO_DOTS:`(?!(?:^|\\/)${p})`,NO_DOT_SLASH:"(?!\\.{0,1}(?:\\/|$))",NO_DOTS_SLASH:`(?!${p})`,QMARK_NO_DOT:"[^.\\/]",STAR:"[^/]*?",START_ANCHOR:l},h={...d,SLASH_LITERAL:"[\\\\/]",QMARK:n,STAR:"[^\\\\/]*?",DOTS_SLASH:"\\.{1,2}(?:[\\\\/]|$)",NO_DOT:"(?!\\.)",NO_DOTS:"(?!(?:^|[\\\\/])\\.{1,2}(?:[\\\\/]|$))",NO_DOT_SLASH:"(?!\\.{0,1}(?:[\\\\/]|$))",NO_DOTS_SLASH:"(?!\\.{1,2}(?:[\\\\/]|$))",QMARK_NO_DOT:"[^.\\\\/]",START_ANCHOR:"(?:^|[\\\\/])",END_ANCHOR:"(?:[\\\\/]|$)"};e.exports={MAX_LENGTH:65536,POSIX_REGEX_SOURCE:{alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"},REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:s.sep,extglobChars:e=>({"!":{type:"negate",open:"(?:(?!(?:",close:`))${e.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}),globChars:e=>!0===e?h:d}},3376:(e,t,i)=>{"use strict";const s=i(1006),n=i(8702),{MAX_LENGTH:a,POSIX_REGEX_SOURCE:r,REGEX_NON_SPECIAL_CHARS:o,REGEX_SPECIAL_CHARS_BACKREF:c,REPLACEMENTS:l}=s,expandRange=(e,t)=>{if("function"==typeof t.expandRange)return t.expandRange(...e,t);e.sort();const i=`[${e.join("-")}]`;try{new RegExp(i)}catch(t){return e.map((e=>n.escapeRegex(e))).join("..")}return i},syntaxError=(e,t)=>`Missing ${e}: "${t}" - use "\\\\${t}" to match literal characters`,parse=(e,t)=>{if("string"!=typeof e)throw new TypeError("Expected a string");e=l[e]||e;const i={...t},p="number"==typeof i.maxLength?Math.min(a,i.maxLength):a;let d=e.length;if(d>p)throw new SyntaxError(`Input length: ${d}, exceeds maximum allowed length: ${p}`);const h={type:"bos",value:"",output:i.prepend||""},u=[h],g=i.capture?"":"?:",v=n.isWindows(t),y=s.globChars(v),x=s.extglobChars(y),{DOT_LITERAL:_,PLUS_LITERAL:b,SLASH_LITERAL:w,ONE_CHAR:E,DOTS_SLASH:k,NO_DOT:S,NO_DOT_SLASH:T,NO_DOTS_SLASH:A,QMARK:O,QMARK_NO_DOT:C,STAR:N,START_ANCHOR:R}=y,globstar=e=>`(${g}(?:(?!${R}${e.dot?k:_}).)*?)`,I=i.dot?"":S,D=i.dot?O:C;let L=!0===i.bash?globstar(i):N;i.capture&&(L=`(${L})`),"boolean"==typeof i.noext&&(i.noextglob=i.noext);const j={input:e,index:-1,start:0,dot:!0===i.dot,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:u};e=n.removePrefix(e,j),d=e.length;const M=[],P=[],U=[];let $,H=h;const eos=()=>j.index===d-1,B=j.peek=(t=1)=>e[j.index+t],q=j.advance=()=>e[++j.index]||"",remaining=()=>e.slice(j.index+1),consume=(e="",t=0)=>{j.consumed+=e,j.index+=t},append=e=>{j.output+=null!=e.output?e.output:e.value,consume(e.value)},negate=()=>{let e=1;for(;"!"===B()&&("("!==B(2)||"?"===B(3));)q(),j.start++,e++;return e%2!=0&&(j.negated=!0,j.start++,!0)},increment=e=>{j[e]++,U.push(e)},decrement=e=>{j[e]--,U.pop()},push=e=>{if("globstar"===H.type){const t=j.braces>0&&("comma"===e.type||"brace"===e.type),i=!0===e.extglob||M.length&&("pipe"===e.type||"paren"===e.type);"slash"===e.type||"paren"===e.type||t||i||(j.output=j.output.slice(0,-H.output.length),H.type="star",H.value="*",H.output=L,j.output+=H.output)}if(M.length&&"paren"!==e.type&&(M[M.length-1].inner+=e.value),(e.value||e.output)&&append(e),H&&"text"===H.type&&"text"===e.type)return H.value+=e.value,void(H.output=(H.output||"")+e.value);e.prev=H,u.push(e),H=e},extglobOpen=(e,t)=>{const s={...x[t],conditions:1,inner:""};s.prev=H,s.parens=j.parens,s.output=j.output;const n=(i.capture?"(":"")+s.open;increment("parens"),push({type:e,value:t,output:j.output?"":E}),push({type:"paren",extglob:!0,value:q(),output:n}),M.push(s)},extglobClose=e=>{let s,n=e.close+(i.capture?")":"");if("negate"===e.type){let a=L;if(e.inner&&e.inner.length>1&&e.inner.includes("/")&&(a=globstar(i)),(a!==L||eos()||/^\)+$/.test(remaining()))&&(n=e.close=`)$))${a}`),e.inner.includes("*")&&(s=remaining())&&/^\.[^\\/.]+$/.test(s)){const i=parse(s,{...t,fastpaths:!1}).output;n=e.close=`)${i})${a})`}"bos"===e.prev.type&&(j.negatedExtglob=!0)}push({type:"paren",extglob:!0,value:$,output:n}),decrement("parens")};if(!1!==i.fastpaths&&!/(^[*!]|[/()[\]{}"])/.test(e)){let s=!1,a=e.replace(c,((e,t,i,n,a,r)=>"\\"===n?(s=!0,e):"?"===n?t?t+n+(a?O.repeat(a.length):""):0===r?D+(a?O.repeat(a.length):""):O.repeat(i.length):"."===n?_.repeat(i.length):"*"===n?t?t+n+(a?L:""):L:t?e:`\\${e}`));return!0===s&&(a=!0===i.unescape?a.replace(/\\/g,""):a.replace(/\\+/g,(e=>e.length%2==0?"\\\\":e?"\\":""))),a===e&&!0===i.contains?(j.output=e,j):(j.output=n.wrapOutput(a,j,t),j)}for(;!eos();){if($=q(),"\0"===$)continue;if("\\"===$){const e=B();if("/"===e&&!0!==i.bash)continue;if("."===e||";"===e)continue;if(!e){$+="\\",push({type:"text",value:$});continue}const t=/^\\+/.exec(remaining());let s=0;if(t&&t[0].length>2&&(s=t[0].length,j.index+=s,s%2!=0&&($+="\\")),!0===i.unescape?$=q():$+=q(),0===j.brackets){push({type:"text",value:$});continue}}if(j.brackets>0&&("]"!==$||"["===H.value||"[^"===H.value)){if(!1!==i.posix&&":"===$){const e=H.value.slice(1);if(e.includes("[")&&(H.posix=!0,e.includes(":"))){const e=H.value.lastIndexOf("["),t=H.value.slice(0,e),i=H.value.slice(e+2),s=r[i];if(s){H.value=t+s,j.backtrack=!0,q(),h.output||1!==u.indexOf(H)||(h.output=E);continue}}}("["===$&&":"!==B()||"-"===$&&"]"===B())&&($=`\\${$}`),"]"!==$||"["!==H.value&&"[^"!==H.value||($=`\\${$}`),!0===i.posix&&"!"===$&&"["===H.value&&($="^"),H.value+=$,append({value:$});continue}if(1===j.quotes&&'"'!==$){$=n.escapeRegex($),H.value+=$,append({value:$});continue}if('"'===$){j.quotes=1===j.quotes?0:1,!0===i.keepQuotes&&push({type:"text",value:$});continue}if("("===$){increment("parens"),push({type:"paren",value:$});continue}if(")"===$){if(0===j.parens&&!0===i.strictBrackets)throw new SyntaxError(syntaxError("opening","("));const e=M[M.length-1];if(e&&j.parens===e.parens+1){extglobClose(M.pop());continue}push({type:"paren",value:$,output:j.parens?")":"\\)"}),decrement("parens");continue}if("["===$){if(!0!==i.nobracket&&remaining().includes("]"))increment("brackets");else{if(!0!==i.nobracket&&!0===i.strictBrackets)throw new SyntaxError(syntaxError("closing","]"));$=`\\${$}`}push({type:"bracket",value:$});continue}if("]"===$){if(!0===i.nobracket||H&&"bracket"===H.type&&1===H.value.length){push({type:"text",value:$,output:`\\${$}`});continue}if(0===j.brackets){if(!0===i.strictBrackets)throw new SyntaxError(syntaxError("opening","["));push({type:"text",value:$,output:`\\${$}`});continue}decrement("brackets");const e=H.value.slice(1);if(!0===H.posix||"^"!==e[0]||e.includes("/")||($=`/${$}`),H.value+=$,append({value:$}),!1===i.literalBrackets||n.hasRegexChars(e))continue;const t=n.escapeRegex(H.value);if(j.output=j.output.slice(0,-H.value.length),!0===i.literalBrackets){j.output+=t,H.value=t;continue}H.value=`(${g}${t}|${H.value})`,j.output+=H.value;continue}if("{"===$&&!0!==i.nobrace){increment("braces");const e={type:"brace",value:$,output:"(",outputIndex:j.output.length,tokensIndex:j.tokens.length};P.push(e),push(e);continue}if("}"===$){const e=P[P.length-1];if(!0===i.nobrace||!e){push({type:"text",value:$,output:$});continue}let t=")";if(!0===e.dots){const e=u.slice(),s=[];for(let t=e.length-1;t>=0&&(u.pop(),"brace"!==e[t].type);t--)"dots"!==e[t].type&&s.unshift(e[t].value);t=expandRange(s,i),j.backtrack=!0}if(!0!==e.comma&&!0!==e.dots){const i=j.output.slice(0,e.outputIndex),s=j.tokens.slice(e.tokensIndex);e.value=e.output="\\{",$=t="\\}",j.output=i;for(const e of s)j.output+=e.output||e.value}push({type:"brace",value:$,output:t}),decrement("braces"),P.pop();continue}if("|"===$){M.length>0&&M[M.length-1].conditions++,push({type:"text",value:$});continue}if(","===$){let e=$;const t=P[P.length-1];t&&"braces"===U[U.length-1]&&(t.comma=!0,e="|"),push({type:"comma",value:$,output:e});continue}if("/"===$){if("dot"===H.type&&j.index===j.start+1){j.start=j.index+1,j.consumed="",j.output="",u.pop(),H=h;continue}push({type:"slash",value:$,output:w});continue}if("."===$){if(j.braces>0&&"dot"===H.type){"."===H.value&&(H.output=_);const e=P[P.length-1];H.type="dots",H.output+=$,H.value+=$,e.dots=!0;continue}if(j.braces+j.parens===0&&"bos"!==H.type&&"slash"!==H.type){push({type:"text",value:$,output:_});continue}push({type:"dot",value:$,output:_});continue}if("?"===$){if(!(H&&"("===H.value)&&!0!==i.noextglob&&"("===B()&&"?"!==B(2)){extglobOpen("qmark",$);continue}if(H&&"paren"===H.type){const e=B();let t=$;if("<"===e&&!n.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");("("===H.value&&!/[!=<:]/.test(e)||"<"===e&&!/<([!=]|\w+>)/.test(remaining()))&&(t=`\\${$}`),push({type:"text",value:$,output:t});continue}if(!0!==i.dot&&("slash"===H.type||"bos"===H.type)){push({type:"qmark",value:$,output:C});continue}push({type:"qmark",value:$,output:O});continue}if("!"===$){if(!0!==i.noextglob&&"("===B()&&("?"!==B(2)||!/[!=<:]/.test(B(3)))){extglobOpen("negate",$);continue}if(!0!==i.nonegate&&0===j.index){negate();continue}}if("+"===$){if(!0!==i.noextglob&&"("===B()&&"?"!==B(2)){extglobOpen("plus",$);continue}if(H&&"("===H.value||!1===i.regex){push({type:"plus",value:$,output:b});continue}if(H&&("bracket"===H.type||"paren"===H.type||"brace"===H.type)||j.parens>0){push({type:"plus",value:$});continue}push({type:"plus",value:b});continue}if("@"===$){if(!0!==i.noextglob&&"("===B()&&"?"!==B(2)){push({type:"at",extglob:!0,value:$,output:""});continue}push({type:"text",value:$});continue}if("*"!==$){"$"!==$&&"^"!==$||($=`\\${$}`);const e=o.exec(remaining());e&&($+=e[0],j.index+=e[0].length),push({type:"text",value:$});continue}if(H&&("globstar"===H.type||!0===H.star)){H.type="star",H.star=!0,H.value+=$,H.output=L,j.backtrack=!0,j.globstar=!0,consume($);continue}let t=remaining();if(!0!==i.noextglob&&/^\([^?]/.test(t)){extglobOpen("star",$);continue}if("star"===H.type){if(!0===i.noglobstar){consume($);continue}const s=H.prev,n=s.prev,a="slash"===s.type||"bos"===s.type,r=n&&("star"===n.type||"globstar"===n.type);if(!0===i.bash&&(!a||t[0]&&"/"!==t[0])){push({type:"star",value:$,output:""});continue}const o=j.braces>0&&("comma"===s.type||"brace"===s.type),c=M.length&&("pipe"===s.type||"paren"===s.type);if(!a&&"paren"!==s.type&&!o&&!c){push({type:"star",value:$,output:""});continue}for(;"/**"===t.slice(0,3);){const i=e[j.index+4];if(i&&"/"!==i)break;t=t.slice(3),consume("/**",3)}if("bos"===s.type&&eos()){H.type="globstar",H.value+=$,H.output=globstar(i),j.output=H.output,j.globstar=!0,consume($);continue}if("slash"===s.type&&"bos"!==s.prev.type&&!r&&eos()){j.output=j.output.slice(0,-(s.output+H.output).length),s.output=`(?:${s.output}`,H.type="globstar",H.output=globstar(i)+(i.strictSlashes?")":"|$)"),H.value+=$,j.globstar=!0,j.output+=s.output+H.output,consume($);continue}if("slash"===s.type&&"bos"!==s.prev.type&&"/"===t[0]){const e=void 0!==t[1]?"|$":"";j.output=j.output.slice(0,-(s.output+H.output).length),s.output=`(?:${s.output}`,H.type="globstar",H.output=`${globstar(i)}${w}|${w}${e})`,H.value+=$,j.output+=s.output+H.output,j.globstar=!0,consume($+q()),push({type:"slash",value:"/",output:""});continue}if("bos"===s.type&&"/"===t[0]){H.type="globstar",H.value+=$,H.output=`(?:^|${w}|${globstar(i)}${w})`,j.output=H.output,j.globstar=!0,consume($+q()),push({type:"slash",value:"/",output:""});continue}j.output=j.output.slice(0,-H.output.length),H.type="globstar",H.output=globstar(i),H.value+=$,j.output+=H.output,j.globstar=!0,consume($);continue}const s={type:"star",value:$,output:L};!0!==i.bash?!H||"bracket"!==H.type&&"paren"!==H.type||!0!==i.regex?(j.index!==j.start&&"slash"!==H.type&&"dot"!==H.type||("dot"===H.type?(j.output+=T,H.output+=T):!0===i.dot?(j.output+=A,H.output+=A):(j.output+=I,H.output+=I),"*"!==B()&&(j.output+=E,H.output+=E)),push(s)):(s.output=$,push(s)):(s.output=".*?","bos"!==H.type&&"slash"!==H.type||(s.output=I+s.output),push(s))}for(;j.brackets>0;){if(!0===i.strictBrackets)throw new SyntaxError(syntaxError("closing","]"));j.output=n.escapeLast(j.output,"["),decrement("brackets")}for(;j.parens>0;){if(!0===i.strictBrackets)throw new SyntaxError(syntaxError("closing",")"));j.output=n.escapeLast(j.output,"("),decrement("parens")}for(;j.braces>0;){if(!0===i.strictBrackets)throw new SyntaxError(syntaxError("closing","}"));j.output=n.escapeLast(j.output,"{"),decrement("braces")}if(!0===i.strictSlashes||"star"!==H.type&&"bracket"!==H.type||push({type:"maybe_slash",value:"",output:`${w}?`}),!0===j.backtrack){j.output="";for(const e of j.tokens)j.output+=null!=e.output?e.output:e.value,e.suffix&&(j.output+=e.suffix)}return j};parse.fastpaths=(e,t)=>{const i={...t},r="number"==typeof i.maxLength?Math.min(a,i.maxLength):a,o=e.length;if(o>r)throw new SyntaxError(`Input length: ${o}, exceeds maximum allowed length: ${r}`);e=l[e]||e;const c=n.isWindows(t),{DOT_LITERAL:p,SLASH_LITERAL:d,ONE_CHAR:h,DOTS_SLASH:u,NO_DOT:g,NO_DOTS:v,NO_DOTS_SLASH:y,STAR:x,START_ANCHOR:_}=s.globChars(c),b=i.dot?v:g,w=i.dot?y:g,E=i.capture?"":"?:";let k=!0===i.bash?".*?":x;i.capture&&(k=`(${k})`);const globstar=e=>!0===e.noglobstar?k:`(${E}(?:(?!${_}${e.dot?u:p}).)*?)`,create=e=>{switch(e){case"*":return`${b}${h}${k}`;case".*":return`${p}${h}${k}`;case"*.*":return`${b}${k}${p}${h}${k}`;case"*/*":return`${b}${k}${d}${h}${w}${k}`;case"**":return b+globstar(i);case"**/*":return`(?:${b}${globstar(i)}${d})?${w}${h}${k}`;case"**/*.*":return`(?:${b}${globstar(i)}${d})?${w}${k}${p}${h}${k}`;case"**/.*":return`(?:${b}${globstar(i)}${d})?${p}${h}${k}`;default:{const t=/^(.*?)\.(\w+)$/.exec(e);if(!t)return;const i=create(t[1]);if(!i)return;return i+p+t[2]}}},S=n.removePrefix(e,{negated:!1,prefix:""});let T=create(S);return T&&!0!==i.strictSlashes&&(T+=`${d}?`),T},e.exports=parse},6087:(e,t,i)=>{"use strict";const s=i(1017),n=i(3921),a=i(3376),r=i(8702),o=i(1006),picomatch=(e,t,i=!1)=>{if(Array.isArray(e)){const s=e.map((e=>picomatch(e,t,i))),arrayMatcher=e=>{for(const t of s){const i=t(e);if(i)return i}return!1};return arrayMatcher}const s=(n=e)&&"object"==typeof n&&!Array.isArray(n)&&e.tokens&&e.input;var n;if(""===e||"string"!=typeof e&&!s)throw new TypeError("Expected pattern to be a non-empty string");const a=t||{},o=r.isWindows(t),c=s?picomatch.compileRe(e,t):picomatch.makeRe(e,t,!1,!0),l=c.state;delete c.state;let isIgnored=()=>!1;if(a.ignore){const e={...t,ignore:null,onMatch:null,onResult:null};isIgnored=picomatch(a.ignore,e,i)}const matcher=(i,s=!1)=>{const{isMatch:n,match:r,output:p}=picomatch.test(i,c,t,{glob:e,posix:o}),d={glob:e,state:l,regex:c,posix:o,input:i,output:p,match:r,isMatch:n};return"function"==typeof a.onResult&&a.onResult(d),!1===n?(d.isMatch=!1,!!s&&d):isIgnored(i)?("function"==typeof a.onIgnore&&a.onIgnore(d),d.isMatch=!1,!!s&&d):("function"==typeof a.onMatch&&a.onMatch(d),!s||d)};return i&&(matcher.state=l),matcher};picomatch.test=(e,t,i,{glob:s,posix:n}={})=>{if("string"!=typeof e)throw new TypeError("Expected input to be a string");if(""===e)return{isMatch:!1,output:""};const a=i||{},o=a.format||(n?r.toPosixSlashes:null);let c=e===s,l=c&&o?o(e):e;return!1===c&&(l=o?o(e):e,c=l===s),!1!==c&&!0!==a.capture||(c=!0===a.matchBase||!0===a.basename?picomatch.matchBase(e,t,i,n):t.exec(l)),{isMatch:Boolean(c),match:c,output:l}},picomatch.matchBase=(e,t,i,n=r.isWindows(i))=>(t instanceof RegExp?t:picomatch.makeRe(t,i)).test(s.basename(e)),picomatch.isMatch=(e,t,i)=>picomatch(t,i)(e),picomatch.parse=(e,t)=>Array.isArray(e)?e.map((e=>picomatch.parse(e,t))):a(e,{...t,fastpaths:!1}),picomatch.scan=(e,t)=>n(e,t),picomatch.compileRe=(e,t,i=!1,s=!1)=>{if(!0===i)return e.output;const n=t||{},a=n.contains?"":"^",r=n.contains?"":"$";let o=`${a}(?:${e.output})${r}`;e&&!0===e.negated&&(o=`^(?!${o}).*$`);const c=picomatch.toRegex(o,t);return!0===s&&(c.state=e),c},picomatch.makeRe=(e,t={},i=!1,s=!1)=>{if(!e||"string"!=typeof e)throw new TypeError("Expected a non-empty string");let n={negated:!1,fastpaths:!0};return!1===t.fastpaths||"."!==e[0]&&"*"!==e[0]||(n.output=a.fastpaths(e,t)),n.output||(n=a(e,t)),picomatch.compileRe(n,t,i,s)},picomatch.toRegex=(e,t)=>{try{const i=t||{};return new RegExp(e,i.flags||(i.nocase?"i":""))}catch(e){if(t&&!0===t.debug)throw e;return/$^/}},picomatch.constants=o,e.exports=picomatch},3921:(e,t,i)=>{"use strict";const s=i(8702),{CHAR_ASTERISK:n,CHAR_AT:a,CHAR_BACKWARD_SLASH:r,CHAR_COMMA:o,CHAR_DOT:c,CHAR_EXCLAMATION_MARK:l,CHAR_FORWARD_SLASH:p,CHAR_LEFT_CURLY_BRACE:d,CHAR_LEFT_PARENTHESES:h,CHAR_LEFT_SQUARE_BRACKET:u,CHAR_PLUS:g,CHAR_QUESTION_MARK:v,CHAR_RIGHT_CURLY_BRACE:y,CHAR_RIGHT_PARENTHESES:x,CHAR_RIGHT_SQUARE_BRACKET:_}=i(1006),isPathSeparator=e=>e===p||e===r,depth=e=>{!0!==e.isPrefix&&(e.depth=e.isGlobstar?1/0:1)};e.exports=(e,t)=>{const i=t||{},b=e.length-1,w=!0===i.parts||!0===i.scanToEnd,E=[],k=[],S=[];let T,A,O=e,C=-1,N=0,R=0,I=!1,D=!1,L=!1,j=!1,M=!1,P=!1,U=!1,$=!1,H=!1,B=!1,q=0,F={value:"",depth:0,isGlob:!1};const eos=()=>C>=b,advance=()=>(T=A,O.charCodeAt(++C));for(;C<b;){let e;if(A=advance(),A!==r){if(!0===P||A===d){for(q++;!0!==eos()&&(A=advance());)if(A!==r)if(A!==d){if(!0!==P&&A===c&&(A=advance())===c){if(I=F.isBrace=!0,L=F.isGlob=!0,B=!0,!0===w)continue;break}if(!0!==P&&A===o){if(I=F.isBrace=!0,L=F.isGlob=!0,B=!0,!0===w)continue;break}if(A===y&&(q--,0===q)){P=!1,I=F.isBrace=!0,B=!0;break}}else q++;else U=F.backslashes=!0,advance();if(!0===w)continue;break}if(A!==p){if(!0!==i.noext){if(!0===(A===g||A===a||A===n||A===v||A===l)&&O.charCodeAt(C+1)===h){if(L=F.isGlob=!0,j=F.isExtglob=!0,B=!0,A===l&&C===N&&(H=!0),!0===w){for(;!0!==eos()&&(A=advance());)if(A!==r){if(A===x){L=F.isGlob=!0,B=!0;break}}else U=F.backslashes=!0,A=advance();continue}break}}if(A===n){if(T===n&&(M=F.isGlobstar=!0),L=F.isGlob=!0,B=!0,!0===w)continue;break}if(A===v){if(L=F.isGlob=!0,B=!0,!0===w)continue;break}if(A===u){for(;!0!==eos()&&(e=advance());)if(e!==r){if(e===_){D=F.isBracket=!0,L=F.isGlob=!0,B=!0;break}}else U=F.backslashes=!0,advance();if(!0===w)continue;break}if(!0===i.nonegate||A!==l||C!==N){if(!0!==i.noparen&&A===h){if(L=F.isGlob=!0,!0===w){for(;!0!==eos()&&(A=advance());)if(A!==h){if(A===x){B=!0;break}}else U=F.backslashes=!0,A=advance();continue}break}if(!0===L){if(B=!0,!0===w)continue;break}}else $=F.negated=!0,N++}else{if(E.push(C),k.push(F),F={value:"",depth:0,isGlob:!1},!0===B)continue;if(T===c&&C===N+1){N+=2;continue}R=C+1}}else U=F.backslashes=!0,A=advance(),A===d&&(P=!0)}!0===i.noext&&(j=!1,L=!1);let Q=O,z="",G="";N>0&&(z=O.slice(0,N),O=O.slice(N),R-=N),Q&&!0===L&&R>0?(Q=O.slice(0,R),G=O.slice(R)):!0===L?(Q="",G=O):Q=O,Q&&""!==Q&&"/"!==Q&&Q!==O&&isPathSeparator(Q.charCodeAt(Q.length-1))&&(Q=Q.slice(0,-1)),!0===i.unescape&&(G&&(G=s.removeBackslashes(G)),Q&&!0===U&&(Q=s.removeBackslashes(Q)));const W={prefix:z,input:e,start:N,base:Q,glob:G,isBrace:I,isBracket:D,isGlob:L,isExtglob:j,isGlobstar:M,negated:$,negatedExtglob:H};if(!0===i.tokens&&(W.maxDepth=0,isPathSeparator(A)||k.push(F),W.tokens=k),!0===i.parts||!0===i.tokens){let t;for(let s=0;s<E.length;s++){const n=t?t+1:N,a=E[s],r=e.slice(n,a);i.tokens&&(0===s&&0!==N?(k[s].isPrefix=!0,k[s].value=z):k[s].value=r,depth(k[s]),W.maxDepth+=k[s].depth),0===s&&""===r||S.push(r),t=a}if(t&&t+1<e.length){const s=e.slice(t+1);S.push(s),i.tokens&&(k[k.length-1].value=s,depth(k[k.length-1]),W.maxDepth+=k[k.length-1].depth)}W.slashes=E,W.parts=S}return W}},8702:(e,t,i)=>{"use strict";const s=i(1017),n="win32"===process.platform,{REGEX_BACKSLASH:a,REGEX_REMOVE_BACKSLASH:r,REGEX_SPECIAL_CHARS:o,REGEX_SPECIAL_CHARS_GLOBAL:c}=i(1006);t.isObject=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),t.hasRegexChars=e=>o.test(e),t.isRegexChar=e=>1===e.length&&t.hasRegexChars(e),t.escapeRegex=e=>e.replace(c,"\\$1"),t.toPosixSlashes=e=>e.replace(a,"/"),t.removeBackslashes=e=>e.replace(r,(e=>"\\"===e?"":e)),t.supportsLookbehinds=()=>{const e=process.version.slice(1).split(".").map(Number);return 3===e.length&&e[0]>=9||8===e[0]&&e[1]>=10},t.isWindows=e=>e&&"boolean"==typeof e.windows?e.windows:!0===n||"\\"===s.sep,t.escapeLast=(e,i,s)=>{const n=e.lastIndexOf(i,s);return-1===n?e:"\\"===e[n-1]?t.escapeLast(e,i,n-1):`${e.slice(0,n)}\\${e.slice(n)}`},t.removePrefix=(e,t={})=>{let i=e;return i.startsWith("./")&&(i=i.slice(2),t.prefix="./"),i},t.wrapOutput=(e,t={},i={})=>{let s=`${i.contains?"":"^"}(?:${e})${i.contains?"":"$"}`;return!0===t.negated&&(s=`(?:^(?!${s}).*$)`),s}},8356:(e,t,i)=>{"use strict";const s=i(7147),{Readable:n}=i(2781),a=i(1017),{promisify:r}=i(3837),o=i(9444),c=r(s.readdir),l=r(s.stat),p=r(s.lstat),d=r(s.realpath),h="READDIRP_RECURSIVE_ERROR",u=new Set(["ENOENT","EPERM","EACCES","ELOOP",h]),g="files",v="directories",y="files_directories",x="all",_=[g,v,y,x],[b,w]=process.versions.node.split(".").slice(0,2).map((e=>Number.parseInt(e,10))),E="win32"===process.platform&&(b>10||10===b&&w>=5),normalizeFilter=e=>{if(void 0!==e){if("function"==typeof e)return e;if("string"==typeof e){const t=o(e.trim());return e=>t(e.basename)}if(Array.isArray(e)){const t=[],i=[];for(const s of e){const e=s.trim();"!"===e.charAt(0)?i.push(o(e.slice(1))):t.push(o(e))}return i.length>0?t.length>0?e=>t.some((t=>t(e.basename)))&&!i.some((t=>t(e.basename))):e=>!i.some((t=>t(e.basename))):e=>t.some((t=>t(e.basename)))}}};class ReaddirpStream extends n{static get defaultOptions(){return{root:".",fileFilter:e=>!0,directoryFilter:e=>!0,type:g,lstat:!1,depth:2147483648,alwaysStat:!1}}constructor(e={}){super({objectMode:!0,autoDestroy:!0,highWaterMark:e.highWaterMark||4096});const t={...ReaddirpStream.defaultOptions,...e},{root:i,type:n}=t;this._fileFilter=normalizeFilter(t.fileFilter),this._directoryFilter=normalizeFilter(t.directoryFilter);const r=t.lstat?p:l;this._stat=E?e=>r(e,{bigint:!0}):r,this._maxDepth=t.depth,this._wantsDir=[v,y,x].includes(n),this._wantsFile=[g,y,x].includes(n),this._wantsEverything=n===x,this._root=a.resolve(i),this._isDirent="Dirent"in s&&!t.alwaysStat,this._statsProp=this._isDirent?"dirent":"stats",this._rdOptions={encoding:"utf8",withFileTypes:this._isDirent},this.parents=[this._exploreDir(i,1)],this.reading=!1,this.parent=void 0}async _read(e){if(!this.reading){this.reading=!0;try{for(;!this.destroyed&&e>0;){const{path:t,depth:i,files:s=[]}=this.parent||{};if(s.length>0){const n=s.splice(0,e).map((e=>this._formatEntry(e,t)));for(const t of await Promise.all(n)){if(this.destroyed)return;const s=await this._getEntryType(t);"directory"===s&&this._directoryFilter(t)?(i<=this._maxDepth&&this.parents.push(this._exploreDir(t.fullPath,i+1)),this._wantsDir&&(this.push(t),e--)):("file"===s||this._includeAsFile(t))&&this._fileFilter(t)&&this._wantsFile&&(this.push(t),e--)}}else{const e=this.parents.pop();if(!e){this.push(null);break}if(this.parent=await e,this.destroyed)return}}}catch(e){this.destroy(e)}finally{this.reading=!1}}}async _exploreDir(e,t){let i;try{i=await c(e,this._rdOptions)}catch(e){this._onError(e)}return{files:i,depth:t,path:e}}async _formatEntry(e,t){let i;try{const s=this._isDirent?e.name:e,n=a.resolve(a.join(t,s));i={path:a.relative(this._root,n),fullPath:n,basename:s},i[this._statsProp]=this._isDirent?e:await this._stat(n)}catch(e){this._onError(e)}return i}_onError(e){var t;t=e,u.has(t.code)&&!this.destroyed?this.emit("warn",e):this.destroy(e)}async _getEntryType(e){const t=e&&e[this._statsProp];if(t){if(t.isFile())return"file";if(t.isDirectory())return"directory";if(t&&t.isSymbolicLink()){const t=e.fullPath;try{const e=await d(t),i=await p(e);if(i.isFile())return"file";if(i.isDirectory()){const i=e.length;if(t.startsWith(e)&&t.substr(i,1)===a.sep){const i=new Error(`Circular symlink detected: "${t}" points to "${e}"`);return i.code=h,this._onError(i)}return"directory"}}catch(e){this._onError(e)}}}}_includeAsFile(e){const t=e&&e[this._statsProp];return t&&this._wantsEverything&&!t.isDirectory()}}const readdirp=(e,t={})=>{let i=t.entryType||t.type;if("both"===i&&(i=y),i&&(t.type=i),!e)throw new Error("readdirp: root argument is required. Usage: readdirp(root, options)");if("string"!=typeof e)throw new TypeError("readdirp: root argument must be a string. Usage: readdirp(root, options)");if(i&&!_.includes(i))throw new Error(`readdirp: Invalid type passed. Use one of ${_.join(", ")}`);return t.root=e,new ReaddirpStream(t)};readdirp.promise=(e,t={})=>new Promise(((i,s)=>{const n=[];readdirp(e,t).on("data",(e=>n.push(e))).on("end",(()=>i(n))).on("error",(e=>s(e)))})),readdirp.ReaddirpStream=ReaddirpStream,readdirp.default=readdirp,e.exports=readdirp},8660:()=>{var e;!function(e){!function(t){var i="object"==typeof global?global:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),s=makeExporter(e);function makeExporter(e,t){return function(i,s){"function"!=typeof e[i]&&Object.defineProperty(e,i,{configurable:!0,writable:!0,value:s}),t&&t(i,s)}}void 0===i.Reflect?i.Reflect=e:s=makeExporter(i.Reflect,s),function(e){var t=Object.prototype.hasOwnProperty,i="function"==typeof Symbol,s=i&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",n=i&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Object.create,r={__proto__:[]}instanceof Array,o=!a&&!r,c={create:a?function(){return MakeDictionary(Object.create(null))}:r?function(){return MakeDictionary({__proto__:null})}:function(){return MakeDictionary({})},has:o?function(e,i){return t.call(e,i)}:function(e,t){return t in e},get:o?function(e,i){return t.call(e,i)?e[i]:void 0}:function(e,t){return e[t]}},l=Object.getPrototypeOf(Function),p="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,d=p||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?CreateMapPolyfill():Map,h=p||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?CreateSetPolyfill():Set,u=new(p||"function"!=typeof WeakMap?CreateWeakMapPolyfill():WeakMap);function decorate(e,t,i,s){if(IsUndefined(i)){if(!IsArray(e))throw new TypeError;if(!IsConstructor(t))throw new TypeError;return DecorateConstructor(e,t)}if(!IsArray(e))throw new TypeError;if(!IsObject(t))throw new TypeError;if(!IsObject(s)&&!IsUndefined(s)&&!IsNull(s))throw new TypeError;return IsNull(s)&&(s=void 0),DecorateProperty(e,t,i=ToPropertyKey(i),s)}function metadata(e,t){function decorator(i,s){if(!IsObject(i))throw new TypeError;if(!IsUndefined(s)&&!IsPropertyKey(s))throw new TypeError;OrdinaryDefineOwnMetadata(e,t,i,s)}return decorator}function defineMetadata(e,t,i,s){if(!IsObject(i))throw new TypeError;return IsUndefined(s)||(s=ToPropertyKey(s)),OrdinaryDefineOwnMetadata(e,t,i,s)}function hasMetadata(e,t,i){if(!IsObject(t))throw new TypeError;return IsUndefined(i)||(i=ToPropertyKey(i)),OrdinaryHasMetadata(e,t,i)}function hasOwnMetadata(e,t,i){if(!IsObject(t))throw new TypeError;return IsUndefined(i)||(i=ToPropertyKey(i)),OrdinaryHasOwnMetadata(e,t,i)}function getMetadata(e,t,i){if(!IsObject(t))throw new TypeError;return IsUndefined(i)||(i=ToPropertyKey(i)),OrdinaryGetMetadata(e,t,i)}function getOwnMetadata(e,t,i){if(!IsObject(t))throw new TypeError;return IsUndefined(i)||(i=ToPropertyKey(i)),OrdinaryGetOwnMetadata(e,t,i)}function getMetadataKeys(e,t){if(!IsObject(e))throw new TypeError;return IsUndefined(t)||(t=ToPropertyKey(t)),OrdinaryMetadataKeys(e,t)}function getOwnMetadataKeys(e,t){if(!IsObject(e))throw new TypeError;return IsUndefined(t)||(t=ToPropertyKey(t)),OrdinaryOwnMetadataKeys(e,t)}function deleteMetadata(e,t,i){if(!IsObject(t))throw new TypeError;IsUndefined(i)||(i=ToPropertyKey(i));var s=GetOrCreateMetadataMap(t,i,!1);if(IsUndefined(s))return!1;if(!s.delete(e))return!1;if(s.size>0)return!0;var n=u.get(t);return n.delete(i),n.size>0||u.delete(t),!0}function DecorateConstructor(e,t){for(var i=e.length-1;i>=0;--i){var s=(0,e[i])(t);if(!IsUndefined(s)&&!IsNull(s)){if(!IsConstructor(s))throw new TypeError;t=s}}return t}function DecorateProperty(e,t,i,s){for(var n=e.length-1;n>=0;--n){var a=(0,e[n])(t,i,s);if(!IsUndefined(a)&&!IsNull(a)){if(!IsObject(a))throw new TypeError;s=a}}return s}function GetOrCreateMetadataMap(e,t,i){var s=u.get(e);if(IsUndefined(s)){if(!i)return;s=new d,u.set(e,s)}var n=s.get(t);if(IsUndefined(n)){if(!i)return;n=new d,s.set(t,n)}return n}function OrdinaryHasMetadata(e,t,i){if(OrdinaryHasOwnMetadata(e,t,i))return!0;var s=OrdinaryGetPrototypeOf(t);return!IsNull(s)&&OrdinaryHasMetadata(e,s,i)}function OrdinaryHasOwnMetadata(e,t,i){var s=GetOrCreateMetadataMap(t,i,!1);return!IsUndefined(s)&&ToBoolean(s.has(e))}function OrdinaryGetMetadata(e,t,i){if(OrdinaryHasOwnMetadata(e,t,i))return OrdinaryGetOwnMetadata(e,t,i);var s=OrdinaryGetPrototypeOf(t);return IsNull(s)?void 0:OrdinaryGetMetadata(e,s,i)}function OrdinaryGetOwnMetadata(e,t,i){var s=GetOrCreateMetadataMap(t,i,!1);if(!IsUndefined(s))return s.get(e)}function OrdinaryDefineOwnMetadata(e,t,i,s){GetOrCreateMetadataMap(i,s,!0).set(e,t)}function OrdinaryMetadataKeys(e,t){var i=OrdinaryOwnMetadataKeys(e,t),s=OrdinaryGetPrototypeOf(e);if(null===s)return i;var n=OrdinaryMetadataKeys(s,t);if(n.length<=0)return i;if(i.length<=0)return n;for(var a=new h,r=[],o=0,c=i;o<c.length;o++){var l=c[o];a.has(l)||(a.add(l),r.push(l))}for(var p=0,d=n;p<d.length;p++){l=d[p];a.has(l)||(a.add(l),r.push(l))}return r}function OrdinaryOwnMetadataKeys(e,t){var i=[],s=GetOrCreateMetadataMap(e,t,!1);if(IsUndefined(s))return i;for(var n=GetIterator(s.keys()),a=0;;){var r=IteratorStep(n);if(!r)return i.length=a,i;var o=IteratorValue(r);try{i[a]=o}catch(e){try{IteratorClose(n)}finally{throw e}}a++}}function Type(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function IsUndefined(e){return void 0===e}function IsNull(e){return null===e}function IsSymbol(e){return"symbol"==typeof e}function IsObject(e){return"object"==typeof e?null!==e:"function"==typeof e}function ToPrimitive(e,t){switch(Type(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var i=3===t?"string":5===t?"number":"default",n=GetMethod(e,s);if(void 0!==n){var a=n.call(e,i);if(IsObject(a))throw new TypeError;return a}return OrdinaryToPrimitive(e,"default"===i?"number":i)}function OrdinaryToPrimitive(e,t){if("string"===t){var i=e.toString;if(IsCallable(i))if(!IsObject(n=i.call(e)))return n;if(IsCallable(s=e.valueOf))if(!IsObject(n=s.call(e)))return n}else{var s;if(IsCallable(s=e.valueOf))if(!IsObject(n=s.call(e)))return n;var n,a=e.toString;if(IsCallable(a))if(!IsObject(n=a.call(e)))return n}throw new TypeError}function ToBoolean(e){return!!e}function ToString(e){return""+e}function ToPropertyKey(e){var t=ToPrimitive(e,3);return IsSymbol(t)?t:ToString(t)}function IsArray(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function IsCallable(e){return"function"==typeof e}function IsConstructor(e){return"function"==typeof e}function IsPropertyKey(e){switch(Type(e)){case 3:case 4:return!0;default:return!1}}function GetMethod(e,t){var i=e[t];if(null!=i){if(!IsCallable(i))throw new TypeError;return i}}function GetIterator(e){var t=GetMethod(e,n);if(!IsCallable(t))throw new TypeError;var i=t.call(e);if(!IsObject(i))throw new TypeError;return i}function IteratorValue(e){return e.value}function IteratorStep(e){var t=e.next();return!t.done&&t}function IteratorClose(e){var t=e.return;t&&t.call(e)}function OrdinaryGetPrototypeOf(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===l)return t;if(t!==l)return t;var i=e.prototype,s=i&&Object.getPrototypeOf(i);if(null==s||s===Object.prototype)return t;var n=s.constructor;return"function"!=typeof n||n===e?t:n}function CreateMapPolyfill(){var e={},t=[],i=function(){function MapIterator(e,t,i){this._index=0,this._keys=e,this._values=t,this._selector=i}return MapIterator.prototype["@@iterator"]=function(){return this},MapIterator.prototype[n]=function(){return this},MapIterator.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var i=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:i,done:!1}}return{value:void 0,done:!0}},MapIterator.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},MapIterator.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},MapIterator}();return function(){function Map(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(Map.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Map.prototype.has=function(e){return this._find(e,!1)>=0},Map.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},Map.prototype.set=function(e,t){var i=this._find(e,!0);return this._values[i]=t,this},Map.prototype.delete=function(t){var i=this._find(t,!1);if(i>=0){for(var s=this._keys.length,n=i+1;n<s;n++)this._keys[n-1]=this._keys[n],this._values[n-1]=this._values[n];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},Map.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},Map.prototype.keys=function(){return new i(this._keys,this._values,getKey)},Map.prototype.values=function(){return new i(this._keys,this._values,getValue)},Map.prototype.entries=function(){return new i(this._keys,this._values,getEntry)},Map.prototype["@@iterator"]=function(){return this.entries()},Map.prototype[n]=function(){return this.entries()},Map.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},Map}();function getKey(e,t){return e}function getValue(e,t){return t}function getEntry(e,t){return[e,t]}}function CreateSetPolyfill(){return function(){function Set(){this._map=new d}return Object.defineProperty(Set.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Set.prototype.has=function(e){return this._map.has(e)},Set.prototype.add=function(e){return this._map.set(e,e),this},Set.prototype.delete=function(e){return this._map.delete(e)},Set.prototype.clear=function(){this._map.clear()},Set.prototype.keys=function(){return this._map.keys()},Set.prototype.values=function(){return this._map.values()},Set.prototype.entries=function(){return this._map.entries()},Set.prototype["@@iterator"]=function(){return this.keys()},Set.prototype[n]=function(){return this.keys()},Set}()}function CreateWeakMapPolyfill(){var e=16,i=c.create(),s=CreateUniqueKey();return function(){function WeakMap(){this._key=CreateUniqueKey()}return WeakMap.prototype.has=function(e){var t=GetOrCreateWeakMapTable(e,!1);return void 0!==t&&c.has(t,this._key)},WeakMap.prototype.get=function(e){var t=GetOrCreateWeakMapTable(e,!1);return void 0!==t?c.get(t,this._key):void 0},WeakMap.prototype.set=function(e,t){return GetOrCreateWeakMapTable(e,!0)[this._key]=t,this},WeakMap.prototype.delete=function(e){var t=GetOrCreateWeakMapTable(e,!1);return void 0!==t&&delete t[this._key]},WeakMap.prototype.clear=function(){this._key=CreateUniqueKey()},WeakMap}();function CreateUniqueKey(){var e;do{e="@@WeakMap@@"+CreateUUID()}while(c.has(i,e));return i[e]=!0,e}function GetOrCreateWeakMapTable(e,i){if(!t.call(e,s)){if(!i)return;Object.defineProperty(e,s,{value:c.create()})}return e[s]}function FillRandomBytes(e,t){for(var i=0;i<t;++i)e[i]=255*Math.random()|0;return e}function GenRandomBytes(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):FillRandomBytes(new Uint8Array(e),e):FillRandomBytes(new Array(e),e)}function CreateUUID(){var t=GenRandomBytes(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var i="",s=0;s<e;++s){var n=t[s];4!==s&&6!==s&&8!==s||(i+="-"),n<16&&(i+="0"),i+=n.toString(16).toLowerCase()}return i}}function MakeDictionary(e){return e.__=void 0,delete e.__,e}e("decorate",decorate),e("metadata",metadata),e("defineMetadata",defineMetadata),e("hasMetadata",hasMetadata),e("hasOwnMetadata",hasOwnMetadata),e("getMetadata",getMetadata),e("getOwnMetadata",getOwnMetadata),e("getMetadataKeys",getMetadataKeys),e("getOwnMetadataKeys",getOwnMetadataKeys),e("deleteMetadata",deleteMetadata)}(s)}()}(e||(e={}))},2257:(e,t,i)=>{const s=Symbol("SemVer ANY");class Comparator{static get ANY(){return s}constructor(e,t){if(t=n(t),e instanceof Comparator){if(e.loose===!!t.loose)return e;e=e.value}c("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===s?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}parse(e){const t=this.options.loose?a[r.COMPARATORLOOSE]:a[r.COMPARATOR],i=e.match(t);if(!i)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==i[1]?i[1]:"","="===this.operator&&(this.operator=""),i[2]?this.semver=new l(i[2],this.options.loose):this.semver=s}toString(){return this.value}test(e){if(c("Comparator.test",e,this.options.loose),this.semver===s||e===s)return!0;if("string"==typeof e)try{e=new l(e,this.options)}catch(e){return!1}return o(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof Comparator))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new p(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new p(this.value,t).test(e.semver);const i=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),s=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),n=this.semver.version===e.semver.version,a=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),r=o(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=o(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return i||s||n&&a||r||c}}e.exports=Comparator;const n=i(2893),{re:a,t:r}=i(5765),o=i(7539),c=i(4225),l=i(6376),p=i(6902)},6902:(e,t,i)=>{class Range{constructor(e,t){if(t=n(t),e instanceof Range)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new Range(e.raw,t);if(e instanceof a)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${e}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!isNullSet(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&isAny(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();const t=`parseRange:${Object.keys(this.options).join(",")}:${e}`,i=s.get(t);if(i)return i;const n=this.options.loose,o=n?c[l.HYPHENRANGELOOSE]:c[l.HYPHENRANGE];e=e.replace(o,hyphenReplace(this.options.includePrerelease)),r("hyphen replace",e),e=e.replace(c[l.COMPARATORTRIM],p),r("comparator trim",e);let u=(e=(e=(e=e.replace(c[l.TILDETRIM],d)).replace(c[l.CARETTRIM],h)).split(/\s+/).join(" ")).split(" ").map((e=>parseComparator(e,this.options))).join(" ").split(/\s+/).map((e=>replaceGTE0(e,this.options)));n&&(u=u.filter((e=>(r("loose invalid filter",e,this.options),!!e.match(c[l.COMPARATORLOOSE]))))),r("range list",u);const g=new Map,v=u.map((e=>new a(e,this.options)));for(const e of v){if(isNullSet(e))return[e];g.set(e.value,e)}g.size>1&&g.has("")&&g.delete("");const y=[...g.values()];return s.set(t,y),y}intersects(e,t){if(!(e instanceof Range))throw new TypeError("a Range is required");return this.set.some((i=>isSatisfiable(i,t)&&e.set.some((e=>isSatisfiable(e,t)&&i.every((i=>e.every((e=>i.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new o(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(testSet(this.set[t],e,this.options))return!0;return!1}}e.exports=Range;const s=new(i(9593))({max:1e3}),n=i(2893),a=i(2257),r=i(4225),o=i(6376),{re:c,t:l,comparatorTrimReplace:p,tildeTrimReplace:d,caretTrimReplace:h}=i(5765),isNullSet=e=>"<0.0.0-0"===e.value,isAny=e=>""===e.value,isSatisfiable=(e,t)=>{let i=!0;const s=e.slice();let n=s.pop();for(;i&&s.length;)i=s.every((e=>n.intersects(e,t))),n=s.pop();return i},parseComparator=(e,t)=>(r("comp",e,t),e=replaceCarets(e,t),r("caret",e),e=replaceTildes(e,t),r("tildes",e),e=replaceXRanges(e,t),r("xrange",e),e=replaceStars(e,t),r("stars",e),e),isX=e=>!e||"x"===e.toLowerCase()||"*"===e,replaceTildes=(e,t)=>e.trim().split(/\s+/).map((e=>replaceTilde(e,t))).join(" "),replaceTilde=(e,t)=>{const i=t.loose?c[l.TILDELOOSE]:c[l.TILDE];return e.replace(i,((t,i,s,n,a)=>{let o;return r("tilde",e,t,i,s,n,a),isX(i)?o="":isX(s)?o=`>=${i}.0.0 <${+i+1}.0.0-0`:isX(n)?o=`>=${i}.${s}.0 <${i}.${+s+1}.0-0`:a?(r("replaceTilde pr",a),o=`>=${i}.${s}.${n}-${a} <${i}.${+s+1}.0-0`):o=`>=${i}.${s}.${n} <${i}.${+s+1}.0-0`,r("tilde return",o),o}))},replaceCarets=(e,t)=>e.trim().split(/\s+/).map((e=>replaceCaret(e,t))).join(" "),replaceCaret=(e,t)=>{r("caret",e,t);const i=t.loose?c[l.CARETLOOSE]:c[l.CARET],s=t.includePrerelease?"-0":"";return e.replace(i,((t,i,n,a,o)=>{let c;return r("caret",e,t,i,n,a,o),isX(i)?c="":isX(n)?c=`>=${i}.0.0${s} <${+i+1}.0.0-0`:isX(a)?c="0"===i?`>=${i}.${n}.0${s} <${i}.${+n+1}.0-0`:`>=${i}.${n}.0${s} <${+i+1}.0.0-0`:o?(r("replaceCaret pr",o),c="0"===i?"0"===n?`>=${i}.${n}.${a}-${o} <${i}.${n}.${+a+1}-0`:`>=${i}.${n}.${a}-${o} <${i}.${+n+1}.0-0`:`>=${i}.${n}.${a}-${o} <${+i+1}.0.0-0`):(r("no pr"),c="0"===i?"0"===n?`>=${i}.${n}.${a}${s} <${i}.${n}.${+a+1}-0`:`>=${i}.${n}.${a}${s} <${i}.${+n+1}.0-0`:`>=${i}.${n}.${a} <${+i+1}.0.0-0`),r("caret return",c),c}))},replaceXRanges=(e,t)=>(r("replaceXRanges",e,t),e.split(/\s+/).map((e=>replaceXRange(e,t))).join(" ")),replaceXRange=(e,t)=>{e=e.trim();const i=t.loose?c[l.XRANGELOOSE]:c[l.XRANGE];return e.replace(i,((i,s,n,a,o,c)=>{r("xRange",e,i,s,n,a,o,c);const l=isX(n),p=l||isX(a),d=p||isX(o),h=d;return"="===s&&h&&(s=""),c=t.includePrerelease?"-0":"",l?i=">"===s||"<"===s?"<0.0.0-0":"*":s&&h?(p&&(a=0),o=0,">"===s?(s=">=",p?(n=+n+1,a=0,o=0):(a=+a+1,o=0)):"<="===s&&(s="<",p?n=+n+1:a=+a+1),"<"===s&&(c="-0"),i=`${s+n}.${a}.${o}${c}`):p?i=`>=${n}.0.0${c} <${+n+1}.0.0-0`:d&&(i=`>=${n}.${a}.0${c} <${n}.${+a+1}.0-0`),r("xRange return",i),i}))},replaceStars=(e,t)=>(r("replaceStars",e,t),e.trim().replace(c[l.STAR],"")),replaceGTE0=(e,t)=>(r("replaceGTE0",e,t),e.trim().replace(c[t.includePrerelease?l.GTE0PRE:l.GTE0],"")),hyphenReplace=e=>(t,i,s,n,a,r,o,c,l,p,d,h,u)=>`${i=isX(s)?"":isX(n)?`>=${s}.0.0${e?"-0":""}`:isX(a)?`>=${s}.${n}.0${e?"-0":""}`:r?`>=${i}`:`>=${i}${e?"-0":""}`} ${c=isX(l)?"":isX(p)?`<${+l+1}.0.0-0`:isX(d)?`<${l}.${+p+1}.0-0`:h?`<=${l}.${p}.${d}-${h}`:e?`<${l}.${p}.${+d+1}-0`:`<=${c}`}`.trim(),testSet=(e,t,i)=>{for(let i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!i.includePrerelease){for(let i=0;i<e.length;i++)if(r(e[i].semver),e[i].semver!==a.ANY&&e[i].semver.prerelease.length>0){const s=e[i].semver;if(s.major===t.major&&s.minor===t.minor&&s.patch===t.patch)return!0}return!1}return!0}},6376:(e,t,i)=>{const s=i(4225),{MAX_LENGTH:n,MAX_SAFE_INTEGER:a}=i(3295),{re:r,t:o}=i(5765),c=i(2893),{compareIdentifiers:l}=i(6742);class SemVer{constructor(e,t){if(t=c(t),e instanceof SemVer){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid Version: ${e}`);if(e.length>n)throw new TypeError(`version is longer than ${n} characters`);s("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const i=e.trim().match(t.loose?r[o.LOOSE]:r[o.FULL]);if(!i)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>a||this.major<0)throw new TypeError("Invalid major version");if(this.minor>a||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>a||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<a)return t}return e})):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(s("SemVer.compare",this.version,this.options,e),!(e instanceof SemVer)){if("string"==typeof e&&e===this.version)return 0;e=new SemVer(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),l(this.major,e.major)||l(this.minor,e.minor)||l(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const i=this.prerelease[t],n=e.prerelease[t];if(s("prerelease compare",t,i,n),void 0===i&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===i)return-1;if(i!==n)return l(i,n)}while(++t)}compareBuild(e){e instanceof SemVer||(e=new SemVer(e,this.options));let t=0;do{const i=this.build[t],n=e.build[t];if(s("prerelease compare",t,i,n),void 0===i&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===i)return-1;if(i!==n)return l(i,n)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(0===l(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}}e.exports=SemVer},3507:(e,t,i)=>{const s=i(3959);e.exports=(e,t)=>{const i=s(e.trim().replace(/^[=v]+/,""),t);return i?i.version:null}},7539:(e,t,i)=>{const s=i(8718),n=i(1194),a=i(1312),r=i(5903),o=i(1544),c=i(2056);e.exports=(e,t,i,l)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof i&&(i=i.version),e===i;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof i&&(i=i.version),e!==i;case"":case"=":case"==":return s(e,i,l);case"!=":return n(e,i,l);case">":return a(e,i,l);case">=":return r(e,i,l);case"<":return o(e,i,l);case"<=":return c(e,i,l);default:throw new TypeError(`Invalid operator: ${t}`)}}},9038:(e,t,i)=>{const s=i(6376),n=i(3959),{re:a,t:r}=i(5765);e.exports=(e,t)=>{if(e instanceof s)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let i=null;if((t=t||{}).rtl){let t;for(;(t=a[r.COERCERTL].exec(e))&&(!i||i.index+i[0].length!==e.length);)i&&t.index+t[0].length===i.index+i[0].length||(i=t),a[r.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;a[r.COERCERTL].lastIndex=-1}else i=e.match(a[r.COERCE]);return null===i?null:n(`${i[2]}.${i[3]||"0"}.${i[4]||"0"}`,t)}},8880:(e,t,i)=>{const s=i(6376);e.exports=(e,t,i)=>{const n=new s(e,i),a=new s(t,i);return n.compare(a)||n.compareBuild(a)}},7880:(e,t,i)=>{const s=i(6269);e.exports=(e,t)=>s(e,t,!0)},6269:(e,t,i)=>{const s=i(6376);e.exports=(e,t,i)=>new s(e,i).compare(new s(t,i))},2378:(e,t,i)=>{const s=i(3959),n=i(8718);e.exports=(e,t)=>{if(n(e,t))return null;{const i=s(e),n=s(t),a=i.prerelease.length||n.prerelease.length,r=a?"pre":"",o=a?"prerelease":"";for(const e in i)if(("major"===e||"minor"===e||"patch"===e)&&i[e]!==n[e])return r+e;return o}}},8718:(e,t,i)=>{const s=i(6269);e.exports=(e,t,i)=>0===s(e,t,i)},1312:(e,t,i)=>{const s=i(6269);e.exports=(e,t,i)=>s(e,t,i)>0},5903:(e,t,i)=>{const s=i(6269);e.exports=(e,t,i)=>s(e,t,i)>=0},253:(e,t,i)=>{const s=i(6376);e.exports=(e,t,i,n)=>{"string"==typeof i&&(n=i,i=void 0);try{return new s(e instanceof s?e.version:e,i).inc(t,n).version}catch(e){return null}}},1544:(e,t,i)=>{const s=i(6269);e.exports=(e,t,i)=>s(e,t,i)<0},2056:(e,t,i)=>{const s=i(6269);e.exports=(e,t,i)=>s(e,t,i)<=0},8679:(e,t,i)=>{const s=i(6376);e.exports=(e,t)=>new s(e,t).major},7789:(e,t,i)=>{const s=i(6376);e.exports=(e,t)=>new s(e,t).minor},1194:(e,t,i)=>{const s=i(6269);e.exports=(e,t,i)=>0!==s(e,t,i)},3959:(e,t,i)=>{const{MAX_LENGTH:s}=i(3295),{re:n,t:a}=i(5765),r=i(6376),o=i(2893);e.exports=(e,t)=>{if(t=o(t),e instanceof r)return e;if("string"!=typeof e)return null;if(e.length>s)return null;if(!(t.loose?n[a.LOOSE]:n[a.FULL]).test(e))return null;try{return new r(e,t)}catch(e){return null}}},2358:(e,t,i)=>{const s=i(6376);e.exports=(e,t)=>new s(e,t).patch},7559:(e,t,i)=>{const s=i(3959);e.exports=(e,t)=>{const i=s(e,t);return i&&i.prerelease.length?i.prerelease:null}},9795:(e,t,i)=>{const s=i(6269);e.exports=(e,t,i)=>s(t,e,i)},3657:(e,t,i)=>{const s=i(8880);e.exports=(e,t)=>e.sort(((e,i)=>s(i,e,t)))},5712:(e,t,i)=>{const s=i(6902);e.exports=(e,t,i)=>{try{t=new s(t,i)}catch(e){return!1}return t.test(e)}},1100:(e,t,i)=>{const s=i(8880);e.exports=(e,t)=>e.sort(((e,i)=>s(e,i,t)))},6397:(e,t,i)=>{const s=i(3959);e.exports=(e,t)=>{const i=s(e,t);return i?i.version:null}},1249:(e,t,i)=>{const s=i(5765);e.exports={re:s.re,src:s.src,tokens:s.t,SEMVER_SPEC_VERSION:i(3295).SEMVER_SPEC_VERSION,SemVer:i(6376),compareIdentifiers:i(6742).compareIdentifiers,rcompareIdentifiers:i(6742).rcompareIdentifiers,parse:i(3959),valid:i(6397),clean:i(3507),inc:i(253),diff:i(2378),major:i(8679),minor:i(7789),patch:i(2358),prerelease:i(7559),compare:i(6269),rcompare:i(9795),compareLoose:i(7880),compareBuild:i(8880),sort:i(1100),rsort:i(3657),gt:i(1312),lt:i(1544),eq:i(8718),neq:i(1194),gte:i(5903),lte:i(2056),cmp:i(7539),coerce:i(9038),Comparator:i(2257),Range:i(6902),satisfies:i(5712),toComparators:i(1042),maxSatisfying:i(5775),minSatisfying:i(1657),minVersion:i(5316),validRange:i(9042),outside:i(6826),gtr:i(7606),ltr:i(32),intersects:i(2937),simplifyRange:i(7908),subset:i(799)}},3295:e=>{const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:t,MAX_SAFE_COMPONENT_LENGTH:16}},4225:e=>{const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},6742:e=>{const t=/^[0-9]+$/,compareIdentifiers=(e,i)=>{const s=t.test(e),n=t.test(i);return s&&n&&(e=+e,i=+i),e===i?0:s&&!n?-1:n&&!s?1:e<i?-1:1};e.exports={compareIdentifiers,rcompareIdentifiers:(e,t)=>compareIdentifiers(t,e)}},2893:e=>{const t=["includePrerelease","loose","rtl"];e.exports=e=>e?"object"!=typeof e?{loose:!0}:t.filter((t=>e[t])).reduce(((e,t)=>(e[t]=!0,e)),{}):{}},5765:(e,t,i)=>{const{MAX_SAFE_COMPONENT_LENGTH:s}=i(3295),n=i(4225),a=(t=e.exports={}).re=[],r=t.src=[],o=t.t={};let c=0;const createToken=(e,t,i)=>{const s=c++;n(e,s,t),o[e]=s,r[s]=t,a[s]=new RegExp(t,i?"g":void 0)};createToken("NUMERICIDENTIFIER","0|[1-9]\\d*"),createToken("NUMERICIDENTIFIERLOOSE","[0-9]+"),createToken("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),createToken("MAINVERSION",`(${r[o.NUMERICIDENTIFIER]})\\.(${r[o.NUMERICIDENTIFIER]})\\.(${r[o.NUMERICIDENTIFIER]})`),createToken("MAINVERSIONLOOSE",`(${r[o.NUMERICIDENTIFIERLOOSE]})\\.(${r[o.NUMERICIDENTIFIERLOOSE]})\\.(${r[o.NUMERICIDENTIFIERLOOSE]})`),createToken("PRERELEASEIDENTIFIER",`(?:${r[o.NUMERICIDENTIFIER]}|${r[o.NONNUMERICIDENTIFIER]})`),createToken("PRERELEASEIDENTIFIERLOOSE",`(?:${r[o.NUMERICIDENTIFIERLOOSE]}|${r[o.NONNUMERICIDENTIFIER]})`),createToken("PRERELEASE",`(?:-(${r[o.PRERELEASEIDENTIFIER]}(?:\\.${r[o.PRERELEASEIDENTIFIER]})*))`),createToken("PRERELEASELOOSE",`(?:-?(${r[o.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${r[o.PRERELEASEIDENTIFIERLOOSE]})*))`),createToken("BUILDIDENTIFIER","[0-9A-Za-z-]+"),createToken("BUILD",`(?:\\+(${r[o.BUILDIDENTIFIER]}(?:\\.${r[o.BUILDIDENTIFIER]})*))`),createToken("FULLPLAIN",`v?${r[o.MAINVERSION]}${r[o.PRERELEASE]}?${r[o.BUILD]}?`),createToken("FULL",`^${r[o.FULLPLAIN]}$`),createToken("LOOSEPLAIN",`[v=\\s]*${r[o.MAINVERSIONLOOSE]}${r[o.PRERELEASELOOSE]}?${r[o.BUILD]}?`),createToken("LOOSE",`^${r[o.LOOSEPLAIN]}$`),createToken("GTLT","((?:<|>)?=?)"),createToken("XRANGEIDENTIFIERLOOSE",`${r[o.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),createToken("XRANGEIDENTIFIER",`${r[o.NUMERICIDENTIFIER]}|x|X|\\*`),createToken("XRANGEPLAIN",`[v=\\s]*(${r[o.XRANGEIDENTIFIER]})(?:\\.(${r[o.XRANGEIDENTIFIER]})(?:\\.(${r[o.XRANGEIDENTIFIER]})(?:${r[o.PRERELEASE]})?${r[o.BUILD]}?)?)?`),createToken("XRANGEPLAINLOOSE",`[v=\\s]*(${r[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${r[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${r[o.XRANGEIDENTIFIERLOOSE]})(?:${r[o.PRERELEASELOOSE]})?${r[o.BUILD]}?)?)?`),createToken("XRANGE",`^${r[o.GTLT]}\\s*${r[o.XRANGEPLAIN]}$`),createToken("XRANGELOOSE",`^${r[o.GTLT]}\\s*${r[o.XRANGEPLAINLOOSE]}$`),createToken("COERCE",`(^|[^\\d])(\\d{1,${s}})(?:\\.(\\d{1,${s}}))?(?:\\.(\\d{1,${s}}))?(?:$|[^\\d])`),createToken("COERCERTL",r[o.COERCE],!0),createToken("LONETILDE","(?:~>?)"),createToken("TILDETRIM",`(\\s*)${r[o.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",createToken("TILDE",`^${r[o.LONETILDE]}${r[o.XRANGEPLAIN]}$`),createToken("TILDELOOSE",`^${r[o.LONETILDE]}${r[o.XRANGEPLAINLOOSE]}$`),createToken("LONECARET","(?:\\^)"),createToken("CARETTRIM",`(\\s*)${r[o.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",createToken("CARET",`^${r[o.LONECARET]}${r[o.XRANGEPLAIN]}$`),createToken("CARETLOOSE",`^${r[o.LONECARET]}${r[o.XRANGEPLAINLOOSE]}$`),createToken("COMPARATORLOOSE",`^${r[o.GTLT]}\\s*(${r[o.LOOSEPLAIN]})$|^$`),createToken("COMPARATOR",`^${r[o.GTLT]}\\s*(${r[o.FULLPLAIN]})$|^$`),createToken("COMPARATORTRIM",`(\\s*)${r[o.GTLT]}\\s*(${r[o.LOOSEPLAIN]}|${r[o.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",createToken("HYPHENRANGE",`^\\s*(${r[o.XRANGEPLAIN]})\\s+-\\s+(${r[o.XRANGEPLAIN]})\\s*$`),createToken("HYPHENRANGELOOSE",`^\\s*(${r[o.XRANGEPLAINLOOSE]})\\s+-\\s+(${r[o.XRANGEPLAINLOOSE]})\\s*$`),createToken("STAR","(<|>)?=?\\s*\\*"),createToken("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),createToken("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},7606:(e,t,i)=>{const s=i(6826);e.exports=(e,t,i)=>s(e,t,">",i)},2937:(e,t,i)=>{const s=i(6902);e.exports=(e,t,i)=>(e=new s(e,i),t=new s(t,i),e.intersects(t))},32:(e,t,i)=>{const s=i(6826);e.exports=(e,t,i)=>s(e,t,"<",i)},5775:(e,t,i)=>{const s=i(6376),n=i(6902);e.exports=(e,t,i)=>{let a=null,r=null,o=null;try{o=new n(t,i)}catch(e){return null}return e.forEach((e=>{o.test(e)&&(a&&-1!==r.compare(e)||(a=e,r=new s(a,i)))})),a}},1657:(e,t,i)=>{const s=i(6376),n=i(6902);e.exports=(e,t,i)=>{let a=null,r=null,o=null;try{o=new n(t,i)}catch(e){return null}return e.forEach((e=>{o.test(e)&&(a&&1!==r.compare(e)||(a=e,r=new s(a,i)))})),a}},5316:(e,t,i)=>{const s=i(6376),n=i(6902),a=i(1312);e.exports=(e,t)=>{e=new n(e,t);let i=new s("0.0.0");if(e.test(i))return i;if(i=new s("0.0.0-0"),e.test(i))return i;i=null;for(let t=0;t<e.set.length;++t){const n=e.set[t];let r=null;n.forEach((e=>{const t=new s(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":r&&!a(t,r)||(r=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!r||i&&!a(i,r)||(i=r)}return i&&e.test(i)?i:null}},6826:(e,t,i)=>{const s=i(6376),n=i(2257),{ANY:a}=n,r=i(6902),o=i(5712),c=i(1312),l=i(1544),p=i(2056),d=i(5903);e.exports=(e,t,i,h)=>{let u,g,v,y,x;switch(e=new s(e,h),t=new r(t,h),i){case">":u=c,g=p,v=l,y=">",x=">=";break;case"<":u=l,g=d,v=c,y="<",x="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(o(e,t,h))return!1;for(let i=0;i<t.set.length;++i){const s=t.set[i];let r=null,o=null;if(s.forEach((e=>{e.semver===a&&(e=new n(">=0.0.0")),r=r||e,o=o||e,u(e.semver,r.semver,h)?r=e:v(e.semver,o.semver,h)&&(o=e)})),r.operator===y||r.operator===x)return!1;if((!o.operator||o.operator===y)&&g(e,o.semver))return!1;if(o.operator===x&&v(e,o.semver))return!1}return!0}},7908:(e,t,i)=>{const s=i(5712),n=i(6269);e.exports=(e,t,i)=>{const a=[];let r=null,o=null;const c=e.sort(((e,t)=>n(e,t,i)));for(const e of c){s(e,t,i)?(o=e,r||(r=e)):(o&&a.push([r,o]),o=null,r=null)}r&&a.push([r,null]);const l=[];for(const[e,t]of a)e===t?l.push(e):t||e!==c[0]?t?e===c[0]?l.push(`<=${t}`):l.push(`${e} - ${t}`):l.push(`>=${e}`):l.push("*");const p=l.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return p.length<d.length?p:t}},799:(e,t,i)=>{const s=i(6902),n=i(2257),{ANY:a}=n,r=i(5712),o=i(6269),simpleSubset=(e,t,i)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===a){if(1===t.length&&t[0].semver===a)return!0;e=i.includePrerelease?[new n(">=0.0.0-0")]:[new n(">=0.0.0")]}if(1===t.length&&t[0].semver===a){if(i.includePrerelease)return!0;t=[new n(">=0.0.0")]}const s=new Set;let c,l,p,d,h,u,g;for(const t of e)">"===t.operator||">="===t.operator?c=higherGT(c,t,i):"<"===t.operator||"<="===t.operator?l=lowerLT(l,t,i):s.add(t.semver);if(s.size>1)return null;if(c&&l){if(p=o(c.semver,l.semver,i),p>0)return null;if(0===p&&(">="!==c.operator||"<="!==l.operator))return null}for(const e of s){if(c&&!r(e,String(c),i))return null;if(l&&!r(e,String(l),i))return null;for(const s of t)if(!r(e,String(s),i))return!1;return!0}let v=!(!l||i.includePrerelease||!l.semver.prerelease.length)&&l.semver,y=!(!c||i.includePrerelease||!c.semver.prerelease.length)&&c.semver;v&&1===v.prerelease.length&&"<"===l.operator&&0===v.prerelease[0]&&(v=!1);for(const e of t){if(g=g||">"===e.operator||">="===e.operator,u=u||"<"===e.operator||"<="===e.operator,c)if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),">"===e.operator||">="===e.operator){if(d=higherGT(c,e,i),d===e&&d!==c)return!1}else if(">="===c.operator&&!r(c.semver,String(e),i))return!1;if(l)if(v&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===v.major&&e.semver.minor===v.minor&&e.semver.patch===v.patch&&(v=!1),"<"===e.operator||"<="===e.operator){if(h=lowerLT(l,e,i),h===e&&h!==l)return!1}else if("<="===l.operator&&!r(l.semver,String(e),i))return!1;if(!e.operator&&(l||c)&&0!==p)return!1}return!(c&&u&&!l&&0!==p)&&(!(l&&g&&!c&&0!==p)&&(!y&&!v))},higherGT=(e,t,i)=>{if(!e)return t;const s=o(e.semver,t.semver,i);return s>0?e:s<0||">"===t.operator&&">="===e.operator?t:e},lowerLT=(e,t,i)=>{if(!e)return t;const s=o(e.semver,t.semver,i);return s<0?e:s>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,i={})=>{if(e===t)return!0;e=new s(e,i),t=new s(t,i);let n=!1;e:for(const s of e.set){for(const e of t.set){const t=simpleSubset(s,e,i);if(n=n||null!==t,t)continue e}if(n)return!1}return!0}},1042:(e,t,i)=>{const s=i(6902);e.exports=(e,t)=>new s(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},9042:(e,t,i)=>{const s=i(6902);e.exports=(e,t)=>{try{return new s(e,t).range||"*"}catch(e){return null}}},5702:(e,t,i)=>{"use strict";const s=i(9924),toRegexRange=(e,t,i)=>{if(!1===s(e))throw new TypeError("toRegexRange: expected the first argument to be a number");if(void 0===t||e===t)return String(e);if(!1===s(t))throw new TypeError("toRegexRange: expected the second argument to be a number.");let n={relaxZeros:!0,...i};"boolean"==typeof n.strictZeros&&(n.relaxZeros=!1===n.strictZeros);let a=e+":"+t+"="+String(n.relaxZeros)+String(n.shorthand)+String(n.capture)+String(n.wrap);if(toRegexRange.cache.hasOwnProperty(a))return toRegexRange.cache[a].result;let r=Math.min(e,t),o=Math.max(e,t);if(1===Math.abs(r-o)){let i=e+"|"+t;return n.capture?`(${i})`:!1===n.wrap?i:`(?:${i})`}let c=hasPadding(e)||hasPadding(t),l={min:e,max:t,a:r,b:o},p=[],d=[];if(c&&(l.isPadded=c,l.maxLen=String(l.max).length),r<0){d=splitToPatterns(o<0?Math.abs(o):1,Math.abs(r),l,n),r=l.a=0}return o>=0&&(p=splitToPatterns(r,o,l,n)),l.negatives=d,l.positives=p,l.result=function collatePatterns(e,t,i){let s=filterPatterns(e,t,"-",!1,i)||[],n=filterPatterns(t,e,"",!1,i)||[],a=filterPatterns(e,t,"-?",!0,i)||[];return s.concat(a).concat(n).join("|")}(d,p,n),!0===n.capture?l.result=`(${l.result})`:!1!==n.wrap&&p.length+d.length>1&&(l.result=`(?:${l.result})`),toRegexRange.cache[a]=l,l.result};function rangeToPattern(e,t,i){if(e===t)return{pattern:e,count:[],digits:0};let s=function zip(e,t){let i=[];for(let s=0;s<e.length;s++)i.push([e[s],t[s]]);return i}(e,t),n=s.length,a="",r=0;for(let e=0;e<n;e++){let[t,n]=s[e];t===n?a+=t:"0"!==t||"9"!==n?a+=toCharacterClass(t,n,i):r++}return r&&(a+=!0===i.shorthand?"\\d":"[0-9]"),{pattern:a,count:[r],digits:n}}function splitToPatterns(e,t,i,s){let n,a=function splitToRanges(e,t){let i=1,s=1,n=countNines(e,i),a=new Set([t]);for(;e<=n&&n<=t;)a.add(n),i+=1,n=countNines(e,i);for(n=countZeros(t+1,s)-1;e<n&&n<=t;)a.add(n),s+=1,n=countZeros(t+1,s)-1;return a=[...a],a.sort(compare),a}(e,t),r=[],o=e;for(let e=0;e<a.length;e++){let t=a[e],c=rangeToPattern(String(o),String(t),s),l="";i.isPadded||!n||n.pattern!==c.pattern?(i.isPadded&&(l=padZeros(t,i,s)),c.string=l+c.pattern+toQuantifier(c.count),r.push(c),o=t+1,n=c):(n.count.length>1&&n.count.pop(),n.count.push(c.count[0]),n.string=n.pattern+toQuantifier(n.count),o=t+1)}return r}function filterPatterns(e,t,i,s,n){let a=[];for(let n of e){let{string:e}=n;s||contains(t,"string",e)||a.push(i+e),s&&contains(t,"string",e)&&a.push(i+e)}return a}function compare(e,t){return e>t?1:t>e?-1:0}function contains(e,t,i){return e.some((e=>e[t]===i))}function countNines(e,t){return Number(String(e).slice(0,-t)+"9".repeat(t))}function countZeros(e,t){return e-e%Math.pow(10,t)}function toQuantifier(e){let[t=0,i=""]=e;return i||t>1?`{${t+(i?","+i:"")}}`:""}function toCharacterClass(e,t,i){return`[${e}${t-e==1?"":"-"}${t}]`}function hasPadding(e){return/^-?(0+)\d/.test(e)}function padZeros(e,t,i){if(!t.isPadded)return e;let s=Math.abs(t.maxLen-String(e).length),n=!1!==i.relaxZeros;switch(s){case 0:return"";case 1:return n?"0?":"0";case 2:return n?"0{0,2}":"00";default:return n?`0{0,${s}}`:`0{${s}}`}}toRegexRange.cache={},toRegexRange.clearCache=()=>toRegexRange.cache={},e.exports=toRegexRange},2314:(e,t,i)=>{"use strict";const s=i(655),n=i(2513),a=i(1485),r=(0,s.__importDefault)(i(1017));Error.stackTraceLimit=1/0,a.Logger.setConfig({console:{level:a.LoggerSeverity.none},file:{level:a.LoggerSeverity.debug,outDir:r.default.resolve(__dirname,"_logs")}});const o=new n.SdServiceServer({rootPath:__dirname,services:[n.SdOrmService,n.SdCryptoService],port:50281}),c=a.Logger.get(["kakao-map1","server"]);o.listenAsync().catch((e=>{c.error(e),process.exit(1)})),e.exports=o},655:(e,t,i)=>{"use strict";i.r(t),i.d(t,{__assign:()=>__assign,__asyncDelegator:()=>__asyncDelegator,__asyncGenerator:()=>__asyncGenerator,__asyncValues:()=>__asyncValues,__await:()=>__await,__awaiter:()=>__awaiter,__classPrivateFieldGet:()=>__classPrivateFieldGet,__classPrivateFieldIn:()=>__classPrivateFieldIn,__classPrivateFieldSet:()=>__classPrivateFieldSet,__createBinding:()=>s,__decorate:()=>__decorate,__exportStar:()=>__exportStar,__extends:()=>__extends,__generator:()=>__generator,__importDefault:()=>__importDefault,__importStar:()=>__importStar,__makeTemplateObject:()=>__makeTemplateObject,__metadata:()=>__metadata,__param:()=>__param,__read:()=>__read,__rest:()=>__rest,__spread:()=>__spread,__spreadArray:()=>__spreadArray,__spreadArrays:()=>__spreadArrays,__values:()=>__values});var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},extendStatics(e,t)};function __extends(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}var __assign=function(){return __assign=Object.assign||function __assign(e){for(var t,i=1,s=arguments.length;i<s;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},__assign.apply(this,arguments)};function __rest(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}function __decorate(e,t,i,s){var n,a=arguments.length,r=a<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(r=(a<3?n(r):a>3?n(t,i,r):n(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r}function __param(e,t){return function(i,s){t(i,s,e)}}function __metadata(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function __awaiter(e,t,i,s){return new(i||(i=Promise))((function(n,a){function fulfilled(e){try{step(s.next(e))}catch(e){a(e)}}function rejected(e){try{step(s.throw(e))}catch(e){a(e)}}function step(e){e.done?n(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())}))}function __generator(e,t){var i,s,n,a,r={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function verb(a){return function(o){return function step(a){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,s&&(n=2&a[0]?s.return:a[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,a[1])).done)return n;switch(s=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(n=r.trys,(n=n.length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){r.label=a[1];break}if(6===a[0]&&r.label<n[1]){r.label=n[1],n=a;break}if(n&&r.label<n[2]){r.label=n[2],r.ops.push(a);break}n[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],s=0}finally{i=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}}var s=Object.create?function(e,t,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,s,n)}:function(e,t,i,s){void 0===s&&(s=i),e[s]=t[i]};function __exportStar(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||s(t,e,i)}function __values(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],s=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var s,n,a=i.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(s=a.next()).done;)r.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return r}function __spread(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e}function __spreadArrays(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var s=Array(e),n=0;for(t=0;t<i;t++)for(var a=arguments[t],r=0,o=a.length;r<o;r++,n++)s[n]=a[r];return s}function __spreadArray(e,t,i){if(i||2===arguments.length)for(var s,n=0,a=t.length;n<a;n++)!s&&n in t||(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}function __await(e){return this instanceof __await?(this.v=e,this):new __await(e)}function __asyncGenerator(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,n=i.apply(e,t||[]),a=[];return s={},verb("next"),verb("throw"),verb("return"),s[Symbol.asyncIterator]=function(){return this},s;function verb(e){n[e]&&(s[e]=function(t){return new Promise((function(i,s){a.push([e,t,i,s])>1||resume(e,t)}))})}function resume(e,t){try{!function step(e){e.value instanceof __await?Promise.resolve(e.value.v).then(fulfill,reject):settle(a[0][2],e)}(n[e](t))}catch(e){settle(a[0][3],e)}}function fulfill(e){resume("next",e)}function reject(e){resume("throw",e)}function settle(e,t){e(t),a.shift(),a.length&&resume(a[0][0],a[0][1])}}function __asyncDelegator(e){var t,i;return t={},verb("next"),verb("throw",(function(e){throw e})),verb("return"),t[Symbol.iterator]=function(){return this},t;function verb(s,n){t[s]=e[s]?function(t){return(i=!i)?{value:__await(e[s](t)),done:"return"===s}:n?n(t):t}:n}}function __asyncValues(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e=__values(e),t={},verb("next"),verb("throw"),verb("return"),t[Symbol.asyncIterator]=function(){return this},t);function verb(i){t[i]=e[i]&&function(t){return new Promise((function(s,n){(function settle(e,t,i,s){Promise.resolve(s).then((function(t){e({value:t,done:i})}),t)})(s,n,(t=e[i](t)).done,t.value)}))}}}function __makeTemplateObject(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var n=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function __importStar(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&s(t,e,i);return n(t,e),t}function __importDefault(e){return e&&e.__esModule?e:{default:e}}function __classPrivateFieldGet(e,t,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(e):s?s.value:t.get(e)}function __classPrivateFieldSet(e,t,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(e,i):n?n.value=i:t.set(e,i),i}function __classPrivateFieldIn(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},2479:e=>{e.exports=function wrappy(e,t){if(e&&t)return wrappy(e)(t);if("function"!=typeof e)throw new TypeError("need wrapper function");return Object.keys(e).forEach((function(t){wrapper[t]=e[t]})),wrapper;function wrapper(){for(var t=new Array(arguments.length),i=0;i<t.length;i++)t[i]=arguments[i];var s=e.apply(this,t),n=t[t.length-1];return"function"==typeof s&&s!==n&&Object.keys(n).forEach((function(e){s[e]=n[e]})),s}}},977:(e,t,i)=>{"use strict";const{EMPTY_BUFFER:s}=i(1872);function _mask(e,t,i,s,n){for(let a=0;a<n;a++)i[s+a]=e[a]^t[3&a]}function _unmask(e,t){for(let i=0;i<e.length;i++)e[i]^=t[3&i]}if(e.exports={concat:function concat(e,t){if(0===e.length)return s;if(1===e.length)return e[0];const i=Buffer.allocUnsafe(t);let n=0;for(let t=0;t<e.length;t++){const s=e[t];i.set(s,n),n+=s.length}return n<t?i.slice(0,n):i},mask:_mask,toArrayBuffer:function toArrayBuffer(e){return e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)},toBuffer:function toBuffer(e){if(toBuffer.readOnly=!0,Buffer.isBuffer(e))return e;let t;return e instanceof ArrayBuffer?t=Buffer.from(e):ArrayBuffer.isView(e)?t=Buffer.from(e.buffer,e.byteOffset,e.byteLength):(t=Buffer.from(e),toBuffer.readOnly=!1),t},unmask:_unmask},!process.env.WS_NO_BUFFER_UTIL)try{const t=i(2864);e.exports.mask=function(e,i,s,n,a){a<48?_mask(e,i,s,n,a):t.mask(e,i,s,n,a)},e.exports.unmask=function(e,i){e.length<32?_unmask(e,i):t.unmask(e,i)}}catch(e){}},1872:e=>{"use strict";e.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},62:(e,t,i)=>{"use strict";const{kForOnEventAttribute:s,kListener:n}=i(1872),a=Symbol("kCode"),r=Symbol("kData"),o=Symbol("kError"),c=Symbol("kMessage"),l=Symbol("kReason"),p=Symbol("kTarget"),d=Symbol("kType"),h=Symbol("kWasClean");class Event{constructor(e){this[p]=null,this[d]=e}get target(){return this[p]}get type(){return this[d]}}Object.defineProperty(Event.prototype,"target",{enumerable:!0}),Object.defineProperty(Event.prototype,"type",{enumerable:!0});class CloseEvent extends Event{constructor(e,t={}){super(e),this[a]=void 0===t.code?0:t.code,this[l]=void 0===t.reason?"":t.reason,this[h]=void 0!==t.wasClean&&t.wasClean}get code(){return this[a]}get reason(){return this[l]}get wasClean(){return this[h]}}Object.defineProperty(CloseEvent.prototype,"code",{enumerable:!0}),Object.defineProperty(CloseEvent.prototype,"reason",{enumerable:!0}),Object.defineProperty(CloseEvent.prototype,"wasClean",{enumerable:!0});class ErrorEvent extends Event{constructor(e,t={}){super(e),this[o]=void 0===t.error?null:t.error,this[c]=void 0===t.message?"":t.message}get error(){return this[o]}get message(){return this[c]}}Object.defineProperty(ErrorEvent.prototype,"error",{enumerable:!0}),Object.defineProperty(ErrorEvent.prototype,"message",{enumerable:!0});class MessageEvent extends Event{constructor(e,t={}){super(e),this[r]=void 0===t.data?null:t.data}get data(){return this[r]}}Object.defineProperty(MessageEvent.prototype,"data",{enumerable:!0});const u={addEventListener(e,t,i={}){let a;if("message"===e)a=function onMessage(e,i){const s=new MessageEvent("message",{data:i?e:e.toString()});s[p]=this,t.call(this,s)};else if("close"===e)a=function onClose(e,i){const s=new CloseEvent("close",{code:e,reason:i.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});s[p]=this,t.call(this,s)};else if("error"===e)a=function onError(e){const i=new ErrorEvent("error",{error:e,message:e.message});i[p]=this,t.call(this,i)};else{if("open"!==e)return;a=function onOpen(){const e=new Event("open");e[p]=this,t.call(this,e)}}a[s]=!!i[s],a[n]=t,i.once?this.once(e,a):this.on(e,a)},removeEventListener(e,t){for(const i of this.listeners(e))if(i[n]===t&&!i[s]){this.removeListener(e,i);break}}};e.exports={CloseEvent,ErrorEvent,Event,EventTarget:u,MessageEvent}},1503:(e,t,i)=>{"use strict";const{tokenChars:s}=i(6746);function push(e,t,i){void 0===e[t]?e[t]=[i]:e[t].push(i)}e.exports={format:function format(e){return Object.keys(e).map((t=>{let i=e[t];return Array.isArray(i)||(i=[i]),i.map((e=>[t].concat(Object.keys(e).map((t=>{let i=e[t];return Array.isArray(i)||(i=[i]),i.map((e=>!0===e?t:`${t}=${e}`)).join("; ")}))).join("; "))).join(", ")})).join(", ")},parse:function parse(e){const t=Object.create(null);let i,n,a=Object.create(null),r=!1,o=!1,c=!1,l=-1,p=-1,d=-1,h=0;for(;h<e.length;h++)if(p=e.charCodeAt(h),void 0===i)if(-1===d&&1===s[p])-1===l&&(l=h);else if(0===h||32!==p&&9!==p){if(59!==p&&44!==p)throw new SyntaxError(`Unexpected character at index ${h}`);{if(-1===l)throw new SyntaxError(`Unexpected character at index ${h}`);-1===d&&(d=h);const s=e.slice(l,d);44===p?(push(t,s,a),a=Object.create(null)):i=s,l=d=-1}}else-1===d&&-1!==l&&(d=h);else if(void 0===n)if(-1===d&&1===s[p])-1===l&&(l=h);else if(32===p||9===p)-1===d&&-1!==l&&(d=h);else if(59===p||44===p){if(-1===l)throw new SyntaxError(`Unexpected character at index ${h}`);-1===d&&(d=h),push(a,e.slice(l,d),!0),44===p&&(push(t,i,a),a=Object.create(null),i=void 0),l=d=-1}else{if(61!==p||-1===l||-1!==d)throw new SyntaxError(`Unexpected character at index ${h}`);n=e.slice(l,h),l=d=-1}else if(o){if(1!==s[p])throw new SyntaxError(`Unexpected character at index ${h}`);-1===l?l=h:r||(r=!0),o=!1}else if(c)if(1===s[p])-1===l&&(l=h);else if(34===p&&-1!==l)c=!1,d=h;else{if(92!==p)throw new SyntaxError(`Unexpected character at index ${h}`);o=!0}else if(34===p&&61===e.charCodeAt(h-1))c=!0;else if(-1===d&&1===s[p])-1===l&&(l=h);else if(-1===l||32!==p&&9!==p){if(59!==p&&44!==p)throw new SyntaxError(`Unexpected character at index ${h}`);{if(-1===l)throw new SyntaxError(`Unexpected character at index ${h}`);-1===d&&(d=h);let s=e.slice(l,d);r&&(s=s.replace(/\\/g,""),r=!1),push(a,n,s),44===p&&(push(t,i,a),a=Object.create(null),i=void 0),n=void 0,l=d=-1}}else-1===d&&(d=h);if(-1===l||c||32===p||9===p)throw new SyntaxError("Unexpected end of input");-1===d&&(d=h);const u=e.slice(l,d);return void 0===i?push(t,u,a):(void 0===n?push(a,u,!0):push(a,n,r?u.replace(/\\/g,""):u),push(t,i,a)),t}}},305:e=>{"use strict";const t=Symbol("kDone"),i=Symbol("kRun");e.exports=class Limiter{constructor(e){this[t]=()=>{this.pending--,this[i]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[i]()}[i](){if(this.pending!==this.concurrency&&this.jobs.length){const e=this.jobs.shift();this.pending++,e(this[t])}}}},5196:(e,t,i)=>{"use strict";const s=i(9796),n=i(977),a=i(305),{kStatusCode:r}=i(1872),o=Buffer.from([0,0,255,255]),c=Symbol("permessage-deflate"),l=Symbol("total-length"),p=Symbol("callback"),d=Symbol("buffers"),h=Symbol("error");let u;function deflateOnData(e){this[d].push(e),this[l]+=e.length}function inflateOnData(e){this[l]+=e.length,this[c]._maxPayload<1||this[l]<=this[c]._maxPayload?this[d].push(e):(this[h]=new RangeError("Max payload size exceeded"),this[h].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[h][r]=1009,this.removeListener("data",inflateOnData),this.reset())}function inflateOnError(e){this[c]._inflate=null,e[r]=1007,this[p](e)}e.exports=class PerMessageDeflate{constructor(e,t,i){if(this._maxPayload=0|i,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!u){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;u=new a(e)}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const e=this._deflate[p];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){const t=this._options,i=e.find((e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits)));if(!i)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(i.server_no_context_takeover=!0),t.clientNoContextTakeover&&(i.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(i.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?i.client_max_window_bits=t.clientMaxWindowBits:!0!==i.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete i.client_max_window_bits,i}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach((e=>{Object.keys(e).forEach((t=>{let i=e[t];if(i.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(i=i[0],"client_max_window_bits"===t){if(!0!==i){const e=+i;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${i}`);i=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${i}`)}else if("server_max_window_bits"===t){const e=+i;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${i}`);i=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==i)throw new TypeError(`Invalid value for parameter "${t}": ${i}`)}e[t]=i}))})),e}decompress(e,t,i){u.add((s=>{this._decompress(e,t,((e,t)=>{s(),i(e,t)}))}))}compress(e,t,i){u.add((s=>{this._compress(e,t,((e,t)=>{s(),i(e,t)}))}))}_decompress(e,t,i){const a=this._isServer?"client":"server";if(!this._inflate){const e=`${a}_max_window_bits`,t="number"!=typeof this.params[e]?s.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=s.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[c]=this,this._inflate[l]=0,this._inflate[d]=[],this._inflate.on("error",inflateOnError),this._inflate.on("data",inflateOnData)}this._inflate[p]=i,this._inflate.write(e),t&&this._inflate.write(o),this._inflate.flush((()=>{const e=this._inflate[h];if(e)return this._inflate.close(),this._inflate=null,void i(e);const s=n.concat(this._inflate[d],this._inflate[l]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[l]=0,this._inflate[d]=[],t&&this.params[`${a}_no_context_takeover`]&&this._inflate.reset()),i(null,s)}))}_compress(e,t,i){const a=this._isServer?"server":"client";if(!this._deflate){const e=`${a}_max_window_bits`,t="number"!=typeof this.params[e]?s.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=s.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[l]=0,this._deflate[d]=[],this._deflate.on("data",deflateOnData)}this._deflate[p]=i,this._deflate.write(e),this._deflate.flush(s.Z_SYNC_FLUSH,(()=>{if(!this._deflate)return;let e=n.concat(this._deflate[d],this._deflate[l]);t&&(e=e.slice(0,e.length-4)),this._deflate[p]=null,this._deflate[l]=0,this._deflate[d]=[],t&&this.params[`${a}_no_context_takeover`]&&this._deflate.reset(),i(null,e)}))}}},2957:(e,t,i)=>{"use strict";const{Writable:s}=i(2781),n=i(5196),{BINARY_TYPES:a,EMPTY_BUFFER:r,kStatusCode:o,kWebSocket:c}=i(1872),{concat:l,toArrayBuffer:p,unmask:d}=i(977),{isValidStatusCode:h,isValidUTF8:u}=i(6746);function error(e,t,i,s,n){const a=new e(i?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(a,error),a.code=n,a[o]=s,a}e.exports=class Receiver extends s{constructor(e={}){super(),this._binaryType=e.binaryType||a[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[c]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=0,this._loop=!1}_write(e,t,i){if(8===this._opcode&&0==this._state)return i();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(i)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=t.slice(e),t.slice(0,e)}const t=Buffer.allocUnsafe(e);do{const i=this._buffers[0],s=t.length-e;e>=i.length?t.set(this._buffers.shift(),s):(t.set(new Uint8Array(i.buffer,i.byteOffset,e),s),this._buffers[0]=i.slice(e)),e-=i.length}while(e>0);return t}startLoop(e){let t;this._loop=!0;do{switch(this._state){case 0:t=this.getInfo();break;case 1:t=this.getPayloadLength16();break;case 2:t=this.getPayloadLength64();break;case 3:this.getMask();break;case 4:t=this.getData(e);break;default:return void(this._loop=!1)}}while(this._loop);e(t)}getInfo(){if(this._bufferedBytes<2)return void(this._loop=!1);const e=this.consume(2);if(0!=(48&e[0]))return this._loop=!1,error(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");const t=64==(64&e[0]);if(t&&!this._extensions[n.extensionName])return this._loop=!1,error(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=128==(128&e[0]),this._opcode=15&e[0],this._payloadLength=127&e[1],0===this._opcode){if(t)return this._loop=!1,error(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,error(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return this._loop=!1,error(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=t}else{if(!(this._opcode>7&&this._opcode<11))return this._loop=!1,error(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin)return this._loop=!1,error(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(t)return this._loop=!1,error(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125)return this._loop=!1,error(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=128==(128&e[1]),this._isServer){if(!this._masked)return this._loop=!1,error(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,error(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(126===this._payloadLength)this._state=1;else{if(127!==this._payloadLength)return this.haveLength();this._state=2}}getPayloadLength16(){if(!(this._bufferedBytes<2))return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength();this._loop=!1}getPayloadLength64(){if(this._bufferedBytes<8)return void(this._loop=!1);const e=this.consume(8),t=e.readUInt32BE(0);return t>Math.pow(2,21)-1?(this._loop=!1,error(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,error(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=3:this._state=4}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}getData(e){let t=r;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&0!=(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])&&d(t,this._mask)}return this._opcode>7?this.controlMessage(t):this._compressed?(this._state=5,void this.decompress(t,e)):(t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage())}decompress(e,t){this._extensions[n.extensionName].decompress(e,this._fin,((e,i)=>{if(e)return t(e);if(i.length){if(this._messageLength+=i.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return t(error(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(i)}const s=this.dataMessage();if(s)return t(s);this.startLoop(t)}))}dataMessage(){if(this._fin){const e=this._messageLength,t=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let i;i="nodebuffer"===this._binaryType?l(t,e):"arraybuffer"===this._binaryType?p(l(t,e)):t,this.emit("message",i,!0)}else{const i=l(t,e);if(!this._skipUTF8Validation&&!u(i))return this._loop=!1,error(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",i,!1)}}this._state=0}controlMessage(e){if(8===this._opcode)if(this._loop=!1,0===e.length)this.emit("conclude",1005,r),this.end();else{if(1===e.length)return error(RangeError,"invalid payload length 1",!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");{const t=e.readUInt16BE(0);if(!h(t))return error(RangeError,`invalid status code ${t}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");const i=e.slice(2);if(!this._skipUTF8Validation&&!u(i))return error(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",t,i),this.end()}}else 9===this._opcode?this.emit("ping",e):this.emit("pong",e);this._state=0}}},7330:(e,t,i)=>{"use strict";i(1808),i(4404);const{randomFillSync:s}=i(6113),n=i(5196),{EMPTY_BUFFER:a}=i(1872),{isValidStatusCode:r}=i(6746),{mask:o,toBuffer:c}=i(977),l=Symbol("kByteLength"),p=Buffer.alloc(4);class Sender{constructor(e,t,i){this._extensions=t||{},i&&(this._generateMask=i,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){let i,n,a=!1,r=2,c=!1;t.mask&&(i=t.maskBuffer||p,t.generateMask?t.generateMask(i):s(i,0,4),c=0==(i[0]|i[1]|i[2]|i[3]),r=6),"string"==typeof e?n=t.mask&&!c||void 0===t[l]?(e=Buffer.from(e)).length:t[l]:(n=e.length,a=t.mask&&t.readOnly&&!c);let d=n;n>=65536?(r+=8,d=127):n>125&&(r+=2,d=126);const h=Buffer.allocUnsafe(a?n+r:r);return h[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(h[0]|=64),h[1]=d,126===d?h.writeUInt16BE(n,2):127===d&&(h[2]=h[3]=0,h.writeUIntBE(n,4,6)),t.mask?(h[1]|=128,h[r-4]=i[0],h[r-3]=i[1],h[r-2]=i[2],h[r-1]=i[3],c?[h,e]:a?(o(e,i,h,r,n),[h]):(o(e,i,e,0,n),[h,e])):[h,e]}close(e,t,i,s){let n;if(void 0===e)n=a;else{if("number"!=typeof e||!r(e))throw new TypeError("First argument must be a valid error code number");if(void 0!==t&&t.length){const i=Buffer.byteLength(t);if(i>123)throw new RangeError("The message must not be greater than 123 bytes");n=Buffer.allocUnsafe(2+i),n.writeUInt16BE(e,0),"string"==typeof t?n.write(t,2):n.set(t,2)}else n=Buffer.allocUnsafe(2),n.writeUInt16BE(e,0)}const o={[l]:n.length,fin:!0,generateMask:this._generateMask,mask:i,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,n,!1,o,s]):this.sendFrame(Sender.frame(n,o),s)}ping(e,t,i){let s,n;if("string"==typeof e?(s=Buffer.byteLength(e),n=!1):(s=(e=c(e)).length,n=c.readOnly),s>125)throw new RangeError("The data size must not be greater than 125 bytes");const a={[l]:s,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:n,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,a,i]):this.sendFrame(Sender.frame(e,a),i)}pong(e,t,i){let s,n;if("string"==typeof e?(s=Buffer.byteLength(e),n=!1):(s=(e=c(e)).length,n=c.readOnly),s>125)throw new RangeError("The data size must not be greater than 125 bytes");const a={[l]:s,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:n,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,a,i]):this.sendFrame(Sender.frame(e,a),i)}send(e,t,i){const s=this._extensions[n.extensionName];let a,r,o=t.binary?2:1,p=t.compress;if("string"==typeof e?(a=Buffer.byteLength(e),r=!1):(a=(e=c(e)).length,r=c.readOnly),this._firstFragment?(this._firstFragment=!1,p&&s&&s.params[s._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(p=a>=s._threshold),this._compress=p):(p=!1,o=0),t.fin&&(this._firstFragment=!0),s){const s={[l]:a,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:o,readOnly:r,rsv1:p};this._deflating?this.enqueue([this.dispatch,e,this._compress,s,i]):this.dispatch(e,this._compress,s,i)}else this.sendFrame(Sender.frame(e,{[l]:a,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:o,readOnly:r,rsv1:!1}),i)}dispatch(e,t,i,s){if(!t)return void this.sendFrame(Sender.frame(e,i),s);const a=this._extensions[n.extensionName];this._bufferedBytes+=i[l],this._deflating=!0,a.compress(e,i.fin,((e,t)=>{if(this._socket.destroyed){const e=new Error("The socket was closed while data was being compressed");"function"==typeof s&&s(e);for(let t=0;t<this._queue.length;t++){const i=this._queue[t],s=i[i.length-1];"function"==typeof s&&s(e)}}else this._bufferedBytes-=i[l],this._deflating=!1,i.readOnly=!1,this.sendFrame(Sender.frame(t,i),s),this.dequeue()}))}dequeue(){for(;!this._deflating&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[3][l],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][l],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}e.exports=Sender},404:(e,t,i)=>{"use strict";const{Duplex:s}=i(2781);function emitClose(e){e.emit("close")}function duplexOnEnd(){!this.destroyed&&this._writableState.finished&&this.destroy()}function duplexOnError(e){this.removeListener("error",duplexOnError),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}e.exports=function createWebSocketStream(e,t){let i=!0;const n=new s({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return e.on("message",(function message(t,i){const s=!i&&n._readableState.objectMode?t.toString():t;n.push(s)||e.pause()})),e.once("error",(function error(e){n.destroyed||(i=!1,n.destroy(e))})),e.once("close",(function close(){n.destroyed||n.push(null)})),n._destroy=function(t,s){if(e.readyState===e.CLOSED)return s(t),void process.nextTick(emitClose,n);let a=!1;e.once("error",(function error(e){a=!0,s(e)})),e.once("close",(function close(){a||s(t),process.nextTick(emitClose,n)})),i&&e.terminate()},n._final=function(t){e.readyState!==e.CONNECTING?null!==e._socket&&(e._socket._writableState.finished?(t(),n._readableState.endEmitted&&n.destroy()):(e._socket.once("finish",(function finish(){t()})),e.close())):e.once("open",(function open(){n._final(t)}))},n._read=function(){e.isPaused&&e.resume()},n._write=function(t,i,s){e.readyState!==e.CONNECTING?e.send(t,s):e.once("open",(function open(){n._write(t,i,s)}))},n.on("end",duplexOnEnd),n.on("error",duplexOnError),n}},640:(e,t,i)=>{"use strict";const{tokenChars:s}=i(6746);e.exports={parse:function parse(e){const t=new Set;let i=-1,n=-1,a=0;for(;a<e.length;a++){const r=e.charCodeAt(a);if(-1===n&&1===s[r])-1===i&&(i=a);else if(0===a||32!==r&&9!==r){if(44!==r)throw new SyntaxError(`Unexpected character at index ${a}`);{if(-1===i)throw new SyntaxError(`Unexpected character at index ${a}`);-1===n&&(n=a);const s=e.slice(i,n);if(t.has(s))throw new SyntaxError(`The "${s}" subprotocol is duplicated`);t.add(s),i=n=-1}}else-1===n&&-1!==i&&(n=a)}if(-1===i||-1!==n)throw new SyntaxError("Unexpected end of input");const r=e.slice(i,a);if(t.has(r))throw new SyntaxError(`The "${r}" subprotocol is duplicated`);return t.add(r),t}}},6746:(e,t,i)=>{"use strict";function _isValidUTF8(e){const t=e.length;let i=0;for(;i<t;)if(0==(128&e[i]))i++;else if(192==(224&e[i])){if(i+1===t||128!=(192&e[i+1])||192==(254&e[i]))return!1;i+=2}else if(224==(240&e[i])){if(i+2>=t||128!=(192&e[i+1])||128!=(192&e[i+2])||224===e[i]&&128==(224&e[i+1])||237===e[i]&&160==(224&e[i+1]))return!1;i+=3}else{if(240!=(248&e[i]))return!1;if(i+3>=t||128!=(192&e[i+1])||128!=(192&e[i+2])||128!=(192&e[i+3])||240===e[i]&&128==(240&e[i+1])||244===e[i]&&e[i+1]>143||e[i]>244)return!1;i+=4}return!0}if(e.exports={isValidStatusCode:function isValidStatusCode(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},isValidUTF8:_isValidUTF8,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},!process.env.WS_NO_UTF_8_VALIDATE)try{const t=i(2239);e.exports.isValidUTF8=function(e){return e.length<150?_isValidUTF8(e):t(e)}}catch(e){}},9284:(e,t,i)=>{"use strict";const s=i(2361),n=i(3685),{createHash:a}=(i(5687),i(1808),i(4404),i(6113)),r=i(1503),o=i(5196),c=i(640),l=i(8762),{GUID:p,kWebSocket:d}=i(1872),h=/^[+/0-9A-Za-z]{22}==$/;function emitClose(e){e._state=2,e.emit("close")}function socketOnError(){this.destroy()}function abortHandshake(e,t,i,s){i=i||n.STATUS_CODES[t],s={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(i),...s},e.once("finish",e.destroy),e.end(`HTTP/1.1 ${t} ${n.STATUS_CODES[t]}\r\n`+Object.keys(s).map((e=>`${e}: ${s[e]}`)).join("\r\n")+"\r\n\r\n"+i)}function abortHandshakeOrEmitwsClientError(e,t,i,s,n){if(e.listenerCount("wsClientError")){const s=new Error(n);Error.captureStackTrace(s,abortHandshakeOrEmitwsClientError),e.emit("wsClientError",s,i,t)}else abortHandshake(i,s,n)}e.exports=class WebSocketServer extends s{constructor(e,t){if(super(),null==(e={maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:l,...e}).port&&!e.server&&!e.noServer||null!=e.port&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=e.port?(this._server=n.createServer(((e,t)=>{const i=n.STATUS_CODES[426];t.writeHead(426,{"Content-Length":i.length,"Content-Type":"text/plain"}),t.end(i)})),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){const e=this.emit.bind(this,"connection");this._removeListeners=function addListeners(e,t){for(const i of Object.keys(t))e.on(i,t[i]);return function removeListeners(){for(const i of Object.keys(t))e.removeListener(i,t[i])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(t,i,s)=>{this.handleUpgrade(t,i,s,e)}})}!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=0}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(2===this._state)return e&&this.once("close",(()=>{e(new Error("The server is not running"))})),void process.nextTick(emitClose,this);if(e&&this.once("close",e),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(emitClose,this);else{const e=this._server;this._removeListeners(),this._removeListeners=this._server=null,e.close((()=>{emitClose(this)}))}}shouldHandle(e){if(this.options.path){const t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,i,s){t.on("error",socketOnError);const n=e.headers["sec-websocket-key"],a=+e.headers["sec-websocket-version"];if("GET"!==e.method){return void abortHandshakeOrEmitwsClientError(this,e,t,405,"Invalid HTTP method")}if("websocket"!==e.headers.upgrade.toLowerCase()){return void abortHandshakeOrEmitwsClientError(this,e,t,400,"Invalid Upgrade header")}if(!n||!h.test(n)){return void abortHandshakeOrEmitwsClientError(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header")}if(8!==a&&13!==a){return void abortHandshakeOrEmitwsClientError(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header")}if(!this.shouldHandle(e))return void abortHandshake(t,400);const l=e.headers["sec-websocket-protocol"];let p=new Set;if(void 0!==l)try{p=c.parse(l)}catch(i){return void abortHandshakeOrEmitwsClientError(this,e,t,400,"Invalid Sec-WebSocket-Protocol header")}const d=e.headers["sec-websocket-extensions"],u={};if(this.options.perMessageDeflate&&void 0!==d){const i=new o(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const e=r.parse(d);e[o.extensionName]&&(i.accept(e[o.extensionName]),u[o.extensionName]=i)}catch(i){return void abortHandshakeOrEmitwsClientError(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header")}}if(this.options.verifyClient){const r={origin:e.headers[""+(8===a?"sec-websocket-origin":"origin")],secure:!(!e.socket.authorized&&!e.socket.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(r,((a,r,o,c)=>{if(!a)return abortHandshake(t,r||401,o,c);this.completeUpgrade(u,n,p,e,t,i,s)}));if(!this.options.verifyClient(r))return abortHandshake(t,401)}this.completeUpgrade(u,n,p,e,t,i,s)}completeUpgrade(e,t,i,s,n,c,l){if(!n.readable||!n.writable)return n.destroy();if(n[d])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return abortHandshake(n,503);const h=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${a("sha1").update(t+p).digest("base64")}`],u=new this.options.WebSocket(null);if(i.size){const e=this.options.handleProtocols?this.options.handleProtocols(i,s):i.values().next().value;e&&(h.push(`Sec-WebSocket-Protocol: ${e}`),u._protocol=e)}if(e[o.extensionName]){const t=e[o.extensionName].params,i=r.format({[o.extensionName]:[t]});h.push(`Sec-WebSocket-Extensions: ${i}`),u._extensions=e}this.emit("headers",h,s),n.write(h.concat("\r\n").join("\r\n")),n.removeListener("error",socketOnError),u.setSocket(n,c,{maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(u),u.on("close",(()=>{this.clients.delete(u),this._shouldEmitClose&&!this.clients.size&&process.nextTick(emitClose,this)}))),l(u,s)}}},8762:(e,t,i)=>{"use strict";const s=i(2361),n=i(5687),a=i(3685),r=i(1808),o=i(4404),{randomBytes:c,createHash:l}=i(6113),{Readable:p}=i(2781),{URL:d}=i(7310),h=i(5196),u=i(2957),g=i(7330),{BINARY_TYPES:v,EMPTY_BUFFER:y,GUID:x,kForOnEventAttribute:_,kListener:b,kStatusCode:w,kWebSocket:E,NOOP:k}=i(1872),{EventTarget:{addEventListener:S,removeEventListener:T}}=i(62),{format:A,parse:O}=i(1503),{toBuffer:C}=i(977),N=Symbol("kAborted"),R=[8,13],I=["CONNECTING","OPEN","CLOSING","CLOSED"],D=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class WebSocket extends s{constructor(e,t,i){super(),this._binaryType=v[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=y,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=WebSocket.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===t?t=[]:Array.isArray(t)||("object"==typeof t&&null!==t?(i=t,t=[]):t=[t]),initAsClient(this,e,t,i)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(e){v.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,i){const s=new u({binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:i.maxPayload,skipUTF8Validation:i.skipUTF8Validation});this._sender=new g(e,this._extensions,i.generateMask),this._receiver=s,this._socket=e,s[E]=this,e[E]=this,s.on("conclude",receiverOnConclude),s.on("drain",receiverOnDrain),s.on("error",receiverOnError),s.on("message",receiverOnMessage),s.on("ping",receiverOnPing),s.on("pong",receiverOnPong),e.setTimeout(0),e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",socketOnClose),e.on("data",socketOnData),e.on("end",socketOnEnd),e.on("error",socketOnError),this._readyState=WebSocket.OPEN,this.emit("open")}emitClose(){if(!this._socket)return this._readyState=WebSocket.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[h.extensionName]&&this._extensions[h.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=WebSocket.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==WebSocket.CLOSED){if(this.readyState===WebSocket.CONNECTING){const e="WebSocket was closed before the connection was established";return abortHandshake(this,this._req,e)}this.readyState!==WebSocket.CLOSING?(this._readyState=WebSocket.CLOSING,this._sender.close(e,t,!this._isServer,(e=>{e||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())})),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),3e4)):this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end()}}pause(){this.readyState!==WebSocket.CONNECTING&&this.readyState!==WebSocket.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,i){if(this.readyState===WebSocket.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(i=e,e=t=void 0):"function"==typeof t&&(i=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===WebSocket.OPEN?(void 0===t&&(t=!this._isServer),this._sender.ping(e||y,t,i)):sendAfterClose(this,e,i)}pong(e,t,i){if(this.readyState===WebSocket.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(i=e,e=t=void 0):"function"==typeof t&&(i=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===WebSocket.OPEN?(void 0===t&&(t=!this._isServer),this._sender.pong(e||y,t,i)):sendAfterClose(this,e,i)}resume(){this.readyState!==WebSocket.CONNECTING&&this.readyState!==WebSocket.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,i){if(this.readyState===WebSocket.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(i=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==WebSocket.OPEN)return void sendAfterClose(this,e,i);const s={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[h.extensionName]||(s.compress=!1),this._sender.send(e||y,s,i)}terminate(){if(this.readyState!==WebSocket.CLOSED){if(this.readyState===WebSocket.CONNECTING){const e="WebSocket was closed before the connection was established";return abortHandshake(this,this._req,e)}this._socket&&(this._readyState=WebSocket.CLOSING,this._socket.destroy())}}}function initAsClient(e,t,i,s){const r={protocolVersion:R[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...s,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(!R.includes(r.protocolVersion))throw new RangeError(`Unsupported protocol version: ${r.protocolVersion} (supported versions: ${R.join(", ")})`);let o;if(t instanceof d)o=t,e._url=t.href;else{try{o=new d(t)}catch(e){throw new SyntaxError(`Invalid URL: ${t}`)}e._url=t}const p="wss:"===o.protocol,u="ws+unix:"===o.protocol;let g;if("ws:"===o.protocol||p||u?u&&!o.pathname?g="The URL's pathname is empty":o.hash&&(g="The URL contains a fragment identifier"):g='The URL\'s protocol must be one of "ws:", "wss:", or "ws+unix:"',g){const t=new SyntaxError(g);if(0===e._redirects)throw t;return void emitErrorAndClose(e,t)}const v=p?443:80,y=c(16).toString("base64"),_=p?n.request:a.request,b=new Set;let w,E;if(r.createConnection=p?tlsConnect:netConnect,r.defaultPort=r.defaultPort||v,r.port=o.port||v,r.host=o.hostname.startsWith("[")?o.hostname.slice(1,-1):o.hostname,r.headers={...r.headers,"Sec-WebSocket-Version":r.protocolVersion,"Sec-WebSocket-Key":y,Connection:"Upgrade",Upgrade:"websocket"},r.path=o.pathname+o.search,r.timeout=r.handshakeTimeout,r.perMessageDeflate&&(w=new h(!0!==r.perMessageDeflate?r.perMessageDeflate:{},!1,r.maxPayload),r.headers["Sec-WebSocket-Extensions"]=A({[h.extensionName]:w.offer()})),i.length){for(const e of i){if("string"!=typeof e||!D.test(e)||b.has(e))throw new SyntaxError("An invalid or duplicated subprotocol was specified");b.add(e)}r.headers["Sec-WebSocket-Protocol"]=i.join(",")}if(r.origin&&(r.protocolVersion<13?r.headers["Sec-WebSocket-Origin"]=r.origin:r.headers.Origin=r.origin),(o.username||o.password)&&(r.auth=`${o.username}:${o.password}`),u){const e=r.path.split(":");r.socketPath=e[0],r.path=e[1]}if(r.followRedirects){if(0===e._redirects){e._originalUnixSocket=u,e._originalSecure=p,e._originalHostOrSocketPath=u?r.socketPath:o.host;const t=s&&s.headers;if(s={...s,headers:{}},t)for(const[e,i]of Object.entries(t))s.headers[e.toLowerCase()]=i}else if(0===e.listenerCount("redirect")){const t=u?!!e._originalUnixSocket&&r.socketPath===e._originalHostOrSocketPath:!e._originalUnixSocket&&o.host===e._originalHostOrSocketPath;(!t||e._originalSecure&&!p)&&(delete r.headers.authorization,delete r.headers.cookie,t||delete r.headers.host,r.auth=void 0)}r.auth&&!s.headers.authorization&&(s.headers.authorization="Basic "+Buffer.from(r.auth).toString("base64")),E=e._req=_(r),e._redirects&&e.emit("redirect",e.url,E)}else E=e._req=_(r);r.timeout&&E.on("timeout",(()=>{abortHandshake(e,E,"Opening handshake has timed out")})),E.on("error",(t=>{null===E||E[N]||(E=e._req=null,emitErrorAndClose(e,t))})),E.on("response",(n=>{const a=n.headers.location,o=n.statusCode;if(a&&r.followRedirects&&o>=300&&o<400){if(++e._redirects>r.maxRedirects)return void abortHandshake(e,E,"Maximum redirects exceeded");let n;E.abort();try{n=new d(a,t)}catch(t){const i=new SyntaxError(`Invalid URL: ${a}`);return void emitErrorAndClose(e,i)}initAsClient(e,n,i,s)}else e.emit("unexpected-response",E,n)||abortHandshake(e,E,`Unexpected server response: ${n.statusCode}`)})),E.on("upgrade",((t,i,s)=>{if(e.emit("upgrade",t),e.readyState!==WebSocket.CONNECTING)return;if(E=e._req=null,"websocket"!==t.headers.upgrade.toLowerCase())return void abortHandshake(e,i,"Invalid Upgrade header");const n=l("sha1").update(y+x).digest("base64");if(t.headers["sec-websocket-accept"]!==n)return void abortHandshake(e,i,"Invalid Sec-WebSocket-Accept header");const a=t.headers["sec-websocket-protocol"];let o;if(void 0!==a?b.size?b.has(a)||(o="Server sent an invalid subprotocol"):o="Server sent a subprotocol but none was requested":b.size&&(o="Server sent no subprotocol"),o)return void abortHandshake(e,i,o);a&&(e._protocol=a);const c=t.headers["sec-websocket-extensions"];if(void 0!==c){if(!w){return void abortHandshake(e,i,"Server sent a Sec-WebSocket-Extensions header but no extension was requested")}let t;try{t=O(c)}catch(t){return void abortHandshake(e,i,"Invalid Sec-WebSocket-Extensions header")}const s=Object.keys(t);if(1!==s.length||s[0]!==h.extensionName){return void abortHandshake(e,i,"Server indicated an extension that was not requested")}try{w.accept(t[h.extensionName])}catch(t){return void abortHandshake(e,i,"Invalid Sec-WebSocket-Extensions header")}e._extensions[h.extensionName]=w}e.setSocket(i,s,{generateMask:r.generateMask,maxPayload:r.maxPayload,skipUTF8Validation:r.skipUTF8Validation})})),E.end()}function emitErrorAndClose(e,t){e._readyState=WebSocket.CLOSING,e.emit("error",t),e.emitClose()}function netConnect(e){return e.path=e.socketPath,r.connect(e)}function tlsConnect(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=r.isIP(e.host)?"":e.host),o.connect(e)}function abortHandshake(e,t,i){e._readyState=WebSocket.CLOSING;const s=new Error(i);Error.captureStackTrace(s,abortHandshake),t.setHeader?(t[N]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(emitErrorAndClose,e,s)):(t.destroy(s),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function sendAfterClose(e,t,i){if(t){const i=C(t).length;e._socket?e._sender._bufferedBytes+=i:e._bufferedAmount+=i}if(i){i(new Error(`WebSocket is not open: readyState ${e.readyState} (${I[e.readyState]})`))}}function receiverOnConclude(e,t){const i=this[E];i._closeFrameReceived=!0,i._closeMessage=t,i._closeCode=e,void 0!==i._socket[E]&&(i._socket.removeListener("data",socketOnData),process.nextTick(resume,i._socket),1005===e?i.close():i.close(e,t))}function receiverOnDrain(){const e=this[E];e.isPaused||e._socket.resume()}function receiverOnError(e){const t=this[E];void 0!==t._socket[E]&&(t._socket.removeListener("data",socketOnData),process.nextTick(resume,t._socket),t.close(e[w])),t.emit("error",e)}function receiverOnFinish(){this[E].emitClose()}function receiverOnMessage(e,t){this[E].emit("message",e,t)}function receiverOnPing(e){const t=this[E];t.pong(e,!t._isServer,k),t.emit("ping",e)}function receiverOnPong(e){this[E].emit("pong",e)}function resume(e){e.resume()}function socketOnClose(){const e=this[E];let t;this.removeListener("close",socketOnClose),this.removeListener("data",socketOnData),this.removeListener("end",socketOnEnd),e._readyState=WebSocket.CLOSING,this._readableState.endEmitted||e._closeFrameReceived||e._receiver._writableState.errorEmitted||null===(t=e._socket.read())||e._receiver.write(t),e._receiver.end(),this[E]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",receiverOnFinish),e._receiver.on("finish",receiverOnFinish))}function socketOnData(e){this[E]._receiver.write(e)||this.pause()}function socketOnEnd(){const e=this[E];e._readyState=WebSocket.CLOSING,e._receiver.end(),this.end()}function socketOnError(){const e=this[E];this.removeListener("error",socketOnError),this.on("error",k),e&&(e._readyState=WebSocket.CLOSING,this.destroy())}Object.defineProperty(WebSocket,"CONNECTING",{enumerable:!0,value:I.indexOf("CONNECTING")}),Object.defineProperty(WebSocket.prototype,"CONNECTING",{enumerable:!0,value:I.indexOf("CONNECTING")}),Object.defineProperty(WebSocket,"OPEN",{enumerable:!0,value:I.indexOf("OPEN")}),Object.defineProperty(WebSocket.prototype,"OPEN",{enumerable:!0,value:I.indexOf("OPEN")}),Object.defineProperty(WebSocket,"CLOSING",{enumerable:!0,value:I.indexOf("CLOSING")}),Object.defineProperty(WebSocket.prototype,"CLOSING",{enumerable:!0,value:I.indexOf("CLOSING")}),Object.defineProperty(WebSocket,"CLOSED",{enumerable:!0,value:I.indexOf("CLOSED")}),Object.defineProperty(WebSocket.prototype,"CLOSED",{enumerable:!0,value:I.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach((e=>{Object.defineProperty(WebSocket.prototype,e,{enumerable:!0})})),["open","error","close","message"].forEach((e=>{Object.defineProperty(WebSocket.prototype,`on${e}`,{enumerable:!0,get(){for(const t of this.listeners(e))if(t[_])return t[b];return null},set(t){for(const t of this.listeners(e))if(t[_]){this.removeListener(e,t);break}"function"==typeof t&&this.addEventListener(e,t,{[_]:!0})}})})),WebSocket.prototype.addEventListener=S,WebSocket.prototype.removeEventListener=T,e.exports=WebSocket},9602:e=>{"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},4411:(e,t,i)=>{"use strict";function Yallist(e){var t=this;if(t instanceof Yallist||(t=new Yallist),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var i=0,s=arguments.length;i<s;i++)t.push(arguments[i]);return t}function insert(e,t,i){var s=t===e.head?new Node(i,null,t,e):new Node(i,t,t.next,e);return null===s.next&&(e.tail=s),null===s.prev&&(e.head=s),e.length++,s}function push(e,t){e.tail=new Node(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function unshift(e,t){e.head=new Node(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Node(e,t,i,s){if(!(this instanceof Node))return new Node(e,t,i,s);this.list=s,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,i?(i.prev=this,this.next=i):this.next=null}e.exports=Yallist,Yallist.Node=Node,Yallist.create=Yallist,Yallist.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,i=e.prev;return t&&(t.prev=i),i&&(i.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=i),e.list.length--,e.next=null,e.prev=null,e.list=null,t},Yallist.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},Yallist.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},Yallist.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)push(this,arguments[e]);return this.length},Yallist.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)unshift(this,arguments[e]);return this.length},Yallist.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},Yallist.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},Yallist.prototype.forEach=function(e,t){t=t||this;for(var i=this.head,s=0;null!==i;s++)e.call(t,i.value,s,this),i=i.next},Yallist.prototype.forEachReverse=function(e,t){t=t||this;for(var i=this.tail,s=this.length-1;null!==i;s--)e.call(t,i.value,s,this),i=i.prev},Yallist.prototype.get=function(e){for(var t=0,i=this.head;null!==i&&t<e;t++)i=i.next;if(t===e&&null!==i)return i.value},Yallist.prototype.getReverse=function(e){for(var t=0,i=this.tail;null!==i&&t<e;t++)i=i.prev;if(t===e&&null!==i)return i.value},Yallist.prototype.map=function(e,t){t=t||this;for(var i=new Yallist,s=this.head;null!==s;)i.push(e.call(t,s.value,this)),s=s.next;return i},Yallist.prototype.mapReverse=function(e,t){t=t||this;for(var i=new Yallist,s=this.tail;null!==s;)i.push(e.call(t,s.value,this)),s=s.prev;return i},Yallist.prototype.reduce=function(e,t){var i,s=this.head;if(arguments.length>1)i=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");s=this.head.next,i=this.head.value}for(var n=0;null!==s;n++)i=e(i,s.value,n),s=s.next;return i},Yallist.prototype.reduceReverse=function(e,t){var i,s=this.tail;if(arguments.length>1)i=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");s=this.tail.prev,i=this.tail.value}for(var n=this.length-1;null!==s;n--)i=e(i,s.value,n),s=s.prev;return i},Yallist.prototype.toArray=function(){for(var e=new Array(this.length),t=0,i=this.head;null!==i;t++)e[t]=i.value,i=i.next;return e},Yallist.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,i=this.tail;null!==i;t++)e[t]=i.value,i=i.prev;return e},Yallist.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var i=new Yallist;if(t<e||t<0)return i;e<0&&(e=0),t>this.length&&(t=this.length);for(var s=0,n=this.head;null!==n&&s<e;s++)n=n.next;for(;null!==n&&s<t;s++,n=n.next)i.push(n.value);return i},Yallist.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var i=new Yallist;if(t<e||t<0)return i;e<0&&(e=0),t>this.length&&(t=this.length);for(var s=this.length,n=this.tail;null!==n&&s>t;s--)n=n.prev;for(;null!==n&&s>e;s--,n=n.prev)i.push(n.value);return i},Yallist.prototype.splice=function(e,t,...i){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var s=0,n=this.head;null!==n&&s<e;s++)n=n.next;var a=[];for(s=0;n&&s<t;s++)a.push(n.value),n=this.removeNode(n);null===n&&(n=this.tail),n!==this.head&&n!==this.tail&&(n=n.prev);for(s=0;s<i.length;s++)n=insert(this,n,i[s]);return a},Yallist.prototype.reverse=function(){for(var e=this.head,t=this.tail,i=e;null!==i;i=i.prev){var s=i.prev;i.prev=i.next,i.next=s}return this.head=t,this.tail=e,this};try{i(9602)(Yallist)}catch(e){}},9095:e=>{"use strict";e.exports=require("@simplysm/sd-orm-node-mssql")},4696:e=>{"use strict";e.exports=require("@simplysm/sd-orm-node-mysql")},3003:e=>{"use strict";e.exports=require("@simplysm/sd-orm-node-sqlite")},2864:e=>{"use strict";e.exports=require("bufferutil")},4943:e=>{"use strict";e.exports=require("fsevents")},2239:e=>{"use strict";e.exports=require("utf-8-validate")},9491:e=>{"use strict";e.exports=require("assert")},2081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},8056:(e,t,i)=>{"use strict";i.d(t,{uE:()=>DateOnly,ou:()=>DateTime,Z1:()=>FunctionUtil,Q9:()=>JsonConvert,kj:()=>MathUtil,AJ:()=>NeverEntryError,J6:()=>NotImplementError,QI:()=>ObjectUtil_ObjectUtil,Nf:()=>SdError,qp:()=>Time,r6:()=>Uuid,NT:()=>Wait_Wait});i(8660);var s,n=i(2037);class SdError extends Error{constructor(e,t){if(super("object"==typeof e||"string"==typeof t?(t??"")+("object"==typeof e?` => ${e.message}`:"string"==typeof e?` => ${e}`:"처리되지 않은 예외가 발생하였습니다."):e??"처리되지 않은 예외가 발생하였습니다."),Object.setPrototypeOf(this,new.target.prototype),this.name=new.target.name,void 0!==Error.captureStackTrace)Error.captureStackTrace(this,new.target);else try{throw new Error(this.message)}catch(e){if(!(e instanceof Error))throw e;this.stack=e.stack}"object"==typeof e&&"string"==typeof e.stack&&(this.innerError=e,this.stack+=`${n.EOL}---- inner error stack ----${n.EOL}${e.stack}`)}}class ArgumentError extends SdError{constructor(e){super("인수가 잘못되었습니다: "+JSON.stringify(e))}}class DateTimeFormatUtil{static format(e,t){const i=t.year,s=t.month,n=t.day,a=t.hour,r=t.minute,o=t.second,c=t.millisecond,l=void 0!==t.timezoneOffsetMinutes?Math.floor(t.timezoneOffsetMinutes/60):void 0,p=void 0!==t.timezoneOffsetMinutes?t.timezoneOffsetMinutes%60:void 0,d=void 0!==i&&void 0!==s&&void 0!==n?new Date(i,s-1,n).getDay():void 0,h=0===d?"일":1===d?"월":2===d?"화":3===d?"수":4===d?"목":5===d?"금":6===d?"토":void 0;let u=e;return void 0!==i&&(u=u.replace(/yyyy/g,i.toString()),u=u.replace(/yy/g,i.toString().substring(2,4))),void 0!==s&&(u=u.replace(/MM/g,s.toString().padStart(2,"0")),u=u.replace(/M/g,s.toString())),void 0!==h&&(u=u.replace(/ddd/g,h)),void 0!==n&&(u=u.replace(/dd/g,n.toString().padStart(2,"0")),u=u.replace(/d/g,n.toString())),void 0!==a&&(u=u.replace(/tt/g,a<12?"오전":"오후"),u=u.replace(/hh/g,(a%12).toString().padStart(2,"0")),u=u.replace(/h/g,(a%12).toString()),u=u.replace(/HH/g,a.toString().padStart(2,"0")),u=u.replace(/H/g,a.toString())),void 0!==r&&(u=u.replace(/mm/g,r.toString().padStart(2,"0")),u=u.replace(/m/g,r.toString())),void 0!==o&&(u=u.replace(/ss/g,o.toString().padStart(2,"0")),u=u.replace(/s/g,o.toString())),void 0!==c&&(u=u.replace(/fff/g,c.toString().padStart(3,"0")),u=u.replace(/ff/g,c.toString().padStart(3,"0").substring(0,2)),u=u.replace(/f/g,c.toString().padStart(3,"0").substring(0,1))),void 0!==l&&void 0!==p&&(u=u.replace(/zzz/g,(l>0?"+":"-")+Math.abs(l).toString().padStart(2,"0")+":"+Math.abs(p).toString().padStart(2,"0")),u=u.replace(/zz/g,(l>0?"+":"-")+Math.abs(l).toString().padStart(2,"0")),u=u.replace(/z/g,(l>0?"+":"-")+Math.abs(l).toString())),u}}class DateTime{constructor(e,t,i,s,n,a,r){void 0===e?this.date=new Date:void 0!==t&&void 0!==i?this.date=new Date(e,t-1,i,s??0,n??0,a??0,r??0):e instanceof Date?this.date=e:this.date=new Date(e)}static parse(e){const t=Date.parse(e);if(!Number.isNaN(t))return new DateTime(t);const i=/^([0-9]{4})-([0-9]{2})-([0-9]{2}) (오전|오후) ([0-9]{2}):([0-9]{2}):([0-9]{2})$/.exec(e);if(null!=i)return new DateTime(Number(i[1]),Number(i[2]),Number(i[3]),Number(i[5])+("오후"===i[4]?12:0),Number(i[6]),Number(i[7]));if(null!=/^[0-9]{14}$/.exec(e))return new DateTime(Number(e.substring(0,4)),Number(e.substring(4,6)),Number(e.substring(6,8)),Number(e.substring(8,10)),Number(e.substring(10,12)),Number(e.substring(12,14)));const s=/^([0-9]{4})-([0-9]{2})-([0-9]{2}) ([0-9]{2}):([0-9]{2}):([0-9]{2})(\.([0-9]{3}))?$/.exec(e);if(null!=s)return new DateTime(Number(s[1]),Number(s[2]),Number(s[3]),Number(s[4]),Number(s[5]),Number(s[6]),s[8]?Number(s[8]):void 0);throw new ArgumentError({str:e})}get year(){return this.date.getFullYear()}set year(e){this.date.setFullYear(e)}get month(){return this.date.getMonth()+1}set month(e){this.date.setMonth(e-1)}get day(){return this.date.getDate()}set day(e){this.date.setDate(e)}get hour(){return this.date.getHours()}set hour(e){this.date.setHours(e)}get minute(){return this.date.getMinutes()}set minute(e){this.date.setMinutes(e)}get second(){return this.date.getSeconds()}set second(e){this.date.setSeconds(e)}get millisecond(){return this.date.getMilliseconds()}set millisecond(e){this.date.setMilliseconds(e)}get tick(){return this.date.getTime()}set tick(e){this.date.setTime(e)}get week(){return this.date.getDay()}get timezoneOffsetMinutes(){return-this.date.getTimezoneOffset()}setYear(e){return new DateTime(new Date(this.tick).setFullYear(e))}setMonth(e){const t=new Date(this.tick);t.setDate(1),t.setMonth(e),t.setDate(0);const i=t.getDate(),s=i<this.day?i:this.day;return t.setDate(s),new DateTime(t)}setDay(e){return new DateTime(new Date(this.tick).setDate(e))}setHour(e){return new DateTime(new Date(this.tick).setHours(e))}setMinute(e){return new DateTime(new Date(this.tick).setMinutes(e))}setSecond(e){return new DateTime(new Date(this.tick).setSeconds(e))}setMillisecond(e){return new DateTime(new Date(this.tick).setMilliseconds(e))}addYears(e){return this.setYear(this.year+e)}addMonths(e){return this.setMonth(this.month+e)}addDays(e){return this.setDay(this.day+e)}addHours(e){return this.setHour(this.hour+e)}addMinutes(e){return this.setMinute(this.minute+e)}addSeconds(e){return this.setSecond(this.second+e)}addMilliseconds(e){return this.setMillisecond(this.millisecond+e)}toFormatString(e){return DateTimeFormatUtil.format(e,{year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second,millisecond:this.millisecond,timezoneOffsetMinutes:this.timezoneOffsetMinutes})}toString(){return this.toFormatString("yyyy-MM-ddTHH:mm:ss.fffzzz")}}class DateOnly{constructor(e,t,i){if(void 0===e){const e=Date.now(),t=new Date(e);this.date=new Date(t.getFullYear(),t.getMonth(),t.getDate())}else if(void 0!==t&&void 0!==i)this.date=new Date(e,t-1,i);else if(e instanceof Date)this.date=e;else{const t=new Date(e);this.date=new Date(t.getFullYear(),t.getMonth(),t.getDate())}}static parse(e){const t=(new Date).getTimezoneOffset(),i=Date.parse(e)-60*t*1e3;if(!Number.isNaN(i))return new DateOnly(i);if(null!=/^[0-9]{8}$/.exec(e))return new DateOnly(Number(e.substring(0,4)),Number(e.substring(4,6)),Number(e.substring(6,8)));throw new ArgumentError({str:e})}static _getByMonthWeekFirstDate(e,t,i=4,s=1){const n=e.setDay(1),a=n.week;return(a<=i?n:n.setDay(7-a+1+s)).addDays(7*(t>0?t-1:t))}static getWeekSeqOfMonth(e,t=4,i=1){const s=DateOnly._getByMonthWeekFirstDate(e.setDay(1),1,t,i),n=DateOnly._getByMonthWeekFirstDate(e.setDay(1).addMonths(1),1,t,i),a=1!==n.day?e.addMonths(1).addDays(-1):n.addDays(-n.week-1+i);if(e.tick<s.tick)return DateOnly.getWeekSeqOfMonth(e.setDay(1).addDays(-1),t,i);if(e.tick>a.tick)return DateOnly.getWeekSeqOfMonth(e.addMonths(1).setDay(1),t,i);{const t=s.addDays(1-s.week),i=Math.floor((e.tick-t.tick)/864e5),n=Math.floor(i/7);return{year:e.year,month:e.month,weekSeq:n+1}}}get isValidDate(){return this.date instanceof Date&&!isNaN(this.date)}get year(){return this.date.getFullYear()}set year(e){this.date.setFullYear(e)}get month(){return this.date.getMonth()+1}set month(e){this.date.setMonth(e-1)}get day(){return this.date.getDate()}set day(e){this.date.setDate(e)}get tick(){return this.date.getTime()}set tick(e){this.date.setTime(e-e%864e5)}get week(){return this.date.getDay()}setYear(e){return new DateOnly(new Date(this.tick).setFullYear(e))}setMonth(e){const t=new Date(this.tick);t.setDate(1),t.setMonth(e),t.setDate(0);const i=t.getDate(),s=i<this.day?i:this.day;return t.setDate(s),new DateOnly(t)}setDay(e){return new DateOnly(new Date(this.tick).setDate(e))}addYears(e){return this.setYear(this.year+e)}addMonths(e){return this.setMonth(this.month+e)}addDays(e){return this.setDay(this.day+e)}toFormatString(e){return DateTimeFormatUtil.format(e,{year:this.year,month:this.month,day:this.day})}toString(){return this.toFormatString("yyyy-MM-dd")}}class Time{constructor(e,t,i,s){if(void 0===e){const e=new Date;this._tick=(e.getMilliseconds()+1e3*e.getSeconds()+60*e.getMinutes()*1e3+60*e.getHours()*60*1e3)%864e5}else this._tick=void 0!==t?((s??0)+1e3*(i??0)+60*t*1e3+60*e*60*1e3)%864e5:e%864e5}static parse(e){const t=/(오전|오후) ([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})(\.([0-9]{1,3}))?$/.exec(e);if(null!=t)return new Time(Number(t[2])+("오후"===t[1]?12:0),Number(t[3]),Number(t[4]),Number(t[6]?t[6].padEnd(3,"0"):"0"));const i=/([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})(\.([0-9]{1,3}))?$/.exec(e);if(null!=i)return new Time(Number(i[1]),Number(i[2]),Number(i[3]),Number(i[5]?i[5].padEnd(3,"0"):"0"));try{const t=DateTime.parse(e);return new Time(t.hour,t.minute,t.second,t.millisecond)}catch{throw new ArgumentError({str:e})}}get hour(){return Math.floor(this._tick/36e5)}set hour(e){this._tick=(this._tick+60*(e-this.hour)*60*1e3)%864e5}get minute(){return Math.floor(this._tick/6e4)%60}set minute(e){this._tick=(this._tick+60*(e-this.minute)*1e3)%864e5}get second(){return Math.floor(this._tick/1e3)%60}set second(e){this._tick=(this._tick+1e3*(e-this.second))%864e5}get millisecond(){return this._tick%1e3}set millisecond(e){this._tick=(this._tick+(e-this.millisecond))%864e5}get tick(){return this._tick}set tick(e){this._tick=e%864e5}setHour(e){return new Time(e,this.minute,this.second,this.millisecond)}setMinute(e){return new Time(this.hour,e,this.second,this.millisecond)}setSecond(e){return new Time(this.hour,this.minute,e,this.millisecond)}setMillisecond(e){return new Time(this.hour,this.minute,this.second,e)}addHours(e){return this.setHour(this.hour+e)}addMinutes(e){return this.setMinute(this.minute+e)}addSeconds(e){return this.setSecond(this.second+e)}addMilliseconds(e){return this.setMillisecond(this.millisecond+e)}toFormatString(e){return DateTimeFormatUtil.format(e,{hour:this.hour,minute:this.minute,second:this.second,millisecond:this.millisecond})}toString(){return this.toFormatString("HH:mm:ss.fff")}}class Uuid{constructor(e){this._uuid=e}static new(){const fn=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}));let e=fn();for(;Uuid._prevUuidTexts.includes(e);)e=fn();return Uuid._prevUuidTexts.push(e),new Uuid(e)}toString(){return this._uuid}}Uuid._prevUuidTexts=[];class NeverEntryError extends SdError{constructor(e){super("절대 진입될 수 없는것으로 판단된 코드에 진입되었습니다"+(void 0!==e?": "+e:""))}}class ObjectUtil_ObjectUtil{static clone(e,t){return ObjectUtil_ObjectUtil._clone(e,t)}static _clone(e,t,i){if(null==e)return e;if(e instanceof Array)return e.map((e=>ObjectUtil_ObjectUtil._clone(e,t)));if(e instanceof Map)return Array.from(e.keys()).toMap((e=>ObjectUtil_ObjectUtil._clone(e,t)),(i=>ObjectUtil_ObjectUtil._clone(e.get(i),t)));if(e instanceof Date)return new Date(e.getTime());if(e instanceof DateTime)return new DateTime(e.tick);if(e instanceof DateOnly)return new DateOnly(e.tick);if(e instanceof Time)return new Time(e.tick);if(e instanceof Uuid)return new Uuid(e.toString());if(e instanceof Buffer)return Buffer.from(e.buffer);if("object"==typeof e){const s={};Object.setPrototypeOf(s,e.constructor.prototype);const n=i??[];n.push({source:e,clone:s});for(const a of Object.keys(e).filter((e=>!0!==t?.excludes?.includes(e))))if(void 0===e[a])s[a]=void 0;else if(!0===t?.useRefTypes?.includes(e[a].constructor))s[a]=e[a];else{const r=i?.single((t=>t.source===e[a]));s[a]=void 0!==r?r.clone:ObjectUtil_ObjectUtil._clone(e[a],{useRefTypes:t?.useRefTypes},n)}return s}return e}static merge(e,t,i){if(void 0===e)return ObjectUtil_ObjectUtil.clone(t);if(void 0===t)return ObjectUtil_ObjectUtil.clone(e);if(null===t)return i?.useDelTargetNull?void 0:ObjectUtil_ObjectUtil.clone(e);if("object"!=typeof t)return t;if(t instanceof Date||t instanceof DateTime||t instanceof DateOnly||t instanceof Time||t instanceof Uuid||t instanceof Buffer||"replace"===i?.arrayProcess&&t instanceof Array)return ObjectUtil_ObjectUtil.clone(t);if(typeof e!=typeof t)throw new Error("병합하려고 하는 두 객체의 타입이 서로 다릅니다.");if(e instanceof Map&&t instanceof Map){const s=ObjectUtil_ObjectUtil.clone(e);for(const e of t.keys())s.has(e)?s.set(e,ObjectUtil_ObjectUtil.merge(s.get(e),t.get(e),i)):s.set(e,t.get(e));return s}if("concat"===i?.arrayProcess&&e instanceof Array&&t instanceof Array){let s=e.concat(t).distinct();return i.useDelTargetNull&&(s=s.filter((e=>null!==e))),s}const s=ObjectUtil_ObjectUtil.clone(e);for(const n of Object.keys(t))s[n]=ObjectUtil_ObjectUtil.merge(e[n],t[n],i),void 0===s[n]&&delete s[n];return s}static merge3(e,t,i,s){let n=!1;const a=ObjectUtil_ObjectUtil.clone(t);for(const r of Object.keys(e).concat(Object.keys(i)).concat(Object.keys(t)))ObjectUtil_ObjectUtil.equal(e[r],a[r],s?.[r])?a[r]=ObjectUtil_ObjectUtil.clone(i[r]):ObjectUtil_ObjectUtil.equal(i[r],a[r],s?.[r])||ObjectUtil_ObjectUtil.equal(e[r],i[r],s?.[r])?a[r]=ObjectUtil_ObjectUtil.clone(e[r]):n=!0;return{conflict:n,result:a}}static pick(e,t){const i={};for(const s of t)i[s]=e[s];return i}static pickByType(e,t){const i={};for(const s of Object.keys(i)){const n=t;(n===String&&"string"==typeof e[s]||n===Number&&"number"==typeof e[s]||n===Boolean&&"boolean"==typeof e[s]||n===DateOnly&&e[s]instanceof DateOnly||n===DateTime&&e[s]instanceof DateTime||n===Time&&e[s]instanceof Time||n===Uuid&&e[s]instanceof Uuid||n===Buffer&&e[s]instanceof Buffer)&&(i[s]=e[s])}return i}static equal(e,t,i){if(e===t)return!0;if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(e instanceof Time&&t instanceof DateTime||e instanceof Time&&t instanceof DateOnly||e instanceof Time&&t instanceof Time)return e.tick===t.tick;if(e instanceof Array&&t instanceof Array){if(e.length!==t.length)return!1;if(i?.ignoreArrayIndex)return e.every((e=>t.some((t=>ObjectUtil_ObjectUtil.equal(t,e,i)))));for(let s=0;s<e.length;s++)if(!ObjectUtil_ObjectUtil.equal(e[s],t[s],i))return!1;return!0}if(e instanceof Map&&t instanceof Map){const s=Array.from(e.keys()).filter((t=>(void 0===i?.keys||i.keys.includes(t))&&!i?.excludes?.includes(t)&&void 0!==e[t])),n=Array.from(t.keys()).filter((e=>(void 0===i?.keys||i.keys.includes(e))&&!i?.excludes?.includes(e)&&void 0!==t[e]));if(s.length!==n.length)return!1;for(const n of s)if(!ObjectUtil_ObjectUtil.equal(e.get(n),t.get(n),{ignoreArrayIndex:i?.ignoreArrayIndex}))return!1;return!0}if("object"==typeof e&&"object"==typeof t){const s=Object.keys(e).filter((t=>(void 0===i?.keys||i.keys.includes(t))&&!i?.excludes?.includes(t)&&void 0!==e[t])),n=Object.keys(t).filter((e=>(void 0===i?.keys||i.keys.includes(e))&&!i?.excludes?.includes(e)&&void 0!==t[e]));if(s.length!==n.length)return!1;for(const n of s)if(!ObjectUtil_ObjectUtil.equal(e[n],t[n],{ignoreArrayIndex:i?.ignoreArrayIndex}))return!1;return!0}return!1}static validate(e,t){let i;i=t instanceof Array?{type:t}:"function"==typeof t?{type:[t]}:{...t,type:void 0!==t.type?t.type instanceof Array?t.type:[t.type]:void 0};const s={};if(i.notnull&&void 0===e&&(s.notnull=i.notnull),!i.notnull&&void 0===e)return;let n;if(void 0===i.type||i.type.some((t=>t===e?.constructor))||(s.type=i.type),Number.isNaN(e)&&(s.type=i.type),void 0!==i.validator){const t=i.validator(e);!0!==t&&(s.validator=i.validator,"string"==typeof t&&(n=t))}return void 0===i.includes||i.includes.includes(e)||(s.includes=i.includes),Object.keys(s).length>0?{value:e,invalidateDef:s,message:n}:void 0}static validateObject(e,t){const i={};for(const s of Object.keys(t)){const n=ObjectUtil_ObjectUtil.validate(e[s],t[s]);void 0!==n&&(i[s]=n)}return i}static validateObjectWithThrow(e,t,i){const s=ObjectUtil_ObjectUtil.validateObject(t,i);if(Object.keys(s).length>0){const t=[],a=Object.keys(s);for(const e of a){let n=`- '${i[e].displayName}'`;if(i[e].displayValue){const t=s[e].value;("string"==typeof t||"number"==typeof t||"boolean"==typeof t||void 0===t||t instanceof DateTime||t instanceof DateOnly)&&(n+=`: ${t?.toString()??"undefined"}`)}t.push(n)}throw new Error(`${e}중 잘못된 내용이 있습니다.`+n.EOL+t.join(n.EOL))}}static validateArray(e,t){const i=[];for(let s=0;s<e.length;s++){const n=e[s],a=ObjectUtil_ObjectUtil.validateObject(n,"function"==typeof t?t(n):t);Object.keys(a).length>0&&i.push({index:s,item:n,result:a})}return i}static validateArrayWithThrow(e,t,i){const s=ObjectUtil_ObjectUtil.validateArray(t,i);if(s.length>0){const t=[];for(const e of s){const s="function"==typeof i?i(e.item):i,n=Object.keys(e.result);for(const i of n){const n=s[i].displayName;let a=`- ${e.index+1}번째 항목의 '${n}'`;if(s[i].displayValue){const t=e.result[i].value;("string"==typeof t||"number"==typeof t||"boolean"==typeof t||void 0===t||t instanceof DateTime||t instanceof DateOnly)&&(a+=`: ${t?.toString()??"undefined"}`)}t.push(a)}}throw new Error(`${e}중 잘못된 내용이 있습니다.`+n.EOL+t.join(n.EOL))}}static getChainValueByDepth(e,t,i,s){let n=e;for(let e=0;e<i;e++)n=s?n?.[t]:n[t];return n}static getChainValue(e,t,i){const s=t.split(".");let n=e;for(const e of s)n=i&&void 0===n?void 0:n[e];return n}static setChainValue(e,t,i){const s=t.split(".");let n=e;for(const e of s.slice(0,-1))n=n[e];const a=s.last();if(void 0===a)throw new NeverEntryError;n[a]=i}static deleteChainValue(e,t){const i=t.split(".");let s=e;for(const e of i.slice(0,-1))s=s[e];const n=i.last();if(void 0===n)throw new NeverEntryError;delete s[n]}static clearUndefined(e){if(void 0===e)return e;for(const t of Object.keys(e))void 0===e[t]&&delete e[t];return e}static clear(e){for(const t of Object.keys(e))delete e[t];return e}static nullToUndefined(e){if(null!=e){if(e instanceof Date||e instanceof DateTime||e instanceof DateOnly||e instanceof Time)return e;if(e instanceof Array){for(let t=0;t<e.length;t++)e[t]=ObjectUtil_ObjectUtil.nullToUndefined(e[t]);return e}if("object"==typeof e){for(const t of Object.keys(e))null==e[t]&&(e[t]=void 0);return e}return e}}}class NotImplementError extends SdError{constructor(e){super("구현되어있지 않습니다"+(void 0!==e?": "+e:""))}}class TimeoutError extends SdError{constructor(e,t){super("대기시간이 초과되었습니다"+(void 0!==e?`(${e}ms)`:"")+(void 0!==t?`: ${t}`:""))}}(s=Array.prototype).single=function(e){const t=void 0!==e?this.filter(e):this;if(t.length>1)throw new Error(`복수의 결과물이 있습니다. (${t.length}개)`);return t[0]},s.first=function(e){return void 0!==e?this.find(e):this[0]},s.filterAsync=async function(e){const t=[];for(let i=0;i<this.length;i++)await e(this[i],i)&&t.push(this[i]);return t},s.last=function(e){if(void 0===e)return this[this.length-1];for(let t=this.length-1;t>=0;t--)if(e(this[t],t))return this[t]},s.filterExists=function(){return this.filter((e=>void 0!==e))},s.ofType=function(e){return this.filter((t=>t instanceof e||t?.constructor===e))},s.mapAsync=async function(e){return await Promise.all(this.map(e))},s.mapMany=function(e){const t=e?this.map(e):this;return t.length>0?t.reduce(((e,t)=>(e??[]).concat(t??[]))):t},s.mapManyAsync=async function(e){return(void 0!==e?await this.mapAsync(e):this).mapMany()},s.parallelAsync=async function(e){return await Promise.all(this.map((async(t,i)=>await e(t,i))))},s.groupBy=function(e,t){const i=[];for(let s=0;s<this.length;s++){const n=e(this[s],s),a=void 0!==t?t(this[s],s):this[s],r=i.single((e=>ObjectUtil_ObjectUtil.equal(e.key,n)));void 0!==r?r.values.push(a):i.push({key:n,values:[a]})}return i},s.toMap=function(e,t){const i=new Map;for(let s=0;s<this.length;s++){const n=this[s],a=e(n,s),r=void 0!==t?t(n,s):n;if(i.has(a))throw new Error(`키가 중복되었습니다. (중복된키: ${JSON.stringify(a)})`);i.set(a,r)}return i},s.toMapAsync=async function(e,t){const i=new Map;for(let s=0;s<this.length;s++){const n=this[s],a=await e(n,s),r=void 0!==t?await t(n,s):n;if(i.has(a))throw new Error(`키가 중복되었습니다. (중복된키: ${JSON.stringify(a)})`);i.set(a,r)}return i},s.toObject=function(e,t){const i={};for(let s=0;s<this.length;s++){const n=this[s],a=e(n,s),r=void 0!==t?t(n,s):n;if(void 0!==i[a])throw new Error(`키가 중복되었습니다. (중복된키: ${a})`);i[a]=r}return i},s.toTree=function(e,t){const fn=i=>i.map((i=>({...ObjectUtil_ObjectUtil.clone(i),children:fn(this.filter((s=>s[t]===i[e])))}))),i=this.filter((e=>null==e[t]));return fn(i)},s.distinct=function(e){const t=[];for(const i of this)t.some((t=>!0===e?t===i:ObjectUtil_ObjectUtil.equal(t,i)))||t.push(i);return t},s.distinctThis=function(e){const t=this.distinct(e);return this.clear().push(...t),this},s.orderBy=function(e){return this.concat().sort(((t,i)=>{const s=void 0!==e?e(i):i,n=void 0!==e?e(t):t,a=s instanceof DateOnly||s instanceof DateTime||s instanceof Time?s.tick:s,r=n instanceof DateOnly||n instanceof DateTime||n instanceof Time?n.tick:n;if(a===r)return 0;if("string"==typeof a&&"string"==typeof r)return r.localeCompare(a);if("number"==typeof a&&"number"==typeof r)return a>r?-1:a<r?1:0;if(void 0===r)return-1;if(void 0===a)return 1;throw new Error("orderBy 는 string 이나 number 에 대해서만 사용할 수 있습니다.")}))},s.orderByThis=function(e){return this.sort(((t,i)=>{const s=void 0!==e?e(i):i,n=void 0!==e?e(t):t,a=s instanceof DateOnly||s instanceof DateTime||s instanceof Time?s.tick:s,r=n instanceof DateOnly||n instanceof DateTime||n instanceof Time?n.tick:n;if(a===r)return 0;if("string"==typeof a&&"string"==typeof r)return r.localeCompare(a);if("number"==typeof a&&"number"==typeof r)return a>r?-1:a<r?1:0;if(void 0===r)return-1;if(void 0===a)return 1;throw new Error("orderBy 는 string 이나 number 에 대해서만 사용할 수 있습니다.")}))},s.orderByDesc=function(e){return this.concat().sort(((t,i)=>{const s=void 0!==e?e(i):i,n=void 0!==e?e(t):t,a=s instanceof DateOnly||s instanceof DateTime||s instanceof Time?s.tick:s,r=n instanceof DateOnly||n instanceof DateTime||n instanceof Time?n.tick:n;if(a===r)return 0;if("string"==typeof a&&"string"==typeof r)return a.localeCompare(r);if("number"==typeof a&&"number"==typeof r)return a<r?-1:a>r?1:0;if(void 0===r)return 1;if(void 0===a)return-1;throw new Error("orderBy 는 string 이나 number 에 대해서만 사용할 수 있습니다.")}))},s.orderByDescThis=function(e){return this.sort(((t,i)=>{const s=void 0!==e?e(i):i,n=void 0!==e?e(t):t,a=s instanceof DateOnly||s instanceof DateTime||s instanceof Time?s.tick:s,r=n instanceof DateOnly||n instanceof DateTime||n instanceof Time?n.tick:n;if(a===r)return 0;if("string"==typeof a&&"string"==typeof r)return a.localeCompare(r);if("number"==typeof a&&"number"==typeof r)return a<r?-1:a>r?1:0;if(void 0===r)return 1;if(void 0===a)return-1;throw new Error("orderBy 는 string 이나 number 에 대해서만 사용할 수 있습니다.")}))},s.diffs=function(e,t){const i=[],s=[].concat(e);for(const e of this){const n=s.single((i=>ObjectUtil_ObjectUtil.equal(i,e,void 0!==t?.excludes?{excludes:t.excludes}:void 0)));if(void 0===n){if(void 0!==t?.keys){const n=s.single((i=>ObjectUtil_ObjectUtil.equal(i,e,{keys:t.keys})));if(void 0!==n){i.push({source:e,target:n}),s.remove(n);continue}}i.push({source:e,target:void 0})}else s.remove(n)}for(const e of s)i.push({source:void 0,target:e});return i},s.oneWayDiffs=function(e,t,i){const s=e instanceof Map?e:e.toMap((e=>e[t])),n=i?.includeSame??!1,a=[];for(const e of this){if(void 0===e[t]){a.push({type:"create",item:e});continue}const r=s.get(e[t]);r?ObjectUtil_ObjectUtil.equal(r,e,{excludes:i?.excludes})?n&&a.push({type:"same",item:e,orgItem:r}):a.push({type:"update",item:e,orgItem:r}):a.push({type:"create",item:e})}return a},s.merge=function(e,t){const i=this.diffs(e,t),s=ObjectUtil_ObjectUtil.clone(this);for(const e of i)if(void 0!==e.source&&void 0!==e.target){const t=s.single((t=>ObjectUtil_ObjectUtil.equal(t,e.source)));if(void 0===t)throw new NeverEntryError;s[s.indexOf(t)]=ObjectUtil_ObjectUtil.merge(e.source,e.target)}else void 0!==e.target&&s.push(e.target);return s},s.sum=function(e){let t=0;for(let i=0;i<this.length;i++){const s=void 0!==e?e(this[i],i):this[i];if("number"!=typeof s)throw new Error("sum 은 number 에 대해서만 사용할 수 있습니다.");t+=s}return t},s.min=function(e){let t;for(let i=0;i<this.length;i++){const s=void 0!==e?e(this[i],i):this[i];if("number"!=typeof s&&"string"!=typeof s)throw new Error("min 은 number/string 에 대해서만 사용할 수 있습니다.");(void 0===t||t>s)&&(t=s)}return t},s.max=function(e){let t;for(let i=0;i<this.length;i++){const s=void 0!==e?e(this[i],i):this[i];if("number"!=typeof s&&"string"!=typeof s)throw new Error("max 은 number/string 에 대해서만 사용할 수 있습니다.");(void 0===t||t<s)&&(t=s)}return t},s.shuffle=function(){if(this.length<=1)return ObjectUtil_ObjectUtil.clone(this);let e=this;for(;e=e.orderBy((()=>Math.random())),ObjectUtil_ObjectUtil.equal(e,this););return e},s.insert=function(e,...t){return this.splice(e,0,...t),this},s.remove=function(e){const t="function"==typeof e?this.filter(e.bind(this)):[e];for(const e of t)for(;this.includes(e);)this.splice(this.indexOf(e),1);return this},s.clear=function(){return this.remove((()=>!0))},Map.prototype.getOrCreate=function(e,t){return this.has(e)||(t instanceof Function?this.set(e,t()):this.set(e,t)),this.get(e)},Set.prototype.adds=function(...e){for(const t of e)this.add(t);return this};Set;class Wait_Wait{static async until(e,t,i){let s=0;for(;!await e();)if(await Wait_Wait.time(t??100),void 0!==i&&(s+=t??100,s>=i))throw new TimeoutError}static async time(e){await new Promise((t=>{setTimeout((()=>{t()}),e)}))}}class FunctionUtil{static parse(e){let t=/function\s?\(([^)]*)\)[^{]*{((?!return)(.|\r|\n))*return\s?((.|\r|\n)*);?\s?}$/.exec(e.toString());if(null==t){if(t=/^\(?([^)]*)\)?(\s?)=>(\s?)(.*)$/.exec(e.toString()),void 0===t?.[4])throw new Error("Function 파싱 실패: "+e.toString()+n.EOL);if(t[4].startsWith("{")){const i=/(?!return)(.|\r|\n)*return\s((.|\r|\n)*);/.exec(t[4]);if(void 0===i?.[2])throw new Error("Function 파싱 실패: "+e.toString()+n.EOL);t[4]=i[2]}}const i=t[1].split(",").map((e=>e.trim()));let s=t[4].trim();return s.endsWith(";")&&(s=s.slice(0,-1)),{params:i,returnContent:s}}}class JsonConvert{static stringify(e,t){const replacer=(e,i)=>{const s=void 0!==t?.replacer?t.replacer(e,i):i;return s instanceof Date?{__type__:"Date",data:s.toISOString()}:s instanceof DateTime?{__type__:"DateTime",data:s.toString()}:s instanceof DateOnly?{__type__:"DateOnly",data:s.toString()}:s instanceof Time?{__type__:"Time",data:s.toString()}:s instanceof Uuid?{__type__:"Uuid",data:s.toString()}:s instanceof Error?{__type__:"Error",data:{...s,message:s.message,name:s.name,stack:s.stack}}:"Buffer"===s?.type&&!0===t?.hideBuffer?{type:"Buffer",data:"__hidden__"}:s},i=Date.prototype.toJSON;delete Date.prototype.toJSON;const s=JSON.stringify(replacer(void 0,e),replacer,t?.space);return Date.prototype.toJSON=i,s}static parse(e){return ObjectUtil_ObjectUtil.nullToUndefined(JSON.parse(e,((e,t)=>{if(null!=t){if("object"==typeof t&&"Date"===t.__type__)return new Date(Date.parse(t.data));if("object"==typeof t&&"DateTime"===t.__type__)return DateTime.parse(t.data);if("object"==typeof t&&"DateOnly"===t.__type__)return DateOnly.parse(t.data);if("object"==typeof t&&"Time"===t.__type__)return Time.parse(t.data);if("object"==typeof t&&"Uuid"===t.__type__)return new Uuid(t.data);if("object"==typeof t&&"Error"===t.__type__){const e=new Error(t.data.message);return Object.assign(e,t.data),e}if("object"==typeof t&&"Buffer"===t.type)return Buffer.from(t.data)}return t})))}}class MathUtil{static getRandomInt(e,t){return Math.floor(Math.random()*(t-e)+e)}}},1485:(e,t,i)=>{"use strict";i.r(t),i.d(t,{FsUtil:()=>n.g,Logger:()=>a.Yd,LoggerSeverity:()=>a.KH,LoggerStyle:()=>a.Gi,PathUtil:()=>PathUtil,SdFsWatcher:()=>SdFsWatcher,SdProcess:()=>SdProcess});var s=i(8056),n=i(1862),a=i(3233),r=i(1017);class PathUtil{static posix(...e){return r.join(...e).replace(/\\/g,"/")}static changeFileDirectory(e,t,i){if(e===t)return i;if(!PathUtil.isChildPath(e,t))throw new Error(`'${e}'가 ${t}안에 없습니다.`);return r.resolve(i,r.relative(t,e))}static removeExt(e){return r.basename(e,r.extname(e))}static isChildPath(e,t){const i=r.relative(t,e);return Boolean(i)&&!i.startsWith("..")&&!r.isAbsolute(i)}}var o=i(7954);class SdFsWatcher{constructor(e,t){this._watcher=o.watch(e,s.QI.merge(t,{ignoreInitial:!0,persistent:!0}))}static watch(e){return new SdFsWatcher(e)}onChange(e,t){const i=new Map;this._watcher.on("all",((s,n)=>{const a=i.getOrCreate(n,s);"add"===a&&"change"===s?i.set(n,a):"add"===a&&"unlink"===s||"addDir"===a&&"unlinkDir"===s||i.set(n,s),setTimeout((async()=>{if(0===i.size)return;const e=Array.from(i.entries()).map((e=>({event:e[1],path:e[0]})));i.clear(),await t(e)}),e.delay??500)}))}add(e){this._watcher.add(e)}async closeAsync(){await this._watcher.close()}}var c=i(2081);class SdProcess{static async spawnAsync(e,t,i){return await new Promise(((s,n)=>{const a=c.spawn(e.split(" ")[0],e.split(" ").slice(1),{shell:!0,stdio:"pipe",...t});a.on("error",(e=>{n(e)}));let r=Buffer.from([]);a.stdout.on("data",(e=>{r=Buffer.concat([r,e]),i&&process.stdout.write(e)})),a.stderr.on("data",(e=>{r=Buffer.concat([r,e]),i&&process.stderr.write(e)})),a.on("exit",(t=>{0===t?s(r.toString()):n(new Error(`'${e}' 명령이 오류와 함께 닫힘 (${t})\n${r.toString()}`))}))}))}}},1862:(e,t,i)=>{"use strict";i.d(t,{g:()=>FsUtil});var s=i(1017),n=i(8285),a=i(2037),r=i(7147),o=i(6113),c=i(8056);class FsUtil{static getParentPaths(e){const t=[];let i=e;for(;i!==s.resolve(i,"..");)i=s.resolve(i,".."),t.push(i);return t}static async getMd5Async(e){return await new Promise(((t,i)=>{const s=o.createHash("md5").setEncoding("hex");r.createReadStream(e).on("error",(t=>{i(new c.Nf(t,e))})).pipe(s).once("finish",(()=>{t(s.read())}))}))}static async globAsync(e,t){return await new Promise(((i,a)=>{n(e.replace(/\\/g,"/"),t??{},((e,t)=>{e?a(e):i(t.map((e=>s.resolve(e))))}))}))}static glob(e,t){return n.sync(e.replace(/\\/g,"/"),t)}static async readdirAsync(e){try{return await r.promises.readdir(e)}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static readdir(e){try{return r.readdirSync(e)}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static exists(e){try{return r.existsSync(e)}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static async removeAsync(e){try{await r.promises.rm(e,{recursive:!0,force:!0,retryDelay:500,maxRetries:6})}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static remove(e){try{r.rmSync(e,{recursive:!0,force:!0})}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static async copyAsync(e,t,i){if(!FsUtil.exists(e))return;let n;try{n=await r.promises.lstat(e)}catch(e){throw e instanceof Error?new c.Nf(e,t):e}if(n.isDirectory()){await FsUtil.mkdirsAsync(t);const n=await FsUtil.globAsync(s.resolve(e,"*"));await n.parallelAsync((async n=>{if(i&&!i(n))return;const a=s.relative(e,n),r=s.resolve(t,a);await FsUtil.copyAsync(n,r)}))}else{await FsUtil.mkdirsAsync(s.resolve(t,".."));try{await r.promises.copyFile(e,t)}catch(e){throw e instanceof Error?new c.Nf(e,t):e}}}static copy(e,t,i){if(!FsUtil.exists(e))return;let n;try{n=r.lstatSync(e)}catch(e){throw e instanceof Error?new c.Nf(e,t):e}if(n.isDirectory()){FsUtil.mkdirs(t);const n=FsUtil.glob(s.resolve(e,"*"));for(const a of n){if(i&&!i(a))return;const n=s.relative(e,a),r=s.resolve(t,n);FsUtil.copy(a,r)}}else{FsUtil.mkdirs(s.resolve(t,".."));try{r.copyFileSync(e,t)}catch(e){throw e instanceof Error?new c.Nf(e,t):e}}}static async mkdirsAsync(e){if(!FsUtil.exists(e))try{await r.promises.mkdir(e,{recursive:!0})}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static mkdirs(e){try{r.mkdirSync(e,{recursive:!0})}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static async writeJsonAsync(e,t,i){const s=c.Q9.stringify(t,i);await FsUtil.writeFileAsync(e,s)}static async writeFileAsync(e,t){await FsUtil.mkdirsAsync(s.dirname(e));try{await r.promises.writeFile(e,t)}catch(i){throw i instanceof Error?new c.Nf(i,e+("object"==typeof t?t.constructor?.name??"object":typeof t)):i}}static writeFile(e,t){FsUtil.mkdirs(s.resolve(e,".."));try{r.writeFileSync(e,t)}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static readFile(e){try{return r.readFileSync(e,"utf-8")}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static async readFileAsync(e){if(!FsUtil.exists(e))throw new c.Nf(e+"파일을 찾을 수 없습니다.");try{return await r.promises.readFile(e,"utf-8")}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static readFileBuffer(e){try{return r.readFileSync(e)}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static async readFileBufferAsync(e){try{return await r.promises.readFile(e)}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static readJson(e){const t=FsUtil.readFile(e);return c.Q9.parse(t)}static async readJsonAsync(e){const t=await FsUtil.readFileAsync(e);try{return c.Q9.parse(t)}catch(i){throw i instanceof Error?new c.Nf(i,e+a.EOL+t):i}}static lstat(e){try{return r.lstatSync(e)}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static async lstatAsync(e){try{return await r.promises.lstat(e)}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static stat(e){try{return r.statSync(e)}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static async statAsync(e){try{return await r.promises.stat(e)}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static appendFile(e,t){try{r.appendFileSync(e,t,"utf8")}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static open(e,t){try{return r.openSync(e,t)}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static async openAsync(e,t){try{return await r.promises.open(e,t)}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static createReadStream(e){try{return r.createReadStream(e)}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static createWriteStream(e){try{return r.createWriteStream(e)}catch(t){throw t instanceof Error?new c.Nf(t,e):t}}static async clearEmptyDirectoryAsync(e){if(!FsUtil.exists(e))return;const t=await FsUtil.readdirAsync(e);for(const i of t){const t=s.resolve(e,i);(await FsUtil.lstatAsync(t)).isDirectory()&&await this.clearEmptyDirectoryAsync(t)}0===(await FsUtil.readdirAsync(e)).length&&await FsUtil.removeAsync(e)}static findAllParentChildDirPaths(e,t,i){const n=[];let a=t;for(;a;){const t=s.resolve(a,e),r=FsUtil.glob(t);for(const e of r)FsUtil.exists(e)&&FsUtil.stat(e).isDirectory()&&n.push(e);if(a===i)break;const o=s.dirname(a);if(o===a)break;a=o}return n}}},3233:(e,t,i)=>{"use strict";i.d(t,{Gi:()=>s,KH:()=>n,Yd:()=>Logger});var s,n,a=i(1017),r=i(1862),o=i(2037),c=i(8056);!function(e){e.clear="[0m",e.fgGray="[90m",e.fgBlack="[30m",e.fgWhite="[37m",e.fgRed="[31m",e.fgGreen="[32m",e.fgYellow="[33m",e.fgBlue="[34m",e.fgMagenta="[35m",e.fgCyan="[36m",e.bgBlack="[40m[97m",e.bgRed="[41m[97m",e.bgGreen="[42m[97m",e.bgYellow="[43m[97m",e.bgBlue="[44m[97m",e.bgMagenta="[45m[97m",e.bgWhite="[46m[97m"}(s||(s={})),function(e){e.debug="debug",e.log="log",e.info="info",e.warn="warn",e.error="error",e.none=""}(n||(n={}));class Logger{constructor(e){this._group=e,this._randomForStyle=c.kj.getRandomInt(4,9)}static get(e=[]){return new Logger(e)}static setConfig(e,t){const i=void 0!==t?e:[],s=void 0!==t?t:e;Logger.configs.set(i.join("_"),s)}static restoreConfig(){Logger.configs.clear()}static setHistoryLength(e){Logger._historyLength=e}debug(...e){this._write(n.debug,e)}log(...e){this._write(n.log,e)}info(...e){this._write(n.info,e)}warn(...e){this._write(n.warn,e)}error(...e){this._write(n.error,e)}_write(e,t){const i=this._getConfig(),l=new c.ou,p=Object.values(n).indexOf(e),d=Object.values(n).indexOf(i.console.level),h=Object.values(n).indexOf(i.file.level);if(p>=d){"function"==typeof process.stdout.clearLine&&(process.stdout.clearLine(0),process.stdout.cursorTo(0));const n=i.console.styles[e];let a=s.fgGray;a+=l.toFormatString("yyyy-MM-dd HH:mm:ss.fff")+" ",this._group.length>0&&(a+=i.console.style+"["+this._group.join(".")+"] "),a+=n,a+=e.toUpperCase().padStart(5," ");const r=t.map((e=>e instanceof Error&&void 0!==e.stack?e.stack:e)),o=s.clear;console.log(a,...r,o)}else i.dot&&process.stdout.write(".");if(p>=h){let s=l.toFormatString("yyyy-MM-dd HH:mm:ss.fff")+" ";s+=this._group.length>0?"["+this._group.join(".")+"] ":"",s+=e.toUpperCase().padStart(5," ")+o.EOL;for(const e of t){let t;t="string"==typeof e?e.replace(/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-ORZcf-nqry=><]/g,""):"function"!=typeof e.toString||/^\[.*]$/.test(e.toString())?JSON.stringify(e):e.toString(),s+=t+o.EOL}const n=a.resolve(i.file.outDir,l.toFormatString("yyyyMMdd"));r.g.mkdirs(n);const c=r.g.readdir(n).filter((e=>e.endsWith(".log"))).map((e=>Number(a.basename(e,a.extname(e))))).filter((e=>!Number.isNaN(e))).max();let p="1.log";if(void 0!==c){p=r.g.lstat(a.resolve(n,`${c}.log`)).size>(i.file.maxBytes??5e5)?`${c+1}.log`:c.toString()+".log"}const d=a.resolve(n,p);r.g.exists(d)?r.g.appendFile(d,s):r.g.writeFile(d,s)}if(Logger._historyLength>0)for(Logger.history.push({datetime:l,group:this._group,severity:e,logs:t});Logger.history.length>Logger._historyLength;)Logger.history.remove(Logger.history[0])}_getConfig(){let e={dot:!1,console:{style:s[Object.keys(s)[this._randomForStyle]],level:n.log,styles:{debug:s.fgGray,log:s.clear,info:s.fgCyan,warn:s.fgYellow,error:s.fgRed}},file:{level:n.none,outDir:a.resolve(process.cwd(),"_logs"),maxBytes:3e5}};const t=[];e=c.QI.merge(e,Logger.configs.get(t.join("_")));for(const i of this._group)t.push(i),Logger.configs.has(t.join("_"))&&(e=c.QI.merge(e,Logger.configs.get(t.join("_"))));return e}}Logger.configs=new Map,Logger._historyLength=0,Logger.history=[]},2513:(e,t,i)=>{"use strict";i.r(t),i.d(t,{SdAutoUpdateService:()=>SdAutoUpdateService,SdCryptoService:()=>SdCryptoService,SdOrmService:()=>SdOrmService,SdServiceBase:()=>SdServiceBase,SdServiceServer:()=>SdServiceServer,SdServiceServerConfigUtil:()=>SdServiceServerConfigUtil,SdSmtpClientService:()=>SdSmtpClientService});class SdServiceBase{}var s=i(5687),n=i(3685),a=i(7310),r=i(1017),o=i(3233),c=i(1862),l=i(2361),p=i(8056),d=(i(404),i(2957),i(7330),i(8762)),h=i(9284);var u=i(3893);class SdServiceServer extends l.EventEmitter{constructor(e){super(),this.options=e,this._logger=o.Yd.get(["simplysm","sd-service",this.constructor.name]),this.isOpen=!1,this._splitReqCache=new Map,this._eventListeners=[],this.pathProxy=[]}getWsClient(e){if(this._wsServer)return Array.from(this._wsServer.clients).single((t=>t.readyState===d.OPEN&&t.id===e))}async listenAsync(){await new Promise((async e=>{if(this._logger.debug("서버 시작..."),this.options.ssl){const e="function"==typeof this.options.ssl.pfxBuffer?await this.options.ssl.pfxBuffer():this.options.ssl.pfxBuffer;this._httpServer=s.createServer({pfx:e,passphrase:this.options.ssl.passphrase})}else this._httpServer=n.createServer();this._httpServer.on("request",(async(e,t)=>{await this._onWebRequestAsync(e,t)})),this._wsServer=new h({server:this._httpServer}),this._wsServer.on("connection",(async e=>{await this._onWsClientConnectionAsync(e)})),this._httpServer.listen(this.options.port,(()=>{e()}))})),this.isOpen=!0,this._logger.debug("서버 시작됨"),this.emit("ready")}async closeAsync(){this._wsServer&&(this._wsServer.clients.forEach((e=>{e.close()})),await new Promise(((e,t)=>{this._wsServer.close((i=>{i?t(i):e()}))}))),await new Promise(((e,t)=>{this._httpServer&&this._httpServer.listening?this._httpServer.close((i=>{i?t(i):e()})):e()})),this.isOpen=!1,this._logger.debug("서버 종료됨"),this.emit("close")}broadcastReload(){this._logger.debug("서버내 모든 클라이언트 RELOAD 명령 전송"),this._wsServer?.clients.forEach((e=>{e.send(p.Q9.stringify({name:"client-reload"}))}))}async _getWsClientIdAsync(e){return await new Promise((t=>{const msgFn=i=>{const s=p.Q9.parse(i);"client-get-id-response"===s.name&&(e.off("message",msgFn),t(s.body))};e.on("message",msgFn);e.send(p.Q9.stringify({name:"client-get-id"}))}))}async _onWsClientConnectionAsync(e){const t=await this._getWsClientIdAsync(e);e.id=t,this._logger.debug("클라이언트 연결됨: "+t),e.on("close",(e=>{this._onWsClientClosed(t,e)})),e.on("message",(async e=>{await this._onWsClientMessageAsync(t,e)}));e.send(p.Q9.stringify({name:"connected"}))}_onWsClientClosed(e,t){if(this._logger.debug("클라이언트 연결 끊김: "+e+": "+t),1001===t){this._logger.debug("닫힌 소켓의 이벤트 리스너 비우기...");const t=this._eventListeners.filter((t=>t.socketId===e));for(const e of t)this._eventListeners.remove(e)}}async _onWsClientMessageAsync(e,t){const i=p.Q9.parse(t);"request"===i.name?await this._onSocketRequestAsync(e,i):"request-split"===i.name&&await this._onSocketRequestSplitAsync(e,i)}async _onSocketRequestAsync(e,t){this._logger.debug("요청 받음",t);const i=await this._processSocketRequestAsync(e,t),s=this.getWsClient(e);try{await p.NT.until((()=>void 0!==s),500,1e4),s.send(p.Q9.stringify(i))}catch(e){this._logger.error("소켓요청을 처리하는 중에 클라이언트 소켓이 끊김",e)}}async _onSocketRequestSplitAsync(e,t){this._logger.debug("분할요청 받음",t.uuid+"("+t.index+")");const i=this._splitReqCache.getOrCreate(t.uuid,{completedSize:0,data:[]});if(i.data[t.index]=t.body,i.completedSize+=t.body.length,i.completedSize===t.fullSize){const t=p.Q9.parse(i.data.join(""));await this._onSocketRequestAsync(e,t)}}async _runServiceMethodAsync(e){const t=this.options.services.last((t=>t.name===e.serviceName));if(!t)throw new Error(`서비스[${e.serviceName}]를 찾을 수 없습니다.`);const i=new t;i.server=this,i.request=e.request,i.socketId=e.socketId;const s=i[e.methodName];if(void 0===s)throw new Error(`메소드[${e.serviceName}.${e.methodName}]를 찾을 수 없습니다.`);return await s.apply(i,e.params)}async _processSocketRequestAsync(e,t){try{const i=t.command.split(".");if(2===i.length){const s=i[0],n=i[1],a=await this._runServiceMethodAsync({socketId:e,request:t,serviceName:s,methodName:n,params:t.params});return{name:"response",reqUuid:t.uuid,state:"success",body:a}}if("addEventListener"===t.command){const i=t.params[0],s=t.params[1],n=t.params[2];return this._eventListeners.push({key:i,eventName:s,info:n,socketId:e}),{name:"response",reqUuid:t.uuid,state:"success",body:void 0}}if("removeEventListener"===t.command){const e=t.params[0];return this._eventListeners.remove((t=>t.key===e)),{name:"response",reqUuid:t.uuid,state:"success",body:void 0}}if("getEventListenerInfos"===t.command){const e=t.params[0];return{name:"response",reqUuid:t.uuid,state:"success",body:this._eventListeners.filter((t=>t.eventName===e)).map((e=>({key:e.key,info:e.info})))}}if("emitEvent"===t.command){const e=t.params[0],i=t.params[1],s=this._eventListeners.filter((t=>e.includes(t.key)));for(const e of s){const t=this.getWsClient(e.socketId);if(t?.readyState===d.OPEN){const s={name:"event",key:e.key,body:i};t.send(p.Q9.stringify(s))}}return{name:"response",reqUuid:t.uuid,state:"success",body:void 0}}return{name:"response",reqUuid:t.uuid,state:"error",body:"요청이 잘못되었습니다."}}catch(e){return{name:"response",reqUuid:t.uuid,state:"error",body:e.stack}}}async _onWebRequestAsync(e,t){try{if(this.options.middlewares)for(const i of this.options.middlewares)await new Promise(((s,n)=>{i(e,t,(e=>{null==e?s():n(e)}))}));const i=a.parse(e.url,!0,!1),s=decodeURI(i.pathname.slice(1)),n=s.split("/");if("api"===n[0]){if(e.headers.origin?.includes("://localhost")&&"OPTIONS"===e.method)return t.writeHead(204,{"Access-Control-Allow-Origin":"*"}),void t.end();const s=n[1],a=n[2];let r;if("GET"===e.method){if("string"!=typeof i.query.json)throw new Error;r=p.Q9.parse(i.query.json)}else if("POST"===e.method){const t=await new Promise((t=>{let i=Buffer.from([]);e.on("data",(e=>{i=Buffer.concat([i,e])})),e.on("end",(()=>{t(i)}))}));r=p.Q9.parse(t.toString())}if(r){const e=await this._runServiceMethodAsync({serviceName:s,methodName:a,params:r}),i=p.Q9.stringify(e);return t.writeHead(200,{"Content-Length":i.length,"Content-Type":"application/json"}),void t.end(i)}}if("GET"!==e.method){const i="요청이 잘못되었습니다.";return this._responseErrorHtml(t,405,i),void this._logger.warn(`[405] ${i} (${e.method.toUpperCase()})`)}{let e;const i=this.pathProxy.single((e=>s.startsWith(e.from)));if(e=i?r.resolve(i.to+s.substring(i.from.length)):r.resolve(this.options.rootPath,"www",s),e=c.g.exists(e)&&c.g.stat(e).isDirectory()?r.resolve(e,"index.html"):e,!c.g.exists(e)){const i="파일을 찾을 수 없습니다.";return this._responseErrorHtml(t,404,i),void this._logger.warn(`[404] ${i} (${e})`)}if(r.basename(e).startsWith(".")){const i="파일을 사용할 권한이 없습니다.";return this._responseErrorHtml(t,403,i),void this._logger.warn(`[403] ${i} (${e})`)}const n=c.g.createReadStream(e),a=(await c.g.lstatAsync(e)).size;t.setHeader("Access-Control-Allow-Origin","*"),t.setHeader("Content-Length",a),t.setHeader("Content-Type",u.getType(e)),t.writeHead(200),n.pipe(t)}}catch(e){const i="요청 처리중 오류가 발생하였습니다.";this._responseErrorHtml(t,405,i),this._logger.error(`[405] ${i}`,e)}}_responseErrorHtml(e,t,i){e.writeHead(t),e.end(`\n<!DOCTYPE html>\n<html>\n<head>\n    <meta name="viewport" content="width=device-width, initial-scale=1">\n    <meta charset="UTF-8">\n    <title>${t}: ${i}</title>\n</head>\n<body>${t}: ${i}</body>\n</html>`)}}var g=i(1249);class SdAutoUpdateService extends SdServiceBase{async getLastVersionAsync(e,t){try{const i=(await c.g.readdirAsync(r.resolve(this.server.options.rootPath,"www",e,t,"updates"))).map((e=>({fileName:e,version:r.basename(e,r.extname(e))}))).filter((e=>/^[0-9.]*$/.test(e.version)));return g.maxSatisfying(i.map((e=>e.version)),"*")??void 0}catch(e){return}}}var v=i(6113);class SdServiceServerConfigUtil{static async getConfigAsync(e,t){let i={};const s=r.resolve(e,".config.json");if(c.g.exists(s)&&(i=await c.g.readJsonAsync(s)),void 0!==t){const s=r.resolve(e,"www",t),n=r.resolve(s,".config.json");c.g.exists(n)&&(i=p.QI.merge(i,await c.g.readJsonAsync(n)))}return i}static getConfig(e,t){let i={};const s=r.resolve(e,".config.json");if(c.g.exists(s)&&(i=c.g.readJson(s)),null!=t){const s=r.resolve(e,"www",t),n=r.resolve(s,".config.json");c.g.exists(n)&&(i=p.QI.merge(i,c.g.readJson(n)))}return i}}class SdCryptoService extends SdServiceBase{async encryptAsync(e){const t=(await SdServiceServerConfigUtil.getConfigAsync(this.server.options.rootPath,this.request?.clientName)).crypto;if(void 0===t)throw new Error("암호화 설정을 찾을 수 없습니다.");return v.createHmac("sha256",t.key).update(e).digest("hex")}}class QueryUnit{constructor(e,t){this.type=e,this._query=t}get query(){return this._query}notNull(){return this}nullable(){return this}}var y=i(655);class DbDefinitionUtil_DbDefinitionUtil{static getTableDef(e,t=!0){const i=Reflect.getMetadata(DbDefinitionUtil_DbDefinitionUtil._tableDefMetadataKey,e);if(t&&void 0===i)throw new Error(`'${e.name}'에 '@Table()'이 지정되지 않았습니다.`);return i??{name:"",description:"",columns:[],foreignKeys:[],foreignKeyTargets:[],indexes:[]}}static setTableDef(e,t){Reflect.defineMetadata(DbDefinitionUtil_DbDefinitionUtil._tableDefMetadataKey,t,e)}static mergeTableDef(e,t){let i=DbDefinitionUtil_DbDefinitionUtil.getTableDef(e,!1);i=p.QI.merge(i,t),DbDefinitionUtil_DbDefinitionUtil.setTableDef(e,i)}static addColumnDef(e,t){const i=DbDefinitionUtil_DbDefinitionUtil.getTableDef(e,!1);i.columns=i.columns.merge([t],{keys:["propertyKey"]}),DbDefinitionUtil_DbDefinitionUtil.setTableDef(e,i)}static addForeignKeyDef(e,t){const i=DbDefinitionUtil_DbDefinitionUtil.getTableDef(e,!1);i.foreignKeys=i.foreignKeys.merge([t],{keys:["propertyKey"]}),DbDefinitionUtil_DbDefinitionUtil.setTableDef(e,i)}static addForeignKeyTargetDef(e,t){const i=DbDefinitionUtil_DbDefinitionUtil.getTableDef(e,!1);i.foreignKeyTargets=i.foreignKeyTargets.merge([t],{keys:["propertyKey"]}),DbDefinitionUtil_DbDefinitionUtil.setTableDef(e,i)}static addIndexDef(e,t){const i=DbDefinitionUtil_DbDefinitionUtil.getTableDef(e,!1),s=i.indexes.single((e=>e.name===t.name));s?(s.columns=s.columns.merge(t.columns,{keys:["columnPropertyKey"]}),i.indexes=i.indexes.merge([s],{keys:["name"]})):i.indexes.push(t),DbDefinitionUtil_DbDefinitionUtil.setTableDef(e,i)}}DbDefinitionUtil_DbDefinitionUtil._tableDefMetadataKey="sd-orm-table-def";let x=class SystemMigration{};(0,y.__decorate)([function Column(e){return(t,i)=>{const s=t.constructor;DbDefinitionUtil_DbDefinitionUtil.addColumnDef(s,{propertyKey:i,name:e.name??i,dataType:e.dataType,nullable:e.nullable,autoIncrement:e.autoIncrement,primaryKey:e.primaryKey,description:e.description,typeFwd:()=>Reflect.getMetadata("design:type",t,i)})}}({primaryKey:1,description:"코드"}),(0,y.__metadata)("design:type",String)],x.prototype,"code",void 0),x=(0,y.__decorate)([function Table(e){return t=>{DbDefinitionUtil_DbDefinitionUtil.mergeTableDef(t,{name:t.name,...e})}}({name:"_migration",description:"마이그레이션"})],x);class DbContext{constructor(e,t){this._executor=e,this.opt=t,this.status="ready",this.prepareDefs=[],this.qb=new QueryBuilder(this.opt.dialect),this.qh=new QueryHelper(this.opt.dialect),this.systemMigration=new Queryable(this,x)}getTableDefinitions(){return Object.values(this).ofType(Queryable).map((e=>e.tableDef)).filterExists()}async connectWithoutTransactionAsync(e){let t;await this._executor.connectAsync(),this.status="connect",this.lastConnectionDateTime=new p.ou;try{t=await e()}catch(e){throw await this._executor.closeAsync(),this.status="ready",this.lastConnectionDateTime=void 0,e}return await this._executor.closeAsync(),this.status="ready",this.lastConnectionDateTime=void 0,t}async connectAsync(e,t){let i;await this._executor.connectAsync(),this.status="connect",this.lastConnectionDateTime=new p.ou,await this._executor.beginTransactionAsync(t),this.status="transact";try{i=await e(),await this._executor.commitTransactionAsync(),this.status="connect",this.lastConnectionDateTime=new p.ou}catch(e){try{await this._executor.rollbackTransactionAsync(),this.status="connect",this.lastConnectionDateTime=new p.ou}catch(e){if(!(e instanceof Error))throw new p.AJ;if(!e.message.includes("ROLLBACK")||!e.message.includes("BEGIN"))throw await this._executor.closeAsync(),this.status="ready",this.lastConnectionDateTime=void 0,e}throw await this._executor.closeAsync(),this.status="ready",this.lastConnectionDateTime=void 0,e}return await this._executor.closeAsync(),this.status="ready",this.lastConnectionDateTime=void 0,i}async transAsync(e,t){if("transact"===this.status)throw new Error("이미 TRANSACTION 상태 입니다.");let i;await this._executor.beginTransactionAsync(t),this.status="transact";try{i=await e(),await this._executor.commitTransactionAsync(),this.status="connect",this.lastConnectionDateTime=new p.ou}catch(e){try{await this._executor.rollbackTransactionAsync(),this.status="connect",this.lastConnectionDateTime=new p.ou}catch(e){if(!(e instanceof Error))throw new p.AJ;if(!e.message.includes("ROLLBACK")||!e.message.includes("BEGIN"))throw await this._executor.closeAsync(),this.status="ready",this.lastConnectionDateTime=void 0,e}throw await this._executor.closeAsync(),this.status="ready",this.lastConnectionDateTime=void 0,e}return i}async executeDefsAsync(e,t){return await this._executor.executeDefsAsync(e,t)}async executeQueriesAsync(e){return await this._executor.executeAsync(e)}async bulkInsertAsync(e,t,i){await this._executor.bulkInsertAsync(e,t,i)}async executePreparedAsync(){this.prepareDefs.length<1||(await this.executeDefsAsync(this.prepareDefs),this.prepareDefs=[],DbContext.selectCache.clear())}async getIsDbExistsAsync(e){if("sqlite"!==this.opt.dialect){if(void 0===e)throw new p.AJ;return(await this.executeDefsAsync([{type:"getDatabaseInfo",database:e}]))[0].length>0}throw new p.J6("sqlite")}async getIsTableExistsAsync(e){return(await this.executeDefsAsync([{type:"getTableInfo",table:e}]))[0].length>0}get tableDefs(){return Object.keys(this).filter((e=>!e.startsWith("_"))).map((e=>this[e])).ofType(Queryable).map((e=>DbDefinitionUtil_DbDefinitionUtil.getTableDef(e.tableType))).filterExists()}async getTableInfosAsync(e,t){return(await this.executeDefsAsync([{type:"getTableInfos",database:e,schema:t}]))[0].map((e=>({schema:e.TABLE_SCHEMA,name:e.TABLE_NAME})))}async getTableColumnInfosAsync(e,t,i){return(await this.executeDefsAsync([{type:"getTableColumnInfos",table:{database:e,schema:t,name:i}}]))[0].map((e=>({name:e.name,dataType:e.dataType,length:e.length,precision:e.precision,digits:e.digits,nullable:e.nullable,autoIncrement:e.autoIncrement})))}async getTablePkColumnNamesAsync(e,t,i){return(await this.executeDefsAsync([{type:"getTablePrimaryKeys",table:{database:e,schema:t,name:i}}]))[0].map((e=>e.name))}async getTableFksAsync(e,t,i){return(await this.executeDefsAsync([{type:"getTableForeignKeys",table:{database:e,schema:t,name:i}}]))[0].groupBy((e=>e.name)).map((e=>({name:e.key,sourceColumnNames:e.values.map((e=>e.sourceColumnName)),targetSchemaName:e.values[0].targetSchemaName,targetTableName:e.values[0].targetTableName})))}async getTableIndexesAsync(e,t,i){return(await this.executeDefsAsync([{type:"getTableIndexes",table:{database:e,schema:t,name:i}}]))[0].groupBy((e=>e.name)).map((e=>({name:e.key,columns:e.values.map((e=>({name:e.columnName,orderBy:!0===e.isDesc?"DESC":"ASC"})))})))}async truncateTable(e){await this.executeDefsAsync([{type:"truncateTable",table:{..."sqlite"===this.opt.dialect?{}:{database:this.opt.database,schema:this.opt.schema},name:e}}])}async initializeAsync(e,t){if(t&&"transact"===this.status)throw new Error("DB 강제 초기화는 트랜젝션 상에서는 동작하지 못합니다.\nconnect 대신에 connectWithoutTransaction 로 연결하여 시도하세요.");if(t&&"sqlite"===this.opt.dialect)throw new Error("sqlite 강제초기화 불가, 강제로 초기화 하려면, 데이터베이스 파일을 삭제하고 초기화를 수행하세요.");if(!t){const e="sqlite"===this.opt.dialect||await this.getIsDbExistsAsync(this.opt.database),t=!!e&&await this.getIsTableExistsAsync({..."sqlite"===this.opt.dialect?{}:{database:this.opt.database,schema:this.opt.schema},name:"_migration"});if(e&&t){const e=(await this.systemMigration.select((e=>({code:e.code}))).resultAsync()).map((e=>e.code)),t=this.migrations.filter((t=>!e.includes(t.name))).orderBy((e=>e.name));if(t.length>0){if("transact"!==this.status)await this.transAsync((async()=>{for(const e of t)await(new e).up(this),await this.systemMigration.insertAsync([{code:e.name}])}));else for(const e of t)await(new e).up(this),await this.systemMigration.insertAsync([{code:e.name}]);return!0}return!1}}const i=[];let s;if("sqlite"!==this.opt.dialect){const t=e??[this.opt.database];if(t.length<1)throw new Error("생성할 데이터베이스가 없습니다.");for(const e of t)i.push([{type:"clearDatabaseIfExists",database:e},{type:"createDatabaseIfNotExists",database:e}]);s=this.tableDefs.filter((e=>void 0===e.database||t.includes(e.database))).filterExists()}else s=this.tableDefs.filterExists();const n=[];for(const e of s)n.push(this.getCreateTableQueryDefFromTableDef(e));i.push(n);const a=[];for(const e of s)a.push(...this.getCreateFksQueryDefsFromTableDef(e));i.push(a);const r=[];for(const e of s)r.push(...this.getCreateIndexesQueryDefsFromTableDef(e));i.push(r);const o=[];for(const e of this.migrations.orderBy((e=>e.name)))o.push({type:"insert",from:this.qb.getTableName({..."sqlite"===this.opt.dialect?{}:{database:this.opt.database,schema:this.opt.schema},name:"_migration"}),record:{[this.qb.wrap("code")]:`N'${e.name}'`}});i.push(o);for(const e of i)await this.executeDefsAsync(e);return!0}getCreateTableQueryDefFromTableDef(e){if(e.columns.length<1)throw new Error(`'${e.name}'의 컬럼 설정이 잘못되었습니다.`);return{type:"createTable",table:this.getTableNameDef(e),columns:e.columns.map((e=>p.QI.clearUndefined({name:e.name,dataType:this.qh.type(e.dataType??e.typeFwd()),autoIncrement:e.autoIncrement,nullable:e.nullable}))),primaryKeys:e.columns.filter((e=>void 0!==e.primaryKey)).orderBy((e=>e.primaryKey)).map((e=>({columnName:e.name,orderBy:"ASC"})))}}getCreateFksQueryDefsFromTableDef(e){if(e.columns.length<1)throw new Error(`'${e.name}'의 컬럼 설정이 잘못되었습니다.`);const t=[];for(const i of e.foreignKeys)try{const s=DbDefinitionUtil_DbDefinitionUtil.getTableDef(i.targetTypeFwd());if(s.columns.length<1)throw new Error(`${s.name}의 컬럼 설정이 잘못되었습니다.`);const n=s.columns.filter((e=>void 0!==e.primaryKey)).orderBy((e=>e.primaryKey)).map((e=>e.name));t.push({type:"addForeignKey",table:this.getTableNameDef(e),foreignKey:{name:i.name,fkColumns:i.columnPropertyKeys.map((t=>e.columns.single((e=>e.propertyKey===t)).name)),targetTable:this.getTableNameDef(s),targetPkColumns:n}},{type:"createIndex",table:this.getTableNameDef(e),index:{name:i.name,columns:i.columnPropertyKeys.map((t=>({name:e.columns.single((e=>e.propertyKey===t)).name,orderBy:"ASC"})))}})}catch(t){throw t instanceof Error?new p.Nf(t,e.name+" > "+i.name+": 오류"):t}return t}getCreateIndexesQueryDefsFromTableDef(e){if(e.columns.length<1)throw new Error(`'${e.name}'의 컬럼 설정이 잘못되었습니다.`);const t=[];for(const i of e.indexes)t.push({type:"createIndex",table:this.getTableNameDef(e),index:{name:i.name,columns:i.columns.orderBy((e=>e.order)).map((t=>({name:e.columns.single((e=>e.propertyKey===t.columnPropertyKey)).name,orderBy:t.orderBy})))}});return t}getAddColumnQueryDefFromTableDef(e,t){if(e.columns.length<1)throw new Error(`'${e.name}'의 컬럼 설정이 잘못되었습니다.`);const i=e.columns.single((e=>e.name===t));if(!i)throw new Error(`'${e.name}.${t}' 설정이 잘못되었습니다.`);return{type:"addColumn",table:this.getTableNameDef(e),column:{name:i.name,dataType:this.qh.type(i.dataType??i.typeFwd()),autoIncrement:i.autoIncrement,nullable:i.nullable}}}getModifyColumnQueryDefFromTableDef(e,t){if(e.columns.length<1)throw new Error(`'${e.name}'의 컬럼 설정이 잘못되었습니다.`);const i=e.columns.single((e=>e.name===t));if(!i)throw new Error(`'${e.name}.${t}' 설정이 잘못되었습니다.`);return{type:"modifyColumn",table:this.getTableNameDef(e),column:{name:i.name,dataType:this.qh.type(i.dataType??i.typeFwd()),autoIncrement:i.autoIncrement,nullable:i.nullable}}}getModifyPkQueryDefFromTableDef(e,t){if(e.columns.length<1)throw new Error(`'${e.name}'의 컬럼 설정이 잘못되었습니다.`);return[{type:"dropPrimaryKey",table:this.getTableNameDef(e)},...t.length>0?[{type:"addPrimaryKey",table:this.getTableNameDef(e),columns:t}]:[]]}getAddFkQueryDefFromTableDef(e,t){if(e.columns.length<1)throw new Error(`'${e.name}'의 컬럼 설정이 잘못되었습니다.`);const i=e.foreignKeys.single((e=>e.name===t));if(!i)throw new Error(`'${e.name} => FK: ${t}' 설정이 잘못되었습니다.`);const s=DbDefinitionUtil_DbDefinitionUtil.getTableDef(i.targetTypeFwd());if(s.columns.length<1)throw new Error(`${s.name}의 컬럼 설정이 잘못되었습니다.`);const n=s.columns.filter((e=>void 0!==e.primaryKey)).orderBy((e=>e.primaryKey)).map((e=>e.name));return{type:"addForeignKey",table:this.getTableNameDef(e),foreignKey:{name:i.name,fkColumns:i.columnPropertyKeys.map((t=>e.columns.single((e=>e.propertyKey===t)).name)),targetTable:this.getTableNameDef(s),targetPkColumns:n}}}getRemoveFkQueryDefFromTableDef(e,t){if(e.columns.length<1)throw new Error(`'${e.name}'의 컬럼 설정이 잘못되었습니다.`);return{type:"removeForeignKey",table:this.getTableNameDef(e),foreignKey:t}}getCreateIndexQueryDefFromTableDef(e,t){if(e.columns.length<1)throw new Error(`'${e.name}'의 컬럼 설정이 잘못되었습니다.`);let i=e.indexes.single((e=>e.name===t));if(!i){const s=e.foreignKeys.single((e=>e.name===t));if(!s)throw new Error(`'${e.name} => IDX: ${t}' 설정이 잘못되었습니다.`);i={name:s.name,description:s.description,columns:s.columnPropertyKeys.map(((t,i)=>({columnPropertyKey:t,name:e.columns.single((e=>e.propertyKey===t)).name,order:i+1,orderBy:"ASC"})))}}return{type:"createIndex",table:this.getTableNameDef(e),index:{name:i.name,columns:i.columns.orderBy((e=>e.order)).map((t=>({name:e.columns.single((e=>e.propertyKey===t.columnPropertyKey)).name,orderBy:t.orderBy})))}}}getDropIndexQueryDefFromTableDef(e,t){if(e.columns.length<1)throw new Error(`'${e.name}'의 컬럼 설정이 잘못되었습니다.`);return{type:"dropIndex",table:this.getTableNameDef(e),index:t}}getTableNameDef(e){return{..."sqlite"===this.opt.dialect?{}:{database:e.database??this.opt.database,schema:e.schema??this.opt.schema},name:e.name}}}DbContext.SELECT_CACHE_TIMEOUT=1e3,DbContext.selectCache=new Map;class SdOrmUtil{static canConvertToQueryValue(e){return["undefined","boolean","number","string"].includes(typeof e)||e instanceof QueryUnit||e instanceof Number||e instanceof String||e instanceof Boolean||e instanceof p.uE||e instanceof p.ou||e instanceof p.qp||e instanceof p.r6||e instanceof Buffer}static getQueryValueType(e){if(e instanceof QueryUnit)return e.type;if(e instanceof Number||"number"==typeof e)return Number;if(e instanceof String||"string"==typeof e)return String;if(e instanceof Boolean||"boolean"==typeof e)return Boolean;if(e instanceof p.uE)return p.uE;if(e instanceof p.ou)return p.ou;if(e instanceof p.qp)return p.qp;if(e instanceof p.r6)return p.r6;if(e instanceof Buffer)return Buffer;if(void 0!==e)throw new Error(`QueryValue 를 추출할 수 있는 타입이 아닙니다: ${JSON.stringify(e)}`)}static getQueryValueFields(e,t){return void 0!==t&&t<1?[]:Object.values(e).mapMany((e=>SdOrmUtil.canConvertToQueryValue(e)?[e]:SdOrmUtil.getQueryValueFields(e,void 0!==t?t-1:void 0)))}static parseQueryResult(e,t){const i=e.map((e=>{const i={};for(const s of Object.keys(e))null==e[s]?i[s]=void 0:i[s]="DateTime"===t?.columns?.[s]?.dataType?p.ou.parse(e[s]):"DateOnly"===t?.columns?.[s]?.dataType?p.uE.parse(e[s]):"Time"===t?.columns?.[s]?.dataType?p.qp.parse(e[s]):"Uuid"===t?.columns?.[s]?.dataType?new p.r6(e[s]):"Boolean"===t?.columns?.[s]?.dataType?Boolean(e[s]):"Number"===t?.columns?.[s]?.dataType?Number.parseFloat(e[s]):e[s];if(0!==Object.keys(i).length)return i})).filterExists(),s=t?.joins?Object.keys(t.joins).map((e=>({key:e,isSingle:t.joins[e].isSingle}))):[],n=s.filter((e=>!e.key.includes(".")));if(n.length>0){const getObjKeyString=e=>{const t=[];for(const i of Object.keys(e).orderBy()){const s=e[i];["undefined","boolean","number","string"].includes(typeof s)||s instanceof Number||s instanceof String||s instanceof Boolean||s instanceof p.uE||s instanceof p.ou||s instanceof p.qp||s instanceof p.r6||s instanceof Buffer?t.push(i+":"+p.Q9.stringify(s)):t.push(i+":"+getObjKeyString(s))}return"("+t.join("|")+")"},getKeyObj=(e,t)=>{const i={};for(const s of Object.keys(e))t.some((e=>s===e||s.startsWith(e+".")))||(i[s]=e[s]);return i},getObjOrUndefined=e=>void 0===e||Object.keys(e).every((t=>void 0===e[t]))?void 0:e,joinToObj=(e,t)=>{const i=[];for(const s of e){const e={};for(const i of Object.keys(s))for(const n of t)i.startsWith(n+".")?(e[n]=e[n]??{},e[n][i.slice(n.length+1)]=s[i]):e[i]=s[i];i.push(e)}return i},grouping=(e,t)=>{const i=new Map;for(const s of e){const e=getKeyObj(s,t),n=getObjKeyString(e);if(i.has(n)){const e=i.get(n);for(const i of t){const t=getObjOrUndefined(s[i]);t&&e[i].push(t)}}else{const a={...e};for(const e of t){const t=getObjOrUndefined(s[e]);a[e]=t?[t]:[]}i.set(n,a)}}for(const e of i.values())for(const i of t)e[i].distinctThis();return Array.from(i.values())},doing=(e,t,i)=>{const n=t.map((e=>e.key)),a=grouping(joinToObj(e,n),n);for(const e of a)for(const n of t){const t=(void 0!==i?i+".":"")+n.key,a=s.filter((e=>e.key.startsWith(t+".")&&!e.key.slice(t.length+1).includes("."))).map((e=>({key:e.key.slice(t.length+1),isSingle:e.isSingle}))),r=e[n.key];if(a.length>0){const t=doing(r,a);if(n.isSingle){if(t.length>1)throw new Error("중복");e[n.key]=t[0]}else e[n.key]=t}else if(n.isSingle){if(r.length>1)throw new Error("중복");e[n.key]=r[0]}else e[n.key]=r}return a};return doing(i,n)}return i}}class Queryable{constructor(e,t,i,s,n){if(this.db=e,this._isCustomEntity=!1,this.hasMultiJoin=!1,t instanceof Queryable)this.tableType=t.tableType,this._as=t._as,this.tableDef=t.tableDef?p.QI.clone(t.tableDef):void 0,this._entity=p.QI.clone(t._entity),this._def=p.QI.clone(t._def),void 0!==i&&(this._entity=p.QI.clone(i,{useRefTypes:[this.db.constructor]}),this._isCustomEntity=!0);else if(void 0===s){this.tableType=t,this._as=i;const e=DbDefinitionUtil_DbDefinitionUtil.getTableDef(this.tableType);if(void 0===e)throw new Error(`'${this.tableType.name}'에 '@Table()'이 지정되지 않았습니다.`);this.tableDef=e,this._entity={};for(const e of this.tableDef.columns)this._entity[e.propertyKey]=new QueryUnit(e.typeFwd(),`${this.db.qb.wrap("TBL"+(void 0!==this._as?`.${this._as}`:""))}.${this.db.qb.wrap(e.name)}`);this._def={from:this.tableName}}else if(this._as=i,this._entity=s,this._def=n,void 0!==t){this.tableType=t;const e=DbDefinitionUtil_DbDefinitionUtil.getTableDef(this.tableType);if(void 0===e)throw new Error(`'${this.tableType.name}'에 '@Table()'이 지정되지 않았습니다.`);this.tableDef=e}}get tableName(){if(!this.tableDef)throw new p.AJ;return this.db.qb.getTableName(this.tableNameDef)}get tableDescription(){if(!this.tableDef)throw new p.AJ;return this.tableDef.description}get tableNameDef(){if(!this.tableDef)throw new p.AJ;return{..."sqlite"===this.db.opt.dialect?{}:{database:this.tableDef.database??this.db.opt.database,schema:this.tableDef.schema??this.db.opt.schema},name:this.tableDef.name}}static union(e,t){const i=e[0].db,s=e.map((e=>new Queryable(i,e).wrap().clearOrderBy())),getNewEntity=e=>{const i={};for(const n of Object.keys(e)){const a=e[n];SdOrmUtil.canConvertToQueryValue(a)?i[n]=new QueryUnit(SdOrmUtil.getQueryValueType(a),`${s[0].db.qb.wrap("TBL"+(void 0!==t?"."+t:""))}.${s[0].db.qb.wrap(n)}`):i[n]=a instanceof Array?[getNewEntity(a[0])]:getNewEntity(a)}return i},n=getNewEntity(s[0]._entity),a=s.map((e=>e.getSelectQueryDef()));return new Queryable(i,void 0,t,n,{from:a})}lock(){const e=new Queryable(this.db,this);return e._def.lock=!0,e}select(e){const t=e(this._entity);return new Queryable(this.db,this,t)}selectByType(e){const t=DbDefinitionUtil_DbDefinitionUtil.getTableDef(e);if(void 0===t)throw new Error(`'${e.name}'에 '@Table()'이 지정되지 않았습니다.`);const i={};for(const e of t.columns)i[e.propertyKey]=this._entity[e.propertyKey];return new Queryable(this.db,this,i)}ofType(){return this}where(e){const t=new Queryable(this.db,this),i=this.db.qh.and(e(this._entity));return t._def.where=t._def.where?this.db.qh.and([t._def.where,i]):i,t}distinct(){const e=new Queryable(this.db,this);return e._def.distinct=!0,e}top(e){const t=new Queryable(this.db,this);return t._def.top=e,t}orderBy(e,t){let i,s=new Queryable(this.db,this);if("function"==typeof e)i=e(this._entity);else{const t=e.split(".").slice(0,-1),n=[];for(const e of t){n.push(e);const t=n.join(".");this._def.join?.some((e=>e.as===this.db.qb.wrap(`TBL.${t}`)))||void 0===this._getEntityChainValue(s._entity,t)&&(s=s.includeByTableChainedName(t))}i=this._getEntityChainValue(s._entity,e)}s._def.orderBy=s._def.orderBy??[];const n=this.db.qh.getQueryValue(i);if(s._def.orderBy.some((e=>e[0]===n)))throw new Error("정렬 기준이 중복 되었습니다: "+n);return s._def.orderBy.push([n,t?"DESC":"ASC"]),s}clearOrderBy(){const e=new Queryable(this.db,this);return delete e._def.orderBy,e}limit(e,t){const i=new Queryable(this.db,this);return i._def.limit=[e,t],i}sample(e){const t=new Queryable(this.db,this);return t._def.sample=e,t}pivot(e,t,i){const s=e(this._entity),n=t(this._entity),a={...this._entity};if("mysql"===this.db.opt.dialect)for(const e of i){if(!(s instanceof QueryUnit))throw new p.J6;{const t=this.db.qb.wrap("TBL"+(void 0!==this._as?`.${this._as}`:""));a[e]=new QueryUnit(s.type,`SUM(IF(${t}.${this.db.qh.getQueryValue(n)} = '${e}', ${t}.${this.db.qh.getQueryValue(s)}, 0))`)}}else for(const e of i){if(!(s instanceof QueryUnit))throw new p.J6;a[e]=new QueryUnit(s.type,`${this.db.qb.wrap("TBL"+(void 0!==this._as?`.${this._as}`:""))}.${this.db.qb.wrap(e)}`)}let r=new Queryable(this.db,this,a);return r._def.pivot={valueColumn:this.db.qh.getQueryValue(s),pivotColumn:this.db.qh.getQueryValue(n),pivotKeys:i},"mysql"===this.db.opt.dialect&&(r=r.groupBy((e=>Object.entries(e).filter((([e,t])=>!i.includes(e)&&!p.QI.equal(t,s)&&!p.QI.equal(t,n))).map((([e,t])=>t))))),r}unpivot(e,t,i,s){const n={...this._entity};if("mysql"===this.db.opt.dialect)throw new p.J6;if(!(n[i[0]]instanceof QueryUnit))throw new p.J6;n[e]=new QueryUnit(n[i[0]].type,`${this.db.qb.wrap("TBL"+(void 0!==this._as?`.${this._as}`:""))}.${this.db.qb.wrap(e)}`),n[t]=new QueryUnit(String,`${this.db.qb.wrap("TBL"+(void 0!==this._as?`.${this._as}`:""))}.${this.db.qb.wrap(t)}`);for(const e of i)delete n[e];const a=new Queryable(this.db,this,n);return a._def.unpivot={valueColumn:this.db.qb.wrap(e),pivotColumn:this.db.qb.wrap(t),pivotKeys:i},a}groupBy(e){const t=new Queryable(this.db,this);return t._def.groupBy=e(this._entity).map((e=>this.db.qh.getQueryValue(e))),t}having(e){const t=new Queryable(this.db,this),i=this.db.qh.and(e(this._entity));return t._def.having=t._def.having?this.db.qh.and([t._def.having,i]):i,t}join(e,t,i){const s=void 0!==this._as?this._as+"."+t:t;if(this._def.join?.some((e=>e.as===this.db.qb.wrap(`TBL.${s}`))))return new Queryable(this.db,this);let n;n=e instanceof Array?Queryable.union(e,s):new Queryable(this.db,e,s);const a=i(n,this._entity),r=this._getParentEntity(a._entity,s,void 0),o={...this._entity};this._setEntityChainValue(o,t,[r]);const c=new Queryable(this.db,this,o);return c._def.join=c._def.join??[],c._def.join.push({...a.getSelectQueryDef(),isCustomSelect:a._isCustomEntity,isSingle:!1}),this.hasMultiJoin=!0,c}joinSingle(e,t,i){const s=void 0!==this._as?this._as+"."+t:t;if(this._def.join?.some((e=>e.as===this.db.qb.wrap(`TBL.${s}`))))return new Queryable(this.db,this);let n;n=e instanceof Array?Queryable.union(e,s):new Queryable(this.db,e,s);const a=i(n,this._entity),r=this._getParentEntity(a._entity,s,void 0),o={...this._entity};this._setEntityChainValue(o,t,r);const c=new Queryable(this.db,this,o);return c._def.join=c._def.join??[],c._def.join.push({...a.getSelectQueryDef(),isCustomSelect:a._isCustomEntity,isSingle:!0}),this.hasMultiJoin=this.hasMultiJoin||a.hasMultiJoin,c}includeByTableChainedName(e){return this._include(e)}include(e){const t=p.Z1.parse(e),i=t.params[0],s=t.returnContent.replace(new RegExp(`${i}\\.`),"").replace(/\[0]/g,"").trim();return this._include(s)}_include(e){if(!this.tableDef)throw new Error("'Wrapping'된 이후에는 include 를 사용할 수 없습니다.");const t=e.split(".");let i=this,s=this.tableDef;const n=[];for(const e of t){const t=n.join(".");n.push(e);const a=n.join("."),r=s.foreignKeys.single((t=>t.propertyKey===e)),o=s.foreignKeyTargets.single((t=>t.propertyKey===e));if(!r&&!o)throw new Error(`'${s.name}.${a}'에 '@ForeignKey()'나 '@ForeignKeyTarget()'이 지정되지 않았습니다.`);if(r){const e=r.targetTypeFwd(),n=DbDefinitionUtil_DbDefinitionUtil.getTableDef(e);if(r.columnPropertyKeys.length!==n.columns.filter((e=>void 0!==e.primaryKey)).length)throw new Error(`'${s.name}.${a}'의 FK 설정과 '${n.name}'의 PK 설정의 길이가 다릅니다.`);i=i.joinSingle(e,a,((e,i)=>e.where((e=>{const s=this._getEntityChainValue(i,t),a=[];for(let t=0;t<r.columnPropertyKeys.length;t++)a.push(this.db.qh.equal(e[n.columns[t].propertyKey],s[r.columnPropertyKeys[t]]));return a})))),s=n}else if(o){const e=o.sourceTypeFwd(),n=DbDefinitionUtil_DbDefinitionUtil.getTableDef(e),r=n.foreignKeys.single((e=>e.propertyKey===o.foreignKeyPropertyKey));if(!r)throw new Error(`'${n.name}.${o.foreignKeyPropertyKey}'에 '@ForeignKey()'가 지정되지 않았습니다.`);if(r.columnPropertyKeys.length!==s.columns.filter((e=>void 0!==e.primaryKey)).length)throw new Error(`'${n.name}.${o.foreignKeyPropertyKey}'의 FK 설정과 '${s.name}'의 PK 설정의 길이가 다릅니다.`);i=i.join(e,a,((e,i)=>e.where((e=>{const n=this._getEntityChainValue(i,t),a=[];for(let t=0;t<r.columnPropertyKeys.length;t++)a.push(this.db.qh.equal(e[r.columnPropertyKeys[t]],n[s.columns[t].propertyKey]));return a})))),s=n}}return i}search(e,t){let i=new Queryable(this.db,this);const s=t.trim().split(" ").map((e=>e.trim())).filter((e=>Boolean(e))),n=i._def.groupBy&&i._def.groupBy.length>0?"having":"where";return i=t.startsWith("<>")?i[n]((t=>{const i=[],n=e(t);for(const e of n){const t=[];for(const i of s)i.includes("*")?t.push(this.db.qh.notLike(this.db.qh.toLowerCase(e),i.substring(2).replace(/\*/g,"%").toLowerCase())):t.push(this.db.qh.notIncludes(this.db.qh.toLowerCase(e),i.substring(2).toLowerCase()));i.push(this.db.qh.and(t))}return[this.db.qh.and(i)]})):i[n]((t=>{const i=[],n=e(t);for(const e of n){const t=[];for(const i of s)i.includes("*")?t.push(this.db.qh.like(this.db.qh.toLowerCase(e),i.replace(/\*/g,"%").toLowerCase())):t.push(this.db.qh.includes(this.db.qh.toLowerCase(e),i.toLowerCase()));i.push(this.db.qh.and(t))}return[this.db.qh.or(i)]})),i}searchEveryStringFields(e){return this.search((e=>{const t=[],addFieldProc=e=>{for(const i of Object.keys(e)){const s=e[i];if(SdOrmUtil.canConvertToQueryValue(s)){SdOrmUtil.getQueryValueType(s)===String&&t.push(s)}else if(s instanceof Array)for(const e of s)addFieldProc(e);else s instanceof QueryUnit||addFieldProc(s)}};return addFieldProc(e),t}),e)}wrap(e){let t;if(void 0!==e){const e={};for(const t of Object.keys(this._entity)){const i=this._entity[t];SdOrmUtil.canConvertToQueryValue(i)&&(e[t]=i)}t=new Queryable(this.db,this,e),t._def.distinct=!0}else t=new Queryable(this.db,this);const i=t.getSelectQueryDef();if(i.orderBy){let e=0;for(const t of i.orderBy)e++,i.select["__order_"+e]=t[0]}const s=this._getParentEntity(t._entity,this._as,void 0),n=new Queryable(this.db,e,this._as,s,{from:i});if(i.orderBy&&i.orderBy.length>0){n._def.orderBy=[];let e=0;for(const t of i.orderBy)e++,n._def.orderBy.push(["__order_"+e,t[1]]);i.limit||delete i.orderBy}return n}getSelectQueryDef(){const e={};e.from=this._def.from,e.as=this.db.qb.wrap("TBL"+(void 0!==this._as?`.${this._as}`:"")),e.select={};const addSelectValue=(t,i)=>{if(SdOrmUtil.canConvertToQueryValue(i)){if(void 0===e.select)throw new p.AJ;e.select[`${this.db.qb.wrap(t)}`]=this.db.qh.getQueryValue(i)}else if(i instanceof Array){if(i.some((e=>SdOrmUtil.canConvertToQueryValue(e))))throw new Error("SELECT 에 입력할 수 없는 정보가 입력되었습니다. (qh.equal 등은 qh.is 로 wrapping 해 주어야 사용할 수 있습니다.)");for(const e of Object.keys(i[0]).orderBy())addSelectValue(`${t}.${e}`,i[0][e])}else for(const e of Object.keys(i).orderBy())addSelectValue(`${t}.${e}`,i[e])};for(const e of Object.keys(this._entity).orderBy())addSelectValue(e,this._entity[e]);if(e.where=this._def.where,e.distinct=this._def.distinct,e.top=this._def.top,e.orderBy=this._def.orderBy,e.limit=this._def.limit,e.pivot=this._def.pivot,e.unpivot=this._def.unpivot,e.groupBy=this._def.groupBy,e.having=this._def.having,e.lock=this._def.lock,e.sample=this._def.sample,this._def.join){const t=p.QI.clone(this._def.join);for(const e of t)delete e.isSingle;e.join=t}if(this._def.having&&!(this._def.groupBy&&this._def.groupBy.length>0))throw new Error("'HAVING'을 사용하려면, 'GROUP BY'를 반드시 설정해야 합니다.");if(this._def.limit&&this._def.join&&this._def.join.some((e=>!e.isSingle))&&!this._def.groupBy&&!this._isCustomEntity)throw new Error("다수의 'RECORD'를 'JOIN'하는 쿼리와 'LIMIT'을 동시에 사용할 수 없습니다. 'LIMIT'을 먼저 사용하고, 'WRAP'한 이후에 'JOIN' 하거나, 'GROUP BY'도 함께 사용하세요.");if(this._def.limit&&(!this._def.orderBy||this._def.orderBy.length<=0))throw new Error("'LIMIT'을 사용하려면, 'ORDER BY'를 반드시 설정해야 합니다.");return p.QI.clearUndefined(e)}_getParentEntity(e,t,i){const s={};for(const n of Object.keys(e)){const a=e[n];SdOrmUtil.canConvertToQueryValue(a)?s[n]=new QueryUnit(SdOrmUtil.getQueryValueType(a),this.db.qb.wrap("TBL"+(void 0!==t?"."+t:""))+"."+this.db.qb.wrap((void 0!==i?`${i}.`:"")+n)):s[n]=a instanceof Array?[this._getParentEntity(a[0],t,(void 0!==i?i+".":"")+n)]:this._getParentEntity(a,t,(void 0!==i?i+".":"")+n)}return s}getInsertQueryDef(e,t){if("string"!=typeof this._def.from)throw new Error("INSERT 할 TABLE 을 정확히 지정해야 합니다.");if(void 0!==this._def.join)throw new Error("INSERT 와 JOIN 를 함께 사용할 수 없습니다.");if(this._isCustomEntity)throw new Error("INSERT 와 SELECT 를 함께 사용할 수 없습니다.");if(void 0!==this._def.where)throw new Error("INSERT 와 WHERE 를 함께 사용할 수 없습니다.");if(void 0!==this._def.distinct)throw new Error("INSERT 와 DISTINCT 를 함께 사용할 수 없습니다.");if(void 0!==this._def.top)throw new Error("INSERT 와 TOP 를 함께 사용할 수 없습니다.");if(void 0!==this._def.orderBy)throw new Error("INSERT 와 ORDER BY 를 함께 사용할 수 없습니다.");if(void 0!==this._def.limit)throw new Error("INSERT 와 LIMIT 를 함께 사용할 수 없습니다.");if(void 0!==this._def.groupBy)throw new Error("INSERT 와 GROUP BY 를 함께 사용할 수 없습니다.");if(void 0!==this._def.having)throw new Error("INSERT 와 HAVING 를 함께 사용할 수 없습니다.");const i={};for(const t of Object.keys(e))i[this.db.qb.wrap(t)]=this.db.qh.getQueryValue(e[t]);return p.QI.clearUndefined({from:this._def.from,output:t?.map((e=>this.db.qb.wrap(e))),record:i})}getUpdateQueryDef(e,t){if("string"!=typeof this._def.from)throw new Error("UPDATE 할 TABLE 을 정확히 지정해야 합니다.");if(this._isCustomEntity)throw new Error("UPDATE 와 SELECT 를 함께 사용할 수 없습니다.");if(void 0!==this._def.orderBy)throw new Error("UPDATE 와 ORDER BY 를 함께 사용할 수 없습니다.");if(void 0!==this._def.limit)throw new Error("UPDATE 와 LIMIT 를 함께 사용할 수 없습니다.");if(void 0!==this._def.groupBy)throw new Error("UPDATE 와 GROUP BY 를 함께 사용할 수 없습니다.");if(void 0!==this._def.having)throw new Error("UPDATE 와 HAVING 를 함께 사용할 수 없습니다.");const i={};for(const t of Object.keys(e))i[this.db.qb.wrap(t)]=this.db.qh.getQueryValue(e[t]);let s;if(this._def.join){const e=p.QI.clone(this._def.join);for(const t of e)delete t.isSingle;s=e}return p.QI.clearUndefined({top:this._def.top,from:this._def.from,record:i,output:t?.map((e=>this.db.qb.wrap(e))),as:this.db.qb.wrap("TBL"+(void 0!==this._as?`.${this._as}`:"")),join:s,where:this._def.where})}getInsertIfNotExistsQueryDef(e,t){if(void 0!==this._def.join)throw new Error("INSERT IF NOT EXISTS 와 JOIN 를 함께 사용할 수 없습니다.");if("string"!=typeof this._def.from)throw new Error("INSERT IF NOT EXISTS 할 TABLE 을 정확히 지정해야 합니다.");if(this._isCustomEntity)throw new Error("INSERT IF NOT EXISTS 와 SELECT 를 함께 사용할 수 없습니다.");if(void 0!==this._def.distinct)throw new Error("INSERT IF NOT EXISTS 와 DISTINCT 를 함께 사용할 수 없습니다.");if(void 0!==this._def.top)throw new Error("INSERT IF NOT EXISTS 와 TOP 를 함께 사용할 수 없습니다.");if(void 0!==this._def.orderBy)throw new Error("INSERT IF NOT EXISTS 와 ORDER BY 를 함께 사용할 수 없습니다.");if(void 0!==this._def.limit)throw new Error("INSERT IF NOT EXISTS 와 LIMIT 를 함께 사용할 수 없습니다.");if(void 0!==this._def.groupBy)throw new Error("INSERT IF NOT EXISTS 와 GROUP BY 를 함께 사용할 수 없습니다.");if(void 0!==this._def.having)throw new Error("INSERT IF NOT EXISTS 와 HAVING 를 함께 사용할 수 없습니다.");if(void 0===this._def.where||this._def.where.length<1)throw new Error("INSERT IF NOT EXISTS 시, WHERE 를 반드시 사용해야 합니다.");const i={};for(const t of Object.keys(e))i[this.db.qb.wrap(`${t}`)]=this.db.qh.getQueryValue(e[t]);return p.QI.clearUndefined({from:this._def.from,as:this.db.qb.wrap("TBL"+(void 0!==this._as?`.${this._as}`:"")),where:this._def.where,insertRecord:i,output:t?.map((e=>this.db.qb.wrap(e)))})}getUpsertQueryDef(e,t,i){if(void 0!==this._def.join)throw new Error("UPSERT 와 JOIN 를 함께 사용할 수 없습니다.");if("string"!=typeof this._def.from)throw new Error("UPSERT 할 TABLE 을 정확히 지정해야 합니다.");if(this._isCustomEntity)throw new Error("UPSERT 와 SELECT 를 함께 사용할 수 없습니다.");if(void 0!==this._def.distinct)throw new Error("UPSERT 와 DISTINCT 를 함께 사용할 수 없습니다.");if(void 0!==this._def.top)throw new Error("UPSERT 와 TOP 를 함께 사용할 수 없습니다.");if(void 0!==this._def.orderBy)throw new Error("UPSERT 와 ORDER BY 를 함께 사용할 수 없습니다.");if(void 0!==this._def.limit)throw new Error("UPSERT 와 LIMIT 를 함께 사용할 수 없습니다.");if(void 0!==this._def.groupBy)throw new Error("UPSERT 와 GROUP BY 를 함께 사용할 수 없습니다.");if(void 0!==this._def.having)throw new Error("UPSERT 와 HAVING 를 함께 사용할 수 없습니다.");if(void 0===this._def.where||this._def.where.length<1)throw new Error("UPSERT 시, WHERE 를 반드시 사용해야 합니다.");const s={};for(const t of Object.keys(e))s[this.db.qb.wrap(`${t}`)]=this.db.qh.getQueryValue(e[t]);let n={};if(t)for(const e of Object.keys(t))n[this.db.qb.wrap(`${e}`)]=this.db.qh.getQueryValue(t[e]);else n=p.QI.clone(s);return p.QI.clearUndefined({from:this._def.from,as:this.db.qb.wrap("TBL"+(void 0!==this._as?`.${this._as}`:"")),where:this._def.where,updateRecord:s,insertRecord:n,output:i?.map((e=>this.db.qb.wrap(e)))})}getDeleteQueryDef(e){if("string"!=typeof this._def.from)throw new Error("INSERT 할 TABLE 을 정확히 지정해야 합니다.");if(this._isCustomEntity)throw new Error("INSERT 와 SELECT 를 함께 사용할 수 없습니다.");if(void 0!==this._def.distinct)throw new Error("INSERT 와 DISTINCT 를 함께 사용할 수 없습니다.");if(void 0!==this._def.orderBy)throw new Error("INSERT 와 ORDER BY 를 함께 사용할 수 없습니다.");if(void 0!==this._def.limit)throw new Error("INSERT 와 LIMIT 를 함께 사용할 수 없습니다.");if(void 0!==this._def.groupBy)throw new Error("INSERT 와 GROUP BY 를 함께 사용할 수 없습니다.");if(void 0!==this._def.having)throw new Error("INSERT 와 HAVING 를 함께 사용할 수 없습니다.");let t;if(this._def.join){const e=p.QI.clone(this._def.join);for(const t of e)delete t.isSingle;t=e}return p.QI.clearUndefined({top:this._def.top,from:this._def.from,output:e?.map((e=>this.db.qb.wrap(e))),as:this.db.qb.wrap("TBL"+(void 0!==this._as?`.${this._as}`:"")),join:t,where:this._def.where})}async resultAsync(){if(void 0===this.db)throw new Error("'DbContext'가 설정되지 않은 쿼리는 실행할 수 없습니다.");const e=this.getSelectQueryDef(),t=p.Q9.stringify(e);if(DbContext.selectCache.has(t))try{await p.NT.until((()=>void 0!==DbContext.selectCache.get(t)),void 0,3e4);const e=DbContext.selectCache.get(t);return clearTimeout(e.timeout),e.timeout=setTimeout((()=>{DbContext.selectCache.delete(t)}),DbContext.SELECT_CACHE_TIMEOUT),e.result}catch(e){console.error(e)}DbContext.selectCache.set(t,void 0);const i=await this.db.executeDefsAsync([{type:"select",...e}],[this._getParseOption(void 0)]),s=setTimeout((()=>{DbContext.selectCache.delete(t)}),DbContext.SELECT_CACHE_TIMEOUT);return DbContext.selectCache.set(t,{result:i[0]??[],timeout:s}),i[0]}async singleAsync(){const e=await this.resultAsync();if(e.length>1)throw new Error("복수의 쿼리결과가 있습니다.");return e[0]}async countAsync(){if(this._def.distinct)throw new Error("distinct 이후엔 'countAsync'를 사용할 수 없습니다. 사용하려면 distinct와 countAsync 사이에 wrap을 먼저 사용하거나, distinct대신 groupBy와 qh.count 로 수동으로 처리하세요.");const e=this.select((()=>({cnt:new QueryUnit(Number,"COUNT(*)")})));delete e._def.orderBy;return(await e.singleAsync())?.cnt??0}async existsAsync(){return await this.countAsync()>0}async bulkInsertAsync(e){const t=e instanceof Array?e:[e];if(void 0===this.db)throw new Error("'DbContext'가 설정되지 않은 쿼리는 실행할 수 없습니다.");if(DbContext.selectCache.clear(),!this.tableDef)throw new Error("'Wrapping'된 이후에는 테이블의 정보를 가져올 수 없습니다.");const i=this.tableDef.columns.map((e=>({name:e.name,dataType:this.db.qh.type(e.dataType??e.typeFwd()),autoIncrement:e.autoIncrement,nullable:e.nullable})));await this.db.bulkInsertAsync(this.tableName,i,t.map((e=>{const t={};for(const i of Object.keys(e))t[i]=this.db.qh.getBulkInsertQueryValue(e[i]);return t})))}async insertAsync(e,t){return await this._insertAsync(!1,e,t)}async insertWithoutFkCheckAsync(e,t){return await this._insertAsync(!0,e,t)}async _insertAsync(e,t,i){if(0===t.length&&void 0!==i)return[];if(0===t.length&&void 0===i)return;const{defs:s,dataIndexes:n}=this._getInsertDefs(e,t,i),a=i?this._getParseOption(i):void 0;return(await this.db.executeDefsAsync(s,s.map(((e,t)=>n.includes(t)?a:void 0)))).filter(((e,t)=>n.includes(t))).map((e=>e[0]))}insertPrepare(e){this._insertPrepare(!1,e)}insertWithoutFkCheckPrepare(e){this._insertPrepare(!0,e)}_insertPrepare(e,t){if(0===t.length)return;const{defs:i}=this._getInsertDefs(e,t,void 0);this.db.prepareDefs.push(...i)}_getInsertDefs(e,t,i){if(t.length<1)throw new Error("데이터 누락");if(void 0===this.db)throw new Error("'DbContext'가 설정되지 않은 쿼리는 실행할 수 없습니다.");if(!this.tableDef)throw new Error("'Wrapping'된 이후에는 테이블의 정보를 가져올 수 없습니다.");DbContext.selectCache.clear();const s=this.tableDef.columns.filter((e=>void 0!==e.primaryKey)).map((e=>e.name)),n=this.tableDef.columns.filter((e=>e.autoIncrement)).map((e=>e.name)),a=[],r=[];for(let e=0;e<t.length;e++){const o=t[e],c=this.getInsertQueryDef(o,i);if(r.push({type:"insert",...c}),"mysql"===this.db.opt.dialect&&i){const t=i.toObject((e=>this.db.qb.wrap(e)),(e=>this.db.qb.wrap(e)));if(1!==s.length||1!==n.length||s[0]!==n[0]||Object.keys(o).includes(n[0]))r.push({type:"select",from:this._def.from,select:t,where:s.map((e=>[[this.db.qb.wrap(e)," = ",this.db.qh.getQueryValue(o[e])]]))});else{const e=s[0];r.push({type:"select",from:this._def.from,select:t,where:[[this.db.qb.wrap(e)," = ","LAST_INSERT_ID()"]]})}a.push(2*e+1)}else i&&a.push(e)}if(e){r.insert(0,{type:"configForeignKeyCheck",table:this.tableNameDef,useCheck:!1});for(let e=0;e<a.length;e++)a[e]++;r.push({type:"configForeignKeyCheck",table:this.tableNameDef,useCheck:!0})}if("mssql"===this.db.opt.dialect||"mssql-azure"===this.db.opt.dialect){if(t.some((e=>Object.keys(e).some((e=>n.includes(e)))))){r.insert(0,{type:"configIdentityInsert",table:this.tableNameDef,state:"on"});for(let e=0;e<a.length;e++)a[e]++;r.push({type:"configIdentityInsert",table:this.tableNameDef,state:"off"})}}return{defs:r,dataIndexes:a}}async updateAsync(e,t){const i=await e(this._entity),{defs:s,dataIndex:n}=this._getUpdateDefs(i,t),a=t?this._getParseOption(t):void 0;return(await this.db.executeDefsAsync(s,s.map(((e,t)=>n===t?a:void 0))))[n]}updatePrepare(e){const t=e(this._entity),{defs:i}=this._getUpdateDefs(t,void 0);this.db.prepareDefs.push(...i)}_getUpdateDefs(e,t){if(void 0===this.db)throw new Error("'DbContext'가 설정되지 않은 쿼리는 실행할 수 없습니다.");if(!this.tableDef)throw new Error("'Wrapping'된 이후에는 편집 쿼리를 실행할 수 없습니다.");let i;DbContext.selectCache.clear();const s=[],n=this.getUpdateQueryDef(e,t);if(s.push({type:"update",...n}),"mysql"===this.db.opt.dialect&&t){const e=t.toObject((e=>this.db.qb.wrap(e)),(e=>this.db.qb.wrap(e)));s.push({type:"select",...this.getSelectQueryDef(),select:e}),i=1}else i=0;return{defs:s,dataIndex:i}}async deleteAsync(e){const{defs:t,dataIndex:i}=this._getDeleteDefs(e),s=e?this._getParseOption(e):void 0;return(await this.db.executeDefsAsync(t,t.map(((e,t)=>i===t?s:void 0))))[i]}deletePrepare(){const{defs:e}=this._getDeleteDefs(void 0);this.db.prepareDefs.push(...e)}_getDeleteDefs(e){if(void 0===this.db)throw new Error("'DbContext'가 설정되지 않은 쿼리는 실행할 수 없습니다.");if(!this.tableDef)throw new Error("'Wrapping'된 이후에는 편집 쿼리를 실행할 수 없습니다.");DbContext.selectCache.clear();const t=[],i=this.getDeleteQueryDef(e);if(t.push({type:"delete",...i}),"mysql"===this.db.opt.dialect&&e){const i=e.toObject((e=>this.db.qb.wrap(e)),(e=>this.db.qb.wrap(e)));t.insert(0,{type:"select",...this.getSelectQueryDef(),select:i})}return{defs:t,dataIndex:0}}async upsertAsync(e,t,i){const s=e,n="function"==typeof t?t:void 0,a=t instanceof Array?t:i,r=await s(this._entity),o=n?n(r):p.QI.clone(r),{defs:c,dataIndex:l}=this._getUpsertDefs(r,o,a),d=a?this._getParseOption(a):void 0;return(await this.db.executeDefsAsync(c,c.map(((e,t)=>l===t?d:void 0))))[l]}upsertPrepare(e,t){const i="function"==typeof e?e(this._entity):e,s=t?"function"==typeof t?t(i):t:i,{defs:n}=this._getUpsertDefs(i,s,void 0);this.db.prepareDefs.push(...n)}_getUpsertDefs(e,t,i){if(void 0===this.db)throw new Error("'DbContext'가 설정되지 않은 쿼리는 실행할 수 없습니다.");if(!this.tableDef)throw new Error("'Wrapping'된 이후에는 편집 쿼리를 실행할 수 없습니다.");DbContext.selectCache.clear();const s=this.tableDef.columns.filter((e=>void 0!==e.primaryKey)).map((e=>e.name)),n=this.tableDef.columns.filter((e=>e.autoIncrement)).map((e=>e.name));let a;const r=[],o=this.getUpsertQueryDef(e,t,i);if(r.push({type:"upsert",...o}),"mysql"===this.db.opt.dialect&&i){const e=i.toObject((e=>this.db.qb.wrap(e)),(e=>this.db.qb.wrap(e)));if(1!==s.length||1!==n.length||s[0]!==n[0]||Object.keys(t).includes(n[0]))r.push({type:"select",...this.getSelectQueryDef(),select:e});else{const t=s[0];r.push({type:"select",...this.getSelectQueryDef(),select:e,where:[[this.db.qb.wrap(t)," = ","LAST_INSERT_ID()"]]})}a=1}else a=0;if("mysql"!==this.db.opt.dialect){Object.keys(t).some((e=>n.includes(e)))&&(r.insert(0,{type:"configIdentityInsert",table:this.tableNameDef,state:"on"}),a++,r.push({type:"configIdentityInsert",table:this.tableNameDef,state:"off"}))}return{defs:r,dataIndex:a}}configIdentityInsert(e){if(void 0===this.db)throw new Error("'DbContext'가 설정되지 않은 쿼리는 실행할 수 없습니다.");if(!this.tableDef)throw new Error("'Wrapping'된 이후에는 테이블의 정보를 가져올 수 없습니다.");this.db.prepareDefs.push({type:"configIdentityInsert",table:this.tableNameDef,state:e})}_getParseOption(e){const t={columns:{},joins:{}},configuration=(i,s)=>{for(const n of Object.keys(p.QI.clearUndefined(i))){const a=s.concat([n]),r=a.join(".");if(!e||e.includes(r))try{void 0!==i[n]&&SdOrmUtil.canConvertToQueryValue(i[n])?t.columns[r]={dataType:SdOrmUtil.getQueryValueType(i[n]).name}:i[n]instanceof Array?(t.joins[r]={isSingle:!1},configuration(i[n][0],a)):(t.joins[r]={isSingle:!0},configuration(i[n],a))}catch(e){throw e instanceof Error?(e.message+=`\n==> [${n}]`,e):e}}};return configuration(this._entity,[]),t}_setEntityChainValue(e,t,i){const s=t.split(".");let n=e;for(const e of s.slice(0,-1))n=n[e]instanceof Array?n[e][0]:n[e];const a=s.last();if(void 0===a)throw new p.AJ;n[a]=i}_getEntityChainValue(e,t,i){if(""===t)return e;const s=t.split(".");let n=e;for(const e of s)n=i&&void 0===n?void 0:n[e],n instanceof Array&&(n=n[0]);return n}}class CaseWhenQueryHelper{constructor(e,t){this._qh=e,this._arg=t,this._cases=[],this._type=void 0}when(e,t){return this._type=SdOrmUtil.getQueryValueType(t)??this._type,this._cases.push(" WHEN ",this._qh.getQueryValue(this._qh.equal(this._arg,e))," THEN ",this._qh.getQueryValue(t)),this}else(e){return this._type=SdOrmUtil.getQueryValueType(e)??this._type,new QueryUnit(this._type,["CASE ",...this._cases," ELSE ",this._qh.getQueryValue(e)," END"])}}class CaseQueryHelper{constructor(e,t){this._qh=e,this._type=t,this._cases=[]}case(e,t){return this._type=SdOrmUtil.getQueryValueType(t)??this._type,this._cases.push(" WHEN ",this._qh.getQueryValue(e)," THEN ",this._qh.getQueryValue(t)),this}else(e){return this._type=SdOrmUtil.getQueryValueType(e)??this._type,new QueryUnit(this._type,["CASE ",...this._cases," ELSE ",this._qh.getQueryValue(e)," END"])}}class QueryHelper{constructor(e){this._dialect=e}equal(e,t){return void 0===t?this.isNull(e):"mysql"===this._dialect?[this.getQueryValue(e)," <=> ",this.getQueryValue(t)]:e instanceof QueryUnit&&t instanceof QueryUnit?this.or([this.and([this.isNull(e),this.isNull(t)]),[this.getQueryValue(e)," = ",this.getQueryValue(t)]]):[this.getQueryValue(e)," = ",this.getQueryValue(t)]}notEqual(e,t){return void 0===t?this.isNotNull(e):e instanceof QueryUnit&&t instanceof QueryUnit?this.or([this.and([this.isNull(e),this.isNotNull(t)]),this.and([this.isNotNull(e),this.isNull(t)]),[this.getQueryValue(e)," != ",this.getQueryValue(t)]]):this.or([this.isNull(e),[this.getQueryValue(e)," != ",this.getQueryValue(t)]])}isNull(e){return[this.getQueryValue(e)," IS ","NULL"]}isNotNull(e){return[this.getQueryValue(e)," IS NOT ","NULL"]}isFalse(e){return this.or([this.isNull(e),this.equal(e,!1)])}isTrue(e){return this.and([this.isNotNull(e),this.equal(e,!0)])}lessThen(e,t){return[this.getQueryValue(e)," < ",this.getQueryValue(t)]}lessThenOrEqual(e,t){return[this.getQueryValue(e)," <= ",this.getQueryValue(t)]}greaterThen(e,t){return[this.getQueryValue(e)," > ",this.getQueryValue(t)]}greaterThenOrEqual(e,t){return[this.getQueryValue(e)," >= ",this.getQueryValue(t)]}between(e,t,i){return null!=t||null!=i?this.and([null!=t?this.greaterThenOrEqual(e,t):void 0,null!=i?this.lessThenOrEqual(e,i):void 0].filterExists()):[]}includes(e,t){return[this.getQueryValue(e)," LIKE ",this.concat("%",t,"%").query]}notIncludes(e,t){return this.or([this.isNull(e),[this.getQueryValue(e)," NOT LIKE ",this.concat("%",t,"%").query]])}like(e,t){return[this.getQueryValue(e)," LIKE ",this.getQueryValue(t)]}notLike(e,t){return this.or([this.isNull(e),[this.getQueryValue(e)," NOT LIKE ",this.getQueryValue(t)]])}startsWith(e,t){return[this.getQueryValue(e)," LIKE ",this.getQueryValue(t),"sqlite"===this._dialect?" || ":" + ","'%'"]}notStartsWith(e,t){return[this.getQueryValue(e)," NOT LIKE ",this.getQueryValue(t),"sqlite"===this._dialect?" || ":" + ","'%'"]}endsWith(e,t){return[this.getQueryValue(e)," LIKE ","'%'","sqlite"===this._dialect?" || ":" + ",this.getQueryValue(t)]}notEndsWith(e,t){return[this.getQueryValue(e)," NOT LIKE ","'%'","sqlite"===this._dialect?" || ":" + ",this.getQueryValue(t)]}in(e,t){if(t.length<1)return["1"," = ","0"];{if(t.every((e=>void 0===e)))return this.isNull(e);const i=[this.getQueryValue(e)," IN ",t.filterExists().mapMany((e=>[this.getQueryValue(e),", "])).slice(0,-1)];return t.includes(void 0)?this.or([i,this.isNull(e)]):i}}notIn(e,t){if(t.length<1)return["1"," = ","1"];{if(t.every((e=>void 0===e)))return this.isNull(e);const i=[this.getQueryValue(e)," NOT IN ",t.filterExists().mapMany((e=>[this.getQueryValue(e),", "])).slice(0,-1)];return t.includes(void 0)?i:this.or([i,this.isNull(e)])}}and(e){const t=[];for(const i of e){const e=this.getQueryValue(i);void 0!==e&&t.push(e," AND ")}return t.slice(0,-1)}or(e){const t=[];for(const i of e){const e=this.getQueryValue(i);t.push(e," OR ")}return t.slice(0,-1)}query(e,t){const i=[];for(const e of t)e instanceof QueryUnit?i.push(this.getQueryValue(e)):i.push(e);return new QueryUnit(e,i)}val(e,t){const i=t??SdOrmUtil.getQueryValueType(e);return new QueryUnit(i,this.getQueryValue(e))}is(e){return this.case(e,!0).else(!1)}dateDiff(e,t,i){return new QueryUnit(Number,["DATEDIFF(",e,", ",this.getQueryValue(t),", ",this.getQueryValue(i),")"])}dateAdd(e,t,i){const s=SdOrmUtil.getQueryValueType(t);return new QueryUnit(s,["DATEADD(",e,", ",this.getQueryValue(i),", ",this.getQueryValue(t),")"])}year(e){return new QueryUnit(Number,["YEAR(",this.getQueryValue(e),")"])}month(e){return new QueryUnit(Number,["MONTH(",this.getQueryValue(e),")"])}ifNull(e,...t){let i=this.getQueryValue(e),s=SdOrmUtil.getQueryValueType(e);for(const e of t)i="mssql"===this._dialect||"mssql-azure"===this._dialect?["ISNULL(",i,", ",this.getQueryValue(e),")"]:["IFNULL(",i,", ",this.getQueryValue(e),")"],s=s??SdOrmUtil.getQueryValueType(e);return new QueryUnit(s,i)}case(e,t){const i=SdOrmUtil.getQueryValueType(t);return new CaseQueryHelper(this,i).case(e,t)}caseWhen(e){return new CaseWhenQueryHelper(this,e)}dataLength(e){return"mysql"===this._dialect?new QueryUnit(Number,["LENGTH(",this.getQueryValue(e),")"]):new QueryUnit(Number,["DATALENGTH(",this.getQueryValue(e),")"])}stringLength(e){return new QueryUnit(Number,["LEN(",this.getQueryValue(e),")"])}cast(e,t){return"mysql"===this._dialect?new QueryUnit(t,["CONVERT(",this.getQueryValue(e),", ",this.mysqlConvertType(t),")"]):new QueryUnit(t,["CONVERT(",this.type(t),", ",this.getQueryValue(e),")"])}left(e,t){return new QueryUnit(String,["LEFT(",this.getQueryValue(e),", ",this.getQueryValue(t),")"])}right(e,t){return new QueryUnit(String,["RIGHT(",this.getQueryValue(e),", ",this.getQueryValue(t),")"])}replace(e,t,i){return new QueryUnit(String,["REPLACE(",this.getQueryValue(e),", ",this.getQueryValue(t),", ",this.getQueryValue(i),")"])}toUpperCase(e){return new QueryUnit(String,["UPPER(",this.getQueryValue(e),")"])}toLowerCase(e){return new QueryUnit(String,["LOWER(",this.getQueryValue(e),")"])}abs(e){return new QueryUnit(Number,["ABS(",this.getQueryValue(e),")"])}concat(...e){return"mysql"===this._dialect?new QueryUnit(String,["CONCAT(",...e.mapMany((e=>[void 0!==e?this.ifNull(e,"").query:"",", "])).slice(0,-1),")"]):new QueryUnit(String,[...e.mapMany((e=>[e instanceof QueryUnit?this.ifNull(e,"").query:void 0!==e?this.getQueryValue(e):"","sqlite"===this._dialect?" || ":" + "])).slice(0,-1)])}count(e){return new QueryUnit(Number,void 0!==e?["COUNT(DISTINCT(",this.getQueryValue(e),"))"]:"COUNT(*)")}sum(e){return new QueryUnit(Number,["SUM(",this.getQueryValue(e),")"])}avg(e){return new QueryUnit(Number,["AVG(",this.getQueryValue(e),")"])}round(e,t){return new QueryUnit(Number,["ROUND(",this.getQueryValue(e),", ",t,")"])}max(e){const t=SdOrmUtil.getQueryValueType(e);if(!t)throw new TypeError;return new QueryUnit(t,["MAX(",this.getQueryValue(e),")"])}min(e){const t=SdOrmUtil.getQueryValueType(e);if(!t)throw new TypeError;return new QueryUnit(t,["MIN(",this.getQueryValue(e),")"])}exists(e){return this.case(this.greaterThen(this.ifNull(this.count(e),0),0),!0).else(!1)}notExists(e){return this.case(this.lessThenOrEqual(this.ifNull(this.count(e),0),0),!0).else(!1)}getQueryValue(e){if(e instanceof QueryUnit)return e.query instanceof Array?this._getQueryValueArray(e.query):e.query instanceof QueryUnit||e.query instanceof Queryable?this.getQueryValue(e.query):e.query;if("string"==typeof e)return"mysql"===this._dialect||"sqlite"===this._dialect?`'${e.replace(/'/g,"''")}'`:`N'${e.replace(/'/g,"''")}'`;if("boolean"==typeof e)return e?"1":"0";if(e instanceof p.ou)return"mysql"===this._dialect?"STR_TO_DATE('"+e.toFormatString("yyyy-MM-dd HH:mm:ss")+"', '%Y-%m-%d %H:%i:%s')":"'"+e.toFormatString("yyyy-MM-dd HH:mm:ss")+"'";if(e instanceof p.uE)return"mysql"===this._dialect?"STR_TO_DATE('"+e.toFormatString("yyyy-MM-dd")+"', '%Y-%m-%d')":"'"+e.toFormatString("yyyy-MM-dd")+"'";if(e instanceof p.qp)return"'"+e.toFormatString("HH:mm:ss")+"'";if(e instanceof Buffer)return`0x${e.toString("hex")}`;if(e instanceof p.r6)return"mysql"===this._dialect?"'"+e.toString().replace(/-/g,"")+"'":"'"+e.toString()+"'";if(e instanceof Queryable){const t=e.getSelectQueryDef();if(1!==t.top)throw new Error("하나의 필드를 추출하기 위한 내부쿼리에서는 반드시 TOP 1 이 지정 되야 합니다.");if(Object.keys(t.select).length>1)throw new Error("하나의 필드를 추출하기 위한 내부쿼리에서는 반드시 하나의 컬럼만 SELECT 되야 합니다.");return t}return e??"NULL"}getBulkInsertQueryValue(e){if(e instanceof QueryUnit)return e.query instanceof Array?this._getBulkInsertQueryValueArray(e.query):e.query instanceof QueryUnit||e.query instanceof Queryable?this.getBulkInsertQueryValue(e.query):e.query;if("string"==typeof e)return e;if("boolean"==typeof e)return e?"1":"0";if(e instanceof p.ou)return e.date;if(e instanceof p.uE)return e.date;if(e instanceof p.qp)return e.toFormatString("HH:mm:ss");if(e instanceof Buffer)return`0x${e.toString("hex")}`;if(e instanceof p.r6)return e.toString();if(e instanceof Queryable){const t=e.getSelectQueryDef();if(1!==t.top)throw new Error("하나의 필드를 추출하기 위한 내부쿼리에서는 반드시 TOP 1 이 지정 되야 합니다.");if(void 0!==t.select||Object.keys(t.select).length>1)throw new Error("하나의 필드를 추출하기 위한 내부쿼리에서는 반드시 하나의 컬럼만 SELECT 되야 합니다.");return t}return e}_getBulkInsertQueryValueArray(e){return e.map((e=>e instanceof Array?this._getBulkInsertQueryValueArray(e):e instanceof QueryUnit||e instanceof Queryable?this.getBulkInsertQueryValue(e):e))}_getQueryValueArray(e){return e.map((e=>e instanceof Array?this._getQueryValueArray(e):e instanceof QueryUnit||e instanceof Queryable?this.getQueryValue(e):e))}type(e){if("string"==typeof e)return e;if(void 0!==e?.type){const t=e;switch(t.type){case"TEXT":return"mysql"===this._dialect?"LONGTEXT":"NTEXT";case"DECIMAL":return"DECIMAL("+t.precision+(null==t.digits||0===t.digits?"":", "+t.digits)+")";case"STRING":return"mysql"===this._dialect&&"MAX"===t.length?"LONGTEXT":"NVARCHAR("+(t.length??"255")+")";case"FIXSTRING":return"NCHAR("+t.length+")";case"BINARY":if("mysql"===this._dialect){const e=t.length??"MAX";return"MAX"===e?"LONGBLOB":"VARBINARY("+e+")"}return"VARBINARY("+(t.length??"MAX")+")";default:throw new TypeError}}else{const t=e;switch(t){case String:return"NVARCHAR(255)";case Number:return"sqlite"===this._dialect?"INTEGER":"BIGINT";case Boolean:return"mysql"===this._dialect?"BOOLEAN":"BIT";case p.ou:return"mysql"===this._dialect?"DATETIME":"DATETIME2";case p.uE:return"DATE";case p.qp:return"TIME";case p.r6:return"mysql"===this._dialect?"CHAR(38)":"UNIQUEIDENTIFIER";case Buffer:return this.type({type:"BINARY",length:"MAX"});default:throw new TypeError(void 0!==t?t.name:"undefined")}}}mysqlConvertType(e){switch(e){case String:return"CHAR";case Number:case Boolean:return"DECIMAL";case p.ou:return"DATETIME";case p.uE:return"DATE";case p.qp:return"TIME";case p.r6:return"CHAR";case Buffer:return"BINARY";default:throw new TypeError(e.name)}}}class QueryBuilder{constructor(e){this._dialect=e,this.qh=new QueryHelper(this._dialect)}createDatabaseIfNotExists(e){return"mysql"===this._dialect?`\nCREATE DATABASE IF NOT EXISTS ${this.wrap(e.database)};\nALTER DATABASE ${this.wrap(e.database)} CHARACTER SET utf8 COLLATE utf8_bin;`.trim():"mssql-azure"===this._dialect?`IF NOT EXISTS(SELECT * FROM sys.databases WHERE name='${e.database}') CREATE DATABASE ${this.wrap(e.database)} (EDITION='Standard', SERVICE_OBJECTIVE='S0', MAXSIZE = 250 GB) WITH CATALOG_COLLATION = Korean_Wansung_CS_AS`.trim():`IF NOT EXISTS(SELECT * FROM sys.databases WHERE name = '${e.database}') CREATE DATABASE ${this.wrap(e.database)} COLLATE Korean_Wansung_CS_AS`}clearDatabaseIfExists(e){return"mysql"===this._dialect?`DROP DATABASE IF EXISTS ${this.wrap(e.database)};`:"mssql-azure"===this._dialect?`\nIF EXISTS(select * from sys.databases WHERE name='${e.database}')\nBEGIN\n  DECLARE @sql NVARCHAR(MAX);\n  SET @sql = N'';\n    \n  -- 프록시저 초기화\n  SELECT @sql = @sql + 'DROP PROCEDURE ' + QUOTENAME(SCHEMA_NAME(schema_id)) + '.' + QUOTENAME(o.name) +';' + CHAR(13) + CHAR(10)\n  FROM sys.sql_modules m\n  INNER JOIN sys.objects o ON m.object_id=o.object_id\n  WHERE type_desc like '%PROCEDURE%'\n  AND SCHEMA_NAME(schema_id) <> 'sys'\n    \n  -- 함수 초기화\n  SELECT @sql = @sql + 'DROP FUNCTION ' + QUOTENAME(SCHEMA_NAME(schema_id)) + '.' + QUOTENAME(o.name) + N';' + CHAR(13) + CHAR(10)\n  FROM sys.sql_modules m\n  INNER JOIN sys.objects o ON m.object_id=o.object_id\n  WHERE type_desc like '%function%'\n  AND SCHEMA_NAME(schema_id) <> 'sys'\n    \n  -- 뷰 초기화\n  SELECT @sql = @sql + 'DROP VIEW ' + QUOTENAME(SCHEMA_NAME(schema_id)) + '.' + QUOTENAME(v.name) + N';' + CHAR(13) + CHAR(10)\n  FROM sys.views v\n  WHERE SCHEMA_NAME(schema_id) <> 'sys'\n    \n  -- 테이블 FK 끊기 초기화\n  SELECT @sql = @sql + N'ALTER TABLE ' + QUOTENAME(SCHEMA_NAME([tbl].schema_id)) + '.' + QUOTENAME([tbl].[name]) + N' DROP CONSTRAINT ' + QUOTENAME([obj].[name]) + N';' + CHAR(13) + CHAR(10)\n  FROM sys.tables [tbl]\n  INNER JOIN sys.objects AS [obj] ON [obj].[parent_object_id] = [tbl].[object_id] AND [obj].[type] = 'F'\n\n  -- 테이블 삭제\n  SELECT @sql = @sql + N'DROP TABLE ' + QUOTENAME(SCHEMA_NAME(schema_id)) + '.' + QUOTENAME([tbl].[name]) + N';' + CHAR(13) + CHAR(10)\n  FROM sys.tables [tbl]\n  WHERE [type]= 'U'\n\n  EXEC(@sql);\nEND`.trim():`\nIF EXISTS(select * from sys.databases WHERE name='${e.database}')\nBEGIN\n  DECLARE @sql NVARCHAR(MAX);\n  SET @sql = N'';\n    \n  -- 프록시저 초기화\n  SELECT @sql = @sql + 'DROP PROCEDURE ${this.wrap(e.database)}.' + QUOTENAME(sch.name) + '.' + QUOTENAME(o.name) +';' + CHAR(13) + CHAR(10)\n  FROM ${this.wrap(e.database)}.sys.sql_modules m\n  INNER JOIN ${this.wrap(e.database)}.sys.objects o ON m.object_id=o.object_id\n  INNER JOIN ${this.wrap(e.database)}.sys.schemas sch ON sch.schema_id = [o].schema_id\n  WHERE type_desc like '%PROCEDURE%'\n    \n  -- 함수 초기화\n  SELECT @sql = @sql + 'DROP FUNCTION ${this.wrap(e.database)}.' + QUOTENAME(sch.name) + '.' + QUOTENAME(o.name) + N';' + CHAR(13) + CHAR(10)\n  FROM ${this.wrap(e.database)}.sys.sql_modules m\n  INNER JOIN ${this.wrap(e.database)}.sys.objects o ON m.object_id=o.object_id\n  INNER JOIN ${this.wrap(e.database)}.sys.schemas sch ON sch.schema_id = [o].schema_id\n  WHERE type_desc like '%function%' AND sch.name <> 'sys'\n    \n  -- 뷰 초기화\n  SELECT @sql = @sql + 'DROP VIEW ${this.wrap(e.database)}.' + QUOTENAME(sch.name) + '.' + QUOTENAME(v.name) + N';' + CHAR(13) + CHAR(10)\n  FROM ${this.wrap(e.database)}.sys.views v\n  INNER JOIN ${this.wrap(e.database)}.sys.schemas sch ON sch.schema_id = [v].schema_id\n  WHERE sch.name <> 'sys'\n    \n  -- 테이블 FK 끊기 초기화\n  SELECT @sql = @sql + N'ALTER TABLE ${this.wrap(e.database)}.' + QUOTENAME(sch.name) + '.' + QUOTENAME([tbl].[name]) + N' DROP CONSTRAINT ' + QUOTENAME([obj].[name]) + N';' + CHAR(13) + CHAR(10)\n  FROM ${this.wrap(e.database)}.sys.tables [tbl]\n  INNER JOIN ${this.wrap(e.database)}.sys.objects AS [obj] ON [obj].[parent_object_id] = [tbl].[object_id] AND [obj].[type] = 'F'\n  INNER JOIN ${this.wrap(e.database)}.sys.schemas sch ON sch.schema_id = [tbl].schema_id\n\n  -- 테이블 삭제\n  SELECT @sql = @sql + N'DROP TABLE ${this.wrap(e.database)}.' + QUOTENAME(sch.name) + '.' + QUOTENAME([tbl].[name]) + N';' + CHAR(13) + CHAR(10)\n  FROM ${this.wrap(e.database)}.sys.tables [tbl]\n  INNER JOIN ${this.wrap(e.database)}.sys.schemas sch ON sch.schema_id = [tbl].schema_id\n  WHERE [type]= 'U'\n\n  EXEC(@sql);\nEND`.trim()}getDatabaseInfo(e){return"mysql"===this._dialect?`SELECT * FROM INFORMATION_SCHEMA.SCHEMATA WHERE SCHEMA_NAME='${e.database}'`.trim():`SELECT * FROM dbo.sysdatabases WHERE name='${e.database}'`.trim()}getTableInfos(e){if("mysql"===this._dialect){if(void 0===e?.database)throw new p.AJ;return`SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='${e.database}'`.trim()}if("mssql-azure"===this._dialect)return("SELECT * FROM [INFORMATION_SCHEMA].[TABLES]"+(void 0!==e?.schema?` WHERE TABLE_SCHEMA='${e.schema}'`:"")).trim();if(void 0===e?.database)throw new p.AJ;return`SELECT * FROM ${this.wrap(e.database)}.[INFORMATION_SCHEMA].[TABLES]${void 0!==e.schema?` WHERE TABLE_SCHEMA='${e.schema}'`:""}`.trim()}getTableInfo(e){if("sqlite"===this._dialect)return`SELECT * FROM sqlite_master WHERE type='table' AND name='${e.table.name}'`.trim();if("mysql"===this._dialect){if(void 0===e.table.database)throw new p.AJ;return`SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='${e.table.database}' AND TABLE_NAME='${e.table.name}'`.trim()}if("mssql-azure"===this._dialect){if(void 0===e.table.schema)throw new p.AJ;return`SELECT * FROM [INFORMATION_SCHEMA].[TABLES] WHERE TABLE_SCHEMA='${e.table.schema}' AND TABLE_NAME='${e.table.name}'`.trim()}if(void 0===e.table.database||void 0===e.table.schema)throw new p.AJ;return`SELECT * FROM ${this.wrap(e.table.database)}.[INFORMATION_SCHEMA].[TABLES] WHERE TABLE_SCHEMA='${e.table.schema}' AND TABLE_NAME='${e.table.name}'`.trim()}getTableColumnInfos(e){if("mysql"===this._dialect)throw new p.J6;{const t=void 0!==e.table.database?e.table.database+".":"";return`\nSELECT\n  c2.COLUMN_NAME as name,\n  c2.DATA_TYPE as dataType,\n  c2.CHARACTER_MAXIMUM_LENGTH as length,\n  c2.NUMERIC_PRECISION as precision,\n  c2.NUMERIC_SCALE as digits,\n  c.is_nullable as nullable,\n  c.is_identity as autoIncrement\nFROM ${t}sys.columns c\nINNER JOIN  ${t}[INFORMATION_SCHEMA].[COLUMNS] c2 ON OBJECT_ID(c2.TABLE_CATALOG + '.' + c2.TABLE_SCHEMA + '.' + c2.TABLE_NAME) = c.object_id AND c2.ORDINAL_POSITION = c.column_id\nWHERE c.object_id = OBJECT_ID('${t}${void 0!==e.table.schema?e.table.schema+".":""}${e.table.name}')\n`.trim()}}getTablePrimaryKeys(e){if("mysql"===this._dialect)throw new p.J6;{const t=void 0!==e.table.database?e.table.database+".":"";return`\nSELECT c.name as name\nFROM ${t}sys.indexes i\nINNER JOIN ${t}sys.index_columns ic ON i.object_id = ic.object_id AND i.index_id = ic.index_id\nINNER JOIN ${t}sys.columns c ON ic.object_id = c.object_id AND c.column_id = ic.column_id\nWHERE i.type = 1 AND i.object_id = OBJECT_ID('${t}${void 0!==e.table.schema?e.table.schema+".":""}${e.table.name}') \nORDER BY ic.key_ordinal;\n`.trim()}}getTableForeignKeys(e){if("mysql"===this._dialect)throw new p.J6;return`\nSELECT\n  f.name as name,\n  sc.name as sourceColumnName,\n  ts.name as targetSchemaName,\n  tt.name as targetTableName\nFROM SIMPLYSM_TS.sys.foreign_keys f\nINNER JOIN SIMPLYSM_TS.sys.foreign_key_columns fc ON f.object_id = fc.constraint_object_id\nINNER JOIN SIMPLYSM_TS.sys.columns sc ON sc.object_id = fc.parent_object_id AND sc.column_id = fc.parent_column_id\nINNER JOIN SIMPLYSM_TS.sys.tables tt ON tt.object_id = f.referenced_object_id\nINNER JOIN SIMPLYSM_TS.sys.schemas ts ON ts.schema_id = tt.schema_id\nWHERE f.parent_object_id = OBJECT_ID('${void 0!==e.table.database?e.table.database+".":""}${void 0!==e.table.schema?e.table.schema+".":""}${e.table.name}')\nORDER BY f.object_id, fc.constraint_column_id\n`.trim()}getTableIndexes(e){if("mysql"===this._dialect)throw new p.J6;{const t=void 0!==e.table.database?e.table.database+".":"";return`\nSELECT\n  i.name as name,\n  c.name as columnName,\n  ic.is_descending_key as isDesc\nFROM ${t}sys.indexes i\nINNER JOIN ${t}sys.index_columns ic ON i.object_id = ic.object_id AND i.index_id = ic.index_id\nINNER JOIN ${t}sys.columns c ON ic.object_id = c.object_id AND c.column_id = ic.column_id\nWHERE i.type = 2 AND i.object_id = OBJECT_ID('${t}${void 0!==e.table.schema?e.table.schema+".":""}${e.table.name}') \nORDER BY i.index_id, ic.key_ordinal;\n`.trim()}}createTable(e){let t="";t+=`CREATE TABLE ${this.getTableName(e.table)}\n              (  `;if(t+=e.columns.map((t=>({...t,pkOrderBy:e.primaryKeys.single((e=>e.columnName===t.name))?.orderBy}))).map((e=>"  "+this._getQueryOfColDef(e))).join(",\n"),"sqlite"===this._dialect);else if(e.primaryKeys.length>0)if(t+=",\n","mysql"===this._dialect)t+=`  PRIMARY KEY (${e.primaryKeys.map((e=>""+(this.wrap(e.columnName)+("ASC"===e.orderBy?"":` ${e.orderBy}`)))).join(", ")})\n`;else{t+=`  CONSTRAINT ${this.wrap(`PK_${e.table.name}`)} PRIMARY KEY (${e.primaryKeys.map((e=>this.wrap(e.columnName)+("ASC"===e.orderBy?"":` ${e.orderBy}`))).join(", ")})\n`}else t+="\n";return t+=");",t.trim()}dropTable(e){return`DROP TABLE ${this.getTableName(e.table)}`}addColumn(e){const t=this.getTableName(e.table),i=[];return e.column.nullable||void 0===e.column.defaultValue?i.push(`ALTER TABLE ${t}\n        ADD ${this._getQueryOfColDef(e.column)}`):(i.push(`ALTER TABLE ${t}\n        ADD ${this._getQueryOfColDef({...e.column,nullable:!0})}`),i.push(`UPDATE ${t}\n                    SET ${this.wrap(e.column.name)} = ${this.getQueryOfQueryValue(e.column.defaultValue)}`),i.push(`ALTER TABLE ${t} ALTER COLUMN ${this._getQueryOfColDef(e.column)}`)),i}removeColumn(e){return`ALTER TABLE ${this.getTableName(e.table)} DROP COLUMN ${this.wrap(e.column)}`}modifyColumn(e){if("mysql"===this._dialect){const t=this.getTableName(e.table),i=[];return e.column.nullable||void 0===e.column.defaultValue||(i.push(`ALTER TABLE ${t} MODIFY COLUMN ${this._getQueryOfColDef({...e.column,nullable:!0})}`),i.push(`UPDATE ${t}\n           SET ${this.wrap(e.column.name)} = ${this.getQueryOfQueryValue(e.column.defaultValue)}\n           WHERE ${this.wrap(e.column.name)} IS NULL`)),i.push(`ALTER TABLE ${t} MODIFY COLUMN ${this._getQueryOfColDef(e.column)}`),i}{const t=this.getTableName(e.table),i=[];return e.column.nullable||void 0===e.column.defaultValue||(i.push(`ALTER TABLE ${t} ALTER COLUMN ${this._getQueryOfColDef({...e.column,nullable:!0})}`),i.push(`UPDATE ${t}\n                      SET ${this.wrap(e.column.name)} = ${this.getQueryOfQueryValue(e.column.defaultValue)}\n                      WHERE ${this.wrap(e.column.name)} IS NULL`)),i.push(`ALTER TABLE ${t} ALTER COLUMN ${this._getQueryOfColDef(e.column)}`),i}}renameColumn(e){if("mysql"===this._dialect){return`ALTER TABLE ${this.getTableName(e.table)} RENAME COLUMN ${this.wrap(e.prevName)} TO ${this.wrap(e.nextName)}`}if("mssql-azure"===this._dialect){if(void 0===e.table.schema)throw new p.AJ;return`EXECUTE sp_rename N'${e.table.schema}.${e.table.name}.${this.wrap(e.prevName)}', N'${e.nextName}', 'COLUMN'`}if(void 0===e.table.database||void 0===e.table.schema)throw new p.AJ;return`EXECUTE ${e.table.database}..sp_rename N'${e.table.schema}.${e.table.name}.${this.wrap(e.prevName)}', N'${e.nextName}', 'COLUMN'`}dropPrimaryKey(e){if("mysql"===this._dialect)throw new p.J6;return`ALTER TABLE ${void 0!==e.table.database?e.table.database+".":""}${void 0!==e.table.schema?e.table.schema+".":""}${e.table.name} DROP CONSTRAINT PK_${e.table.name}`}addPrimaryKey(e){if("mysql"===this._dialect)throw new p.J6;return`ALTER TABLE ${void 0!==e.table.database?e.table.database+".":""}${void 0!==e.table.schema?e.table.schema+".":""}${e.table.name} ADD CONSTRAINT PK_${e.table.name} PRIMARY KEY (${e.columns.map((e=>this.wrap(e))).join(", ")})`}addForeignKey(e){if("sqlite"===this._dialect){const t=this.getTableNameChain(e.table).join("."),i=this.getTableNameChain(e.table),s=i.join("_").length>30?i.join("_").replace(/[a-z]/g,""):i.join("_"),n=this.wrap(`FK_${s}_${e.foreignKey.name}`),a=this.getTableName(e.foreignKey.targetTable);return`\npragma writable_schema=1;\nUPDATE sqlite_master\nSET sql = SUBSTR(sql, 1, LENGTH(sql) - 1) || ',\n  CONSTRAINT ${n} FOREIGN KEY (${e.foreignKey.fkColumns.map((e=>`${this.wrap(e)}`)).join(", ")})\n    REFERENCES ${a}(${e.foreignKey.targetPkColumns.map((e=>`${this.wrap(e)}`)).join(", ")})\n    ON UPDATE RESTRICT\n    ON DELETE RESTRICT\n)'\nWHERE name = '${t}' AND type = 'table'\nRETURNING *;\npragma writable_schema=0;`.trim()}{const t=this.getTableName(e.table),i=this.getTableNameChain(e.table),s="mysql"===this._dialect&&i.join("_").length>30?i.join("_").replace(/[a-z]/g,""):i.join("_"),n=this.wrap(`FK_${s}_${e.foreignKey.name}`),a=this.getTableName(e.foreignKey.targetTable);let r="";return r+=`ALTER TABLE ${t}\n        ADD CONSTRAINT ${n} FOREIGN KEY (${e.foreignKey.fkColumns.map((e=>`${this.wrap(e)}`)).join(", ")})  `,r+=`  REFERENCES ${a} (${e.foreignKey.targetPkColumns.map((e=>`${this.wrap(e)}`)).join(", ")})\n`,r+="  ON DELETE NO ACTION\n",r+="  ON UPDATE NO ACTION",r.trim()}}removeForeignKey(e){const t=this.getTableName(e.table),i=this.getTableNameChain(e.table),s="mysql"===this._dialect&&i.join("_").length>30?i.join("_").replace(/[a-z]/g,""):i.join("_");return`ALTER TABLE ${t} DROP CONSTRAINT ${this.wrap(`FK_${s}_${e.foreignKey}`)}`}createIndex(e){const t=this.getTableName(e.table),i="mysql"===this._dialect?this.getTableNameChain(e.table):this.getTableNameChain(e.table).slice(-2),s="mysql"===this._dialect&&i.join("_").length>30?i.join("_").replace(/[a-z]/g,""):i.join("_");return`CREATE INDEX ${this.wrap(`IDX_${s}_${e.index.name}`)} ON ${t} (${e.index.columns.map((e=>`${this.wrap(e.name)} ${e.orderBy}`)).join(", ")})`}dropIndex(e){const t=this.getTableName(e.table),i="mysql"===this._dialect?this.getTableNameChain(e.table):this.getTableNameChain(e.table).slice(-2),s="mysql"===this._dialect&&i.join("_").length>30?i.join("_").replace(/[a-z]/g,""):i.join("_");return`DROP INDEX ${this.wrap(`IDX_${s}_${e.index}`)} ON ${t}`}configIdentityInsert(e){return`SET IDENTITY_INSERT ${this.getTableName(e.table)} ${e.state.toUpperCase()}`}configForeignKeyCheck(e){if("mysql"===this._dialect)return`SET foreign_key_checks=${e.useCheck?1:0};`;return`ALTER TABLE ${this.getTableName(e.table)} ${e.useCheck?"":"NO"} CHECK CONSTRAINT ALL;`}select(e){if(void 0!==e.top&&e.limit)throw new Error("TOP과 LIMIT은 함께사용할 수 없습니다.");let t="SELECT";if(e.distinct&&(t+=" DISTINCT"),"mssql"!==this._dialect&&"mssql-azure"!==this._dialect||void 0!==e.top&&(t+=` TOP ${e.top}`),e.select){t+="\n";const i=[];for(const t of Object.keys(e.select)){const s=e.select[t];if(void 0!==s?.from){const e=s;let n="  (\n";n+="    "+this.select(e).replace(/\n/g,"\n    ")+"\n",n+=`  ) as ${t}`,i.push(n)}else i.push(`  ${this.getQueryOfQueryValue(e.select[t])} as ${t}`)}t+=i.join(",\n"),t+="\n"}else t+=" *\n";if(e.from instanceof Array){t+="FROM (\n";for(const i of e.from)t+="  "+this.select(i).replace(/\n/g,"\n  "),t+="\n\n  UNION ALL\n\n";t=t.slice(0,-14),t+=")"}else if(void 0!==e.from?.from){const i=e.from;t+="FROM (\n",t+="  "+this.select(i).replace(/\n/g,"\n  ")+"\n",t+=")"}else void 0!==e.from&&(t+=`FROM ${e.from}`);if(void 0!==e.from&&void 0!==e.as&&(t+=` as ${e.as}`),"string"==typeof e.from&&e.lock&&(t+=" with (XLOCK)"),t+="\n","mysql"!==this._dialect&&e.pivot){let i=this.getQueryOfQueryValue(e.pivot.valueColumn);i=i.startsWith("(")&&i.endsWith(")")?i.slice(1,-1):i,t+=`PIVOT (${i} FOR ${this.getQueryOfQueryValue(e.pivot.pivotColumn)}`,t+=` IN (${e.pivot.pivotKeys.map((e=>this.wrap(e))).join(", ")}))${void 0!==e.as?` as ${e.as}`:""}`,t+="\n"}if(e.unpivot){let i=this.getQueryOfQueryValue(e.unpivot.valueColumn);i=i.startsWith("(")&&i.endsWith(")")?i.slice(1,-1):i,t+=`UNPIVOT (${i} FOR ${this.getQueryOfQueryValue(e.unpivot.pivotColumn)}`,t+=` IN (${e.unpivot.pivotKeys.map((e=>this.wrap(e))).join(", ")}))${void 0!==e.as?` as ${e.as}`:""}`,t+="\n"}if(e.join&&e.join.length>0)for(const i of e.join)t+=this._getQueryOfJoinDef(i),t+="\n";if(e.where&&(t+=`WHERE ${e.where.map((e=>this.getQueryOfQueryValue(e))).join("")}`,t+="\n"),e.groupBy&&e.groupBy.length>0&&(t+=`GROUP BY ${e.groupBy.map((e=>this.getQueryOfQueryValue(e))).join(", ")}`,t+="\n"),e.having){if(!(e.groupBy&&e.groupBy.length>0))throw new Error("'HAVING'을 사용하려면, 'GROUP BY'를 반드시 설정해야 합니다.");t+=`HAVING ${e.having.map((e=>this.getQueryOfQueryValue(e))).join("")}`,t+="\n"}if(e.orderBy&&e.orderBy.length>0&&(t+=`ORDER BY ${e.orderBy.map((e=>this.getQueryOfQueryValue(e[0])+" "+e[1])).join(", ")}`,t+="\n"),e.limit){if(!(e.orderBy&&e.orderBy.length>0))throw new Error("'LIMIT'을 사용하려면, 'ORDER BY'를 반드시 설정해야 합니다.");"mssql"===this._dialect||"mssql-azure"===this._dialect?(t+=`OFFSET ${e.limit[0]} ROWS FETCH NEXT ${e.limit[1]} ROWS ONLY`,t+="\n"):(t+=`LIMIT ${e.limit[0]}, ${e.limit[1]}`,t+="\n")}if("mssql"!==this._dialect&&"mssql-azure"!==this._dialect&&void 0!==e.top&&(t+=`LIMIT ${e.top}`,t+="\n"),void 0!==e.sample){if("mssql"!==this._dialect)throw new Error("'select > sample'의 경우 mssql만 구현되어 있습니다.");t+=`TABLESAMPLE (${e.sample} ROWS)`,t+="\n"}return t.trim()}insert(e){let t="";return t+=`INSERT INTO ${e.from} (${Object.keys(e.record).join(", ")})`,t+="\n","mssql"!==this._dialect&&"mssql-azure"!==this._dialect||e.output&&(t+=`OUTPUT ${e.output.map((e=>"INSERTED."+e)).join(", ")}`,t+="\n"),t+=`VALUES (${Object.values(e.record).map((e=>this.getQueryOfQueryValue(e))).join(", ")})`,t+="\n","sqlite"===this._dialect&&e.output&&(t+=`RETURNING ${e.output.join(", ")}`,t+="\n"),t.trim()+";"}update(e){if("sqlite"===this._dialect){if(e.join&&e.join.length>0)throw new p.J6("sqlite - update - join");if(e.limit||void 0!==e.top)throw new p.J6("sqlite - update - limit, top")}if(void 0===e.as)throw new p.AJ;if(void 0!==e.top&&e.limit)throw new Error("TOP과 LIMIT은 함께사용할 수 없습니다.");let t="";if(t+="UPDATE","mssql"!==this._dialect&&"mssql-azure"!==this._dialect||void 0!==e.top&&(t+=` TOP (${e.top})`),"mssql"!==this._dialect&&"mssql-azure"!==this._dialect){if(t+=` ${e.from} as ${e.as}`,t+="\n",e.join&&e.join.length>0)for(const i of e.join)t+=this._getQueryOfJoinDef(i),t+="\n";t+="SET",t+="\n"}else t+=` ${e.as} SET`,t+="\n";if(t+=Object.keys(e.record).map((t=>`  ${"sqlite"===this._dialect?"":e.as+"."}${t} = ${this.getQueryOfQueryValue(e.record[t])}`)).join(",\n"),t+="\n","mssql"!==this._dialect&&"mssql-azure"!==this._dialect||e.output&&(t+=`OUTPUT ${e.output.map((e=>"INSERTED."+e)).join(", ")}`,t+="\n"),("mssql"===this._dialect||"mssql-azure"===this._dialect)&&(t+=`FROM ${e.from} as ${e.as}`,t+="\n",e.join&&e.join.length>0))for(const i of e.join)t+=this._getQueryOfJoinDef(i),t+="\n";return e.where&&(t+=`WHERE ${e.where.map((e=>this.getQueryOfQueryValue(e))).join("")}`,t+="\n"),"mssql"!==this._dialect&&"mssql-azure"!==this._dialect&&void 0!==e.top&&(t+=`LIMIT ${e.top}`,t+="\n"),"sqlite"===this._dialect&&e.output&&(t+=`RETURNING ${e.output.join(", ")}`,t+="\n"),t.trim()+";"}insertIfNotExists(e){if("mysql"===this._dialect)throw new p.J6;{let t="";return t+=`MERGE ${e.from} as ${e.as}`,t+="\n",t+="USING (SELECT 0 as _using) as _using",t+="\n",t+=`ON ${e.where.map((e=>this.getQueryOfQueryValue(e))).join("")}`,t+="\n",t+="WHEN NOT MATCHED THEN\n",t+=`  INSERT (${Object.keys(e.insertRecord).join(", ")})\n`,t+=`  VALUES (${Object.values(e.insertRecord).map((e=>this.getQueryOfQueryValue(e))).join(", ")})`,t+="\n",e.output&&("sqlite"===this._dialect?(t+=`RETURNING ${e.output.join(", ")}`,t+="\n"):(t+=`OUTPUT ${e.output.map((e=>"INSERTED."+e)).join(", ")}`,t+="\n")),t.trim()+";"}}upsert(e){if("sqlite"===this._dialect)throw new p.J6("sqlite - upsert");if("mysql"===this._dialect){const t=this.wrap("SD"+p.r6.new().toString().replace(/-/g,""));return`\nUSE ${e.from.split(".")[0]};\n\nCREATE PROCEDURE ${t}()\nproc_label:BEGIN\n\nIF EXISTS (\n  ${this.select(e).replace(/\n/g,"\n  ")}\n) THEN\n\n${Object.keys(e.updateRecord).length>0?this.update({...e,record:e.updateRecord}):"LEAVE proc_label;"}\n\nELSE\n\n${Object.keys(e.insertRecord).length>0?this.insert({...e,record:e.insertRecord}):"LEAVE proc_label;"}\n\nEND IF;\n\nEND;\nCALL ${t};\nDROP PROCEDURE ${t};`.trim()+";"}{let t="";return t+=`MERGE ${e.from} as ${e.as}`,t+="\n",t+="USING (SELECT 0 as _using) as _using",t+="\n",t+=`ON ${e.where.map((e=>this.getQueryOfQueryValue(e))).join("")}`,t+="\n",void 0!==e.updateRecord&&Object.keys(e.updateRecord).length>0&&(t+="WHEN MATCHED THEN\n",t+="  UPDATE SET\n",t+=Object.keys(e.updateRecord).map((t=>`    ${t} = ${this.getQueryOfQueryValue(e.updateRecord[t])}`)).join(",\n"),t+="\n"),t+="WHEN NOT MATCHED THEN\n",t+=`  INSERT (${Object.keys(e.insertRecord).join(", ")})\n`,t+=`  VALUES (${Object.values(e.insertRecord).map((e=>this.getQueryOfQueryValue(e))).join(", ")})`,t+="\n",e.output&&(t+=`OUTPUT ${e.output.map((e=>"INSERTED."+e)).join(", ")}`,t+="\n"),t.trim()+";"}}delete(e){if(void 0===e.as)throw new p.AJ;if("mysql"===this._dialect)return`\nUSE ${e.from.split(".")[0]};\n      \nSET @cols = NULL;\n\nSELECT GROUP_CONCAT('${"`_"+e.as.slice(1)}.\`', COLUMN_NAME, '\`', ' = ', '${e.as}.\`', COLUMN_NAME, '\`' separator ' AND ') INTO @cols\nFROM INFORMATION_SCHEMA.COLUMNS\nWHERE CONCAT('\`', TABLE_SCHEMA, '\`.\`', TABLE_NAME, '\`') = '${e.from}' AND COLUMN_KEY='PRI';\n\nSET @sql = CONCAT('${`DELETE ${e.as} FROM ${e.from} as ${e.as} JOIN (\n  ${this.select(e).replace(/\n/g,"\n  ").replace("*",e.as+".*")}\n) ${"`_"+e.as.slice(1)} ON 1 = 1 WHERE `.replace(/'/g,"''")}', @cols, ';');\nSELECT @sql;\n\nPREPARE stmt FROM @sql;\nEXECUTE stmt;\nDEALLOCATE PREPARE stmt;`.trim();{if("sqlite"===this._dialect){if(e.join&&e.join.length>0)throw new p.J6("sqlite - update - join");if(e.limit||void 0!==e.top)throw new p.J6("sqlite - update - limit, top")}let t="";if(t+="DELETE",void 0!==e.top&&(t+=` TOP (${e.top})`),t+="\n","sqlite"!==this._dialect&&(t+=` ${e.as}`,t+="\n"),e.output&&("sqlite"===this._dialect?(t+=`RETURNING ${e.output.map((e=>"DELETED."+e)).join(", ")}`,t+="\n"):(t+=`OUTPUT ${e.output.map((e=>"DELETED."+e)).join(", ")}`,t+="\n")),t+=`FROM ${e.from} as ${e.as}`,t+="\n",e.join&&e.join.length>0)for(const i of e.join)t+=this._getQueryOfJoinDef(i),t+="\n";return e.where&&(t+=`WHERE ${e.where.map((e=>this.getQueryOfQueryValue(e))).join("")}`,t+="\n"),t.trim()+";"}}truncateTable(e){return`TRUNCATE TABLE ${this.getTableName(e.table)}`}query(e){return this[e.type](e)}wrap(e){return"mysql"===this._dialect?"`"+e+"`":"["+e+"]"}getTableName(e){return this.getTableNameChain(e).map((e=>this.wrap(e))).join(".")}getTableNameChain(e){if("mysql"===this._dialect)return void 0!==e.database?[e.database,e.name]:[e.name];if("mssql-azure"===this._dialect)return void 0!==e.schema?[e.schema,e.name]:[e.name];if(void 0!==e.database){if(void 0===e.schema)throw new Error(`SCHEMA가 지정되어있지 않습니다. (DB: ${e.database}, TABLE: ${e.name})`);return[e.database,e.schema,e.name]}return void 0!==e.schema?[e.schema,e.name]:[e.name]}getQueryOfQueryValue(e){if(e instanceof Array)return"("+e.map((e=>this.getQueryOfQueryValue(e))).join("")+")";if(void 0!==e.from){let t="(\n";return t+="  "+this.select(e).replace(/\n/g,"\n  ")+"\n",t+=")",t}return e}_getQueryOfColDef(e){let t="";return"sqlite"===this._dialect?(t+=this.wrap(e.name)+" ",t+=this.qh.type(e.dataType)+" ",t+=e.pkOrderBy?`PRIMARY KEY ${e.pkOrderBy} `:"",t+=e.autoIncrement?"UNIQUEIDENTIFIER"===this.qh.type(e.dataType)?"default NEWID() ":"AUTOINCREMENT ":"",t+=e.autoIncrement?"":e.nullable?"NULL ":"NOT NULL "):"mysql"===this._dialect?(t+=this.wrap(e.name)+" ",t+=this.qh.type(e.dataType)+" ",t+=e.nullable?"NULL ":"NOT NULL ",t+=e.autoIncrement?"CHAR(38)"===this.qh.type(e.dataType)?"default (REPLACE(UUID(), '-', '')) ":"AUTO_INCREMENT":""):(t+=this.wrap(e.name)+" ",t+=this.qh.type(e.dataType)+" ",t+=e.autoIncrement?"UNIQUEIDENTIFIER"===this.qh.type(e.dataType)?"default NEWID() ":"IDENTITY(1,1) ":"",t+=e.nullable?"NULL":"NOT NULL"),t.trim()}_getQueryOfJoinDef(e){let t="";if(Object.keys(e).every((t=>void 0===e[t]||["from","as","where","select","isCustomSelect"].includes(t)))&&!e.isCustomSelect){if(t+="LEFT OUTER JOIN ",e.from instanceof Array){if(void 0===e.as)throw new p.AJ;t+="(\n";for(const i of e.from)t+="  "+this.select(i).replace(/\n/g,"\n  "),t+="\n\n  UNION ALL\n\n";t=t.slice(0,-14),t+=`) as ${e.as}`}else if(void 0!==e.from?.from){if(void 0===e.as)throw new p.AJ;t+="(\n",t+="  "+this.select(e.from).replace(/\n/g,"\n  ")+"\n",t+=`) as ${e.as}`}else{if(void 0===e.as)throw new p.AJ;t+=`${e.from} as ${e.as}`}e.where?t+=` ON ${e.where.map((e=>this.getQueryOfQueryValue(e))).join("")}`:t+=" ON 1 = 1"}else"sqlite"===this._dialect?(t+="LEFT OUTER JOIN (\n",t+="  "+this.select(e).replace(/\n/g,"\n  ")+"\n",t+=") as "+e.as):"mssql"===this._dialect||"mssql-azure"===this._dialect?(t+="OUTER APPLY (\n",t+="  "+this.select(e).replace(/\n/g,"\n  ")+"\n",t+=") as "+e.as):(t+="LEFT OUTER JOIN LATERAL (\n",t+="  "+this.select(e).replace(/\n/g,"\n  ")+"\n",t+=") as "+e.as+" ON 1 = 1");return t.trim()}}class SdOrmService extends SdServiceBase{constructor(){super(...arguments),this._logger=o.Yd.get(["simplysm","sd-service-server",this.constructor.name])}async getInfoAsync(e){const t=await SdOrmService.getDbConnConfigAsync(this.server.options.rootPath,this.request?.clientName,e);return{dialect:t.dialect,..."sqlite"===t.dialect?{}:{database:t.database,schema:t.schema}}}async connectAsync(e){const t=await SdOrmService.getDbConnConfigAsync(this.server.options.rootPath,this.request?.clientName,e),s=await class DbConnectionFactory{static async createAsync(e){return"sqlite"===e.dialect?new((await Promise.resolve().then(i.t.bind(i,3003,19))).SqliteDbConnection)(e):"mysql"===e.dialect?new((await Promise.resolve().then(i.t.bind(i,4696,19))).MysqlDbConnection)(e):new((await Promise.resolve().then(i.t.bind(i,9095,19))).MssqlDbConnection)(e)}}.createAsync(t),n=(Array.from(SdOrmService._connections.keys()).max()??0)+1;SdOrmService._connections.set(n,s),await s.connectAsync();const closeEventListener=async e=>{1001===e&&(await s.closeAsync(),this._logger.warn("소켓연결이 끊어져, DB 연결이 중지되었습니다."))};return SdOrmService._wsConnectionCloseListenerMap.set(n,closeEventListener),void 0!==this.socketId&&this.server.getWsClient(this.socketId)?.on("close",closeEventListener),s.on("close",(()=>{SdOrmService._connections.delete(n),SdOrmService._wsConnectionCloseListenerMap.delete(n),void 0!==this.socketId&&this.server.getWsClient(this.socketId)?.off("close",closeEventListener)})),n}async closeAsync(e){const t=SdOrmService._connections.get(e);t&&await t.closeAsync()}async beginTransactionAsync(e,t){const i=SdOrmService._connections.get(e);if(!i)throw new Error("DB에 연결되어있지 않습니다.");await i.beginTransactionAsync(t)}async commitTransactionAsync(e){const t=SdOrmService._connections.get(e);if(!t)throw new Error("DB에 연결되어있지 않습니다.");await t.commitTransactionAsync()}async rollbackTransactionAsync(e){const t=SdOrmService._connections.get(e);if(!t)throw new Error("DB에 연결되어있지 않습니다.");await t.rollbackTransactionAsync()}async executeAsync(e,t){const i=SdOrmService._connections.get(e);if(!i)throw new Error("DB에 연결되어있지 않습니다.");return await i.executeAsync(t)}async executeDefsAsync(e,t,i){const s=SdOrmService._connections.get(e);if(!s)throw new Error("DB에 연결되어있지 않습니다.");if(i&&i.every((e=>null==e)))return await s.executeAsync([t.map((e=>new QueryBuilder(s.config.dialect).query(e))).join("\n")]);return(await s.executeAsync(t.map((e=>new QueryBuilder(s.config.dialect).query(e))))).map(((e,t)=>SdOrmUtil.parseQueryResult(e,i?i[t]:void 0)))}async bulkInsertAsync(e,t,i,s){const n=SdOrmService._connections.get(e);if(!n)throw new Error("DB에 연결되어있지 않습니다.");await n.bulkInsertAsync(t,i,s)}}SdOrmService._connections=new Map,SdOrmService._wsConnectionCloseListenerMap=new Map,SdOrmService.getDbConnConfigAsync=async(e,t,i)=>{const s=void 0!==i.configName?(await SdServiceServerConfigUtil.getConfigAsync(e,t)).orm?.[i.configName]:void 0;if(void 0===s)throw new Error("서버에서 ORM 설정을 찾을 수 없습니다.");return{...s,...i.config}};var _=i(162);class SdSmtpClientService extends SdServiceBase{async sendAsync(e){return await new Promise(((t,i)=>{_.createTransport({host:e.host,port:e.port,secure:e.secure,auth:{user:e.user,pass:e.pass},tls:{rejectUnauthorized:!1}}).sendMail(e,((e,s)=>{e?i(e):t(s.messageId)}))}))}async sendByConfigAsync(e,t){const i=(await SdServiceServerConfigUtil.getConfigAsync(this.server.options.rootPath,this.request?.clientName)).smtp?.[e];if(void 0===i)throw new Error("서버에서 메일서버 설정을 찾을 수 없습니다.");return await this.sendAsync({user:i.user,pass:i.pass,host:i.host,port:i.port,secure:i.secure,from:`"${i.senderName}" <${i.senderEmail??i.user}>`,...t})}}},5133:e=>{"use strict";e.exports=JSON.parse('["3dm","3ds","3g2","3gp","7z","a","aac","adp","ai","aif","aiff","alz","ape","apk","appimage","ar","arj","asf","au","avi","bak","baml","bh","bin","bk","bmp","btif","bz2","bzip2","cab","caf","cgm","class","cmx","cpio","cr2","cur","dat","dcm","deb","dex","djvu","dll","dmg","dng","doc","docm","docx","dot","dotm","dra","DS_Store","dsk","dts","dtshd","dvb","dwg","dxf","ecelp4800","ecelp7470","ecelp9600","egg","eol","eot","epub","exe","f4v","fbs","fh","fla","flac","flatpak","fli","flv","fpx","fst","fvt","g3","gh","gif","graffle","gz","gzip","h261","h263","h264","icns","ico","ief","img","ipa","iso","jar","jpeg","jpg","jpgv","jpm","jxr","key","ktx","lha","lib","lvp","lz","lzh","lzma","lzo","m3u","m4a","m4v","mar","mdi","mht","mid","midi","mj2","mka","mkv","mmr","mng","mobi","mov","movie","mp3","mp4","mp4a","mpeg","mpg","mpga","mxu","nef","npx","numbers","nupkg","o","odp","ods","odt","oga","ogg","ogv","otf","ott","pages","pbm","pcx","pdb","pdf","pea","pgm","pic","png","pnm","pot","potm","potx","ppa","ppam","ppm","pps","ppsm","ppsx","ppt","pptm","pptx","psd","pya","pyc","pyo","pyv","qt","rar","ras","raw","resources","rgb","rip","rlc","rmf","rmvb","rpm","rtf","rz","s3m","s7z","scpt","sgi","shar","snap","sil","sketch","slk","smv","snk","so","stl","suo","sub","swf","tar","tbz","tbz2","tga","tgz","thmx","tif","tiff","tlz","ttc","ttf","txz","udf","uvh","uvi","uvm","uvp","uvs","uvu","viv","vob","war","wav","wax","wbmp","wdp","weba","webm","webp","whl","wim","wm","wma","wmv","wmx","woff","woff2","wrm","wvx","xbm","xif","xla","xlam","xls","xlsb","xlsm","xlsx","xlt","xltm","xltx","xm","xmind","xpi","xpm","xwd","xz","z","zip","zipx"]')},8249:e=>{"use strict";e.exports=JSON.parse('{"126":{"host":"smtp.126.com","port":465,"secure":true},"163":{"host":"smtp.163.com","port":465,"secure":true},"1und1":{"host":"smtp.1und1.de","port":465,"secure":true,"authMethod":"LOGIN"},"AOL":{"domains":["aol.com"],"host":"smtp.aol.com","port":587},"Bluewin":{"host":"smtpauths.bluewin.ch","domains":["bluewin.ch"],"port":465},"DebugMail":{"host":"debugmail.io","port":25},"DynectEmail":{"aliases":["Dynect"],"host":"smtp.dynect.net","port":25},"Ethereal":{"aliases":["ethereal.email"],"host":"smtp.ethereal.email","port":587},"FastMail":{"domains":["fastmail.fm"],"host":"smtp.fastmail.com","port":465,"secure":true},"GandiMail":{"aliases":["Gandi","Gandi Mail"],"host":"mail.gandi.net","port":587},"Gmail":{"aliases":["Google Mail"],"domains":["gmail.com","googlemail.com"],"host":"smtp.gmail.com","port":465,"secure":true},"Godaddy":{"host":"smtpout.secureserver.net","port":25},"GodaddyAsia":{"host":"smtp.asia.secureserver.net","port":25},"GodaddyEurope":{"host":"smtp.europe.secureserver.net","port":25},"hot.ee":{"host":"mail.hot.ee"},"Hotmail":{"aliases":["Outlook","Outlook.com","Hotmail.com"],"domains":["hotmail.com","outlook.com"],"host":"smtp-mail.outlook.com","port":587},"iCloud":{"aliases":["Me","Mac"],"domains":["me.com","mac.com"],"host":"smtp.mail.me.com","port":587},"Infomaniak":{"host":"mail.infomaniak.com","domains":["ik.me","ikmail.com","etik.com"],"port":587},"mail.ee":{"host":"smtp.mail.ee"},"Mail.ru":{"host":"smtp.mail.ru","port":465,"secure":true},"Maildev":{"port":1025,"ignoreTLS":true},"Mailgun":{"host":"smtp.mailgun.org","port":465,"secure":true},"Mailjet":{"host":"in.mailjet.com","port":587},"Mailosaur":{"host":"mailosaur.io","port":25},"Mailtrap":{"host":"smtp.mailtrap.io","port":2525},"Mandrill":{"host":"smtp.mandrillapp.com","port":587},"Naver":{"host":"smtp.naver.com","port":587},"One":{"host":"send.one.com","port":465,"secure":true},"OpenMailBox":{"aliases":["OMB","openmailbox.org"],"host":"smtp.openmailbox.org","port":465,"secure":true},"Outlook365":{"host":"smtp.office365.com","port":587,"secure":false},"OhMySMTP":{"host":"smtp.ohmysmtp.com","port":587,"secure":false},"Postmark":{"aliases":["PostmarkApp"],"host":"smtp.postmarkapp.com","port":2525},"qiye.aliyun":{"host":"smtp.mxhichina.com","port":"465","secure":true},"QQ":{"domains":["qq.com"],"host":"smtp.qq.com","port":465,"secure":true},"QQex":{"aliases":["QQ Enterprise"],"domains":["exmail.qq.com"],"host":"smtp.exmail.qq.com","port":465,"secure":true},"SendCloud":{"host":"smtp.sendcloud.net","port":2525},"SendGrid":{"host":"smtp.sendgrid.net","port":587},"SendinBlue":{"host":"smtp-relay.sendinblue.com","port":587},"SendPulse":{"host":"smtp-pulse.com","port":465,"secure":true},"SES":{"host":"email-smtp.us-east-1.amazonaws.com","port":465,"secure":true},"SES-US-EAST-1":{"host":"email-smtp.us-east-1.amazonaws.com","port":465,"secure":true},"SES-US-WEST-2":{"host":"email-smtp.us-west-2.amazonaws.com","port":465,"secure":true},"SES-EU-WEST-1":{"host":"email-smtp.eu-west-1.amazonaws.com","port":465,"secure":true},"Sparkpost":{"aliases":["SparkPost","SparkPost Mail"],"domains":["sparkpost.com"],"host":"smtp.sparkpostmail.com","port":587,"secure":false},"Tipimail":{"host":"smtp.tipimail.com","port":587},"Yahoo":{"domains":["yahoo.com"],"host":"smtp.mail.yahoo.com","port":465,"secure":true},"Yandex":{"domains":["yandex.ru"],"host":"smtp.yandex.ru","port":465,"secure":true},"Zoho":{"host":"smtp.zoho.com","port":465,"secure":true,"authMethod":"LOGIN"}}')},4129:e=>{"use strict";e.exports=JSON.parse('{"name":"nodemailer","version":"6.7.8","description":"Easy as cake e-mail sending from your Node.js applications","main":"lib/nodemailer.js","scripts":{"test":"grunt --trace-warnings"},"repository":{"type":"git","url":"https://github.com/nodemailer/nodemailer.git"},"keywords":["Nodemailer"],"author":"Andris Reinman","license":"MIT","bugs":{"url":"https://github.com/nodemailer/nodemailer/issues"},"homepage":"https://nodemailer.com/","devDependencies":{"@aws-sdk/client-ses":"3.145.0","aws-sdk":"2.1193.0","bunyan":"1.8.15","chai":"4.3.6","eslint-config-nodemailer":"1.2.0","eslint-config-prettier":"8.5.0","grunt":"1.5.3","grunt-cli":"1.4.3","grunt-eslint":"24.0.0","grunt-mocha-test":"0.13.3","libbase64":"1.2.1","libmime":"5.1.0","libqp":"1.1.0","mocha":"10.0.0","nodemailer-ntlm-auth":"1.0.3","proxy":"1.0.2","proxy-test-server":"1.0.0","sinon":"14.0.0","smtp-server":"3.11.0"},"engines":{"node":">=6.0.0"}}')}},s={};function __webpack_require__(e){var t=s[e];if(void 0!==t)return t.exports;var n=s[e]={exports:{}};return i[e](n,n.exports,__webpack_require__),n.exports}t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(i,s){if(1&s&&(i=this(i)),8&s)return i;if("object"==typeof i&&i){if(4&s&&i.__esModule)return i;if(16&s&&"function"==typeof i.then)return i}var n=Object.create(null);__webpack_require__.r(n);var a={};e=e||[null,t({}),t([]),t(t)];for(var r=2&s&&i;"object"==typeof r&&!~e.indexOf(r);r=t(r))Object.getOwnPropertyNames(r).forEach((e=>a[e]=()=>i[e]));return a.default=()=>i,__webpack_require__.d(n,a),n},__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n=__webpack_require__(2314);module.exports=n})();